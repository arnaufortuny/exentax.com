{
  "version": 3,
  "sources": ["../shared/models/auth.ts", "../shared/schema.ts", "../server/db.ts", "../server/lib/email-translations.ts", "../server/lib/email.ts", "../server/lib/id-generator.ts", "../server/lib/rate-limiter.ts", "../server/lib/security.ts", "../server/lib/auth-service.ts", "../server/utils/encryption.ts", "../server/calendar-service.ts", "../vite.config.ts", "../node_modules/nanoid/url-alphabet/index.js", "../node_modules/nanoid/index.js", "../server/vite.ts", "../server/index.ts", "../server/lib/custom-auth.ts", "../server/storage.ts", "../server/routes.ts", "../server/oauth.ts", "../server/lib/abandoned-service.ts", "../server/lib/backup-service.ts", "../server/replit_integrations/object_storage/objectStorage.ts", "../server/replit_integrations/object_storage/objectAcl.ts", "../server/replit_integrations/object_storage/routes.ts", "../server/lib/csrf.ts", "../server/routes/shared.ts", "../server/routes/admin-orders.ts", "../server/routes/admin-users.ts", "../server/routes/admin-billing.ts", "../server/routes/admin-comms.ts", "../server/routes/admin-documents.ts", "../server/routes/consultations.ts", "../server/routes/user-profile.ts", "../server/routes/orders.ts", "../shared/routes.ts", "../server/lib/pdf-generator.ts", "../server/routes/llc.ts", "../server/routes/maintenance.ts", "../server/routes/accounting.ts", "../server/routes/messages.ts", "../server/routes/contact.ts", "../server/routes/auth-ext.ts", "../server/static.ts", "../server/lib/sentry.ts", "../server/lib/backup.ts", "../server/sitemap.ts"],
  "sourcesContent": ["import { sql } from \"drizzle-orm\";\nimport { index, jsonb, pgTable, timestamp, varchar, boolean, text, integer } from \"drizzle-orm/pg-core\";\n\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)]\n);\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  clientId: varchar(\"client_id\", { length: 8 }).unique(), // 8-digit numeric ID\n  email: varchar(\"email\").unique(),\n  passwordHash: varchar(\"password_hash\"),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  phone: varchar(\"phone\"),\n  address: text(\"address\"),\n  streetType: text(\"street_type\"),\n  city: text(\"city\"),\n  province: text(\"province\"),\n  postalCode: text(\"postal_code\"),\n  country: text(\"country\"),\n  businessActivity: text(\"business_activity\"),\n  idNumber: text(\"id_number\"),\n  idType: text(\"id_type\"),\n  birthDate: text(\"birth_date\"),\n  emailVerified: boolean(\"email_verified\").notNull().default(false),\n  preferredLanguage: varchar(\"preferred_language\", { length: 5 }).default(\"es\"), // es, en, ca\n  isAdmin: boolean(\"is_admin\").notNull().default(false),\n  isSupport: boolean(\"is_support\").notNull().default(false),\n  isActive: boolean(\"is_active\").notNull().default(true),\n  accountStatus: text(\"account_status\").notNull().default(\"active\"), // active (Verificado), pending (En revisi\u00F3n), deactivated (Desactivada), vip\n  loginAttempts: integer(\"login_attempts\").notNull().default(0),\n  lockUntil: timestamp(\"lock_until\"),\n  internalNotes: text(\"internal_notes\"),\n  googleId: varchar(\"google_id\"),\n  // Security tracking fields\n  lastLoginIp: varchar(\"last_login_ip\"),\n  loginCount: integer(\"login_count\").notNull().default(0),\n  securityOtpRequired: boolean(\"security_otp_required\").notNull().default(false),\n  lastSecurityOtpAt: timestamp(\"last_security_otp_at\"),\n  pendingProfileChanges: jsonb(\"pending_profile_changes\"),\n  pendingChangesExpiresAt: timestamp(\"pending_changes_expires_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const userNotifications = pgTable(\"user_notifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  orderId: integer(\"order_id\"),\n  orderCode: text(\"order_code\"),\n  ticketId: text(\"ticket_id\").unique(),\n  type: text(\"type\").notNull(),\n  title: text(\"title\").notNull(),\n  message: text(\"message\").notNull(),\n  isRead: boolean(\"is_read\").notNull().default(false),\n  actionUrl: text(\"action_url\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => [\n  index(\"user_notifications_user_id_idx\").on(table.userId),\n  index(\"user_notifications_is_read_idx\").on(table.isRead),\n  index(\"user_notifications_ticket_id_idx\").on(table.ticketId),\n]);\n\nexport const passwordResetTokens = pgTable(\"password_reset_tokens\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  token: varchar(\"token\").notNull().unique(),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  used: boolean(\"used\").notNull().default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const emailVerificationTokens = pgTable(\"email_verification_tokens\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  token: varchar(\"token\").notNull().unique(),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  used: boolean(\"used\").notNull().default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\nexport type PasswordResetToken = typeof passwordResetTokens.$inferSelect;\nexport type EmailVerificationToken = typeof emailVerificationTokens.$inferSelect;\nexport type UserNotification = typeof userNotifications.$inferSelect;\n", "export * from \"./models/auth\";\nimport { pgTable, text, serial, integer, boolean, timestamp, jsonb, varchar, index } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\nimport { users } from \"./models/auth\";\nimport { relations, sql } from \"drizzle-orm\";\n\nexport const products = pgTable(\"products\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  description: text(\"description\").notNull(),\n  price: integer(\"price\").notNull(), // in cents\n  features: jsonb(\"features\").$type<string[]>().notNull(),\n});\n\nexport const orders = pgTable(\"orders\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  productId: integer(\"product_id\").notNull().references(() => products.id),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, paid, processing, documents_ready, completed, cancelled\n  stripeSessionId: text(\"stripe_session_id\"),\n  amount: integer(\"amount\").notNull(),\n  originalAmount: integer(\"original_amount\"), // original amount before discount\n  discountCode: varchar(\"discount_code\", { length: 50 }),\n  discountAmount: integer(\"discount_amount\").default(0), // discount in cents\n  currency: varchar(\"currency\", { length: 3 }).notNull().default(\"EUR\"), // USD or EUR\n  isInvoiceGenerated: boolean(\"is_invoice_generated\").notNull().default(false),\n  invoiceNumber: text(\"invoice_number\"),\n  paymentLink: text(\"payment_link\"), // admin-set payment link URL\n  paymentStatus: text(\"payment_status\").default(\"pending\"), // pending, paid, overdue, cancelled\n  paymentDueDate: timestamp(\"payment_due_date\"),\n  paidAt: timestamp(\"paid_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => ({\n  userIdIdx: index(\"orders_user_id_idx\").on(table.userId),\n  statusIdx: index(\"orders_status_idx\").on(table.status),\n}));\n\nexport const llcApplications = pgTable(\"llc_applications\", {\n  id: serial(\"id\").primaryKey(),\n  orderId: integer(\"order_id\").notNull().references(() => orders.id),\n  requestCode: text(\"request_code\").unique(),\n  ownerFullName: text(\"owner_full_name\"),\n  ownerEmail: text(\"owner_email\"),\n  ownerPhone: text(\"owner_phone\"),\n  ownerBirthDate: text(\"owner_birth_date\"),\n  ownerAddress: text(\"owner_address\"),\n  ownerStreetType: text(\"owner_street_type\"), // Calle, Avenida, Paseo\n  ownerCity: text(\"owner_city\"),\n  ownerCountry: text(\"owner_country\"),\n  ownerProvince: text(\"owner_province\"),\n  ownerPostalCode: text(\"owner_postal_code\"),\n  ownerIdNumber: text(\"owner_id_number\"), // DNI/Passport number\n  ownerIdType: text(\"owner_id_type\"), // DNI or Passport\n  idLater: boolean(\"id_later\").notNull().default(false),\n  dataProcessingConsent: boolean(\"data_processing_consent\").notNull().default(false),\n  termsConsent: boolean(\"terms_consent\").notNull().default(false),\n  ageConfirmation: boolean(\"age_confirmation\").notNull().default(false),\n  companyName: text(\"company_name\"),\n  companyNameOption2: text(\"company_name_option_2\"),\n  designator: text(\"designator\"), // LLC, L.L.C., Ltd.\n  companyDescription: text(\"company_description\"),\n  businessCategory: text(\"business_category\"),\n  businessActivity: text(\"business_activity\"),\n  businessCategoryOther: text(\"business_category_other\"),\n  ownerNamesAlternates: text(\"owner_names_alternates\"), // Plan B, C, D names\n  ownerCount: integer(\"owner_count\").default(1),\n  ownerCountryResidency: text(\"owner_country_residency\"),\n  idDocumentUrl: text(\"id_document_url\"),\n  isSellingOnline: text(\"is_selling_online\"), // Yes, No, Not sure\n  needsBankAccount: text(\"needs_bank_account\"), // Mercury, Relay, No, Yes\n  willUseStripe: text(\"will_use_stripe\"), // Stripe, PayPal, Both, Other, Not yet\n  wantsBoiReport: text(\"wants_boi_report\"), // Yes, No, Info\n  wantsMaintenancePack: text(\"wants_maintenance_pack\"), // Yes, No, Info\n  paymentMethod: text(\"payment_method\"), // transfer, link\n  paymentStatus: text(\"payment_status\").notNull().default(\"unpaid\"), // unpaid, paid\n  notes: text(\"notes\"),\n  state: text(\"state\"),\n  status: text(\"status\").notNull().default(\"draft\"), // draft, submitted, filed, rejected\n  submittedAt: timestamp(\"submitted_at\"),\n  lastUpdated: timestamp(\"last_updated\").defaultNow(),\n  emailOtp: text(\"email_otp\"),\n  emailOtpExpires: timestamp(\"email_otp_expires\"),\n  emailVerified: boolean(\"email_verified\").notNull().default(false),\n  // Important dates for calendar\n  llcCreatedDate: timestamp(\"llc_created_date\"),\n  agentRenewalDate: timestamp(\"agent_renewal_date\"),\n  irs1120DueDate: timestamp(\"irs_1120_due_date\"),\n  irs5472DueDate: timestamp(\"irs_5472_due_date\"),\n  annualReportDueDate: timestamp(\"annual_report_due_date\"),\n  // Tax extension (6 months: April 15 -> October 15)\n  hasTaxExtension: boolean(\"has_tax_extension\").notNull().default(false),\n  // EIN (Employer Identification Number) - set by admin when order completed\n  ein: text(\"ein\"),\n  // Registration number from state (set by admin when filed)\n  registrationNumber: text(\"registration_number\"),\n  // LLC registered address (set by admin)\n  llcAddress: text(\"llc_address\"),\n  // Owner share/capital percentage (set by admin)\n  ownerSharePercentage: text(\"owner_share_percentage\"),\n  // Registered agent status: active, pending_renewal, renewed, expired\n  agentStatus: text(\"agent_status\").default(\"active\"),\n  // BOI (Beneficial Ownership Information) status: pending, filed, update_required, exempt\n  boiStatus: text(\"boi_status\").default(\"pending\"),\n  boiFiledDate: timestamp(\"boi_filed_date\"),\n  // Abandoned application tracking\n  abandonedAt: timestamp(\"abandoned_at\"),\n  remindersSent: integer(\"reminders_sent\").notNull().default(0),\n  lastReminderAt: timestamp(\"last_reminder_at\"),\n}, (table) => ({\n  orderIdIdx: index(\"llc_apps_order_id_idx\").on(table.orderId),\n  requestCodeIdx: index(\"llc_apps_req_code_idx\").on(table.requestCode),\n  statusIdx: index(\"llc_apps_status_idx\").on(table.status),\n}));\n\nexport const applicationDocuments = pgTable(\"application_documents\", {\n  id: serial(\"id\").primaryKey(),\n  applicationId: integer(\"application_id\").references(() => llcApplications.id),\n  orderId: integer(\"order_id\").references(() => orders.id),\n  userId: varchar(\"user_id\").references(() => users.id),\n  fileName: text(\"file_name\").notNull(),\n  fileType: text(\"file_type\").notNull(),\n  fileUrl: text(\"file_url\").notNull(),\n  documentType: text(\"document_type\").notNull(),\n  reviewStatus: text(\"review_status\").notNull().default(\"pending\"),\n  uploadedBy: varchar(\"uploaded_by\").references(() => users.id),\n  uploadedAt: timestamp(\"uploaded_at\").defaultNow(),\n  isEncrypted: boolean(\"is_encrypted\").default(false),\n  encryptionIv: text(\"encryption_iv\"),\n  fileHash: text(\"file_hash\"),\n  originalSize: integer(\"original_size\"),\n}, (table) => ({\n  applicationIdIdx: index(\"app_docs_application_id_idx\").on(table.applicationId),\n  orderIdIdx: index(\"app_docs_order_id_idx\").on(table.orderId),\n  userIdIdx: index(\"app_docs_user_id_idx\").on(table.userId),\n  uploadedByIdx: index(\"app_docs_uploaded_by_idx\").on(table.uploadedBy),\n}));\n\nexport const newsletterSubscribers = pgTable(\"newsletter_subscribers\", {\n  id: serial(\"id\").primaryKey(),\n  email: text(\"email\").notNull().unique(),\n  subscribedAt: timestamp(\"subscribed_at\").defaultNow(),\n});\n\nexport const calculatorConsultations = pgTable(\"calculator_consultations\", {\n  id: serial(\"id\").primaryKey(),\n  email: text(\"email\").notNull(),\n  income: integer(\"income\").notNull(),\n  country: text(\"country\").notNull(),\n  activity: text(\"activity\"),\n  savings: integer(\"savings\"),\n  isRead: boolean(\"is_read\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => ({\n  emailIdx: index(\"calc_consultations_email_idx\").on(table.email),\n  isReadIdx: index(\"calc_consultations_is_read_idx\").on(table.isRead),\n}));\n\nexport type CalculatorConsultation = typeof calculatorConsultations.$inferSelect;\n\nexport const messages = pgTable(\"messages\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").references(() => users.id),\n  name: text(\"name\"),\n  email: text(\"email\").notNull(),\n  phone: text(\"phone\"),\n  contactByWhatsapp: boolean(\"contact_by_whatsapp\").default(false),\n  subject: text(\"subject\"),\n  content: text(\"content\").notNull(),\n  encryptedContent: text(\"encrypted_content\"),\n  status: text(\"status\").notNull().default(\"unread\"), // unread, read, archived\n  type: text(\"type\").notNull().default(\"contact\"), // contact, support, system\n  requestCode: text(\"request_code\"),\n  messageId: text(\"message_id\").unique(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => ({\n  userIdIdx: index(\"messages_user_id_idx\").on(table.userId),\n  statusIdx: index(\"messages_status_idx\").on(table.status),\n  emailIdx: index(\"messages_email_idx\").on(table.email),\n}));\n\nexport const contactOtps = pgTable(\"contact_otps\", {\n  id: serial(\"id\").primaryKey(),\n  email: text(\"email\").notNull(),\n  otp: text(\"otp\").notNull(),\n  otpType: text(\"otp_type\").notNull().default(\"contact\"), // contact, password_change\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  verified: boolean(\"verified\").notNull().default(false),\n}, (table) => ({\n  emailIdx: index(\"contact_otps_email_idx\").on(table.email),\n  expiresAtIdx: index(\"contact_otps_expires_at_idx\").on(table.expiresAt),\n}));\n\nexport const orderEvents = pgTable(\"order_events\", {\n  id: serial(\"id\").primaryKey(),\n  orderId: integer(\"order_id\").notNull().references(() => orders.id),\n  eventType: text(\"event_type\").notNull(),\n  description: text(\"description\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  createdBy: varchar(\"created_by\").references(() => users.id),\n}, (table) => ({\n  orderIdIdx: index(\"order_events_order_id_idx\").on(table.orderId),\n}));\n\nexport const messageReplies = pgTable(\"message_replies\", {\n  id: serial(\"id\").primaryKey(),\n  messageId: integer(\"message_id\").notNull().references(() => messages.id),\n  content: text(\"content\").notNull(),\n  encryptedContent: text(\"encrypted_content\"),\n  isAdmin: boolean(\"is_admin\").notNull().default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  createdBy: varchar(\"created_by\").references(() => users.id),\n});\n\nexport const maintenanceApplications = pgTable(\"maintenance_applications\", {\n  id: serial(\"id\").primaryKey(),\n  orderId: integer(\"order_id\").notNull().references(() => orders.id),\n  requestCode: text(\"request_code\").unique(),\n  ownerFullName: text(\"owner_full_name\"),\n  ownerEmail: text(\"owner_email\"),\n  ownerPhone: text(\"owner_phone\"),\n  companyName: text(\"company_name\"),\n  ein: text(\"ein\"),\n  state: text(\"state\"),\n  creationSource: text(\"creation_source\"),\n  creationYear: text(\"creation_year\"),\n  bankAccount: text(\"bank_account\"),\n  paymentGateway: text(\"payment_gateway\"),\n  businessActivity: text(\"business_activity\"),\n  expectedServices: text(\"expected_services\"),\n  status: text(\"status\").notNull().default(\"draft\"),\n  submittedAt: timestamp(\"submitted_at\"),\n  lastUpdated: timestamp(\"last_updated\").defaultNow(),\n  emailOtp: text(\"email_otp\"),\n  emailOtpExpires: timestamp(\"email_otp_expires\"),\n  emailVerified: boolean(\"email_verified\").notNull().default(false),\n  notes: text(\"notes\"),\n  wantsDissolve: text(\"wants_dissolve\"),\n  paymentMethod: text(\"payment_method\"), // transfer, link\n  authorizedManagement: boolean(\"authorized_management\").notNull().default(false),\n  termsConsent: boolean(\"terms_consent\").notNull().default(false),\n  dataProcessingConsent: boolean(\"data_processing_consent\").notNull().default(false),\n  // Abandoned application tracking\n  abandonedAt: timestamp(\"abandoned_at\"),\n  remindersSent: integer(\"reminders_sent\").notNull().default(0),\n  lastReminderAt: timestamp(\"last_reminder_at\"),\n}, (table) => ({\n  orderIdIdx: index(\"maint_apps_order_id_idx\").on(table.orderId),\n  requestCodeIdx: index(\"maint_apps_req_code_idx\").on(table.requestCode),\n  statusIdx: index(\"maint_apps_status_idx\").on(table.status),\n}));\n\nexport const ordersRelations = relations(orders, ({ one, many }) => ({\n  user: one(users, { fields: [orders.userId], references: [users.id] }),\n  product: one(products, { fields: [orders.productId], references: [products.id] }),\n  application: one(llcApplications, { fields: [orders.id], references: [llcApplications.orderId] }),\n  maintenanceApplication: one(maintenanceApplications, { fields: [orders.id], references: [maintenanceApplications.orderId] }),\n  events: many(orderEvents),\n}));\n\nexport const orderEventsRelations = relations(orderEvents, ({ one }) => ({\n  order: one(orders, { fields: [orderEvents.orderId], references: [orders.id] }),\n}));\n\nexport const messagesRelations = relations(messages, ({ many }) => ({\n  replies: many(messageReplies),\n}));\n\nexport const messageRepliesRelations = relations(messageReplies, ({ one }) => ({\n  message: one(messages, { fields: [messageReplies.messageId], references: [messages.id] }),\n}));\n\nexport const llcApplicationsRelations = relations(llcApplications, ({ one, many }) => ({\n  order: one(orders, { fields: [llcApplications.orderId], references: [orders.id] }),\n  documents: many(applicationDocuments),\n}));\n\nexport const applicationDocumentsRelations = relations(applicationDocuments, ({ one }) => ({\n  application: one(llcApplications, { fields: [applicationDocuments.applicationId], references: [llcApplications.id] }),\n}));\n\nexport const maintenanceApplicationsRelations = relations(maintenanceApplications, ({ one }) => ({\n  order: one(orders, { fields: [maintenanceApplications.orderId], references: [orders.id] }),\n}));\n\nexport const insertProductSchema = createInsertSchema(products).omit({ id: true });\nexport const insertOrderSchema = createInsertSchema(orders).omit({ id: true, createdAt: true });\nexport const insertLlcApplicationSchema = createInsertSchema(llcApplications).omit({ id: true, lastUpdated: true });\nexport const insertApplicationDocumentSchema = createInsertSchema(applicationDocuments).omit({ id: true, uploadedAt: true });\nexport const insertMaintenanceApplicationSchema = createInsertSchema(maintenanceApplications).omit({ id: true, lastUpdated: true });\nexport const insertContactOtpSchema = createInsertSchema(contactOtps).omit({ id: true });\nexport const insertOrderEventSchema = createInsertSchema(orderEvents).omit({ id: true, createdAt: true });\nexport const insertMessageReplySchema = createInsertSchema(messageReplies).omit({ id: true, createdAt: true });\n\n// Discount codes table\nexport const discountCodes = pgTable(\"discount_codes\", {\n  id: serial(\"id\").primaryKey(),\n  code: varchar(\"code\", { length: 50 }).notNull().unique(),\n  description: text(\"description\"),\n  discountType: varchar(\"discount_type\", { length: 20 }).notNull().default(\"percentage\"), // percentage or fixed\n  discountValue: integer(\"discount_value\").notNull(), // percentage (0-100) or fixed amount in cents\n  minOrderAmount: integer(\"min_order_amount\").default(0), // minimum order amount in cents\n  maxUses: integer(\"max_uses\"), // null = unlimited\n  usedCount: integer(\"used_count\").notNull().default(0),\n  validFrom: timestamp(\"valid_from\").defaultNow(),\n  validUntil: timestamp(\"valid_until\"),\n  isActive: boolean(\"is_active\").notNull().default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertDiscountCodeSchema = createInsertSchema(discountCodes).omit({ id: true, createdAt: true, usedCount: true });\nexport type DiscountCode = typeof discountCodes.$inferSelect;\nexport type InsertDiscountCode = z.infer<typeof insertDiscountCodeSchema>;\n\nexport const rateLimitEntries = pgTable(\"rate_limit_entries\", {\n  id: serial(\"id\").primaryKey(),\n  identifier: text(\"identifier\").notNull(),\n  limitType: text(\"limit_type\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n}, (table) => ({\n  identifierIdx: index(\"rate_limit_identifier_idx\").on(table.identifier),\n  createdAtIdx: index(\"rate_limit_created_at_idx\").on(table.createdAt),\n}));\n\nexport const auditLogs = pgTable(\"audit_logs\", {\n  id: serial(\"id\").primaryKey(),\n  action: text(\"action\").notNull(),\n  userId: varchar(\"user_id\"),\n  targetId: text(\"target_id\"),\n  ip: text(\"ip\"),\n  userAgent: text(\"user_agent\"),\n  details: jsonb(\"details\").$type<Record<string, any>>(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n}, (table) => ({\n  actionIdx: index(\"audit_logs_action_idx\").on(table.action),\n  userIdIdx: index(\"audit_logs_user_id_idx\").on(table.userId),\n  createdAtIdx: index(\"audit_logs_created_at_idx\").on(table.createdAt),\n}));\n\nexport const insertAuditLogSchema = createInsertSchema(auditLogs).omit({ id: true, createdAt: true });\nexport type AuditLog = typeof auditLogs.$inferSelect;\nexport type InsertAuditLog = z.infer<typeof insertAuditLogSchema>;\n\nexport const documentAccessLogs = pgTable(\"document_access_logs\", {\n  id: serial(\"id\").primaryKey(),\n  documentId: integer(\"document_id\").notNull().references(() => applicationDocuments.id),\n  userId: varchar(\"user_id\").references(() => users.id),\n  action: text(\"action\").notNull(), // view, download, upload, delete\n  ip: text(\"ip\"),\n  userAgent: text(\"user_agent\"),\n  success: boolean(\"success\").notNull().default(true),\n  errorMessage: text(\"error_message\"),\n  metadata: jsonb(\"metadata\").$type<Record<string, any>>(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n}, (table) => ({\n  documentIdIdx: index(\"doc_access_logs_doc_id_idx\").on(table.documentId),\n  userIdIdx: index(\"doc_access_logs_user_id_idx\").on(table.userId),\n  actionIdx: index(\"doc_access_logs_action_idx\").on(table.action),\n  createdAtIdx: index(\"doc_access_logs_created_at_idx\").on(table.createdAt),\n}));\n\nexport const insertDocumentAccessLogSchema = createInsertSchema(documentAccessLogs).omit({ id: true, createdAt: true });\nexport type DocumentAccessLog = typeof documentAccessLogs.$inferSelect;\nexport type InsertDocumentAccessLog = z.infer<typeof insertDocumentAccessLogSchema>;\n\nexport const encryptedFields = pgTable(\"encrypted_fields\", {\n  id: serial(\"id\").primaryKey(),\n  entityType: text(\"entity_type\").notNull(), // llc_application, user, maintenance\n  entityId: integer(\"entity_id\").notNull(),\n  fieldName: text(\"field_name\").notNull(),\n  encryptedValue: text(\"encrypted_value\").notNull(),\n  iv: text(\"iv\").notNull(),\n  hash: text(\"hash\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n}, (table) => ({\n  entityIdx: index(\"encrypted_fields_entity_idx\").on(table.entityType, table.entityId),\n}));\n\nexport type EncryptedField = typeof encryptedFields.$inferSelect;\n\nexport type MaintenanceApplication = typeof maintenanceApplications.$inferSelect;\nexport type Product = typeof products.$inferSelect;\nexport type Order = typeof orders.$inferSelect;\nexport type LlcApplication = typeof llcApplications.$inferSelect;\nexport type ApplicationDocument = typeof applicationDocuments.$inferSelect;\nexport type OrderEvent = typeof orderEvents.$inferSelect;\nexport type Message = typeof messages.$inferSelect;\nexport type MessageReply = typeof messageReplies.$inferSelect;\nexport type RateLimitEntry = typeof rateLimitEntries.$inferSelect;\n\nexport type CreateOrderRequest = {\n  productId: number;\n};\nexport type UpdateLlcApplicationRequest = Partial<z.infer<typeof insertLlcApplicationSchema>>;\nexport type CreateDocumentRequest = z.infer<typeof insertApplicationDocumentSchema>;\n\n// ============ CONSULTATION BOOKING SYSTEM ============\n\n// Consultation service types that admin can create\nexport const consultationTypes = pgTable(\"consultation_types\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(), // Fiscal, Banking, Strategy, etc.\n  nameEs: text(\"name_es\").notNull(),\n  nameEn: text(\"name_en\").notNull(),\n  nameCa: text(\"name_ca\").notNull(),\n  description: text(\"description\"),\n  descriptionEs: text(\"description_es\"),\n  descriptionEn: text(\"description_en\"),\n  descriptionCa: text(\"description_ca\"),\n  duration: integer(\"duration\").notNull().default(30), // in minutes\n  price: integer(\"price\").notNull().default(0), // in cents (EUR)\n  isActive: boolean(\"is_active\").notNull().default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => ({\n  isActiveIdx: index(\"consultation_types_is_active_idx\").on(table.isActive),\n}));\n\n// Availability slots that admin configures\nexport const consultationAvailability = pgTable(\"consultation_availability\", {\n  id: serial(\"id\").primaryKey(),\n  dayOfWeek: integer(\"day_of_week\").notNull(), // 0=Sunday, 1=Monday, etc.\n  startTime: text(\"start_time\").notNull(), // \"09:00\"\n  endTime: text(\"end_time\").notNull(), // \"10:00\"\n  isActive: boolean(\"is_active\").notNull().default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => ({\n  dayOfWeekIdx: index(\"consultation_avail_day_idx\").on(table.dayOfWeek),\n}));\n\n// Blocked dates (holidays, vacations, etc.)\nexport const consultationBlockedDates = pgTable(\"consultation_blocked_dates\", {\n  id: serial(\"id\").primaryKey(),\n  date: timestamp(\"date\").notNull(),\n  reason: text(\"reason\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => ({\n  dateIdx: index(\"consultation_blocked_date_idx\").on(table.date),\n}));\n\n// Actual consultation bookings\nexport const consultationBookings = pgTable(\"consultation_bookings\", {\n  id: serial(\"id\").primaryKey(),\n  bookingCode: text(\"booking_code\").unique().notNull(),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  consultationTypeId: integer(\"consultation_type_id\").notNull().references(() => consultationTypes.id),\n  scheduledDate: timestamp(\"scheduled_date\").notNull(),\n  scheduledTime: text(\"scheduled_time\").notNull(), // \"10:00\"\n  duration: integer(\"duration\").notNull(), // in minutes\n  status: text(\"status\").notNull().default(\"pending\"), // pending, confirmed, completed, cancelled, no_show, rescheduled\n  // Pre-consultation questionnaire\n  hasLlc: text(\"has_llc\"), // yes, no\n  llcState: text(\"llc_state\"),\n  estimatedRevenue: text(\"estimated_revenue\"),\n  countryOfResidence: text(\"country_of_residence\"),\n  mainTopic: text(\"main_topic\"),\n  additionalNotes: text(\"additional_notes\"),\n  // Admin notes\n  adminNotes: text(\"admin_notes\"),\n  // Meeting info\n  meetingLink: text(\"meeting_link\"),\n  // Timestamps\n  confirmedAt: timestamp(\"confirmed_at\"),\n  completedAt: timestamp(\"completed_at\"),\n  cancelledAt: timestamp(\"cancelled_at\"),\n  cancelReason: text(\"cancel_reason\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n}, (table) => ({\n  userIdIdx: index(\"consultation_bookings_user_id_idx\").on(table.userId),\n  typeIdIdx: index(\"consultation_bookings_type_id_idx\").on(table.consultationTypeId),\n  statusIdx: index(\"consultation_bookings_status_idx\").on(table.status),\n  scheduledDateIdx: index(\"consultation_bookings_date_idx\").on(table.scheduledDate),\n  bookingCodeIdx: index(\"consultation_bookings_code_idx\").on(table.bookingCode),\n}));\n\n// Relations\nexport const consultationTypesRelations = relations(consultationTypes, ({ many }) => ({\n  bookings: many(consultationBookings),\n}));\n\nexport const consultationBookingsRelations = relations(consultationBookings, ({ one }) => ({\n  user: one(users, { fields: [consultationBookings.userId], references: [users.id] }),\n  consultationType: one(consultationTypes, { fields: [consultationBookings.consultationTypeId], references: [consultationTypes.id] }),\n}));\n\n// Insert schemas\nexport const insertConsultationTypeSchema = createInsertSchema(consultationTypes).omit({ id: true, createdAt: true });\nexport const insertConsultationAvailabilitySchema = createInsertSchema(consultationAvailability).omit({ id: true, createdAt: true });\nexport const insertConsultationBlockedDateSchema = createInsertSchema(consultationBlockedDates).omit({ id: true, createdAt: true });\nexport const insertConsultationBookingSchema = createInsertSchema(consultationBookings).omit({ id: true, createdAt: true, updatedAt: true });\n\n// Types\nexport type ConsultationType = typeof consultationTypes.$inferSelect;\nexport type ConsultationAvailability = typeof consultationAvailability.$inferSelect;\nexport type ConsultationBlockedDate = typeof consultationBlockedDates.$inferSelect;\nexport type ConsultationBooking = typeof consultationBookings.$inferSelect;\nexport type InsertConsultationType = z.infer<typeof insertConsultationTypeSchema>;\nexport type InsertConsultationAvailability = z.infer<typeof insertConsultationAvailabilitySchema>;\nexport type InsertConsultationBookedDate = z.infer<typeof insertConsultationBlockedDateSchema>;\nexport type InsertConsultationBooking = z.infer<typeof insertConsultationBookingSchema>;\n\n// Accounting Transactions\nexport const accountingTransactions = pgTable(\"accounting_transactions\", {\n  id: serial(\"id\").primaryKey(),\n  type: text(\"type\").notNull(), // income, expense\n  category: text(\"category\").notNull(), // llc_formation, maintenance, consultation, state_fees, etc.\n  amount: integer(\"amount\").notNull(), // in cents (positive for income, negative for expenses)\n  currency: varchar(\"currency\", { length: 3 }).notNull().default(\"EUR\"),\n  description: text(\"description\"),\n  orderId: integer(\"order_id\").references(() => orders.id), // optional link to order\n  userId: varchar(\"user_id\").references(() => users.id), // optional link to user/client\n  reference: text(\"reference\"), // invoice number, receipt, etc.\n  transactionDate: timestamp(\"transaction_date\").notNull().defaultNow(),\n  createdBy: varchar(\"created_by\").references(() => users.id), // admin who created it\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n}, (table) => ({\n  typeIdx: index(\"accounting_tx_type_idx\").on(table.type),\n  categoryIdx: index(\"accounting_tx_category_idx\").on(table.category),\n  dateIdx: index(\"accounting_tx_date_idx\").on(table.transactionDate),\n  orderIdIdx: index(\"accounting_tx_order_id_idx\").on(table.orderId),\n}));\n\nexport const insertAccountingTransactionSchema = createInsertSchema(accountingTransactions).omit({ id: true, createdAt: true, updatedAt: true });\nexport type AccountingTransaction = typeof accountingTransactions.$inferSelect;\nexport type InsertAccountingTransaction = z.infer<typeof insertAccountingTransactionSchema>;\n\nexport const guestVisitors = pgTable(\"guest_visitors\", {\n  id: serial(\"id\").primaryKey(),\n  email: text(\"email\"),\n  source: text(\"source\").notNull(),\n  ip: text(\"ip\"),\n  userAgent: text(\"user_agent\"),\n  language: text(\"language\"),\n  page: text(\"page\"),\n  referrer: text(\"referrer\"),\n  metadata: text(\"metadata\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => ({\n  emailIdx: index(\"guest_visitors_email_idx\").on(table.email),\n  sourceIdx: index(\"guest_visitors_source_idx\").on(table.source),\n}));\n\nexport const insertGuestVisitorSchema = createInsertSchema(guestVisitors).omit({ id: true, createdAt: true });\nexport type GuestVisitor = typeof guestVisitors.$inferSelect;\nexport type InsertGuestVisitor = z.infer<typeof insertGuestVisitorSchema>;\n\nexport const paymentAccounts = pgTable(\"payment_accounts\", {\n  id: serial(\"id\").primaryKey(),\n  label: text(\"label\").notNull(),\n  holder: text(\"holder\").notNull(),\n  bankName: text(\"bank_name\").notNull(),\n  accountType: text(\"account_type\").notNull().default(\"checking\"),\n  accountNumber: text(\"account_number\"),\n  routingNumber: text(\"routing_number\"),\n  iban: text(\"iban\"),\n  swift: text(\"swift\"),\n  address: text(\"address\"),\n  isActive: boolean(\"is_active\").notNull().default(true),\n  sortOrder: integer(\"sort_order\").notNull().default(0),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertPaymentAccountSchema = createInsertSchema(paymentAccounts).omit({ id: true, createdAt: true });\nexport type PaymentAccount = typeof paymentAccounts.$inferSelect;\nexport type InsertPaymentAccount = z.infer<typeof insertPaymentAccountSchema>;\n", "import { drizzle } from \"drizzle-orm/node-postgres\";\nimport pg from \"pg\";\nimport * as schema from \"@shared/schema\";\n\nconst { Pool } = pg;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nlet connectionString = process.env.DATABASE_URL!;\nif (!connectionString.includes(\"sslmode=\")) {\n  connectionString += (connectionString.includes(\"?\") ? \"&\" : \"?\") + \"sslmode=no-verify\";\n}\n\nexport const pool = new Pool({ \n  connectionString,\n  ssl: {\n    rejectUnauthorized: false\n  },\n  connectionTimeoutMillis: 15000,\n  idleTimeoutMillis: 60000,\n  max: 25,\n  min: 2,\n  allowExitOnIdle: false,\n  keepAlive: true,\n  keepAliveInitialDelayMillis: 10000,\n});\n\npool.on('error', (err) => {\n  console.error('Database pool error:', err.message);\n});\n\npool.on('connect', () => {\n  if (process.env.NODE_ENV === 'development') {\n    console.log('Database connection established');\n  }\n});\n\nexport const db = drizzle(pool, { schema });\n", "export type EmailLanguage = 'es' | 'en' | 'ca' | 'fr' | 'de' | 'it' | 'pt';\n\ninterface EmailTranslations {\n  common: {\n    greeting: string;\n    closing: string;\n    doubts: string;\n    client: string;\n  };\n  otp: {\n    thanks: string;\n    forSecurity: string;\n    yourCode: string;\n    important: string;\n    personalAndConfidential: string;\n    validFor: string;\n    doNotShare: string;\n    ignoreMessage: string;\n    ipDetected: string;\n  };\n  welcome: {\n    welcomeMessage: string;\n    accountCreated: string;\n    accessFrom: string;\n    realTimeTracking: string;\n    documentCenter: string;\n    professionalTools: string;\n    fiscalCalendar: string;\n    directSupport: string;\n    hereToHelp: string;\n    exploreButton: string;\n  };\n  accountPendingVerification: {\n    accountCreatedBut: string;\n    actionRequired: string;\n    accessAndVerify: string;\n    verifyButton: string;\n    whileUnverified: string;\n  };\n  accountUnderReview: {\n    underReview: string;\n    whyReview: string;\n    whyReviewText: string;\n    duringProcess: string;\n    whatHappens: string;\n    step1: string;\n    step2: string;\n    step3: string;\n    teamReviewing: string;\n    patience: string;\n    closing: string;\n  };\n  accountVip: {\n    updatedToVip: string;\n    benefits: string;\n    priorityAttention: string;\n    preferentialTracking: string;\n    fullAccess: string;\n    viewDashboard: string;\n  };\n  accountReactivated: {\n    reactivated: string;\n    canAccess: string;\n    viewDashboard: string;\n  };\n  accountDeactivated: {\n    deactivated: string;\n    cannotAccess: string;\n    contactSupport: string;\n  };\n  confirmation: {\n    greatNews: string;\n    details: string;\n    reference: string;\n    service: string;\n    company: string;\n    state: string;\n    currentStatus: string;\n    inReview: string;\n    whatNow: string;\n    validatingInfo: string;\n    nextSteps: string;\n    step1: string;\n    step2: string;\n    step3: string;\n    trackButton: string;\n    questionRef: string;\n  };\n  autoReply: {\n    receivedMessage: string;\n    ticketNumber: string;\n    estimatedResponse: string;\n    responding: string;\n    seeMessages: string;\n  };\n  orderUpdate: {\n    statusChanged: string;\n    orderLabel: string;\n    newStatus: string;\n    statusPending: string;\n    statusProcessing: string;\n    statusPaid: string;\n    statusFiled: string;\n    statusDocumentsReady: string;\n    statusCompleted: string;\n    statusCancelled: string;\n    clarification: string;\n    trackButton: string;\n  };\n  orderCompleted: {\n    llcReady: string;\n    congratulations: string;\n    docsReady: string;\n    accessDocuments: string;\n    whatYouFind: string;\n    documentList: string;\n    articlesOrg: string;\n    einLetter: string;\n    registeredAgent: string;\n    additionalGuides: string;\n    viewDocuments: string;\n    nextSteps: string;\n    activateBanking: string;\n    operatingAgreement: string;\n    trackExpenses: string;\n    hereForYou: string;\n    feedbackRequest: string;\n  };\n  noteReceived: {\n    teamNote: string;\n    relatedToOrder: string;\n    respondNote: string;\n    viewClientArea: string;\n  };\n  adminNote: {\n    messageAbout: string;\n    viewTicket: string;\n    viewClientArea: string;\n  };\n  paymentRequest: {\n    paymentRequired: string;\n    messageLabel: string;\n    amount: string;\n    payNow: string;\n    buttonFallback: string;\n    securePayment: string;\n  };\n  documentRequest: {\n    needDocument: string;\n    messageLabel: string;\n    documentType: string;\n    referenceTicket: string;\n    important: string;\n    uploadInstruction: string;\n    uploadButton: string;\n  };\n  documentUploaded: {\n    documentReceived: string;\n    forOrder: string;\n    accessDownload: string;\n    reviewing: string;\n    viewDocuments: string;\n    trackButton: string;\n  };\n  messageReply: {\n    newReply: string;\n    repliedToQuery: string;\n    ticket: string;\n    viewConversation: string;\n    viewClientArea: string;\n  };\n  passwordChangeOtp: {\n    passwordChangeRequest: string;\n    useCode: string;\n    yourCode: string;\n    important: string;\n    validFor: string;\n    doNotShare: string;\n    notRequested: string;\n  };\n  profileChangeOtp: {\n    title: string;\n    sensitiveChangeRequest: string;\n    yourCode: string;\n    important: string;\n    personalAndConfidential: string;\n    validFor: string;\n    doNotShare: string;\n    ignoreMessage: string;\n  };\n  accountLocked: {\n    locked: string;\n    attempts: string;\n    verifyIdentity: string;\n    idRequirement: string;\n    birthDateConfirm: string;\n    referenceTicket: string;\n    contactSupport: string;\n    resetPassword: string;\n    unlockButton: string;\n  };\n  renewalReminder: {\n    reminderText: string;\n    expiresIn: string;\n    dueDate: string;\n    daysRemaining: string;\n    withoutMaintenance: string;\n    registeredAgentActive: string;\n    annualReports: string;\n    taxCompliance: string;\n    legalAddress: string;\n    renewNow: string;\n    whatHappens: string;\n    penalties: string;\n    agentExpires: string;\n    goodStanding: string;\n    viewCalendar: string;\n  };\n  registrationOtp: {\n    almostDone: string;\n    confirmEmail: string;\n    yourCode: string;\n    important: string;\n    validFor: string;\n    doNotShare: string;\n    clientIdLabel: string;\n    ignoreMessage: string;\n  };\n  operatingAgreementReady: {\n    ready: string;\n    generated: string;\n    llcData: string;\n    companyLabel: string;\n    stateLabel: string;\n    einLabel: string;\n    whatIs: string;\n    explanation: string;\n    fullExplanation: string;\n    reason1: string;\n    reason2: string;\n    reason3: string;\n    reason4: string;\n    generateButton: string;\n    autoGenerated: string;\n    viewDocument: string;\n    tip: string;\n    tipText: string;\n  };\n  documentApproved: {\n    title: string;\n    approved: string;\n    reviewedAndApproved: string;\n    viewDocuments: string;\n  };\n  documentRejected: {\n    title: string;\n    rejected: string;\n    reviewedAndRejected: string;\n    reason: string;\n    pleaseReupload: string;\n    viewDocuments: string;\n  };\n  profileChangesVerified: {\n    title: string;\n    client: string;\n    email: string;\n    clientId: string;\n    fieldsModified: string;\n    verifiedWithOtp: string;\n  };\n  abandonedApplication: {\n    incomplete: string;\n    noticeText: string;\n    importantNote: string;\n    draftDeletion: string;\n    understandDoubts: string;\n    questionsHelp: string;\n    whyChoose: string;\n    reason1: string;\n    reason2: string;\n    reason3: string;\n    reason4: string;\n    reason5: string;\n    noMoreReminders: string;\n    savedDraft: string;\n    continueButton: string;\n    tip: string;\n    tipText: string;\n    expiring: string;\n    llcFormation: string;\n    maintenancePack: string;\n    dontLoseProgress: string;\n    lastHours: string;\n    autoDeleteWarning: string;\n  };\n  calculatorResults: {\n    results: string;\n    introText: string;\n    summary: string;\n    income: string;\n    expenses: string;\n    autonomoTax: string;\n    llcTax: string;\n    potentialSavings: string;\n    savings: string;\n    withLLC: string;\n    learnMore: string;\n    viewServices: string;\n    disclaimer: string;\n  };\n  newsletter: {\n    confirmed: string;\n    willReceive: string;\n    unsubscribe: string;\n  };\n  orderEvent: {\n    update: string;\n    date: string;\n    viewDetails: string;\n  };\n}\n\nconst translations: Record<EmailLanguage, EmailTranslations> = {\n  es: {\n    common: {\n      greeting: \"Hola\",\n      closing: \"Saludos,\",\n      doubts: \"Si tienes cualquier duda, responde directamente a este correo.\",\n      client: \"Cliente\"\n    },\n    otp: {\n      thanks: \"Gracias por continuar con tu proceso en Easy US LLC.\",\n      forSecurity: \"Para garantizar la seguridad de tu cuenta, utiliza el siguiente c\u00F3digo de verificaci\u00F3n:\",\n      yourCode: \"Tu c\u00F3digo OTP:\",\n      important: \"Importante:\",\n      personalAndConfidential: \"Este c\u00F3digo es personal y confidencial\",\n      validFor: \"Tiene una validez limitada a <strong>15 minutos</strong> por motivos de seguridad\",\n      doNotShare: \"No lo compartas con nadie\",\n      ignoreMessage: \"Si no has solicitado este c\u00F3digo, puedes ignorar este mensaje con total tranquilidad.\",\n      ipDetected: \"Intento de acceso detectado desde la IP:\"\n    },\n    welcome: {\n      welcomeMessage: \"\u00A1Bienvenido a Easy US LLC! Nos alegra mucho tenerte con nosotros.\",\n      accountCreated: \"Tu cuenta ha sido creada correctamente y ya puedes empezar a explorar todo lo que podemos hacer juntos. Desde tu \u00C1rea Cliente tendr\u00E1s acceso a:\",\n      accessFrom: \"Desde tu \u00C1rea Cliente tendr\u00E1s acceso a:\",\n      realTimeTracking: \"Seguimiento en tiempo real de tus solicitudes\",\n      documentCenter: \"Centro de documentaci\u00F3n para descargar todos tus archivos\",\n      professionalTools: \"Herramientas profesionales como generador de facturas\",\n      fiscalCalendar: \"Calendario fiscal con tus fechas importantes\",\n      directSupport: \"Comunicaci\u00F3n directa con nuestro equipo de soporte\",\n      hereToHelp: \"Estamos aqu\u00ED para ayudarte en cada paso de tu aventura empresarial en Estados Unidos. Si tienes cualquier pregunta, no dudes en escribirnos.\",\n      exploreButton: \"Explorar Mi \u00C1rea Cliente\"\n    },\n    accountPendingVerification: {\n      accountCreatedBut: \"Tu cuenta ha sido creada correctamente, pero necesitas verificar tu email para activarla completamente.\",\n      actionRequired: \"Acci\u00F3n requerida:\",\n      accessAndVerify: \"Accede a tu \u00C1rea Cliente y verifica tu email para activar tu cuenta y acceder a todas las funciones.\",\n      verifyButton: \"Verificar mi email\",\n      whileUnverified: \"Mientras tu email no est\u00E9 verificado, tu cuenta permanecer\u00E1 en estado de revisi\u00F3n.\"\n    },\n    accountUnderReview: {\n      underReview: \"Queremos informarte de que tu cuenta ha entrado en un breve proceso de revisi\u00F3n. No te preocupes, esto es algo completamente rutinario y forma parte de nuestros est\u00E1ndares de seguridad para proteger tu informaci\u00F3n y garantizar una experiencia segura.\",\n      whyReview: \"\u00BFPor qu\u00E9 hacemos esto?\",\n      whyReviewText: \"En Easy US LLC nos tomamos muy en serio la seguridad de nuestros clientes. Este proceso nos permite verificar que toda la informaci\u00F3n est\u00E1 correcta y que tu cuenta est\u00E1 debidamente protegida.\",\n      duringProcess: \"Durante este breve per\u00EDodo, las funciones de tu cuenta estar\u00E1n temporalmente limitadas. Esto significa que no podr\u00E1s realizar nuevos pedidos ni modificar informaci\u00F3n existente, pero no te preocupes: esta situaci\u00F3n es temporal y no afectar\u00E1 a ning\u00FAn tr\u00E1mite que ya est\u00E9 en curso.\",\n      whatHappens: \"\u00BFQu\u00E9 pasar\u00E1 ahora?\",\n      step1: \"Nuestro equipo revisar\u00E1 la informaci\u00F3n de tu cuenta (normalmente en 24-48 horas laborables)\",\n      step2: \"Te notificaremos por este mismo correo en cuanto la revisi\u00F3n haya finalizado\",\n      step3: \"Si necesitamos alg\u00FAn documento adicional, te lo haremos saber de forma clara y sencilla\",\n      teamReviewing: \"Mientras tanto, si tienes cualquier pregunta o necesitas ayuda, no dudes en responder a este correo. Estamos aqu\u00ED para ayudarte en todo lo que necesites.\",\n      patience: \"Gracias por tu paciencia y confianza. Sabemos que tu tiempo es valioso y haremos todo lo posible para resolver esto lo antes posible.\",\n      closing: \"Un abrazo del equipo de Easy US LLC\"\n    },\n    accountVip: {\n      updatedToVip: \"Tu cuenta ha sido actualizada al estado VIP.\",\n      benefits: \"Beneficios VIP:\",\n      priorityAttention: \"Atenci\u00F3n prioritaria y gesti\u00F3n acelerada\",\n      preferentialTracking: \"Seguimiento preferente por nuestro equipo\",\n      fullAccess: \"Acceso completo a todos los servicios\",\n      viewDashboard: \"Ver Mi \u00C1rea Cliente\"\n    },\n    accountReactivated: {\n      reactivated: \"Tu cuenta ha sido reactivada correctamente.\",\n      canAccess: \"Ya puedes acceder a tu \u00C1rea Cliente y utilizar todos nuestros servicios con normalidad.\",\n      viewDashboard: \"Ver Mi \u00C1rea Cliente\"\n    },\n    accountDeactivated: {\n      deactivated: \"Lamentamos informarte de que tu cuenta ha sido desactivada.\",\n      cannotAccess: \"Mientras tu cuenta permanezca en este estado, no podr\u00E1s acceder a tu \u00C1rea Cliente ni realizar gestiones a trav\u00E9s de nuestra plataforma.\",\n      contactSupport: \"Si crees que esto es un error o deseas obtener m\u00E1s informaci\u00F3n, por favor contacta con nuestro equipo de soporte respondiendo a este correo.\"\n    },\n    confirmation: {\n      greatNews: \"\u00A1Excelente noticia! Hemos recibido correctamente tu solicitud y ya estamos trabajando en ella. A partir de ahora, nuestro equipo se encargar\u00E1 de todo.\",\n      details: \"Detalles de tu Solicitud\",\n      reference: \"Referencia:\",\n      service: \"Servicio:\",\n      company: \"Empresa:\",\n      state: \"Estado:\",\n      currentStatus: \"Estado actual:\",\n      inReview: \"En revisi\u00F3n\",\n      whatNow: \"\u00BFQu\u00E9 pasa ahora?\",\n      validatingInfo: \"Nuestro equipo est\u00E1 validando toda la informaci\u00F3n que nos proporcionaste. En las pr\u00F3ximas horas recibir\u00E1s actualizaciones sobre el progreso de tu solicitud directamente en tu correo. Tambi\u00E9n podr\u00E1s seguir el estado en tiempo real desde tu \u00C1rea Cliente.\",\n      nextSteps: \"Pr\u00F3ximos Pasos\",\n      step1: \"Verificaremos que toda la informaci\u00F3n es correcta\",\n      step2: \"Iniciaremos los tr\u00E1mites con las autoridades correspondientes\",\n      step3: \"Te mantendremos informado en cada etapa del proceso\",\n      trackButton: \"Ver Estado de mi Solicitud\",\n      questionRef: \"\u00BFTienes alguna pregunta? Simplemente responde a este correo mencionando tu referencia y te ayudaremos encantados.\"\n    },\n    autoReply: {\n      receivedMessage: \"Tu mensaje ha sido recibido correctamente.\",\n      ticketNumber: \"N\u00FAmero de ticket\",\n      estimatedResponse: \"Tiempo estimado de respuesta: <strong>24-48 horas laborables</strong>\",\n      responding: \"Nuestro equipo revisar\u00E1 tu consulta y te responder\u00E1 lo antes posible. Si necesitas a\u00F1adir informaci\u00F3n adicional, responde directamente a este correo.\",\n      seeMessages: \"Ver Mensajes\"\n    },\n    orderUpdate: {\n      statusChanged: \"El estado de tu pedido ha sido actualizado.\",\n      orderLabel: \"Pedido:\",\n      newStatus: \"Nuevo estado:\",\n      statusPending: \"Pendiente\",\n      statusProcessing: \"En proceso\",\n      statusPaid: \"Pagado\",\n      statusFiled: \"Presentado\",\n      statusDocumentsReady: \"Documentos listos\",\n      statusCompleted: \"Completado\",\n      statusCancelled: \"Cancelado\",\n      clarification: \"Para cualquier aclaraci\u00F3n sobre esta actualizaci\u00F3n, responde directamente a este correo.\",\n      trackButton: \"Ver detalles completos\"\n    },\n    orderCompleted: {\n      llcReady: \"\u00A1Tu LLC est\u00E1 lista!\",\n      congratulations: \"\u00A1Felicidades! Tu pedido ha sido completado con \u00E9xito. Todo est\u00E1 listo para que puedas empezar a operar con tu empresa en Estados Unidos.\",\n      docsReady: \"Tu documentaci\u00F3n est\u00E1 lista\",\n      accessDocuments: \"Ya puedes acceder y descargar todos los documentos de tu empresa desde tu Centro de Documentaci\u00F3n.\",\n      whatYouFind: \"\u00BFQu\u00E9 encontrar\u00E1s?\",\n      documentList: \"Documentos disponibles:\",\n      articlesOrg: \"Articles of Organization (documento de constituci\u00F3n)\",\n      einLetter: \"Carta del EIN del IRS\",\n      registeredAgent: \"Informaci\u00F3n del agente registrado\",\n      additionalGuides: \"Gu\u00EDas y documentos adicionales seg\u00FAn tu servicio\",\n      viewDocuments: \"Ver Mis Documentos\",\n      nextSteps: \"Pr\u00F3ximos pasos:\",\n      activateBanking: \"Activar cuenta bancaria (si solicitado)\",\n      operatingAgreement: \"Generar tu Operating Agreement\",\n      trackExpenses: \"Comenzar a registrar ingresos y gastos\",\n      hereForYou: \"Recuerda que seguimos aqu\u00ED para ayudarte en todo lo que necesites. Si tienes dudas sobre los siguientes pasos, como abrir una cuenta bancaria o configurar tu pasarela de pagos, no dudes en escribirnos.\",\n      feedbackRequest: \"Tu experiencia es muy importante para nosotros. Si tienes un momento, nos encantar\u00EDa conocer tu opini\u00F3n sobre nuestro servicio.\"\n    },\n    noteReceived: {\n      teamNote: \"Tienes un nuevo mensaje de nuestro equipo\",\n      relatedToOrder: \"relacionado con tu pedido\",\n      respondNote: \"Puedes responder directamente a este correo o acceder a tu \u00C1rea Cliente para ver el historial completo.\",\n      viewClientArea: \"Ver Mi \u00C1rea Cliente\"\n    },\n    adminNote: {\n      messageAbout: \"Tienes un mensaje importante sobre tu solicitud:\",\n      viewTicket: \"Ver Ticket\",\n      viewClientArea: \"Ver Mi \u00C1rea Cliente\"\n    },\n    paymentRequest: {\n      paymentRequired: \"Se ha generado una solicitud de pago para continuar con tu tr\u00E1mite\",\n      messageLabel: \"Mensaje:\",\n      amount: \"por un valor de\",\n      payNow: \"Realizar Pago\",\n      buttonFallback: \"Si el bot\u00F3n no funciona, copia y pega este enlace:\",\n      securePayment: \"El pago se procesa de forma segura a trav\u00E9s de Stripe.\"\n    },\n    documentRequest: {\n      needDocument: \"Nuestro equipo requiere que subas el siguiente documento:\",\n      messageLabel: \"Mensaje:\",\n      documentType: \"Documento solicitado:\",\n      referenceTicket: \"Ticket de referencia:\",\n      important: \"Importante:\",\n      uploadInstruction: \"Por favor, sube el documento solicitado lo antes posible para evitar retrasos en el proceso.\",\n      uploadButton: \"Subir Documento\"\n    },\n    documentUploaded: {\n      documentReceived: \"Hemos a\u00F1adido un nuevo documento a tu expediente:\",\n      forOrder: \"Pedido:\",\n      accessDownload: \"Puedes acceder y descargar este documento desde tu \u00C1rea Cliente.\",\n      reviewing: \"Nuestro equipo lo revisar\u00E1 y te notificaremos si es necesaria alguna acci\u00F3n adicional.\",\n      viewDocuments: \"Ver Mis Documentos\",\n      trackButton: \"Ver estado de mi solicitud\"\n    },\n    messageReply: {\n      newReply: \"Tienes una nueva respuesta en tu conversaci\u00F3n:\",\n      repliedToQuery: \"Hemos respondido a tu consulta\",\n      ticket: \"Ticket:\",\n      viewConversation: \"Ver conversaci\u00F3n\",\n      viewClientArea: \"Ver Mi \u00C1rea Cliente\"\n    },\n    passwordChangeOtp: {\n      passwordChangeRequest: \"Has solicitado cambiar tu contrase\u00F1a. Usa este c\u00F3digo para verificar tu identidad:\",\n      useCode: \"Utiliza el siguiente c\u00F3digo para confirmar el cambio:\",\n      yourCode: \"Tu c\u00F3digo de verificaci\u00F3n:\",\n      important: \"Importante:\",\n      validFor: \"Este c\u00F3digo expira en <strong>10 minutos</strong>\",\n      doNotShare: \"No lo compartas con nadie\",\n      notRequested: \"Si no solicitaste este cambio, ignora este mensaje.\"\n    },\n    profileChangeOtp: {\n      title: \"Verificaci\u00F3n de Identidad\",\n      sensitiveChangeRequest: \"Se ha solicitado un cambio en los datos sensibles de tu perfil. Para confirmar tu identidad, utiliza el siguiente c\u00F3digo de verificaci\u00F3n:\",\n      yourCode: \"Tu c\u00F3digo de verificaci\u00F3n:\",\n      important: \"Importante:\",\n      personalAndConfidential: \"Este c\u00F3digo es personal y confidencial\",\n      validFor: \"Tiene una validez de <strong>24 horas</strong>\",\n      doNotShare: \"No lo compartas con nadie\",\n      ignoreMessage: \"Si no has solicitado este cambio, puedes ignorar este mensaje con total tranquilidad.\"\n    },\n    accountLocked: {\n      locked: \"Por su seguridad, su cuenta ha sido temporalmente bloqueada tras detectar m\u00FAltiples intentos de acceso fallidos.\",\n      attempts: \"Para desbloquear su cuenta y verificar su identidad, necesitamos que nos env\u00EDe:\",\n      verifyIdentity: \"Para desbloquear su cuenta y verificar su identidad, necesitamos que nos env\u00EDe:\",\n      idRequirement: \"Imagen del DNI/Pasaporte de alta resoluci\u00F3n (ambas caras)\",\n      birthDateConfirm: \"Su fecha de nacimiento confirmada\",\n      referenceTicket: \"Su Ticket ID de referencia es:\",\n      contactSupport: \"Para desbloquear tu cuenta, contacta con nuestro equipo de soporte:\",\n      resetPassword: \"Restablecer contrase\u00F1a\",\n      unlockButton: \"Contactar Soporte\"\n    },\n    renewalReminder: {\n      reminderText: \"Te recordamos que el pack de mantenimiento de tu LLC\",\n      expiresIn: \"Vence en\",\n      dueDate: \"Fecha de vencimiento:\",\n      daysRemaining: \"D\u00EDas restantes:\",\n      withoutMaintenance: \"Sin el pack de mantenimiento activo, tu LLC puede perder su buen estado legal. Esto incluye:\",\n      registeredAgentActive: \"Agente registrado activo\",\n      annualReports: \"Presentaci\u00F3n de informes anuales\",\n      taxCompliance: \"Cumplimiento fiscal (IRS 1120/5472)\",\n      legalAddress: \"Domicilio legal en Estados Unidos\",\n      renewNow: \"Renovar Ahora\",\n      whatHappens: \"\u00BFQu\u00E9 pasa si no renuevo?\",\n      penalties: \"Posibles penalizaciones y recargos\",\n      agentExpires: \"Tu registered agent expirar\u00E1\",\n      goodStanding: \"Tu LLC podr\u00EDa perder el buen estado\",\n      viewCalendar: \"Ver calendario fiscal\"\n    },\n    registrationOtp: {\n      almostDone: \"Gracias por registrarte en Easy US LLC. Tu c\u00F3digo de verificaci\u00F3n es:\",\n      confirmEmail: \"Para completar el registro de tu cuenta, introduce el siguiente c\u00F3digo de verificaci\u00F3n:\",\n      yourCode: \"Tu c\u00F3digo de verificaci\u00F3n:\",\n      important: \"Importante:\",\n      validFor: \"Este c\u00F3digo expira en\",\n      doNotShare: \"No lo compartas con nadie\",\n      clientIdLabel: \"Tu ID de cliente es:\",\n      ignoreMessage: \"Si no has creado una cuenta con nosotros, puedes ignorar este mensaje.\"\n    },\n    operatingAgreementReady: {\n      ready: \"\u00A1Tu Operating Agreement est\u00E1 listo!\",\n      generated: \"Tenemos excelentes noticias para ti.\",\n      llcData: \"Datos de tu LLC\",\n      companyLabel: \"Empresa:\",\n      stateLabel: \"Estado:\",\n      einLabel: \"EIN:\",\n      whatIs: \"\u00BFQu\u00E9 es el Operating Agreement?\",\n      explanation: \"Es el documento legal que establece las reglas de funcionamiento de tu LLC, incluyendo la estructura de propiedad, distribuci\u00F3n de beneficios y responsabilidades de los miembros.\",\n      fullExplanation: \"Es el documento legal fundamental de tu LLC. Define c\u00F3mo se gestiona tu empresa, las responsabilidades del propietario y las reglas de operaci\u00F3n. Aunque en algunos estados no es obligatorio, es altamente recomendable tenerlo porque:\",\n      reason1: \"Refuerza la separaci\u00F3n entre tus finanzas personales y las de la empresa\",\n      reason2: \"Es requerido por bancos y procesadores de pago como Stripe\",\n      reason3: \"Proporciona protecci\u00F3n legal adicional para ti como propietario\",\n      reason4: \"Documenta oficialmente la estructura de tu negocio\",\n      generateButton: \"Generar mi Operating Agreement\",\n      autoGenerated: \"El documento se generar\u00E1 autom\u00E1ticamente con los datos de tu LLC y se guardar\u00E1 en tu Centro de Documentaci\u00F3n para que puedas descargarlo cuando lo necesites.\",\n      viewDocument: \"Ver mi documento\",\n      tip: \"Consejo:\",\n      tipText: \"Guarda una copia firmada de este documento junto con tus otros archivos importantes de la empresa.\"\n    },\n    documentApproved: {\n      title: \"Documento Aprobado\",\n      approved: \"Aprobado\",\n      reviewedAndApproved: \"Tu documento ha sido revisado y aprobado correctamente.\",\n      viewDocuments: \"Ver mis documentos\"\n    },\n    documentRejected: {\n      title: \"Documento Rechazado - Acci\u00F3n Requerida\",\n      rejected: \"Rechazado\",\n      reviewedAndRejected: \"Tu documento ha sido revisado y rechazado.\",\n      reason: \"Motivo\",\n      pleaseReupload: \"Por favor, accede a tu panel de cliente y sube nuevamente el documento corregido.\",\n      viewDocuments: \"Ver mis documentos\"\n    },\n    profileChangesVerified: {\n      title: \"Cambios de Perfil Verificados con OTP\",\n      client: \"Cliente\",\n      email: \"Email\",\n      clientId: \"ID de Cliente\",\n      fieldsModified: \"Campos modificados\",\n      verifiedWithOtp: \"Cambio verificado con OTP\"\n    },\n    abandonedApplication: {\n      incomplete: \"Tu solicitud est\u00E1 incompleta\",\n      noticeText: \"Hemos notado que empezaste a completar tu solicitud de\",\n      importantNote: \"Nota importante:\",\n      draftDeletion: \"Tu borrador se eliminar\u00E1 autom\u00E1ticamente si no lo completas. Por motivos de seguridad y protecci\u00F3n de datos, no podemos mantener solicitudes incompletas indefinidamente.\",\n      understandDoubts: \"Entendemos que dar el paso de crear una LLC puede generar algunas dudas. Queremos que sepas que estamos aqu\u00ED para ayudarte en cada paso del proceso.\",\n      questionsHelp: \"Si tienes alguna pregunta o necesitas asistencia para completar tu solicitud, simplemente responde a este correo y te ayudaremos encantados.\",\n      whyChoose: \"\u00BFPor qu\u00E9 elegir Easy US LLC?\",\n      reason1: \"Formaci\u00F3n completa en 48-72 horas\",\n      reason2: \"Asistencia en espa\u00F1ol durante todo el proceso\",\n      reason3: \"Obtenci\u00F3n del EIN incluida\",\n      reason4: \"Ayuda con apertura de cuenta bancaria\",\n      reason5: \"Soporte continuo post-formaci\u00F3n\",\n      noMoreReminders: \"Si finalmente decides no continuar, no te enviaremos m\u00E1s recordatorios sobre esta solicitud. Tu privacidad es importante para nosotros.\",\n      savedDraft: \"No te preocupes, hemos guardado todo tu progreso para que puedas continuar exactamente donde lo dejaste.\",\n      continueButton: \"Continuar mi Solicitud\",\n      tip: \"Consejo:\",\n      tipText: \"Completa tu solicitud para que podamos empezar a trabajar en tu LLC lo antes posible.\",\n      expiring: \"Tu borrador expirar\u00E1 en 48 horas si no lo completas.\",\n      llcFormation: \"constituci\u00F3n de tu LLC\",\n      maintenancePack: \"paquete de mantenimiento\",\n      dontLoseProgress: \"No pierdas tu progreso. Retoma tu solicitud ahora y completa el proceso en pocos minutos.\",\n      lastHours: \"\u00FAltimas horas\",\n      autoDeleteWarning: \"Tu solicitud se eliminar\u00E1 autom\u00E1ticamente si no la completas.\"\n    },\n    calculatorResults: {\n      results: \"Resultados de tu c\u00E1lculo\",\n      introText: \"Aqu\u00ED tienes el resumen de tu comparaci\u00F3n fiscal que solicitaste. Hemos analizado los n\u00FAmeros y queremos que tengas toda la informaci\u00F3n para tomar la mejor decisi\u00F3n para tu negocio.\",\n      summary: \"Resumen de tu An\u00E1lisis\",\n      income: \"Ingresos anuales:\",\n      expenses: \"Gastos deducibles:\",\n      autonomoTax: \"Impuestos como aut\u00F3nomo:\",\n      llcTax: \"Impuestos con LLC:\",\n      potentialSavings: \"Tu ahorro potencial:\",\n      savings: \"Ahorro estimado:\",\n      withLLC: \"Con una LLC en Estados Unidos, podr\u00EDas optimizar significativamente tu carga fiscal mientras operas de forma completamente legal. Este ahorro se mantiene a\u00F1o tras a\u00F1o, lo que puede suponer una diferencia importante para tu negocio a largo plazo.\",\n      learnMore: \"\u00BFTe gustar\u00EDa saber m\u00E1s sobre c\u00F3mo funciona? Estaremos encantados de resolver todas tus dudas sin ning\u00FAn compromiso.\",\n      viewServices: \"Ver Nuestros Servicios\",\n      disclaimer: \"Este c\u00E1lculo es orientativo y se basa en los datos que proporcionaste. Para un an\u00E1lisis personalizado de tu situaci\u00F3n, no dudes en contactarnos.\"\n    },\n    newsletter: {\n      confirmed: \"Tu suscripci\u00F3n ha sido confirmada correctamente.\",\n      willReceive: \"Recibir\u00E1s informaci\u00F3n relevante sobre servicios, actualizaciones y novedades relacionadas con Easy US LLC.\",\n      unsubscribe: \"Puedes darte de baja en cualquier momento desde el enlace incluido en nuestros correos.\"\n    },\n    orderEvent: {\n      update: \"Tu pedido tiene una actualizaci\u00F3n:\",\n      date: \"Fecha:\",\n      viewDetails: \"Ver Detalles\"\n    }\n  },\n  en: {\n    common: {\n      greeting: \"Hello\",\n      closing: \"Best regards,\",\n      doubts: \"If you have any questions, reply directly to this email.\",\n      client: \"Client\"\n    },\n    otp: {\n      thanks: \"Thank you for continuing with your process at Easy US LLC.\",\n      forSecurity: \"To ensure the security of your account, use the following verification code:\",\n      yourCode: \"Your OTP code:\",\n      important: \"Important:\",\n      personalAndConfidential: \"This code is personal and confidential\",\n      validFor: \"It is valid for <strong>15 minutes</strong> for security reasons\",\n      doNotShare: \"Do not share it with anyone\",\n      ignoreMessage: \"If you did not request this code, you can safely ignore this message.\",\n      ipDetected: \"Login attempt detected from IP:\"\n    },\n    welcome: {\n      welcomeMessage: \"Welcome to Easy US LLC! We're thrilled to have you with us.\",\n      accountCreated: \"Your account has been created successfully and you can start exploring everything we can do together. From your Client Area you'll have access to:\",\n      accessFrom: \"From your Client Area you'll have access to:\",\n      realTimeTracking: \"Real-time tracking of your requests\",\n      documentCenter: \"Documentation center to download all your files\",\n      professionalTools: \"Professional tools like invoice generator\",\n      fiscalCalendar: \"Fiscal calendar with your important dates\",\n      directSupport: \"Direct communication with our support team\",\n      hereToHelp: \"We're here to help you at every step of your business journey in the United States. If you have any questions, don't hesitate to contact us.\",\n      exploreButton: \"Explore My Client Area\"\n    },\n    accountPendingVerification: {\n      accountCreatedBut: \"Your account has been created successfully, but you need to verify your email to fully activate it.\",\n      actionRequired: \"Action required:\",\n      accessAndVerify: \"Access your Client Area and verify your email to activate your account and access all features.\",\n      verifyButton: \"Verify my email\",\n      whileUnverified: \"While your email is not verified, your account will remain under review.\"\n    },\n    accountUnderReview: {\n      underReview: \"We wanted to let you know that your account has entered a brief review process. Don't worry, this is completely routine and is part of our security standards to protect your information and ensure a safe experience.\",\n      whyReview: \"Why do we do this?\",\n      whyReviewText: \"At Easy US LLC, we take our clients' security very seriously. This process allows us to verify that all information is correct and that your account is properly protected.\",\n      duringProcess: \"During this brief period, your account functions will be temporarily limited. This means you won't be able to place new orders or modify existing information, but don't worry: this situation is temporary and won't affect any procedures already in progress.\",\n      whatHappens: \"What happens now?\",\n      step1: \"Our team will review your account information (usually within 24-48 business hours)\",\n      step2: \"We'll notify you by this same email once the review is complete\",\n      step3: \"If we need any additional documents, we'll let you know clearly and simply\",\n      teamReviewing: \"In the meantime, if you have any questions or need help, don't hesitate to reply to this email. We're here to help you with whatever you need.\",\n      patience: \"Thank you for your patience and trust. We know your time is valuable and we'll do everything possible to resolve this as quickly as possible.\",\n      closing: \"Warm regards from the Easy US LLC team\"\n    },\n    accountVip: {\n      updatedToVip: \"Your account has been upgraded to VIP status.\",\n      benefits: \"VIP Benefits:\",\n      priorityAttention: \"Priority attention and expedited processing\",\n      preferentialTracking: \"Preferential tracking by our team\",\n      fullAccess: \"Full access to all services\",\n      viewDashboard: \"View My Client Area\"\n    },\n    accountReactivated: {\n      reactivated: \"Your account has been successfully reactivated.\",\n      canAccess: \"You can now access your Client Area and use all our services normally.\",\n      viewDashboard: \"View My Client Area\"\n    },\n    accountDeactivated: {\n      deactivated: \"We regret to inform you that your account has been deactivated.\",\n      cannotAccess: \"While your account remains in this state, you will not be able to access your Client Area or perform any operations through our platform.\",\n      contactSupport: \"If you believe this is an error or would like more information, please contact our support team by replying to this email.\"\n    },\n    confirmation: {\n      greatNews: \"Great news! We have received your request and are already working on it. From now on, our team will take care of everything.\",\n      details: \"Request Details\",\n      reference: \"Reference:\",\n      service: \"Service:\",\n      company: \"Company:\",\n      state: \"State:\",\n      currentStatus: \"Current status:\",\n      inReview: \"Under review\",\n      whatNow: \"What happens now?\",\n      validatingInfo: \"Our team is validating all the information you provided. In the next few hours you will receive updates on the progress of your request directly to your email. You can also track the status in real time from your Client Area.\",\n      nextSteps: \"Next Steps\",\n      step1: \"We will verify that all information is correct\",\n      step2: \"We will begin the procedures with the corresponding authorities\",\n      step3: \"We will keep you informed at every stage of the process\",\n      trackButton: \"View My Request Status\",\n      questionRef: \"Have any questions? Simply reply to this email mentioning your reference and we'll be happy to help.\"\n    },\n    autoReply: {\n      receivedMessage: \"Your message has been received successfully.\",\n      ticketNumber: \"Ticket number\",\n      estimatedResponse: \"Estimated response time: <strong>24-48 business hours</strong>\",\n      responding: \"Our team will review your inquiry and respond as soon as possible. If you need to add additional information, reply directly to this email.\",\n      seeMessages: \"View Messages\"\n    },\n    orderUpdate: {\n      statusChanged: \"Your order status has been updated.\",\n      orderLabel: \"Order:\",\n      newStatus: \"New status:\",\n      statusPending: \"Pending\",\n      statusProcessing: \"Processing\",\n      statusPaid: \"Paid\",\n      statusFiled: \"Filed\",\n      statusDocumentsReady: \"Documents ready\",\n      statusCompleted: \"Completed\",\n      statusCancelled: \"Cancelled\",\n      clarification: \"For any clarification about this update, reply directly to this email.\",\n      trackButton: \"View full details\"\n    },\n    orderCompleted: {\n      llcReady: \"Your LLC is ready!\",\n      congratulations: \"Congratulations! Your order has been completed successfully. Everything is ready for you to start operating your business in the United States.\",\n      docsReady: \"Your documentation is ready\",\n      accessDocuments: \"You can now access and download all your company documents from your Documentation Center.\",\n      whatYouFind: \"What will you find?\",\n      documentList: \"Available documents:\",\n      articlesOrg: \"Articles of Organization (formation document)\",\n      einLetter: \"EIN Letter from the IRS\",\n      registeredAgent: \"Registered agent information\",\n      additionalGuides: \"Guides and additional documents based on your service\",\n      viewDocuments: \"View My Documents\",\n      nextSteps: \"Next steps:\",\n      activateBanking: \"Activate bank account (if requested)\",\n      operatingAgreement: \"Generate your Operating Agreement\",\n      trackExpenses: \"Start tracking income and expenses\",\n      hereForYou: \"Remember we're still here to help you with anything you need. If you have questions about next steps, like opening a bank account or setting up your payment gateway, don't hesitate to contact us.\",\n      feedbackRequest: \"Your experience is very important to us. If you have a moment, we'd love to hear your opinion about our service.\"\n    },\n    noteReceived: {\n      teamNote: \"You have a new message from our team\",\n      relatedToOrder: \"related to your order\",\n      respondNote: \"You can reply directly to this email or access your Client Area to view the complete history.\",\n      viewClientArea: \"View My Client Area\"\n    },\n    adminNote: {\n      messageAbout: \"You have an important message about your request:\",\n      viewTicket: \"View Ticket\",\n      viewClientArea: \"View My Client Area\"\n    },\n    paymentRequest: {\n      paymentRequired: \"A payment request has been generated to continue with your process\",\n      messageLabel: \"Message:\",\n      amount: \"for an amount of\",\n      payNow: \"Make Payment\",\n      buttonFallback: \"If the button doesn't work, copy and paste this link:\",\n      securePayment: \"Payment is processed securely through Stripe.\"\n    },\n    documentRequest: {\n      needDocument: \"Our team requires you to upload the following document:\",\n      messageLabel: \"Message:\",\n      documentType: \"Requested document:\",\n      referenceTicket: \"Reference ticket:\",\n      important: \"Important:\",\n      uploadInstruction: \"Please upload the requested document as soon as possible to avoid delays in the process.\",\n      uploadButton: \"Upload Document\"\n    },\n    documentUploaded: {\n      documentReceived: \"We have added a new document to your file:\",\n      forOrder: \"Order:\",\n      accessDownload: \"You can access and download this document from your Client Area.\",\n      reviewing: \"Our team will review it and notify you if any additional action is required.\",\n      viewDocuments: \"View My Documents\",\n      trackButton: \"View request status\"\n    },\n    messageReply: {\n      newReply: \"You have a new reply in your conversation:\",\n      repliedToQuery: \"We have responded to your inquiry\",\n      ticket: \"Ticket:\",\n      viewConversation: \"View conversation\",\n      viewClientArea: \"View My Client Area\"\n    },\n    passwordChangeOtp: {\n      passwordChangeRequest: \"You have requested to change your password. Use the following code to verify your identity:\",\n      useCode: \"Use the following code to confirm the change:\",\n      yourCode: \"Your verification code:\",\n      important: \"Important:\",\n      validFor: \"This code expires in <strong>10 minutes</strong>\",\n      doNotShare: \"Do not share it with anyone\",\n      notRequested: \"If you did not request this change, ignore this message.\"\n    },\n    profileChangeOtp: {\n      title: \"Identity Verification\",\n      sensitiveChangeRequest: \"A change to sensitive profile data has been requested. To confirm your identity, use the following verification code:\",\n      yourCode: \"Your verification code:\",\n      important: \"Important:\",\n      personalAndConfidential: \"This code is personal and confidential\",\n      validFor: \"Valid for <strong>24 hours</strong>\",\n      doNotShare: \"Do not share it with anyone\",\n      ignoreMessage: \"If you did not request this change, you can safely ignore this message.\"\n    },\n    accountLocked: {\n      locked: \"For your security, your account has been temporarily locked after detecting multiple failed access attempts.\",\n      attempts: \"To unlock your account and verify your identity, we need you to send us:\",\n      verifyIdentity: \"To unlock your account and verify your identity, we need you to send us:\",\n      idRequirement: \"High-resolution ID/Passport image (both sides)\",\n      birthDateConfirm: \"Your confirmed date of birth\",\n      referenceTicket: \"Your reference Ticket ID is:\",\n      contactSupport: \"To unlock your account, contact our support team:\",\n      resetPassword: \"Reset Password\",\n      unlockButton: \"Contact Support\"\n    },\n    renewalReminder: {\n      reminderText: \"We remind you that the maintenance pack for your LLC\",\n      expiresIn: \"Expires in\",\n      dueDate: \"Due date:\",\n      daysRemaining: \"Days remaining:\",\n      withoutMaintenance: \"Without an active maintenance pack, your LLC may lose its good legal standing. This includes:\",\n      registeredAgentActive: \"Active registered agent\",\n      annualReports: \"Annual report filings\",\n      taxCompliance: \"Tax compliance (IRS 1120/5472)\",\n      legalAddress: \"Legal address in the United States\",\n      renewNow: \"Renew Now\",\n      whatHappens: \"What happens if I don't renew?\",\n      penalties: \"Possible penalties and surcharges\",\n      agentExpires: \"Your registered agent will expire\",\n      goodStanding: \"Your LLC could lose good standing\",\n      viewCalendar: \"View fiscal calendar\"\n    },\n    registrationOtp: {\n      almostDone: \"Thank you for registering at Easy US LLC. Your verification code is:\",\n      confirmEmail: \"To complete your account registration, enter the following verification code:\",\n      yourCode: \"Your verification code:\",\n      important: \"Important:\",\n      validFor: \"This code expires in\",\n      doNotShare: \"Do not share it with anyone\",\n      clientIdLabel: \"Your client ID is:\",\n      ignoreMessage: \"If you didn't create an account with us, you can ignore this message.\"\n    },\n    operatingAgreementReady: {\n      ready: \"Your Operating Agreement is ready!\",\n      generated: \"We have great news for you.\",\n      llcData: \"Your LLC Details\",\n      companyLabel: \"Company:\",\n      stateLabel: \"State:\",\n      einLabel: \"EIN:\",\n      whatIs: \"What is the Operating Agreement?\",\n      explanation: \"It is the legal document that establishes the operating rules of your LLC, including ownership structure, profit distribution, and member responsibilities.\",\n      fullExplanation: \"It is the fundamental legal document of your LLC. It defines how your company is managed, owner responsibilities, and operating rules. Although not mandatory in some states, it is highly recommended because:\",\n      reason1: \"It reinforces the separation between your personal and business finances\",\n      reason2: \"It is required by banks and payment processors like Stripe\",\n      reason3: \"It provides additional legal protection for you as an owner\",\n      reason4: \"It officially documents your business structure\",\n      generateButton: \"Generate my Operating Agreement\",\n      autoGenerated: \"The document will be automatically generated with your LLC data and saved in your Documentation Center so you can download it whenever you need it.\",\n      viewDocument: \"View my document\",\n      tip: \"Tip:\",\n      tipText: \"Keep a signed copy of this document along with your other important company files.\"\n    },\n    documentApproved: {\n      title: \"Document Approved\",\n      approved: \"Approved\",\n      reviewedAndApproved: \"Your document has been reviewed and approved successfully.\",\n      viewDocuments: \"View my documents\"\n    },\n    documentRejected: {\n      title: \"Document Rejected - Action Required\",\n      rejected: \"Rejected\",\n      reviewedAndRejected: \"Your document has been reviewed and rejected.\",\n      reason: \"Reason\",\n      pleaseReupload: \"Please access your client dashboard and upload the corrected document again.\",\n      viewDocuments: \"View my documents\"\n    },\n    profileChangesVerified: {\n      title: \"Profile Changes Verified with OTP\",\n      client: \"Client\",\n      email: \"Email\",\n      clientId: \"Client ID\",\n      fieldsModified: \"Fields modified\",\n      verifiedWithOtp: \"Change verified with OTP\"\n    },\n    abandonedApplication: {\n      incomplete: \"Your application is incomplete\",\n      noticeText: \"We noticed that you started completing your application for\",\n      importantNote: \"Important note:\",\n      draftDeletion: \"Your draft will be automatically deleted if you don't complete it. For security and data protection reasons, we cannot keep incomplete applications indefinitely.\",\n      understandDoubts: \"We understand that taking the step to create an LLC can raise some questions. We want you to know that we are here to help you at every step of the process.\",\n      questionsHelp: \"If you have any questions or need assistance completing your application, simply reply to this email and we'll be happy to help.\",\n      whyChoose: \"Why choose Easy US LLC?\",\n      reason1: \"Complete formation in 48-72 hours\",\n      reason2: \"Spanish-language assistance throughout the process\",\n      reason3: \"EIN obtainment included\",\n      reason4: \"Help with bank account opening\",\n      reason5: \"Ongoing post-formation support\",\n      noMoreReminders: \"If you ultimately decide not to continue, we won't send you any more reminders about this application. Your privacy is important to us.\",\n      savedDraft: \"Don't worry, we've saved all your progress so you can continue exactly where you left off.\",\n      continueButton: \"Continue my Application\",\n      tip: \"Tip:\",\n      tipText: \"Complete your application so we can start working on your LLC as soon as possible.\",\n      expiring: \"Your draft will expire in 48 hours if not completed.\",\n      llcFormation: \"your LLC formation\",\n      maintenancePack: \"maintenance package\",\n      dontLoseProgress: \"Don't lose your progress. Resume your application now and complete the process in a few minutes.\",\n      lastHours: \"last hours\",\n      autoDeleteWarning: \"Your application will be automatically deleted if you don't complete it.\"\n    },\n    calculatorResults: {\n      results: \"Your calculation results\",\n      introText: \"Here is the summary of the tax comparison you requested. We've analyzed the numbers and want you to have all the information to make the best decision for your business.\",\n      summary: \"Your Analysis Summary\",\n      income: \"Annual income:\",\n      expenses: \"Deductible expenses:\",\n      autonomoTax: \"Taxes as freelancer:\",\n      llcTax: \"Taxes with LLC:\",\n      potentialSavings: \"Your potential savings:\",\n      savings: \"Estimated savings:\",\n      withLLC: \"With an LLC in the United States, you could significantly optimize your tax burden while operating completely legally. These savings are maintained year after year, which can make an important difference for your business in the long run.\",\n      learnMore: \"Would you like to know more about how it works? We'll be happy to answer all your questions with no commitment.\",\n      viewServices: \"View Our Services\",\n      disclaimer: \"This calculation is indicative and based on the data you provided. For a personalized analysis of your situation, don't hesitate to contact us.\"\n    },\n    newsletter: {\n      confirmed: \"Your subscription has been confirmed successfully.\",\n      willReceive: \"You will receive relevant information about services, updates, and news related to Easy US LLC.\",\n      unsubscribe: \"You can unsubscribe at any time from the link included in our emails.\"\n    },\n    orderEvent: {\n      update: \"Your order has an update:\",\n      date: \"Date:\",\n      viewDetails: \"View Details\"\n    }\n  },\n  ca: {\n    common: {\n      greeting: \"Hola\",\n      closing: \"Salutacions,\",\n      doubts: \"Si tens qualsevol dubte, respon directament a aquest correu.\",\n      client: \"Client\"\n    },\n    otp: {\n      thanks: \"Gr\u00E0cies per continuar amb el teu proc\u00E9s a Easy US LLC.\",\n      forSecurity: \"Per garantir la seguretat del teu compte, utilitza el seg\u00FCent codi de verificaci\u00F3:\",\n      yourCode: \"El teu codi OTP:\",\n      important: \"Important:\",\n      personalAndConfidential: \"Aquest codi \u00E9s personal i confidencial\",\n      validFor: \"T\u00E9 una validesa limitada a <strong>15 minuts</strong> per motius de seguretat\",\n      doNotShare: \"No el comparteixis amb ning\u00FA\",\n      ignoreMessage: \"Si no has sol\u00B7licitat aquest codi, pots ignorar aquest missatge amb total tranquil\u00B7litat.\",\n      ipDetected: \"Intent d'acc\u00E9s detectat des de la IP:\"\n    },\n    welcome: {\n      welcomeMessage: \"Benvingut a Easy US LLC! Ens alegra molt tenir-te amb nosaltres.\",\n      accountCreated: \"El teu compte s'ha creat correctament i ja pots comen\u00E7ar a explorar tot el que podem fer junts. Des de la teva \u00C0rea Client tindr\u00E0s acc\u00E9s a:\",\n      accessFrom: \"Des de la teva \u00C0rea Client tindr\u00E0s acc\u00E9s a:\",\n      realTimeTracking: \"Seguiment en temps real de les teves sol\u00B7licituds\",\n      documentCenter: \"Centre de documentaci\u00F3 per descarregar tots els teus arxius\",\n      professionalTools: \"Eines professionals com generador de factures\",\n      fiscalCalendar: \"Calendari fiscal amb les teves dates importants\",\n      directSupport: \"Comunicaci\u00F3 directa amb el nostre equip de suport\",\n      hereToHelp: \"Som aqu\u00ED per ajudar-te en cada pas de la teva aventura empresarial als Estats Units. Si tens qualsevol pregunta, no dubtis a escriure'ns.\",\n      exploreButton: \"Explorar la Meva \u00C0rea Client\"\n    },\n    accountPendingVerification: {\n      accountCreatedBut: \"El teu compte s'ha creat correctament, per\u00F2 necessites verificar el teu email per activar-lo completament.\",\n      actionRequired: \"Acci\u00F3 requerida:\",\n      accessAndVerify: \"Accedeix a la teva \u00C0rea Client i verifica el teu email per activar el teu compte i accedir a totes les funcions.\",\n      verifyButton: \"Verificar el meu email\",\n      whileUnverified: \"Mentre el teu email no estigui verificat, el teu compte romandr\u00E0 en estat de revisi\u00F3.\"\n    },\n    accountUnderReview: {\n      underReview: \"Volem informar-te que el teu compte ha entrat en un breu proc\u00E9s de revisi\u00F3. No et preocupis, aix\u00F2 \u00E9s completament rutinari i forma part dels nostres est\u00E0ndards de seguretat per protegir la teva informaci\u00F3 i garantir una experi\u00E8ncia segura.\",\n      whyReview: \"Per qu\u00E8 fem aix\u00F2?\",\n      whyReviewText: \"A Easy US LLC ens prenem molt seriosament la seguretat dels nostres clients. Aquest proc\u00E9s ens permet verificar que tota la informaci\u00F3 \u00E9s correcta i que el teu compte est\u00E0 degudament protegit.\",\n      duringProcess: \"Durant aquest breu per\u00EDode, les funcions del teu compte estaran temporalment limitades. Aix\u00F2 significa que no podr\u00E0s realitzar noves comandes ni modificar informaci\u00F3 existent, per\u00F2 no et preocupis: aquesta situaci\u00F3 \u00E9s temporal i no afectar\u00E0 cap tr\u00E0mit que ja estigui en curs.\",\n      whatHappens: \"Qu\u00E8 passar\u00E0 ara?\",\n      step1: \"El nostre equip revisar\u00E0 la informaci\u00F3 del teu compte (normalment en 24-48 hores laborables)\",\n      step2: \"Et notificarem per aquest mateix correu quan la revisi\u00F3 hagi finalitzat\",\n      step3: \"Si necessitem algun document addicional, t'ho farem saber de forma clara i senzilla\",\n      teamReviewing: \"Mentrestant, si tens qualsevol pregunta o necessites ajuda, no dubtis a respondre a aquest correu. Estem aqu\u00ED per ajudar-te en tot el que necessitis.\",\n      patience: \"Gr\u00E0cies per la teva paci\u00E8ncia i confian\u00E7a. Sabem que el teu temps \u00E9s valu\u00F3s i farem tot el possible per resoldre aix\u00F2 el m\u00E9s aviat possible.\",\n      closing: \"Una abra\u00E7ada de l'equip d'Easy US LLC\"\n    },\n    accountVip: {\n      updatedToVip: \"El teu compte ha estat actualitzat a l'estat VIP.\",\n      benefits: \"Beneficis VIP:\",\n      priorityAttention: \"Atenci\u00F3 priorit\u00E0ria i gesti\u00F3 accelerada\",\n      preferentialTracking: \"Seguiment preferent pel nostre equip\",\n      fullAccess: \"Acc\u00E9s complet a tots els serveis\",\n      viewDashboard: \"Veure la Meva \u00C0rea Client\"\n    },\n    accountReactivated: {\n      reactivated: \"El teu compte ha estat reactivat correctament.\",\n      canAccess: \"Ja pots accedir a la teva \u00C0rea Client i utilitzar tots els nostres serveis amb normalitat.\",\n      viewDashboard: \"Veure la Meva \u00C0rea Client\"\n    },\n    accountDeactivated: {\n      deactivated: \"Lamentem informar-te que el teu compte ha estat desactivat.\",\n      cannotAccess: \"Mentre el teu compte romangui en aquest estat, no podr\u00E0s accedir a la teva \u00C0rea Client ni realitzar gestions a trav\u00E9s de la nostra plataforma.\",\n      contactSupport: \"Si creus que aix\u00F2 \u00E9s un error o desitges obtenir m\u00E9s informaci\u00F3, si us plau contacta amb el nostre equip de suport responent a aquest correu.\"\n    },\n    confirmation: {\n      greatNews: \"Excel\u00B7lent not\u00EDcia! Hem rebut correctament la teva sol\u00B7licitud i ja estem treballant en ella. A partir d'ara, el nostre equip s'encarregar\u00E0 de tot.\",\n      details: \"Detalls de la teva Sol\u00B7licitud\",\n      reference: \"Refer\u00E8ncia:\",\n      service: \"Servei:\",\n      company: \"Empresa:\",\n      state: \"Estat:\",\n      currentStatus: \"Estat actual:\",\n      inReview: \"En revisi\u00F3\",\n      whatNow: \"Qu\u00E8 passa ara?\",\n      validatingInfo: \"El nostre equip est\u00E0 validant tota la informaci\u00F3 que ens vas proporcionar. En les properes hores rebr\u00E0s actualitzacions sobre el progr\u00E9s de la teva sol\u00B7licitud directament al teu correu. Tamb\u00E9 podr\u00E0s seguir l'estat en temps real des de la teva \u00C0rea Client.\",\n      nextSteps: \"Propers Passos\",\n      step1: \"Verificarem que tota la informaci\u00F3 \u00E9s correcta\",\n      step2: \"Iniciarem els tr\u00E0mits amb les autoritats corresponents\",\n      step3: \"Et mantindrem informat en cada etapa del proc\u00E9s\",\n      trackButton: \"Veure Estat de la meva Sol\u00B7licitud\",\n      questionRef: \"Tens alguna pregunta? Simplement respon a aquest correu esmentant la teva refer\u00E8ncia i t'ajudarem encantats.\"\n    },\n    autoReply: {\n      receivedMessage: \"El teu missatge ha estat rebut correctament.\",\n      ticketNumber: \"N\u00FAmero de ticket\",\n      estimatedResponse: \"Temps estimat de resposta: <strong>24-48 hores laborables</strong>\",\n      responding: \"El nostre equip revisar\u00E0 la teva consulta i et respondr\u00E0 el m\u00E9s aviat possible. Si necessites afegir informaci\u00F3 addicional, respon directament a aquest correu.\",\n      seeMessages: \"Veure Missatges\"\n    },\n    orderUpdate: {\n      statusChanged: \"L'estat de la teva comanda ha estat actualitzat.\",\n      orderLabel: \"Comanda:\",\n      newStatus: \"Nou estat:\",\n      statusPending: \"Pendent\",\n      statusProcessing: \"En proc\u00E9s\",\n      statusPaid: \"Pagat\",\n      statusFiled: \"Presentat\",\n      statusDocumentsReady: \"Documents llestos\",\n      statusCompleted: \"Completat\",\n      statusCancelled: \"Cancel\u00B7lat\",\n      clarification: \"Per a qualsevol aclariment sobre aquesta actualitzaci\u00F3, respon directament a aquest correu.\",\n      trackButton: \"Veure detalls complets\"\n    },\n    orderCompleted: {\n      llcReady: \"La teva LLC est\u00E0 llesta!\",\n      congratulations: \"Felicitats! La teva comanda ha estat completada amb \u00E8xit. Tot est\u00E0 llest perqu\u00E8 puguis comen\u00E7ar a operar amb la teva empresa als Estats Units.\",\n      docsReady: \"La teva documentaci\u00F3 est\u00E0 llesta\",\n      accessDocuments: \"Ja pots accedir i descarregar tots els documents de la teva empresa des del teu Centre de Documentaci\u00F3.\",\n      whatYouFind: \"Qu\u00E8 trobar\u00E0s?\",\n      documentList: \"Documents disponibles:\",\n      articlesOrg: \"Articles of Organization (document de constituci\u00F3)\",\n      einLetter: \"Carta de l'EIN de l'IRS\",\n      registeredAgent: \"Informaci\u00F3 de l'agent registrat\",\n      additionalGuides: \"Guies i documents addicionals segons el teu servei\",\n      viewDocuments: \"Veure Els Meus Documents\",\n      nextSteps: \"Propers passos:\",\n      activateBanking: \"Activar compte bancari (si sol\u00B7licitat)\",\n      operatingAgreement: \"Generar el teu Operating Agreement\",\n      trackExpenses: \"Comen\u00E7ar a registrar ingressos i despeses\",\n      hereForYou: \"Recorda que seguim aqu\u00ED per ajudar-te en tot el que necessitis. Si tens dubtes sobre els propers passos, com obrir un compte bancari o configurar la teva passarel\u00B7la de pagaments, no dubtis a escriure'ns.\",\n      feedbackRequest: \"La teva experi\u00E8ncia \u00E9s molt important per a nosaltres. Si tens un moment, ens encantaria con\u00E8ixer la teva opini\u00F3 sobre el nostre servei.\"\n    },\n    noteReceived: {\n      teamNote: \"Tens un nou missatge del nostre equip\",\n      relatedToOrder: \"relacionat amb la teva comanda\",\n      respondNote: \"Pots respondre directament a aquest correu o accedir a la teva \u00C0rea Client per veure l'historial complet.\",\n      viewClientArea: \"Veure la Meva \u00C0rea Client\"\n    },\n    adminNote: {\n      messageAbout: \"Tens un missatge important sobre la teva sol\u00B7licitud:\",\n      viewTicket: \"Veure Ticket\",\n      viewClientArea: \"Veure la Meva \u00C0rea Client\"\n    },\n    paymentRequest: {\n      paymentRequired: \"S'ha generat una sol\u00B7licitud de pagament per continuar amb el teu tr\u00E0mit\",\n      messageLabel: \"Missatge:\",\n      amount: \"per un valor de\",\n      payNow: \"Realitzar Pagament\",\n      buttonFallback: \"Si el bot\u00F3 no funciona, copia i enganxa aquest enlla\u00E7:\",\n      securePayment: \"El pagament es processa de forma segura a trav\u00E9s de Stripe.\"\n    },\n    documentRequest: {\n      needDocument: \"El nostre equip requereix que pugis el seg\u00FCent document:\",\n      messageLabel: \"Missatge:\",\n      documentType: \"Document sol\u00B7licitat:\",\n      referenceTicket: \"Ticket de refer\u00E8ncia:\",\n      important: \"Important:\",\n      uploadInstruction: \"Si us plau, puja el document sol\u00B7licitat el m\u00E9s aviat possible per evitar retards en el proc\u00E9s.\",\n      uploadButton: \"Pujar Document\"\n    },\n    documentUploaded: {\n      documentReceived: \"Hem afegit un nou document al teu expedient:\",\n      forOrder: \"Comanda:\",\n      accessDownload: \"Pots accedir i descarregar aquest document des de la teva \u00C0rea Client.\",\n      reviewing: \"El nostre equip el revisar\u00E0 i et notificarem si \u00E9s necess\u00E0ria alguna acci\u00F3 addicional.\",\n      viewDocuments: \"Veure Els Meus Documents\",\n      trackButton: \"Veure estat de la meva sol\u00B7licitud\"\n    },\n    messageReply: {\n      newReply: \"Tens una nova resposta a la teva conversa:\",\n      repliedToQuery: \"Hem respost a la teva consulta\",\n      ticket: \"Ticket:\",\n      viewConversation: \"Veure conversa\",\n      viewClientArea: \"Veure la Meva \u00C0rea Client\"\n    },\n    passwordChangeOtp: {\n      passwordChangeRequest: \"Has sol\u00B7licitat canviar la teva contrasenya. Utilitza el seg\u00FCent codi per verificar la teva identitat:\",\n      useCode: \"Utilitza el seg\u00FCent codi per confirmar el canvi:\",\n      yourCode: \"El teu codi de verificaci\u00F3:\",\n      important: \"Important:\",\n      validFor: \"Aquest codi expira en <strong>10 minuts</strong>\",\n      doNotShare: \"No el comparteixis amb ning\u00FA\",\n      notRequested: \"Si no has sol\u00B7licitat aquest canvi, ignora aquest missatge.\"\n    },\n    profileChangeOtp: {\n      title: \"Verificaci\u00F3 d'Identitat\",\n      sensitiveChangeRequest: \"S'ha sol\u00B7licitat un canvi en les dades sensibles del teu perfil. Per confirmar la teva identitat, utilitza el seg\u00FCent codi de verificaci\u00F3:\",\n      yourCode: \"El teu codi de verificaci\u00F3:\",\n      important: \"Important:\",\n      personalAndConfidential: \"Aquest codi \u00E9s personal i confidencial\",\n      validFor: \"T\u00E9 una validesa de <strong>24 hores</strong>\",\n      doNotShare: \"No el comparteixis amb ning\u00FA\",\n      ignoreMessage: \"Si no has sol\u00B7licitat aquest canvi, pots ignorar aquest missatge amb total tranquil\u00B7litat.\"\n    },\n    accountLocked: {\n      locked: \"Per la teva seguretat, el teu compte ha estat temporalment bloquejat despr\u00E9s de detectar m\u00FAltiples intents d'acc\u00E9s fallits.\",\n      attempts: \"Per desbloquejar el teu compte i verificar la teva identitat, necessitem que ens envi\u00EFs:\",\n      verifyIdentity: \"Per desbloquejar el teu compte i verificar la teva identitat, necessitem que ens envi\u00EFs:\",\n      idRequirement: \"Imatge del DNI/Passaport d'alta resoluci\u00F3 (ambdues cares)\",\n      birthDateConfirm: \"La teva data de naixement confirmada\",\n      referenceTicket: \"El teu Ticket ID de refer\u00E8ncia \u00E9s:\",\n      contactSupport: \"Per desbloquejar el teu compte, contacta amb el nostre equip de suport:\",\n      resetPassword: \"Restablir contrasenya\",\n      unlockButton: \"Contactar Suport\"\n    },\n    renewalReminder: {\n      reminderText: \"Et recordem que el pack de manteniment de la teva LLC\",\n      expiresIn: \"Ven\u00E7 en\",\n      dueDate: \"Data de venciment:\",\n      daysRemaining: \"Dies restants:\",\n      withoutMaintenance: \"Sense el pack de manteniment actiu, la teva LLC pot perdre el seu bon estat legal. Aix\u00F2 inclou:\",\n      registeredAgentActive: \"Agent registrat actiu\",\n      annualReports: \"Presentaci\u00F3 d'informes anuals\",\n      taxCompliance: \"Compliment fiscal (IRS 1120/5472)\",\n      legalAddress: \"Domicili legal als Estats Units\",\n      renewNow: \"Renovar Ara\",\n      whatHappens: \"Qu\u00E8 passa si no renovo?\",\n      penalties: \"Possibles penalitzacions i rec\u00E0rrecs\",\n      agentExpires: \"El teu registered agent expirar\u00E0\",\n      goodStanding: \"La teva LLC podria perdre el bon estat\",\n      viewCalendar: \"Veure calendari fiscal\"\n    },\n    registrationOtp: {\n      almostDone: \"Gr\u00E0cies per registrar-te a Easy US LLC. El teu codi de verificaci\u00F3 \u00E9s:\",\n      confirmEmail: \"Per completar el registre del teu compte, introdueix el seg\u00FCent codi de verificaci\u00F3:\",\n      yourCode: \"El teu codi de verificaci\u00F3:\",\n      important: \"Important:\",\n      validFor: \"Aquest codi expira en\",\n      doNotShare: \"No el comparteixis amb ning\u00FA\",\n      clientIdLabel: \"El teu ID de client \u00E9s:\",\n      ignoreMessage: \"Si no has creat un compte amb nosaltres, pots ignorar aquest missatge.\"\n    },\n    operatingAgreementReady: {\n      ready: \"El teu Operating Agreement est\u00E0 llest!\",\n      generated: \"Tenim excel\u00B7lents not\u00EDcies per a tu.\",\n      llcData: \"Dades de la teva LLC\",\n      companyLabel: \"Empresa:\",\n      stateLabel: \"Estat:\",\n      einLabel: \"EIN:\",\n      whatIs: \"Qu\u00E8 \u00E9s l'Operating Agreement?\",\n      explanation: \"\u00C9s el document legal que estableix les regles de funcionament de la teva LLC, incloent l'estructura de propietat, distribuci\u00F3 de beneficis i responsabilitats dels membres.\",\n      fullExplanation: \"\u00C9s el document legal fonamental de la teva LLC. Defineix com es gestiona la teva empresa, les responsabilitats del propietari i les regles d'operaci\u00F3. Tot i que en alguns estats no \u00E9s obligatori, \u00E9s altament recomanable tenir-lo perqu\u00E8:\",\n      reason1: \"Refor\u00E7a la separaci\u00F3 entre les teves finances personals i les de l'empresa\",\n      reason2: \"\u00C9s requerit per bancs i processadors de pagament com Stripe\",\n      reason3: \"Proporciona protecci\u00F3 legal addicional per a tu com a propietari\",\n      reason4: \"Documenta oficialment l'estructura del teu negoci\",\n      generateButton: \"Generar el meu Operating Agreement\",\n      autoGenerated: \"El document es generar\u00E0 autom\u00E0ticament amb les dades de la teva LLC i es guardar\u00E0 al teu Centre de Documentaci\u00F3 perqu\u00E8 puguis descarregar-lo quan ho necessitis.\",\n      viewDocument: \"Veure el meu document\",\n      tip: \"Consell:\",\n      tipText: \"Guarda una c\u00F2pia signada d'aquest document juntament amb els teus altres arxius importants de l'empresa.\"\n    },\n    documentApproved: {\n      title: \"Document Aprovat\",\n      approved: \"Aprovat\",\n      reviewedAndApproved: \"El teu document ha estat revisat i aprovat correctament.\",\n      viewDocuments: \"Veure els meus documents\"\n    },\n    documentRejected: {\n      title: \"Document Rebutjat - Acci\u00F3 Requerida\",\n      rejected: \"Rebutjat\",\n      reviewedAndRejected: \"El teu document ha estat revisat i rebutjat.\",\n      reason: \"Motiu\",\n      pleaseReupload: \"Si us plau, accedeix al teu panell de client i puja novament el document corregit.\",\n      viewDocuments: \"Veure els meus documents\"\n    },\n    profileChangesVerified: {\n      title: \"Canvis de Perfil Verificats amb OTP\",\n      client: \"Client\",\n      email: \"Email\",\n      clientId: \"ID de Client\",\n      fieldsModified: \"Camps modificats\",\n      verifiedWithOtp: \"Canvi verificat amb OTP\"\n    },\n    abandonedApplication: {\n      incomplete: \"La teva sol\u00B7licitud est\u00E0 incompleta\",\n      noticeText: \"Hem notat que vas comen\u00E7ar a completar la teva sol\u00B7licitud de\",\n      importantNote: \"Nota important:\",\n      draftDeletion: \"El teu esborrany s'eliminar\u00E0 autom\u00E0ticament si no el completes. Per motius de seguretat i protecci\u00F3 de dades, no podem mantenir sol\u00B7licituds incompletes indefinidament.\",\n      understandDoubts: \"Entenem que fer el pas de crear una LLC pot generar alguns dubtes. Volem que s\u00E0pigues que estem aqu\u00ED per ajudar-te en cada pas del proc\u00E9s.\",\n      questionsHelp: \"Si tens alguna pregunta o necessites assist\u00E8ncia per completar la teva sol\u00B7licitud, simplement respon a aquest correu i t'ajudarem encantats.\",\n      whyChoose: \"Per qu\u00E8 triar Easy US LLC?\",\n      reason1: \"Formaci\u00F3 completa en 48-72 hores\",\n      reason2: \"Assist\u00E8ncia en espanyol durant tot el proc\u00E9s\",\n      reason3: \"Obtenci\u00F3 de l'EIN inclosa\",\n      reason4: \"Ajuda amb obertura de compte bancari\",\n      reason5: \"Suport continu post-formaci\u00F3\",\n      noMoreReminders: \"Si finalment decideixes no continuar, no t'enviarem m\u00E9s recordatoris sobre aquesta sol\u00B7licitud. La teva privacitat \u00E9s important per a nosaltres.\",\n      savedDraft: \"No et preocupis, hem guardat tot el teu progr\u00E9s perqu\u00E8 puguis continuar exactament on ho vas deixar.\",\n      continueButton: \"Continuar la meva Sol\u00B7licitud\",\n      tip: \"Consell:\",\n      tipText: \"Completa la teva sol\u00B7licitud perqu\u00E8 puguem comen\u00E7ar a treballar en la teva LLC el m\u00E9s aviat possible.\",\n      expiring: \"El teu esborrany expirar\u00E0 en 48 hores si no el completes.\",\n      llcFormation: \"constituci\u00F3 de la teva LLC\",\n      maintenancePack: \"paquet de manteniment\",\n      dontLoseProgress: \"No perdis el teu progr\u00E9s. Repr\u00E8n la teva sol\u00B7licitud ara i completa el proc\u00E9s en pocs minuts.\",\n      lastHours: \"\u00FAltimes hores\",\n      autoDeleteWarning: \"La teva sol\u00B7licitud s'eliminar\u00E0 autom\u00E0ticament si no la completes.\"\n    },\n    calculatorResults: {\n      results: \"Resultats del teu c\u00E0lcul\",\n      introText: \"Aqu\u00ED tens el resum de la teva comparaci\u00F3 fiscal que vas sol\u00B7licitar. Hem analitzat els n\u00FAmeros i volem que tinguis tota la informaci\u00F3 per prendre la millor decisi\u00F3 per al teu negoci.\",\n      summary: \"Resum de la teva An\u00E0lisi\",\n      income: \"Ingressos anuals:\",\n      expenses: \"Despeses dedu\u00EFbles:\",\n      autonomoTax: \"Impostos com a aut\u00F2nom:\",\n      llcTax: \"Impostos amb LLC:\",\n      potentialSavings: \"El teu estalvi potencial:\",\n      savings: \"Estalvi estimat:\",\n      withLLC: \"Amb una LLC als Estats Units, podries optimitzar significativament la teva c\u00E0rrega fiscal mentre operes de forma completament legal. Aquest estalvi es mant\u00E9 any rere any, el que pot suposar una difer\u00E8ncia important per al teu negoci a llarg termini.\",\n      learnMore: \"T'agradaria saber m\u00E9s sobre com funciona? Estarem encantats de resoldre tots els teus dubtes sense cap comprom\u00EDs.\",\n      viewServices: \"Veure Els Nostres Serveis\",\n      disclaimer: \"Aquest c\u00E0lcul \u00E9s orientatiu i es basa en les dades que vas proporcionar. Per a una an\u00E0lisi personalitzada de la teva situaci\u00F3, no dubtis a contactar-nos.\"\n    },\n    newsletter: {\n      confirmed: \"La teva subscripci\u00F3 ha estat confirmada correctament.\",\n      willReceive: \"Rebr\u00E0s informaci\u00F3 rellevant sobre serveis, actualitzacions i novetats relacionades amb Easy US LLC.\",\n      unsubscribe: \"Pots donar-te de baixa en qualsevol moment des de l'enlla\u00E7 incl\u00F2s als nostres correus.\"\n    },\n    orderEvent: {\n      update: \"La teva comanda t\u00E9 una actualitzaci\u00F3:\",\n      date: \"Data:\",\n      viewDetails: \"Veure Detalls\"\n    }\n  },\n  fr: {\n    common: {\n      greeting: \"Bonjour\",\n      closing: \"Cordialement,\",\n      doubts: \"Si vous avez des questions, r\u00E9pondez directement \u00E0 cet e-mail.\",\n      client: \"Client\"\n    },\n    otp: {\n      thanks: \"Merci de poursuivre votre d\u00E9marche chez Easy US LLC.\",\n      forSecurity: \"Pour garantir la s\u00E9curit\u00E9 de votre compte, utilisez le code de v\u00E9rification suivant :\",\n      yourCode: \"Votre code OTP :\",\n      important: \"Important :\",\n      personalAndConfidential: \"Ce code est personnel et confidentiel\",\n      validFor: \"Il est valable <strong>15 minutes</strong> pour des raisons de s\u00E9curit\u00E9\",\n      doNotShare: \"Ne le partagez avec personne\",\n      ignoreMessage: \"Si vous n'avez pas demand\u00E9 ce code, vous pouvez ignorer ce message en toute tranquillit\u00E9.\",\n      ipDetected: \"Tentative de connexion d\u00E9tect\u00E9e depuis l'IP :\"\n    },\n    welcome: {\n      welcomeMessage: \"Bienvenue chez Easy US LLC ! Nous sommes ravis de vous compter parmi nous.\",\n      accountCreated: \"Votre compte a \u00E9t\u00E9 cr\u00E9\u00E9 avec succ\u00E8s et vous pouvez commencer \u00E0 explorer tout ce que nous pouvons faire ensemble. Depuis votre Espace Client, vous aurez acc\u00E8s \u00E0 :\",\n      accessFrom: \"Depuis votre Espace Client, vous aurez acc\u00E8s \u00E0 :\",\n      realTimeTracking: \"Suivi en temps r\u00E9el de vos demandes\",\n      documentCenter: \"Centre de documentation pour t\u00E9l\u00E9charger tous vos fichiers\",\n      professionalTools: \"Outils professionnels comme le g\u00E9n\u00E9rateur de factures\",\n      fiscalCalendar: \"Calendrier fiscal avec vos dates importantes\",\n      directSupport: \"Communication directe avec notre \u00E9quipe de support\",\n      hereToHelp: \"Nous sommes l\u00E0 pour vous accompagner \u00E0 chaque \u00E9tape de votre aventure entrepreneuriale aux \u00C9tats-Unis. Si vous avez des questions, n'h\u00E9sitez pas \u00E0 nous \u00E9crire.\",\n      exploreButton: \"Explorer Mon Espace Client\"\n    },\n    accountPendingVerification: {\n      accountCreatedBut: \"Votre compte a \u00E9t\u00E9 cr\u00E9\u00E9 avec succ\u00E8s, mais vous devez v\u00E9rifier votre e-mail pour l'activer compl\u00E8tement.\",\n      actionRequired: \"Action requise :\",\n      accessAndVerify: \"Acc\u00E9dez \u00E0 votre Espace Client et v\u00E9rifiez votre e-mail pour activer votre compte et acc\u00E9der \u00E0 toutes les fonctionnalit\u00E9s.\",\n      verifyButton: \"V\u00E9rifier mon e-mail\",\n      whileUnverified: \"Tant que votre e-mail n'est pas v\u00E9rifi\u00E9, votre compte restera en cours de r\u00E9vision.\"\n    },\n    accountUnderReview: {\n      underReview: \"Nous souhaitons vous informer que votre compte est entr\u00E9 dans un bref processus de v\u00E9rification. Ne vous inqui\u00E9tez pas, c'est tout \u00E0 fait routinier et fait partie de nos normes de s\u00E9curit\u00E9 pour prot\u00E9ger vos informations et garantir une exp\u00E9rience s\u00FBre.\",\n      whyReview: \"Pourquoi faisons-nous cela ?\",\n      whyReviewText: \"Chez Easy US LLC, nous prenons tr\u00E8s au s\u00E9rieux la s\u00E9curit\u00E9 de nos clients. Ce processus nous permet de v\u00E9rifier que toutes les informations sont correctes et que votre compte est correctement prot\u00E9g\u00E9.\",\n      duringProcess: \"Pendant cette br\u00E8ve p\u00E9riode, les fonctions de votre compte seront temporairement limit\u00E9es. Cela signifie que vous ne pourrez pas passer de nouvelles commandes ni modifier les informations existantes, mais ne vous inqui\u00E9tez pas : cette situation est temporaire et n'affectera aucune d\u00E9marche d\u00E9j\u00E0 en cours.\",\n      whatHappens: \"Que va-t-il se passer maintenant ?\",\n      step1: \"Notre \u00E9quipe examinera les informations de votre compte (g\u00E9n\u00E9ralement sous 24 \u00E0 48 heures ouvrables)\",\n      step2: \"Nous vous notifierons par ce m\u00EAme e-mail d\u00E8s que la v\u00E9rification sera termin\u00E9e\",\n      step3: \"Si nous avons besoin de documents suppl\u00E9mentaires, nous vous le ferons savoir clairement et simplement\",\n      teamReviewing: \"En attendant, si vous avez des questions ou besoin d'aide, n'h\u00E9sitez pas \u00E0 r\u00E9pondre \u00E0 cet e-mail. Nous sommes l\u00E0 pour vous aider dans tout ce dont vous avez besoin.\",\n      patience: \"Merci pour votre patience et votre confiance. Nous savons que votre temps est pr\u00E9cieux et nous ferons tout notre possible pour r\u00E9soudre cela le plus rapidement possible.\",\n      closing: \"Chaleureusement, l'\u00E9quipe Easy US LLC\"\n    },\n    accountVip: {\n      updatedToVip: \"Votre compte a \u00E9t\u00E9 mis \u00E0 niveau au statut VIP.\",\n      benefits: \"Avantages VIP :\",\n      priorityAttention: \"Attention prioritaire et traitement acc\u00E9l\u00E9r\u00E9\",\n      preferentialTracking: \"Suivi pr\u00E9f\u00E9rentiel par notre \u00E9quipe\",\n      fullAccess: \"Acc\u00E8s complet \u00E0 tous les services\",\n      viewDashboard: \"Voir Mon Espace Client\"\n    },\n    accountReactivated: {\n      reactivated: \"Votre compte a \u00E9t\u00E9 r\u00E9activ\u00E9 avec succ\u00E8s.\",\n      canAccess: \"Vous pouvez maintenant acc\u00E9der \u00E0 votre Espace Client et utiliser tous nos services normalement.\",\n      viewDashboard: \"Voir Mon Espace Client\"\n    },\n    accountDeactivated: {\n      deactivated: \"Nous avons le regret de vous informer que votre compte a \u00E9t\u00E9 d\u00E9sactiv\u00E9.\",\n      cannotAccess: \"Tant que votre compte reste dans cet \u00E9tat, vous ne pourrez pas acc\u00E9der \u00E0 votre Espace Client ni effectuer d'op\u00E9rations via notre plateforme.\",\n      contactSupport: \"Si vous pensez qu'il s'agit d'une erreur ou souhaitez obtenir plus d'informations, veuillez contacter notre \u00E9quipe de support en r\u00E9pondant \u00E0 cet e-mail.\"\n    },\n    confirmation: {\n      greatNews: \"Excellente nouvelle ! Nous avons bien re\u00E7u votre demande et nous travaillons d\u00E9j\u00E0 dessus. \u00C0 partir de maintenant, notre \u00E9quipe s'occupe de tout.\",\n      details: \"D\u00E9tails de votre demande\",\n      reference: \"R\u00E9f\u00E9rence :\",\n      service: \"Service :\",\n      company: \"Entreprise :\",\n      state: \"\u00C9tat :\",\n      currentStatus: \"Statut actuel :\",\n      inReview: \"En cours de r\u00E9vision\",\n      whatNow: \"Que se passe-t-il maintenant ?\",\n      validatingInfo: \"Notre \u00E9quipe valide toutes les informations que vous avez fournies. Dans les prochaines heures, vous recevrez des mises \u00E0 jour sur l'avancement de votre demande directement par e-mail. Vous pouvez \u00E9galement suivre le statut en temps r\u00E9el depuis votre Espace Client.\",\n      nextSteps: \"Prochaines \u00E9tapes\",\n      step1: \"Nous v\u00E9rifierons que toutes les informations sont correctes\",\n      step2: \"Nous entamerons les d\u00E9marches aupr\u00E8s des autorit\u00E9s comp\u00E9tentes\",\n      step3: \"Nous vous tiendrons inform\u00E9 \u00E0 chaque \u00E9tape du processus\",\n      trackButton: \"Voir le statut de ma demande\",\n      questionRef: \"Vous avez des questions ? R\u00E9pondez simplement \u00E0 cet e-mail en mentionnant votre r\u00E9f\u00E9rence et nous serons ravis de vous aider.\"\n    },\n    autoReply: {\n      receivedMessage: \"Votre message a \u00E9t\u00E9 re\u00E7u avec succ\u00E8s.\",\n      ticketNumber: \"Num\u00E9ro de ticket\",\n      estimatedResponse: \"Temps de r\u00E9ponse estim\u00E9 : <strong>24-48 heures ouvrables</strong>\",\n      responding: \"Notre \u00E9quipe examinera votre demande et vous r\u00E9pondra dans les plus brefs d\u00E9lais. Si vous devez ajouter des informations suppl\u00E9mentaires, r\u00E9pondez directement \u00E0 cet e-mail.\",\n      seeMessages: \"Voir les messages\"\n    },\n    orderUpdate: {\n      statusChanged: \"Le statut de votre commande a \u00E9t\u00E9 mis \u00E0 jour.\",\n      orderLabel: \"Commande :\",\n      newStatus: \"Nouveau statut :\",\n      statusPending: \"En attente\",\n      statusProcessing: \"En cours de traitement\",\n      statusPaid: \"Pay\u00E9\",\n      statusFiled: \"D\u00E9pos\u00E9\",\n      statusDocumentsReady: \"Documents pr\u00EAts\",\n      statusCompleted: \"Termin\u00E9\",\n      statusCancelled: \"Annul\u00E9\",\n      clarification: \"Pour toute clarification concernant cette mise \u00E0 jour, r\u00E9pondez directement \u00E0 cet e-mail.\",\n      trackButton: \"Voir les d\u00E9tails complets\"\n    },\n    orderCompleted: {\n      llcReady: \"Votre LLC est pr\u00EAte !\",\n      congratulations: \"F\u00E9licitations ! Votre commande a \u00E9t\u00E9 compl\u00E9t\u00E9e avec succ\u00E8s. Tout est pr\u00EAt pour que vous puissiez commencer \u00E0 exploiter votre entreprise aux \u00C9tats-Unis.\",\n      docsReady: \"Votre documentation est pr\u00EAte\",\n      accessDocuments: \"Vous pouvez maintenant acc\u00E9der et t\u00E9l\u00E9charger tous les documents de votre entreprise depuis votre Centre de Documentation.\",\n      whatYouFind: \"Que trouverez-vous ?\",\n      documentList: \"Documents disponibles :\",\n      articlesOrg: \"Articles of Organization (document de constitution)\",\n      einLetter: \"Lettre EIN de l'IRS\",\n      registeredAgent: \"Informations sur l'agent enregistr\u00E9\",\n      additionalGuides: \"Guides et documents suppl\u00E9mentaires selon votre service\",\n      viewDocuments: \"Voir Mes Documents\",\n      nextSteps: \"Prochaines \u00E9tapes :\",\n      activateBanking: \"Activer le compte bancaire (si demand\u00E9)\",\n      operatingAgreement: \"G\u00E9n\u00E9rer votre Operating Agreement\",\n      trackExpenses: \"Commencer \u00E0 suivre les revenus et les d\u00E9penses\",\n      hereForYou: \"N'oubliez pas que nous sommes toujours l\u00E0 pour vous aider dans tout ce dont vous avez besoin. Si vous avez des questions sur les prochaines \u00E9tapes, comme l'ouverture d'un compte bancaire ou la configuration de votre passerelle de paiement, n'h\u00E9sitez pas \u00E0 nous contacter.\",\n      feedbackRequest: \"Votre exp\u00E9rience est tr\u00E8s importante pour nous. Si vous avez un moment, nous serions ravis de conna\u00EEtre votre avis sur notre service.\"\n    },\n    noteReceived: {\n      teamNote: \"Vous avez un nouveau message de notre \u00E9quipe\",\n      relatedToOrder: \"concernant votre commande\",\n      respondNote: \"Vous pouvez r\u00E9pondre directement \u00E0 cet e-mail ou acc\u00E9der \u00E0 votre Espace Client pour voir l'historique complet.\",\n      viewClientArea: \"Voir Mon Espace Client\"\n    },\n    adminNote: {\n      messageAbout: \"Vous avez un message important concernant votre demande :\",\n      viewTicket: \"Voir le ticket\",\n      viewClientArea: \"Voir Mon Espace Client\"\n    },\n    paymentRequest: {\n      paymentRequired: \"Une demande de paiement a \u00E9t\u00E9 g\u00E9n\u00E9r\u00E9e pour poursuivre votre d\u00E9marche\",\n      messageLabel: \"Message :\",\n      amount: \"pour un montant de\",\n      payNow: \"Effectuer le paiement\",\n      buttonFallback: \"Si le bouton ne fonctionne pas, copiez et collez ce lien :\",\n      securePayment: \"Le paiement est trait\u00E9 de mani\u00E8re s\u00E9curis\u00E9e via Stripe.\"\n    },\n    documentRequest: {\n      needDocument: \"Notre \u00E9quipe vous demande de t\u00E9l\u00E9charger le document suivant :\",\n      messageLabel: \"Message :\",\n      documentType: \"Document demand\u00E9 :\",\n      referenceTicket: \"Ticket de r\u00E9f\u00E9rence :\",\n      important: \"Important :\",\n      uploadInstruction: \"Veuillez t\u00E9l\u00E9charger le document demand\u00E9 d\u00E8s que possible pour \u00E9viter les retards dans le processus.\",\n      uploadButton: \"T\u00E9l\u00E9charger le document\"\n    },\n    documentUploaded: {\n      documentReceived: \"Nous avons ajout\u00E9 un nouveau document \u00E0 votre dossier :\",\n      forOrder: \"Commande :\",\n      accessDownload: \"Vous pouvez acc\u00E9der et t\u00E9l\u00E9charger ce document depuis votre Espace Client.\",\n      reviewing: \"Notre \u00E9quipe l'examinera et vous informera si une action suppl\u00E9mentaire est n\u00E9cessaire.\",\n      viewDocuments: \"Voir Mes Documents\",\n      trackButton: \"Voir le statut de ma demande\"\n    },\n    messageReply: {\n      newReply: \"Vous avez une nouvelle r\u00E9ponse dans votre conversation :\",\n      repliedToQuery: \"Nous avons r\u00E9pondu \u00E0 votre demande\",\n      ticket: \"Ticket :\",\n      viewConversation: \"Voir la conversation\",\n      viewClientArea: \"Voir Mon Espace Client\"\n    },\n    passwordChangeOtp: {\n      passwordChangeRequest: \"Vous avez demand\u00E9 \u00E0 changer votre mot de passe. Utilisez le code suivant pour v\u00E9rifier votre identit\u00E9 :\",\n      useCode: \"Utilisez le code suivant pour confirmer le changement :\",\n      yourCode: \"Votre code de v\u00E9rification :\",\n      important: \"Important :\",\n      validFor: \"Ce code expire dans <strong>10 minutes</strong>\",\n      doNotShare: \"Ne le partagez avec personne\",\n      notRequested: \"Si vous n'avez pas demand\u00E9 ce changement, ignorez ce message.\"\n    },\n    profileChangeOtp: {\n      title: \"V\u00E9rification d'Identit\u00E9\",\n      sensitiveChangeRequest: \"Un changement des donn\u00E9es sensibles de votre profil a \u00E9t\u00E9 demand\u00E9. Pour confirmer votre identit\u00E9, utilisez le code de v\u00E9rification suivant :\",\n      yourCode: \"Votre code de v\u00E9rification :\",\n      important: \"Important :\",\n      personalAndConfidential: \"Ce code est personnel et confidentiel\",\n      validFor: \"Valable pendant <strong>24 heures</strong>\",\n      doNotShare: \"Ne le partagez avec personne\",\n      ignoreMessage: \"Si vous n'avez pas demand\u00E9 ce changement, vous pouvez ignorer ce message en toute s\u00E9curit\u00E9.\"\n    },\n    accountLocked: {\n      locked: \"Pour votre s\u00E9curit\u00E9, votre compte a \u00E9t\u00E9 temporairement verrouill\u00E9 apr\u00E8s la d\u00E9tection de plusieurs tentatives d'acc\u00E8s \u00E9chou\u00E9es.\",\n      attempts: \"Pour d\u00E9verrouiller votre compte et v\u00E9rifier votre identit\u00E9, nous avons besoin que vous nous envoyiez :\",\n      verifyIdentity: \"Pour d\u00E9verrouiller votre compte et v\u00E9rifier votre identit\u00E9, nous avons besoin que vous nous envoyiez :\",\n      idRequirement: \"Image haute r\u00E9solution de la pi\u00E8ce d'identit\u00E9/passeport (recto-verso)\",\n      birthDateConfirm: \"Votre date de naissance confirm\u00E9e\",\n      referenceTicket: \"Votre num\u00E9ro de ticket de r\u00E9f\u00E9rence est :\",\n      contactSupport: \"Pour d\u00E9verrouiller votre compte, contactez notre \u00E9quipe de support :\",\n      resetPassword: \"R\u00E9initialiser le mot de passe\",\n      unlockButton: \"Contacter le support\"\n    },\n    renewalReminder: {\n      reminderText: \"Nous vous rappelons que le pack de maintenance de votre LLC\",\n      expiresIn: \"Expire dans\",\n      dueDate: \"Date d'\u00E9ch\u00E9ance :\",\n      daysRemaining: \"Jours restants :\",\n      withoutMaintenance: \"Sans le pack de maintenance actif, votre LLC peut perdre son bon \u00E9tat juridique. Cela inclut :\",\n      registeredAgentActive: \"Agent enregistr\u00E9 actif\",\n      annualReports: \"D\u00E9p\u00F4t des rapports annuels\",\n      taxCompliance: \"Conformit\u00E9 fiscale (IRS 1120/5472)\",\n      legalAddress: \"Adresse l\u00E9gale aux \u00C9tats-Unis\",\n      renewNow: \"Renouveler maintenant\",\n      whatHappens: \"Que se passe-t-il si je ne renouvelle pas ?\",\n      penalties: \"P\u00E9nalit\u00E9s et frais suppl\u00E9mentaires possibles\",\n      agentExpires: \"Votre agent enregistr\u00E9 expirera\",\n      goodStanding: \"Votre LLC pourrait perdre son bon \u00E9tat\",\n      viewCalendar: \"Voir le calendrier fiscal\"\n    },\n    registrationOtp: {\n      almostDone: \"Merci de vous \u00EAtre inscrit chez Easy US LLC. Votre code de v\u00E9rification est :\",\n      confirmEmail: \"Pour compl\u00E9ter l'inscription de votre compte, entrez le code de v\u00E9rification suivant :\",\n      yourCode: \"Votre code de v\u00E9rification :\",\n      important: \"Important :\",\n      validFor: \"Ce code expire dans\",\n      doNotShare: \"Ne le partagez avec personne\",\n      clientIdLabel: \"Votre identifiant client est :\",\n      ignoreMessage: \"Si vous n'avez pas cr\u00E9\u00E9 de compte chez nous, vous pouvez ignorer ce message.\"\n    },\n    operatingAgreementReady: {\n      ready: \"Votre Operating Agreement est pr\u00EAt !\",\n      generated: \"Nous avons d'excellentes nouvelles pour vous.\",\n      llcData: \"Donn\u00E9es de votre LLC\",\n      companyLabel: \"Entreprise :\",\n      stateLabel: \"\u00C9tat :\",\n      einLabel: \"EIN :\",\n      whatIs: \"Qu'est-ce que l'Operating Agreement ?\",\n      explanation: \"C'est le document juridique qui \u00E9tablit les r\u00E8gles de fonctionnement de votre LLC, y compris la structure de propri\u00E9t\u00E9, la r\u00E9partition des b\u00E9n\u00E9fices et les responsabilit\u00E9s des membres.\",\n      fullExplanation: \"C'est le document juridique fondamental de votre LLC. Il d\u00E9finit la gestion de votre entreprise, les responsabilit\u00E9s du propri\u00E9taire et les r\u00E8gles de fonctionnement. Bien que non obligatoire dans certains \u00C9tats, il est fortement recommand\u00E9 car :\",\n      reason1: \"Il renforce la s\u00E9paration entre vos finances personnelles et celles de l'entreprise\",\n      reason2: \"Il est exig\u00E9 par les banques et les processeurs de paiement comme Stripe\",\n      reason3: \"Il fournit une protection juridique suppl\u00E9mentaire pour vous en tant que propri\u00E9taire\",\n      reason4: \"Il documente officiellement la structure de votre entreprise\",\n      generateButton: \"G\u00E9n\u00E9rer mon Operating Agreement\",\n      autoGenerated: \"Le document sera g\u00E9n\u00E9r\u00E9 automatiquement avec les donn\u00E9es de votre LLC et sauvegard\u00E9 dans votre Centre de Documentation pour que vous puissiez le t\u00E9l\u00E9charger quand vous en avez besoin.\",\n      viewDocument: \"Voir mon document\",\n      tip: \"Conseil :\",\n      tipText: \"Conservez une copie sign\u00E9e de ce document avec vos autres fichiers importants de l'entreprise.\"\n    },\n    documentApproved: {\n      title: \"Document Approuv\u00E9\",\n      approved: \"Approuv\u00E9\",\n      reviewedAndApproved: \"Votre document a \u00E9t\u00E9 examin\u00E9 et approuv\u00E9 avec succ\u00E8s.\",\n      viewDocuments: \"Voir mes documents\"\n    },\n    documentRejected: {\n      title: \"Document Rejet\u00E9 - Action Requise\",\n      rejected: \"Rejet\u00E9\",\n      reviewedAndRejected: \"Votre document a \u00E9t\u00E9 examin\u00E9 et rejet\u00E9.\",\n      reason: \"Raison\",\n      pleaseReupload: \"Veuillez acc\u00E9der \u00E0 votre tableau de bord client et t\u00E9l\u00E9charger \u00E0 nouveau le document corrig\u00E9.\",\n      viewDocuments: \"Voir mes documents\"\n    },\n    profileChangesVerified: {\n      title: \"Modifications de Profil V\u00E9rifi\u00E9es avec OTP\",\n      client: \"Client\",\n      email: \"Email\",\n      clientId: \"ID Client\",\n      fieldsModified: \"Champs modifi\u00E9s\",\n      verifiedWithOtp: \"Modification v\u00E9rifi\u00E9e avec OTP\"\n    },\n    abandonedApplication: {\n      incomplete: \"Votre demande est incompl\u00E8te\",\n      noticeText: \"Nous avons remarqu\u00E9 que vous avez commenc\u00E9 \u00E0 remplir votre demande de\",\n      importantNote: \"Note importante :\",\n      draftDeletion: \"Votre brouillon sera automatiquement supprim\u00E9 si vous ne le compl\u00E9tez pas. Pour des raisons de s\u00E9curit\u00E9 et de protection des donn\u00E9es, nous ne pouvons pas conserver les demandes incompl\u00E8tes ind\u00E9finiment.\",\n      understandDoubts: \"Nous comprenons que cr\u00E9er une LLC peut soulever quelques questions. Sachez que nous sommes l\u00E0 pour vous accompagner \u00E0 chaque \u00E9tape du processus.\",\n      questionsHelp: \"Si vous avez des questions ou besoin d'aide pour compl\u00E9ter votre demande, r\u00E9pondez simplement \u00E0 cet e-mail et nous serons ravis de vous aider.\",\n      whyChoose: \"Pourquoi choisir Easy US LLC ?\",\n      reason1: \"Formation compl\u00E8te en 48-72 heures\",\n      reason2: \"Assistance en espagnol tout au long du processus\",\n      reason3: \"Obtention de l'EIN incluse\",\n      reason4: \"Aide \u00E0 l'ouverture d'un compte bancaire\",\n      reason5: \"Support continu apr\u00E8s la formation\",\n      noMoreReminders: \"Si vous d\u00E9cidez finalement de ne pas continuer, nous ne vous enverrons plus de rappels concernant cette demande. Votre vie priv\u00E9e est importante pour nous.\",\n      savedDraft: \"Ne vous inqui\u00E9tez pas, nous avons sauvegard\u00E9 toute votre progression pour que vous puissiez reprendre exactement l\u00E0 o\u00F9 vous vous \u00EAtes arr\u00EAt\u00E9.\",\n      continueButton: \"Continuer ma demande\",\n      tip: \"Conseil :\",\n      tipText: \"Compl\u00E9tez votre demande pour que nous puissions commencer \u00E0 travailler sur votre LLC le plus rapidement possible.\",\n      expiring: \"Votre brouillon expirera dans 48 heures s'il n'est pas compl\u00E9t\u00E9.\",\n      llcFormation: \"la constitution de votre LLC\",\n      maintenancePack: \"pack de maintenance\",\n      dontLoseProgress: \"Ne perdez pas votre progression. Reprenez votre demande maintenant et compl\u00E9tez le processus en quelques minutes.\",\n      lastHours: \"derni\u00E8res heures\",\n      autoDeleteWarning: \"Votre demande sera automatiquement supprim\u00E9e si vous ne la compl\u00E9tez pas.\"\n    },\n    calculatorResults: {\n      results: \"R\u00E9sultats de votre calcul\",\n      introText: \"Voici le r\u00E9sum\u00E9 de votre comparaison fiscale demand\u00E9e. Nous avons analys\u00E9 les chiffres et souhaitons que vous ayez toutes les informations pour prendre la meilleure d\u00E9cision pour votre entreprise.\",\n      summary: \"R\u00E9sum\u00E9 de votre analyse\",\n      income: \"Revenus annuels :\",\n      expenses: \"D\u00E9penses d\u00E9ductibles :\",\n      autonomoTax: \"Imp\u00F4ts en tant qu'ind\u00E9pendant :\",\n      llcTax: \"Imp\u00F4ts avec LLC :\",\n      potentialSavings: \"Vos \u00E9conomies potentielles :\",\n      savings: \"\u00C9conomies estim\u00E9es :\",\n      withLLC: \"Avec une LLC aux \u00C9tats-Unis, vous pourriez optimiser consid\u00E9rablement votre charge fiscale tout en op\u00E9rant de mani\u00E8re parfaitement l\u00E9gale. Ces \u00E9conomies se maintiennent ann\u00E9e apr\u00E8s ann\u00E9e, ce qui peut repr\u00E9senter une diff\u00E9rence importante pour votre entreprise \u00E0 long terme.\",\n      learnMore: \"Souhaitez-vous en savoir plus sur le fonctionnement ? Nous serons ravis de r\u00E9pondre \u00E0 toutes vos questions sans engagement.\",\n      viewServices: \"Voir nos services\",\n      disclaimer: \"Ce calcul est indicatif et bas\u00E9 sur les donn\u00E9es que vous avez fournies. Pour une analyse personnalis\u00E9e de votre situation, n'h\u00E9sitez pas \u00E0 nous contacter.\"\n    },\n    newsletter: {\n      confirmed: \"Votre abonnement a \u00E9t\u00E9 confirm\u00E9 avec succ\u00E8s.\",\n      willReceive: \"Vous recevrez des informations pertinentes sur les services, mises \u00E0 jour et nouveaut\u00E9s li\u00E9es \u00E0 Easy US LLC.\",\n      unsubscribe: \"Vous pouvez vous d\u00E9sabonner \u00E0 tout moment via le lien inclus dans nos e-mails.\"\n    },\n    orderEvent: {\n      update: \"Votre commande a une mise \u00E0 jour :\",\n      date: \"Date :\",\n      viewDetails: \"Voir les d\u00E9tails\"\n    }\n  },\n  de: {\n    common: {\n      greeting: \"Hallo\",\n      closing: \"Mit freundlichen Gr\u00FC\u00DFen,\",\n      doubts: \"Bei Fragen antworten Sie bitte direkt auf diese E-Mail.\",\n      client: \"Kunde\"\n    },\n    otp: {\n      thanks: \"Vielen Dank, dass Sie Ihren Prozess bei Easy US LLC fortsetzen.\",\n      forSecurity: \"Um die Sicherheit Ihres Kontos zu gew\u00E4hrleisten, verwenden Sie bitte den folgenden Verifizierungscode:\",\n      yourCode: \"Ihr OTP-Code:\",\n      important: \"Wichtig:\",\n      personalAndConfidential: \"Dieser Code ist pers\u00F6nlich und vertraulich\",\n      validFor: \"Er ist aus Sicherheitsgr\u00FCnden <strong>15 Minuten</strong> g\u00FCltig\",\n      doNotShare: \"Teilen Sie ihn mit niemandem\",\n      ignoreMessage: \"Wenn Sie diesen Code nicht angefordert haben, k\u00F6nnen Sie diese Nachricht bedenkenlos ignorieren.\",\n      ipDetected: \"Anmeldeversuch erkannt von IP:\"\n    },\n    welcome: {\n      welcomeMessage: \"Willkommen bei Easy US LLC! Wir freuen uns sehr, Sie bei uns zu haben.\",\n      accountCreated: \"Ihr Konto wurde erfolgreich erstellt und Sie k\u00F6nnen alles erkunden, was wir gemeinsam erreichen k\u00F6nnen. \u00DCber Ihren Kundenbereich haben Sie Zugang zu:\",\n      accessFrom: \"\u00DCber Ihren Kundenbereich haben Sie Zugang zu:\",\n      realTimeTracking: \"Echtzeit-Verfolgung Ihrer Anfragen\",\n      documentCenter: \"Dokumentencenter zum Herunterladen aller Ihrer Dateien\",\n      professionalTools: \"Professionelle Tools wie den Rechnungsgenerator\",\n      fiscalCalendar: \"Steuerkalender mit Ihren wichtigen Terminen\",\n      directSupport: \"Direkte Kommunikation mit unserem Support-Team\",\n      hereToHelp: \"Wir sind hier, um Sie bei jedem Schritt Ihres gesch\u00E4ftlichen Abenteuers in den Vereinigten Staaten zu unterst\u00FCtzen. Wenn Sie Fragen haben, z\u00F6gern Sie nicht, uns zu kontaktieren.\",\n      exploreButton: \"Meinen Kundenbereich erkunden\"\n    },\n    accountPendingVerification: {\n      accountCreatedBut: \"Ihr Konto wurde erfolgreich erstellt, aber Sie m\u00FCssen Ihre E-Mail-Adresse verifizieren, um es vollst\u00E4ndig zu aktivieren.\",\n      actionRequired: \"Aktion erforderlich:\",\n      accessAndVerify: \"Greifen Sie auf Ihren Kundenbereich zu und verifizieren Sie Ihre E-Mail, um Ihr Konto zu aktivieren und auf alle Funktionen zuzugreifen.\",\n      verifyButton: \"Meine E-Mail verifizieren\",\n      whileUnverified: \"Solange Ihre E-Mail nicht verifiziert ist, bleibt Ihr Konto in \u00DCberpr\u00FCfung.\"\n    },\n    accountUnderReview: {\n      underReview: \"Wir m\u00F6chten Sie dar\u00FCber informieren, dass Ihr Konto einen kurzen \u00DCberpr\u00FCfungsprozess durchl\u00E4uft. Keine Sorge, dies ist v\u00F6llig routinem\u00E4\u00DFig und geh\u00F6rt zu unseren Sicherheitsstandards zum Schutz Ihrer Daten und zur Gew\u00E4hrleistung einer sicheren Erfahrung.\",\n      whyReview: \"Warum tun wir das?\",\n      whyReviewText: \"Bei Easy US LLC nehmen wir die Sicherheit unserer Kunden sehr ernst. Dieser Prozess erm\u00F6glicht es uns zu \u00FCberpr\u00FCfen, ob alle Informationen korrekt sind und Ihr Konto ordnungsgem\u00E4\u00DF gesch\u00FCtzt ist.\",\n      duringProcess: \"W\u00E4hrend dieser kurzen Phase werden die Funktionen Ihres Kontos vor\u00FCbergehend eingeschr\u00E4nkt. Das bedeutet, dass Sie keine neuen Bestellungen aufgeben oder bestehende Informationen \u00E4ndern k\u00F6nnen, aber keine Sorge: Diese Situation ist vor\u00FCbergehend und beeintr\u00E4chtigt keine bereits laufenden Verfahren.\",\n      whatHappens: \"Was passiert jetzt?\",\n      step1: \"Unser Team wird Ihre Kontoinformationen \u00FCberpr\u00FCfen (normalerweise innerhalb von 24-48 Gesch\u00E4ftstagen)\",\n      step2: \"Wir werden Sie per E-Mail benachrichtigen, sobald die \u00DCberpr\u00FCfung abgeschlossen ist\",\n      step3: \"Wenn wir zus\u00E4tzliche Dokumente ben\u00F6tigen, werden wir Sie klar und einfach dar\u00FCber informieren\",\n      teamReviewing: \"In der Zwischenzeit, wenn Sie Fragen haben oder Hilfe ben\u00F6tigen, z\u00F6gern Sie nicht, auf diese E-Mail zu antworten. Wir sind hier, um Ihnen bei allem zu helfen, was Sie brauchen.\",\n      patience: \"Vielen Dank f\u00FCr Ihre Geduld und Ihr Vertrauen. Wir wissen, dass Ihre Zeit wertvoll ist, und werden alles tun, um dies so schnell wie m\u00F6glich zu kl\u00E4ren.\",\n      closing: \"Herzliche Gr\u00FC\u00DFe vom Easy US LLC Team\"\n    },\n    accountVip: {\n      updatedToVip: \"Ihr Konto wurde auf den VIP-Status aktualisiert.\",\n      benefits: \"VIP-Vorteile:\",\n      priorityAttention: \"Priorit\u00E4re Betreuung und beschleunigte Bearbeitung\",\n      preferentialTracking: \"Bevorzugte Nachverfolgung durch unser Team\",\n      fullAccess: \"Vollst\u00E4ndiger Zugang zu allen Diensten\",\n      viewDashboard: \"Meinen Kundenbereich anzeigen\"\n    },\n    accountReactivated: {\n      reactivated: \"Ihr Konto wurde erfolgreich reaktiviert.\",\n      canAccess: \"Sie k\u00F6nnen jetzt auf Ihren Kundenbereich zugreifen und alle unsere Dienste normal nutzen.\",\n      viewDashboard: \"Meinen Kundenbereich anzeigen\"\n    },\n    accountDeactivated: {\n      deactivated: \"Wir bedauern, Ihnen mitteilen zu m\u00FCssen, dass Ihr Konto deaktiviert wurde.\",\n      cannotAccess: \"Solange Ihr Konto in diesem Zustand bleibt, k\u00F6nnen Sie nicht auf Ihren Kundenbereich zugreifen oder Vorg\u00E4nge \u00FCber unsere Plattform durchf\u00FChren.\",\n      contactSupport: \"Wenn Sie glauben, dass dies ein Fehler ist, oder weitere Informationen w\u00FCnschen, kontaktieren Sie bitte unser Support-Team, indem Sie auf diese E-Mail antworten.\"\n    },\n    confirmation: {\n      greatNews: \"Gro\u00DFartige Neuigkeiten! Wir haben Ihre Anfrage erhalten und arbeiten bereits daran. Ab jetzt k\u00FCmmert sich unser Team um alles.\",\n      details: \"Anfrage-Details\",\n      reference: \"Referenz:\",\n      service: \"Dienst:\",\n      company: \"Unternehmen:\",\n      state: \"Staat:\",\n      currentStatus: \"Aktueller Status:\",\n      inReview: \"In \u00DCberpr\u00FCfung\",\n      whatNow: \"Was passiert jetzt?\",\n      validatingInfo: \"Unser Team \u00FCberpr\u00FCft alle von Ihnen bereitgestellten Informationen. In den n\u00E4chsten Stunden erhalten Sie Updates zum Fortschritt Ihrer Anfrage direkt per E-Mail. Sie k\u00F6nnen den Status auch in Echtzeit \u00FCber Ihren Kundenbereich verfolgen.\",\n      nextSteps: \"N\u00E4chste Schritte\",\n      step1: \"Wir werden \u00FCberpr\u00FCfen, ob alle Informationen korrekt sind\",\n      step2: \"Wir werden die Verfahren bei den zust\u00E4ndigen Beh\u00F6rden einleiten\",\n      step3: \"Wir werden Sie in jeder Phase des Prozesses auf dem Laufenden halten\",\n      trackButton: \"Meinen Anfragestatus anzeigen\",\n      questionRef: \"Haben Sie Fragen? Antworten Sie einfach auf diese E-Mail unter Angabe Ihrer Referenz und wir helfen Ihnen gerne.\"\n    },\n    autoReply: {\n      receivedMessage: \"Ihre Nachricht wurde erfolgreich empfangen.\",\n      ticketNumber: \"Ticket-Nummer\",\n      estimatedResponse: \"Gesch\u00E4tzte Antwortzeit: <strong>24-48 Gesch\u00E4ftstage</strong>\",\n      responding: \"Unser Team wird Ihre Anfrage pr\u00FCfen und so schnell wie m\u00F6glich antworten. Wenn Sie zus\u00E4tzliche Informationen hinzuf\u00FCgen m\u00F6chten, antworten Sie direkt auf diese E-Mail.\",\n      seeMessages: \"Nachrichten anzeigen\"\n    },\n    orderUpdate: {\n      statusChanged: \"Der Status Ihrer Bestellung wurde aktualisiert.\",\n      orderLabel: \"Bestellung:\",\n      newStatus: \"Neuer Status:\",\n      statusPending: \"Ausstehend\",\n      statusProcessing: \"In Bearbeitung\",\n      statusPaid: \"Bezahlt\",\n      statusFiled: \"Eingereicht\",\n      statusDocumentsReady: \"Dokumente bereit\",\n      statusCompleted: \"Abgeschlossen\",\n      statusCancelled: \"Storniert\",\n      clarification: \"F\u00FCr R\u00FCckfragen zu dieser Aktualisierung antworten Sie bitte direkt auf diese E-Mail.\",\n      trackButton: \"Vollst\u00E4ndige Details anzeigen\"\n    },\n    orderCompleted: {\n      llcReady: \"Ihre LLC ist fertig!\",\n      congratulations: \"Herzlichen Gl\u00FCckwunsch! Ihre Bestellung wurde erfolgreich abgeschlossen. Alles ist bereit, damit Sie Ihr Unternehmen in den Vereinigten Staaten betreiben k\u00F6nnen.\",\n      docsReady: \"Ihre Dokumentation ist bereit\",\n      accessDocuments: \"Sie k\u00F6nnen jetzt alle Dokumente Ihres Unternehmens \u00FCber Ihr Dokumentencenter abrufen und herunterladen.\",\n      whatYouFind: \"Was werden Sie finden?\",\n      documentList: \"Verf\u00FCgbare Dokumente:\",\n      articlesOrg: \"Articles of Organization (Gr\u00FCndungsdokument)\",\n      einLetter: \"EIN-Brief vom IRS\",\n      registeredAgent: \"Informationen zum registrierten Vertreter\",\n      additionalGuides: \"Leitf\u00E4den und zus\u00E4tzliche Dokumente basierend auf Ihrem Service\",\n      viewDocuments: \"Meine Dokumente anzeigen\",\n      nextSteps: \"N\u00E4chste Schritte:\",\n      activateBanking: \"Bankkonto aktivieren (falls angefordert)\",\n      operatingAgreement: \"Ihren Operating Agreement erstellen\",\n      trackExpenses: \"Einnahmen und Ausgaben erfassen\",\n      hereForYou: \"Denken Sie daran, dass wir weiterhin f\u00FCr Sie da sind, um Ihnen bei allem zu helfen, was Sie brauchen. Wenn Sie Fragen zu den n\u00E4chsten Schritten haben, wie die Er\u00F6ffnung eines Bankkontos oder die Einrichtung Ihres Zahlungs-Gateways, z\u00F6gern Sie nicht, uns zu kontaktieren.\",\n      feedbackRequest: \"Ihre Erfahrung ist uns sehr wichtig. Wenn Sie einen Moment Zeit haben, w\u00FCrden wir uns \u00FCber Ihre Meinung zu unserem Service freuen.\"\n    },\n    noteReceived: {\n      teamNote: \"Sie haben eine neue Nachricht von unserem Team\",\n      relatedToOrder: \"bez\u00FCglich Ihrer Bestellung\",\n      respondNote: \"Sie k\u00F6nnen direkt auf diese E-Mail antworten oder \u00FCber Ihren Kundenbereich den vollst\u00E4ndigen Verlauf einsehen.\",\n      viewClientArea: \"Meinen Kundenbereich anzeigen\"\n    },\n    adminNote: {\n      messageAbout: \"Sie haben eine wichtige Nachricht zu Ihrer Anfrage:\",\n      viewTicket: \"Ticket anzeigen\",\n      viewClientArea: \"Meinen Kundenbereich anzeigen\"\n    },\n    paymentRequest: {\n      paymentRequired: \"Eine Zahlungsanforderung wurde erstellt, um mit Ihrem Verfahren fortzufahren\",\n      messageLabel: \"Nachricht:\",\n      amount: \"in H\u00F6he von\",\n      payNow: \"Jetzt bezahlen\",\n      buttonFallback: \"Wenn die Schaltfl\u00E4che nicht funktioniert, kopieren Sie diesen Link und f\u00FCgen Sie ihn ein:\",\n      securePayment: \"Die Zahlung wird sicher \u00FCber Stripe abgewickelt.\"\n    },\n    documentRequest: {\n      needDocument: \"Unser Team ben\u00F6tigt, dass Sie folgendes Dokument hochladen:\",\n      messageLabel: \"Nachricht:\",\n      documentType: \"Angefordertes Dokument:\",\n      referenceTicket: \"Referenz-Ticket:\",\n      important: \"Wichtig:\",\n      uploadInstruction: \"Bitte laden Sie das angeforderte Dokument so schnell wie m\u00F6glich hoch, um Verz\u00F6gerungen im Prozess zu vermeiden.\",\n      uploadButton: \"Dokument hochladen\"\n    },\n    documentUploaded: {\n      documentReceived: \"Wir haben ein neues Dokument zu Ihrer Akte hinzugef\u00FCgt:\",\n      forOrder: \"Bestellung:\",\n      accessDownload: \"Sie k\u00F6nnen dieses Dokument \u00FCber Ihren Kundenbereich abrufen und herunterladen.\",\n      reviewing: \"Unser Team wird es \u00FCberpr\u00FCfen und Sie benachrichtigen, wenn weitere Ma\u00DFnahmen erforderlich sind.\",\n      viewDocuments: \"Meine Dokumente anzeigen\",\n      trackButton: \"Anfragestatus anzeigen\"\n    },\n    messageReply: {\n      newReply: \"Sie haben eine neue Antwort in Ihrer Konversation:\",\n      repliedToQuery: \"Wir haben auf Ihre Anfrage geantwortet\",\n      ticket: \"Ticket:\",\n      viewConversation: \"Konversation anzeigen\",\n      viewClientArea: \"Meinen Kundenbereich anzeigen\"\n    },\n    passwordChangeOtp: {\n      passwordChangeRequest: \"Sie haben die \u00C4nderung Ihres Passworts beantragt. Verwenden Sie den folgenden Code zur Verifizierung Ihrer Identit\u00E4t:\",\n      useCode: \"Verwenden Sie den folgenden Code, um die \u00C4nderung zu best\u00E4tigen:\",\n      yourCode: \"Ihr Verifizierungscode:\",\n      important: \"Wichtig:\",\n      validFor: \"Dieser Code l\u00E4uft in <strong>10 Minuten</strong> ab\",\n      doNotShare: \"Teilen Sie ihn mit niemandem\",\n      notRequested: \"Wenn Sie diese \u00C4nderung nicht beantragt haben, ignorieren Sie diese Nachricht.\"\n    },\n    profileChangeOtp: {\n      title: \"Identit\u00E4tsverifizierung\",\n      sensitiveChangeRequest: \"Eine \u00C4nderung sensibler Profildaten wurde angefordert. Um Ihre Identit\u00E4t zu best\u00E4tigen, verwenden Sie den folgenden Verifizierungscode:\",\n      yourCode: \"Ihr Verifizierungscode:\",\n      important: \"Wichtig:\",\n      personalAndConfidential: \"Dieser Code ist pers\u00F6nlich und vertraulich\",\n      validFor: \"G\u00FCltig f\u00FCr <strong>24 Stunden</strong>\",\n      doNotShare: \"Teilen Sie ihn mit niemandem\",\n      ignoreMessage: \"Wenn Sie diese \u00C4nderung nicht angefordert haben, k\u00F6nnen Sie diese Nachricht bedenkenlos ignorieren.\"\n    },\n    accountLocked: {\n      locked: \"Zu Ihrer Sicherheit wurde Ihr Konto nach mehreren fehlgeschlagenen Zugriffsversuchen vor\u00FCbergehend gesperrt.\",\n      attempts: \"Um Ihr Konto zu entsperren und Ihre Identit\u00E4t zu verifizieren, ben\u00F6tigen wir Folgendes von Ihnen:\",\n      verifyIdentity: \"Um Ihr Konto zu entsperren und Ihre Identit\u00E4t zu verifizieren, ben\u00F6tigen wir Folgendes von Ihnen:\",\n      idRequirement: \"Hochaufl\u00F6sendes Bild des Ausweises/Reisepasses (beide Seiten)\",\n      birthDateConfirm: \"Ihr best\u00E4tigtes Geburtsdatum\",\n      referenceTicket: \"Ihre Referenz-Ticket-ID lautet:\",\n      contactSupport: \"Um Ihr Konto zu entsperren, kontaktieren Sie unser Support-Team:\",\n      resetPassword: \"Passwort zur\u00FCcksetzen\",\n      unlockButton: \"Support kontaktieren\"\n    },\n    renewalReminder: {\n      reminderText: \"Wir erinnern Sie daran, dass das Wartungspaket Ihrer LLC\",\n      expiresIn: \"L\u00E4uft ab in\",\n      dueDate: \"F\u00E4lligkeitsdatum:\",\n      daysRemaining: \"Verbleibende Tage:\",\n      withoutMaintenance: \"Ohne aktives Wartungspaket kann Ihre LLC ihren guten rechtlichen Status verlieren. Dazu geh\u00F6rt:\",\n      registeredAgentActive: \"Aktiver registrierter Vertreter\",\n      annualReports: \"Einreichung der Jahresberichte\",\n      taxCompliance: \"Steuerkonformit\u00E4t (IRS 1120/5472)\",\n      legalAddress: \"Rechtsadresse in den Vereinigten Staaten\",\n      renewNow: \"Jetzt erneuern\",\n      whatHappens: \"Was passiert, wenn ich nicht erneuere?\",\n      penalties: \"M\u00F6gliche Strafen und Zuschl\u00E4ge\",\n      agentExpires: \"Ihr registrierter Vertreter l\u00E4uft ab\",\n      goodStanding: \"Ihre LLC k\u00F6nnte den guten Status verlieren\",\n      viewCalendar: \"Steuerkalender anzeigen\"\n    },\n    registrationOtp: {\n      almostDone: \"Vielen Dank f\u00FCr Ihre Registrierung bei Easy US LLC. Ihr Verifizierungscode lautet:\",\n      confirmEmail: \"Um die Registrierung Ihres Kontos abzuschlie\u00DFen, geben Sie den folgenden Verifizierungscode ein:\",\n      yourCode: \"Ihr Verifizierungscode:\",\n      important: \"Wichtig:\",\n      validFor: \"Dieser Code l\u00E4uft ab in\",\n      doNotShare: \"Teilen Sie ihn mit niemandem\",\n      clientIdLabel: \"Ihre Kunden-ID lautet:\",\n      ignoreMessage: \"Wenn Sie kein Konto bei uns erstellt haben, k\u00F6nnen Sie diese Nachricht ignorieren.\"\n    },\n    operatingAgreementReady: {\n      ready: \"Ihr Operating Agreement ist fertig!\",\n      generated: \"Wir haben gro\u00DFartige Neuigkeiten f\u00FCr Sie.\",\n      llcData: \"Ihre LLC-Daten\",\n      companyLabel: \"Unternehmen:\",\n      stateLabel: \"Staat:\",\n      einLabel: \"EIN:\",\n      whatIs: \"Was ist das Operating Agreement?\",\n      explanation: \"Es ist das rechtliche Dokument, das die Betriebsregeln Ihrer LLC festlegt, einschlie\u00DFlich der Eigentumsstruktur, Gewinnverteilung und Verantwortlichkeiten der Mitglieder.\",\n      fullExplanation: \"Es ist das grundlegende Rechtsdokument Ihrer LLC. Es definiert, wie Ihr Unternehmen gef\u00FChrt wird, die Verantwortlichkeiten des Eigent\u00FCmers und die Betriebsregeln. Obwohl es in einigen Staaten nicht obligatorisch ist, wird es dringend empfohlen, weil:\",\n      reason1: \"Es verst\u00E4rkt die Trennung zwischen Ihren pers\u00F6nlichen und gesch\u00E4ftlichen Finanzen\",\n      reason2: \"Es wird von Banken und Zahlungsanbietern wie Stripe verlangt\",\n      reason3: \"Es bietet Ihnen als Eigent\u00FCmer zus\u00E4tzlichen Rechtsschutz\",\n      reason4: \"Es dokumentiert offiziell die Struktur Ihres Unternehmens\",\n      generateButton: \"Mein Operating Agreement erstellen\",\n      autoGenerated: \"Das Dokument wird automatisch mit Ihren LLC-Daten erstellt und in Ihrem Dokumentencenter gespeichert, damit Sie es jederzeit herunterladen k\u00F6nnen.\",\n      viewDocument: \"Mein Dokument anzeigen\",\n      tip: \"Tipp:\",\n      tipText: \"Bewahren Sie eine unterzeichnete Kopie dieses Dokuments zusammen mit Ihren anderen wichtigen Unternehmensunterlagen auf.\"\n    },\n    documentApproved: {\n      title: \"Dokument Genehmigt\",\n      approved: \"Genehmigt\",\n      reviewedAndApproved: \"Ihr Dokument wurde \u00FCberpr\u00FCft und erfolgreich genehmigt.\",\n      viewDocuments: \"Meine Dokumente anzeigen\"\n    },\n    documentRejected: {\n      title: \"Dokument Abgelehnt - Aktion Erforderlich\",\n      rejected: \"Abgelehnt\",\n      reviewedAndRejected: \"Ihr Dokument wurde \u00FCberpr\u00FCft und abgelehnt.\",\n      reason: \"Grund\",\n      pleaseReupload: \"Bitte greifen Sie auf Ihr Kunden-Dashboard zu und laden Sie das korrigierte Dokument erneut hoch.\",\n      viewDocuments: \"Meine Dokumente anzeigen\"\n    },\n    profileChangesVerified: {\n      title: \"Profil\u00E4nderungen mit OTP Verifiziert\",\n      client: \"Kunde\",\n      email: \"E-Mail\",\n      clientId: \"Kunden-ID\",\n      fieldsModified: \"Ge\u00E4nderte Felder\",\n      verifiedWithOtp: \"\u00C4nderung mit OTP verifiziert\"\n    },\n    abandonedApplication: {\n      incomplete: \"Ihr Antrag ist unvollst\u00E4ndig\",\n      noticeText: \"Wir haben bemerkt, dass Sie begonnen haben, Ihren Antrag f\u00FCr\",\n      importantNote: \"Wichtiger Hinweis:\",\n      draftDeletion: \"Ihr Entwurf wird automatisch gel\u00F6scht, wenn Sie ihn nicht abschlie\u00DFen. Aus Sicherheits- und Datenschutzgr\u00FCnden k\u00F6nnen wir unvollst\u00E4ndige Antr\u00E4ge nicht unbegrenzt aufbewahren.\",\n      understandDoubts: \"Wir verstehen, dass die Gr\u00FCndung einer LLC einige Fragen aufwerfen kann. Wir m\u00F6chten, dass Sie wissen, dass wir Ihnen bei jedem Schritt des Prozesses zur Seite stehen.\",\n      questionsHelp: \"Wenn Sie Fragen haben oder Hilfe beim Ausf\u00FCllen Ihres Antrags ben\u00F6tigen, antworten Sie einfach auf diese E-Mail und wir helfen Ihnen gerne.\",\n      whyChoose: \"Warum Easy US LLC w\u00E4hlen?\",\n      reason1: \"Vollst\u00E4ndige Gr\u00FCndung in 48-72 Stunden\",\n      reason2: \"Spanischsprachige Unterst\u00FCtzung w\u00E4hrend des gesamten Prozesses\",\n      reason3: \"EIN-Beschaffung inklusive\",\n      reason4: \"Hilfe bei der Kontoer\u00F6ffnung\",\n      reason5: \"Fortlaufender Support nach der Gr\u00FCndung\",\n      noMoreReminders: \"Wenn Sie sich letztendlich entscheiden, nicht fortzufahren, werden wir Ihnen keine weiteren Erinnerungen zu diesem Antrag senden. Ihre Privatsph\u00E4re ist uns wichtig.\",\n      savedDraft: \"Keine Sorge, wir haben Ihren gesamten Fortschritt gespeichert, damit Sie genau dort weitermachen k\u00F6nnen, wo Sie aufgeh\u00F6rt haben.\",\n      continueButton: \"Meinen Antrag fortsetzen\",\n      tip: \"Tipp:\",\n      tipText: \"Schlie\u00DFen Sie Ihren Antrag ab, damit wir so schnell wie m\u00F6glich mit Ihrer LLC beginnen k\u00F6nnen.\",\n      expiring: \"Ihr Entwurf l\u00E4uft in 48 Stunden ab, wenn er nicht abgeschlossen wird.\",\n      llcFormation: \"Ihre LLC-Gr\u00FCndung\",\n      maintenancePack: \"Wartungspaket\",\n      dontLoseProgress: \"Verlieren Sie nicht Ihren Fortschritt. Setzen Sie Ihren Antrag jetzt fort und schlie\u00DFen Sie den Prozess in wenigen Minuten ab.\",\n      lastHours: \"letzte Stunden\",\n      autoDeleteWarning: \"Ihr Antrag wird automatisch gel\u00F6scht, wenn Sie ihn nicht abschlie\u00DFen.\"\n    },\n    calculatorResults: {\n      results: \"Ihre Berechnungsergebnisse\",\n      introText: \"Hier ist die Zusammenfassung Ihres angeforderten Steuervergleichs. Wir haben die Zahlen analysiert und m\u00F6chten, dass Sie alle Informationen haben, um die beste Entscheidung f\u00FCr Ihr Unternehmen zu treffen.\",\n      summary: \"Ihre Analysezusammenfassung\",\n      income: \"Jahreseinkommen:\",\n      expenses: \"Abzugsf\u00E4hige Ausgaben:\",\n      autonomoTax: \"Steuern als Freiberufler:\",\n      llcTax: \"Steuern mit LLC:\",\n      potentialSavings: \"Ihre m\u00F6glichen Einsparungen:\",\n      savings: \"Gesch\u00E4tzte Einsparungen:\",\n      withLLC: \"Mit einer LLC in den Vereinigten Staaten k\u00F6nnten Sie Ihre Steuerlast erheblich optimieren und dabei v\u00F6llig legal operieren. Diese Einsparungen bleiben Jahr f\u00FCr Jahr bestehen, was einen wichtigen Unterschied f\u00FCr Ihr Unternehmen langfristig ausmachen kann.\",\n      learnMore: \"M\u00F6chten Sie mehr dar\u00FCber erfahren, wie es funktioniert? Wir beantworten gerne alle Ihre Fragen unverbindlich.\",\n      viewServices: \"Unsere Dienste anzeigen\",\n      disclaimer: \"Diese Berechnung ist indikativ und basiert auf den von Ihnen bereitgestellten Daten. F\u00FCr eine personalisierte Analyse Ihrer Situation z\u00F6gern Sie nicht, uns zu kontaktieren.\"\n    },\n    newsletter: {\n      confirmed: \"Ihr Abonnement wurde erfolgreich best\u00E4tigt.\",\n      willReceive: \"Sie erhalten relevante Informationen \u00FCber Dienste, Updates und Neuigkeiten rund um Easy US LLC.\",\n      unsubscribe: \"Sie k\u00F6nnen sich jederzeit \u00FCber den Link in unseren E-Mails abmelden.\"\n    },\n    orderEvent: {\n      update: \"Ihre Bestellung hat ein Update:\",\n      date: \"Datum:\",\n      viewDetails: \"Details anzeigen\"\n    }\n  },\n  it: {\n    common: {\n      greeting: \"Ciao\",\n      closing: \"Cordiali saluti,\",\n      doubts: \"Se hai domande, rispondi direttamente a questa e-mail.\",\n      client: \"Cliente\"\n    },\n    otp: {\n      thanks: \"Grazie per continuare il tuo processo con Easy US LLC.\",\n      forSecurity: \"Per garantire la sicurezza del tuo account, utilizza il seguente codice di verifica:\",\n      yourCode: \"Il tuo codice OTP:\",\n      important: \"Importante:\",\n      personalAndConfidential: \"Questo codice \u00E8 personale e confidenziale\",\n      validFor: \"\u00C8 valido per <strong>15 minuti</strong> per motivi di sicurezza\",\n      doNotShare: \"Non condividerlo con nessuno\",\n      ignoreMessage: \"Se non hai richiesto questo codice, puoi ignorare questo messaggio in tutta tranquillit\u00E0.\",\n      ipDetected: \"Tentativo di accesso rilevato dall'IP:\"\n    },\n    welcome: {\n      welcomeMessage: \"Benvenuto in Easy US LLC! Siamo felici di averti con noi.\",\n      accountCreated: \"Il tuo account \u00E8 stato creato con successo e puoi iniziare a esplorare tutto ci\u00F2 che possiamo fare insieme. Dalla tua Area Cliente avrai accesso a:\",\n      accessFrom: \"Dalla tua Area Cliente avrai accesso a:\",\n      realTimeTracking: \"Monitoraggio in tempo reale delle tue richieste\",\n      documentCenter: \"Centro documentazione per scaricare tutti i tuoi file\",\n      professionalTools: \"Strumenti professionali come il generatore di fatture\",\n      fiscalCalendar: \"Calendario fiscale con le tue date importanti\",\n      directSupport: \"Comunicazione diretta con il nostro team di supporto\",\n      hereToHelp: \"Siamo qui per aiutarti in ogni fase della tua avventura imprenditoriale negli Stati Uniti. Se hai domande, non esitare a scriverci.\",\n      exploreButton: \"Esplora la Mia Area Cliente\"\n    },\n    accountPendingVerification: {\n      accountCreatedBut: \"Il tuo account \u00E8 stato creato con successo, ma devi verificare la tua e-mail per attivarlo completamente.\",\n      actionRequired: \"Azione richiesta:\",\n      accessAndVerify: \"Accedi alla tua Area Cliente e verifica la tua e-mail per attivare il tuo account e accedere a tutte le funzionalit\u00E0.\",\n      verifyButton: \"Verifica la mia e-mail\",\n      whileUnverified: \"Finch\u00E9 la tua e-mail non sar\u00E0 verificata, il tuo account rimarr\u00E0 in fase di revisione.\"\n    },\n    accountUnderReview: {\n      underReview: \"Vogliamo informarti che il tuo account \u00E8 entrato in un breve processo di verifica. Non preoccuparti, \u00E8 completamente di routine e fa parte dei nostri standard di sicurezza per proteggere le tue informazioni e garantire un'esperienza sicura.\",\n      whyReview: \"Perch\u00E9 lo facciamo?\",\n      whyReviewText: \"In Easy US LLC prendiamo molto seriamente la sicurezza dei nostri clienti. Questo processo ci permette di verificare che tutte le informazioni siano corrette e che il tuo account sia adeguatamente protetto.\",\n      duringProcess: \"Durante questo breve periodo, le funzioni del tuo account saranno temporaneamente limitate. Ci\u00F2 significa che non potrai effettuare nuovi ordini o modificare le informazioni esistenti, ma non preoccuparti: questa situazione \u00E8 temporanea e non influir\u00E0 su nessuna procedura gi\u00E0 in corso.\",\n      whatHappens: \"Cosa succede ora?\",\n      step1: \"Il nostro team esaminer\u00E0 le informazioni del tuo account (solitamente entro 24-48 ore lavorative)\",\n      step2: \"Ti notificheremo tramite questa stessa e-mail non appena la verifica sar\u00E0 completata\",\n      step3: \"Se avremo bisogno di documenti aggiuntivi, te lo comunicheremo in modo chiaro e semplice\",\n      teamReviewing: \"Nel frattempo, se hai domande o hai bisogno di aiuto, non esitare a rispondere a questa e-mail. Siamo qui per aiutarti in tutto ci\u00F2 di cui hai bisogno.\",\n      patience: \"Grazie per la tua pazienza e fiducia. Sappiamo che il tuo tempo \u00E8 prezioso e faremo tutto il possibile per risolvere la questione il prima possibile.\",\n      closing: \"Un caro saluto dal team di Easy US LLC\"\n    },\n    accountVip: {\n      updatedToVip: \"Il tuo account \u00E8 stato aggiornato allo stato VIP.\",\n      benefits: \"Vantaggi VIP:\",\n      priorityAttention: \"Attenzione prioritaria e gestione accelerata\",\n      preferentialTracking: \"Monitoraggio preferenziale da parte del nostro team\",\n      fullAccess: \"Accesso completo a tutti i servizi\",\n      viewDashboard: \"Visualizza la Mia Area Cliente\"\n    },\n    accountReactivated: {\n      reactivated: \"Il tuo account \u00E8 stato riattivato con successo.\",\n      canAccess: \"Ora puoi accedere alla tua Area Cliente e utilizzare tutti i nostri servizi normalmente.\",\n      viewDashboard: \"Visualizza la Mia Area Cliente\"\n    },\n    accountDeactivated: {\n      deactivated: \"Ci dispiace informarti che il tuo account \u00E8 stato disattivato.\",\n      cannotAccess: \"Finch\u00E9 il tuo account rimarr\u00E0 in questo stato, non potrai accedere alla tua Area Cliente n\u00E9 effettuare operazioni tramite la nostra piattaforma.\",\n      contactSupport: \"Se ritieni che si tratti di un errore o desideri maggiori informazioni, contatta il nostro team di supporto rispondendo a questa e-mail.\"\n    },\n    confirmation: {\n      greatNews: \"Ottime notizie! Abbiamo ricevuto la tua richiesta e stiamo gi\u00E0 lavorando. Da questo momento, il nostro team si occuper\u00E0 di tutto.\",\n      details: \"Dettagli della richiesta\",\n      reference: \"Riferimento:\",\n      service: \"Servizio:\",\n      company: \"Azienda:\",\n      state: \"Stato:\",\n      currentStatus: \"Stato attuale:\",\n      inReview: \"In revisione\",\n      whatNow: \"Cosa succede ora?\",\n      validatingInfo: \"Il nostro team sta verificando tutte le informazioni che hai fornito. Nelle prossime ore riceverai aggiornamenti sull'avanzamento della tua richiesta direttamente via e-mail. Puoi anche seguire lo stato in tempo reale dalla tua Area Cliente.\",\n      nextSteps: \"Prossimi passi\",\n      step1: \"Verificheremo che tutte le informazioni siano corrette\",\n      step2: \"Avvieremo le procedure presso le autorit\u00E0 competenti\",\n      step3: \"Ti terremo informato in ogni fase del processo\",\n      trackButton: \"Visualizza lo stato della mia richiesta\",\n      questionRef: \"Hai domande? Rispondi semplicemente a questa e-mail indicando il tuo riferimento e saremo felici di aiutarti.\"\n    },\n    autoReply: {\n      receivedMessage: \"Il tuo messaggio \u00E8 stato ricevuto con successo.\",\n      ticketNumber: \"Numero di ticket\",\n      estimatedResponse: \"Tempo di risposta stimato: <strong>24-48 ore lavorative</strong>\",\n      responding: \"Il nostro team esaminer\u00E0 la tua richiesta e risponder\u00E0 il prima possibile. Se hai bisogno di aggiungere informazioni supplementari, rispondi direttamente a questa e-mail.\",\n      seeMessages: \"Visualizza messaggi\"\n    },\n    orderUpdate: {\n      statusChanged: \"Lo stato del tuo ordine \u00E8 stato aggiornato.\",\n      orderLabel: \"Ordine:\",\n      newStatus: \"Nuovo stato:\",\n      statusPending: \"In attesa\",\n      statusProcessing: \"In elaborazione\",\n      statusPaid: \"Pagato\",\n      statusFiled: \"Depositato\",\n      statusDocumentsReady: \"Documenti pronti\",\n      statusCompleted: \"Completato\",\n      statusCancelled: \"Annullato\",\n      clarification: \"Per qualsiasi chiarimento su questo aggiornamento, rispondi direttamente a questa e-mail.\",\n      trackButton: \"Visualizza dettagli completi\"\n    },\n    orderCompleted: {\n      llcReady: \"La tua LLC \u00E8 pronta!\",\n      congratulations: \"Congratulazioni! Il tuo ordine \u00E8 stato completato con successo. Tutto \u00E8 pronto per iniziare a operare con la tua azienda negli Stati Uniti.\",\n      docsReady: \"La tua documentazione \u00E8 pronta\",\n      accessDocuments: \"Ora puoi accedere e scaricare tutti i documenti della tua azienda dal tuo Centro Documentazione.\",\n      whatYouFind: \"Cosa troverai?\",\n      documentList: \"Documenti disponibili:\",\n      articlesOrg: \"Articles of Organization (atto costitutivo)\",\n      einLetter: \"Lettera EIN dall'IRS\",\n      registeredAgent: \"Informazioni sull'agente registrato\",\n      additionalGuides: \"Guide e documenti aggiuntivi in base al tuo servizio\",\n      viewDocuments: \"Visualizza I Miei Documenti\",\n      nextSteps: \"Prossimi passi:\",\n      activateBanking: \"Attivare il conto bancario (se richiesto)\",\n      operatingAgreement: \"Generare il tuo Operating Agreement\",\n      trackExpenses: \"Iniziare a registrare entrate e spese\",\n      hereForYou: \"Ricorda che siamo sempre qui per aiutarti in tutto ci\u00F2 di cui hai bisogno. Se hai domande sui prossimi passi, come aprire un conto bancario o configurare il tuo gateway di pagamento, non esitare a contattarci.\",\n      feedbackRequest: \"La tua esperienza \u00E8 molto importante per noi. Se hai un momento, ci farebbe piacere conoscere la tua opinione sul nostro servizio.\"\n    },\n    noteReceived: {\n      teamNote: \"Hai un nuovo messaggio dal nostro team\",\n      relatedToOrder: \"relativo al tuo ordine\",\n      respondNote: \"Puoi rispondere direttamente a questa e-mail o accedere alla tua Area Cliente per visualizzare lo storico completo.\",\n      viewClientArea: \"Visualizza la Mia Area Cliente\"\n    },\n    adminNote: {\n      messageAbout: \"Hai un messaggio importante riguardo alla tua richiesta:\",\n      viewTicket: \"Visualizza ticket\",\n      viewClientArea: \"Visualizza la Mia Area Cliente\"\n    },\n    paymentRequest: {\n      paymentRequired: \"\u00C8 stata generata una richiesta di pagamento per procedere con la tua pratica\",\n      messageLabel: \"Messaggio:\",\n      amount: \"per un importo di\",\n      payNow: \"Effettua il pagamento\",\n      buttonFallback: \"Se il pulsante non funziona, copia e incolla questo link:\",\n      securePayment: \"Il pagamento viene elaborato in modo sicuro tramite Stripe.\"\n    },\n    documentRequest: {\n      needDocument: \"Il nostro team richiede che tu carichi il seguente documento:\",\n      messageLabel: \"Messaggio:\",\n      documentType: \"Documento richiesto:\",\n      referenceTicket: \"Ticket di riferimento:\",\n      important: \"Importante:\",\n      uploadInstruction: \"Per favore, carica il documento richiesto il prima possibile per evitare ritardi nel processo.\",\n      uploadButton: \"Carica documento\"\n    },\n    documentUploaded: {\n      documentReceived: \"Abbiamo aggiunto un nuovo documento al tuo fascicolo:\",\n      forOrder: \"Ordine:\",\n      accessDownload: \"Puoi accedere e scaricare questo documento dalla tua Area Cliente.\",\n      reviewing: \"Il nostro team lo esaminer\u00E0 e ti notificher\u00E0 se \u00E8 necessaria un'azione aggiuntiva.\",\n      viewDocuments: \"Visualizza I Miei Documenti\",\n      trackButton: \"Visualizza stato della richiesta\"\n    },\n    messageReply: {\n      newReply: \"Hai una nuova risposta nella tua conversazione:\",\n      repliedToQuery: \"Abbiamo risposto alla tua richiesta\",\n      ticket: \"Ticket:\",\n      viewConversation: \"Visualizza conversazione\",\n      viewClientArea: \"Visualizza la Mia Area Cliente\"\n    },\n    passwordChangeOtp: {\n      passwordChangeRequest: \"Hai richiesto di cambiare la tua password. Usa il seguente codice per verificare la tua identit\u00E0:\",\n      useCode: \"Usa il seguente codice per confermare la modifica:\",\n      yourCode: \"Il tuo codice di verifica:\",\n      important: \"Importante:\",\n      validFor: \"Questo codice scade tra <strong>10 minuti</strong>\",\n      doNotShare: \"Non condividerlo con nessuno\",\n      notRequested: \"Se non hai richiesto questa modifica, ignora questo messaggio.\"\n    },\n    profileChangeOtp: {\n      title: \"Verifica dell'Identit\u00E0\",\n      sensitiveChangeRequest: \"\u00C8 stata richiesta una modifica ai dati sensibili del tuo profilo. Per confermare la tua identit\u00E0, utilizza il seguente codice di verifica:\",\n      yourCode: \"Il tuo codice di verifica:\",\n      important: \"Importante:\",\n      personalAndConfidential: \"Questo codice \u00E8 personale e riservato\",\n      validFor: \"Valido per <strong>24 ore</strong>\",\n      doNotShare: \"Non condividerlo con nessuno\",\n      ignoreMessage: \"Se non hai richiesto questa modifica, puoi ignorare questo messaggio in tutta sicurezza.\"\n    },\n    accountLocked: {\n      locked: \"Per la tua sicurezza, il tuo account \u00E8 stato temporaneamente bloccato dopo aver rilevato molteplici tentativi di accesso falliti.\",\n      attempts: \"Per sbloccare il tuo account e verificare la tua identit\u00E0, abbiamo bisogno che ci invii:\",\n      verifyIdentity: \"Per sbloccare il tuo account e verificare la tua identit\u00E0, abbiamo bisogno che ci invii:\",\n      idRequirement: \"Immagine ad alta risoluzione del documento d'identit\u00E0/passaporto (fronte e retro)\",\n      birthDateConfirm: \"La tua data di nascita confermata\",\n      referenceTicket: \"Il tuo ID ticket di riferimento \u00E8:\",\n      contactSupport: \"Per sbloccare il tuo account, contatta il nostro team di supporto:\",\n      resetPassword: \"Reimposta password\",\n      unlockButton: \"Contatta il supporto\"\n    },\n    renewalReminder: {\n      reminderText: \"Ti ricordiamo che il pacchetto di manutenzione della tua LLC\",\n      expiresIn: \"Scade tra\",\n      dueDate: \"Data di scadenza:\",\n      daysRemaining: \"Giorni rimanenti:\",\n      withoutMaintenance: \"Senza il pacchetto di manutenzione attivo, la tua LLC potrebbe perdere il suo buono stato legale. Questo include:\",\n      registeredAgentActive: \"Agente registrato attivo\",\n      annualReports: \"Presentazione dei rapporti annuali\",\n      taxCompliance: \"Conformit\u00E0 fiscale (IRS 1120/5472)\",\n      legalAddress: \"Indirizzo legale negli Stati Uniti\",\n      renewNow: \"Rinnova ora\",\n      whatHappens: \"Cosa succede se non rinnovo?\",\n      penalties: \"Possibili penalit\u00E0 e sovrattasse\",\n      agentExpires: \"Il tuo agente registrato scadr\u00E0\",\n      goodStanding: \"La tua LLC potrebbe perdere il buono stato\",\n      viewCalendar: \"Visualizza calendario fiscale\"\n    },\n    registrationOtp: {\n      almostDone: \"Grazie per esserti registrato su Easy US LLC. Il tuo codice di verifica \u00E8:\",\n      confirmEmail: \"Per completare la registrazione del tuo account, inserisci il seguente codice di verifica:\",\n      yourCode: \"Il tuo codice di verifica:\",\n      important: \"Importante:\",\n      validFor: \"Questo codice scade tra\",\n      doNotShare: \"Non condividerlo con nessuno\",\n      clientIdLabel: \"Il tuo ID cliente \u00E8:\",\n      ignoreMessage: \"Se non hai creato un account con noi, puoi ignorare questo messaggio.\"\n    },\n    operatingAgreementReady: {\n      ready: \"Il tuo Operating Agreement \u00E8 pronto!\",\n      generated: \"Abbiamo ottime notizie per te.\",\n      llcData: \"Dati della tua LLC\",\n      companyLabel: \"Azienda:\",\n      stateLabel: \"Stato:\",\n      einLabel: \"EIN:\",\n      whatIs: \"Cos'\u00E8 l'Operating Agreement?\",\n      explanation: \"\u00C8 il documento legale che stabilisce le regole di funzionamento della tua LLC, inclusa la struttura proprietaria, la distribuzione degli utili e le responsabilit\u00E0 dei membri.\",\n      fullExplanation: \"\u00C8 il documento legale fondamentale della tua LLC. Definisce come viene gestita la tua azienda, le responsabilit\u00E0 del proprietario e le regole operative. Sebbene in alcuni stati non sia obbligatorio, \u00E8 altamente raccomandato perch\u00E9:\",\n      reason1: \"Rafforza la separazione tra le tue finanze personali e quelle aziendali\",\n      reason2: \"\u00C8 richiesto da banche e processori di pagamento come Stripe\",\n      reason3: \"Fornisce una protezione legale aggiuntiva per te come proprietario\",\n      reason4: \"Documenta ufficialmente la struttura della tua attivit\u00E0\",\n      generateButton: \"Genera il mio Operating Agreement\",\n      autoGenerated: \"Il documento sar\u00E0 generato automaticamente con i dati della tua LLC e salvato nel tuo Centro Documentazione per poterlo scaricare quando ne avrai bisogno.\",\n      viewDocument: \"Visualizza il mio documento\",\n      tip: \"Consiglio:\",\n      tipText: \"Conserva una copia firmata di questo documento insieme agli altri file importanti della tua azienda.\"\n    },\n    documentApproved: {\n      title: \"Documento Approvato\",\n      approved: \"Approvato\",\n      reviewedAndApproved: \"Il tuo documento \u00E8 stato esaminato e approvato con successo.\",\n      viewDocuments: \"Visualizza i miei documenti\"\n    },\n    documentRejected: {\n      title: \"Documento Rifiutato - Azione Richiesta\",\n      rejected: \"Rifiutato\",\n      reviewedAndRejected: \"Il tuo documento \u00E8 stato esaminato e rifiutato.\",\n      reason: \"Motivo\",\n      pleaseReupload: \"Per favore, accedi al tuo pannello cliente e carica nuovamente il documento corretto.\",\n      viewDocuments: \"Visualizza i miei documenti\"\n    },\n    profileChangesVerified: {\n      title: \"Modifiche Profilo Verificate con OTP\",\n      client: \"Cliente\",\n      email: \"Email\",\n      clientId: \"ID Cliente\",\n      fieldsModified: \"Campi modificati\",\n      verifiedWithOtp: \"Modifica verificata con OTP\"\n    },\n    abandonedApplication: {\n      incomplete: \"La tua richiesta \u00E8 incompleta\",\n      noticeText: \"Abbiamo notato che hai iniziato a compilare la tua richiesta per\",\n      importantNote: \"Nota importante:\",\n      draftDeletion: \"La tua bozza verr\u00E0 eliminata automaticamente se non la completi. Per motivi di sicurezza e protezione dei dati, non possiamo conservare le richieste incomplete a tempo indeterminato.\",\n      understandDoubts: \"Capiamo che fare il passo di creare una LLC possa generare alcune domande. Vogliamo che tu sappia che siamo qui per aiutarti in ogni fase del processo.\",\n      questionsHelp: \"Se hai domande o hai bisogno di assistenza per completare la tua richiesta, rispondi semplicemente a questa e-mail e saremo felici di aiutarti.\",\n      whyChoose: \"Perch\u00E9 scegliere Easy US LLC?\",\n      reason1: \"Costituzione completa in 48-72 ore\",\n      reason2: \"Assistenza in spagnolo durante tutto il processo\",\n      reason3: \"Ottenimento dell'EIN incluso\",\n      reason4: \"Aiuto con l'apertura del conto bancario\",\n      reason5: \"Supporto continuo dopo la costituzione\",\n      noMoreReminders: \"Se alla fine decidi di non continuare, non ti invieremo pi\u00F9 promemoria su questa richiesta. La tua privacy \u00E8 importante per noi.\",\n      savedDraft: \"Non preoccuparti, abbiamo salvato tutti i tuoi progressi in modo che tu possa riprendere esattamente da dove ti eri fermato.\",\n      continueButton: \"Continua la mia richiesta\",\n      tip: \"Consiglio:\",\n      tipText: \"Completa la tua richiesta in modo che possiamo iniziare a lavorare sulla tua LLC il prima possibile.\",\n      expiring: \"La tua bozza scadr\u00E0 tra 48 ore se non la completi.\",\n      llcFormation: \"la costituzione della tua LLC\",\n      maintenancePack: \"pacchetto di manutenzione\",\n      dontLoseProgress: \"Non perdere i tuoi progressi. Riprendi la tua richiesta ora e completa il processo in pochi minuti.\",\n      lastHours: \"ultime ore\",\n      autoDeleteWarning: \"La tua richiesta verr\u00E0 eliminata automaticamente se non la completi.\"\n    },\n    calculatorResults: {\n      results: \"Risultati del tuo calcolo\",\n      introText: \"Ecco il riepilogo del confronto fiscale che hai richiesto. Abbiamo analizzato i numeri e vogliamo che tu abbia tutte le informazioni per prendere la migliore decisione per la tua attivit\u00E0.\",\n      summary: \"Riepilogo della tua analisi\",\n      income: \"Reddito annuale:\",\n      expenses: \"Spese deducibili:\",\n      autonomoTax: \"Tasse come lavoratore autonomo:\",\n      llcTax: \"Tasse con LLC:\",\n      potentialSavings: \"Il tuo risparmio potenziale:\",\n      savings: \"Risparmio stimato:\",\n      withLLC: \"Con una LLC negli Stati Uniti, potresti ottimizzare significativamente il tuo carico fiscale operando in modo completamente legale. Questi risparmi si mantengono anno dopo anno, il che pu\u00F2 fare una differenza importante per la tua attivit\u00E0 a lungo termine.\",\n      learnMore: \"Vorresti saperne di pi\u00F9 su come funziona? Saremo felici di rispondere a tutte le tue domande senza impegno.\",\n      viewServices: \"Visualizza i nostri servizi\",\n      disclaimer: \"Questo calcolo \u00E8 indicativo e si basa sui dati che hai fornito. Per un'analisi personalizzata della tua situazione, non esitare a contattarci.\"\n    },\n    newsletter: {\n      confirmed: \"La tua iscrizione \u00E8 stata confermata con successo.\",\n      willReceive: \"Riceverai informazioni pertinenti su servizi, aggiornamenti e novit\u00E0 relative a Easy US LLC.\",\n      unsubscribe: \"Puoi annullare l'iscrizione in qualsiasi momento tramite il link incluso nelle nostre e-mail.\"\n    },\n    orderEvent: {\n      update: \"Il tuo ordine ha un aggiornamento:\",\n      date: \"Data:\",\n      viewDetails: \"Visualizza dettagli\"\n    }\n  },\n  pt: {\n    common: {\n      greeting: \"Ol\u00E1\",\n      closing: \"Atenciosamente,\",\n      doubts: \"Se tiver alguma d\u00FAvida, responda diretamente a este e-mail.\",\n      client: \"Cliente\"\n    },\n    otp: {\n      thanks: \"Obrigado por continuar com o seu processo na Easy US LLC.\",\n      forSecurity: \"Para garantir a seguran\u00E7a da sua conta, utilize o seguinte c\u00F3digo de verifica\u00E7\u00E3o:\",\n      yourCode: \"O seu c\u00F3digo OTP:\",\n      important: \"Importante:\",\n      personalAndConfidential: \"Este c\u00F3digo \u00E9 pessoal e confidencial\",\n      validFor: \"\u00C9 v\u00E1lido por <strong>15 minutos</strong> por raz\u00F5es de seguran\u00E7a\",\n      doNotShare: \"N\u00E3o o partilhe com ningu\u00E9m\",\n      ignoreMessage: \"Se n\u00E3o solicitou este c\u00F3digo, pode ignorar esta mensagem com toda a tranquilidade.\",\n      ipDetected: \"Tentativa de acesso detetada a partir do IP:\"\n    },\n    welcome: {\n      welcomeMessage: \"Bem-vindo \u00E0 Easy US LLC! Estamos muito felizes por t\u00EA-lo connosco.\",\n      accountCreated: \"A sua conta foi criada com sucesso e pode come\u00E7ar a explorar tudo o que podemos fazer juntos. A partir da sua \u00C1rea de Cliente ter\u00E1 acesso a:\",\n      accessFrom: \"A partir da sua \u00C1rea de Cliente ter\u00E1 acesso a:\",\n      realTimeTracking: \"Acompanhamento em tempo real dos seus pedidos\",\n      documentCenter: \"Centro de documenta\u00E7\u00E3o para descarregar todos os seus ficheiros\",\n      professionalTools: \"Ferramentas profissionais como o gerador de faturas\",\n      fiscalCalendar: \"Calend\u00E1rio fiscal com as suas datas importantes\",\n      directSupport: \"Comunica\u00E7\u00E3o direta com a nossa equipa de suporte\",\n      hereToHelp: \"Estamos aqui para ajud\u00E1-lo em cada passo da sua aventura empresarial nos Estados Unidos. Se tiver alguma d\u00FAvida, n\u00E3o hesite em contactar-nos.\",\n      exploreButton: \"Explorar a Minha \u00C1rea de Cliente\"\n    },\n    accountPendingVerification: {\n      accountCreatedBut: \"A sua conta foi criada com sucesso, mas precisa de verificar o seu e-mail para a ativar completamente.\",\n      actionRequired: \"A\u00E7\u00E3o necess\u00E1ria:\",\n      accessAndVerify: \"Aceda \u00E0 sua \u00C1rea de Cliente e verifique o seu e-mail para ativar a sua conta e aceder a todas as funcionalidades.\",\n      verifyButton: \"Verificar o meu e-mail\",\n      whileUnverified: \"Enquanto o seu e-mail n\u00E3o estiver verificado, a sua conta permanecer\u00E1 em revis\u00E3o.\"\n    },\n    accountUnderReview: {\n      underReview: \"Queremos inform\u00E1-lo de que a sua conta entrou num breve processo de verifica\u00E7\u00E3o. N\u00E3o se preocupe, \u00E9 completamente rotineiro e faz parte dos nossos padr\u00F5es de seguran\u00E7a para proteger as suas informa\u00E7\u00F5es e garantir uma experi\u00EAncia segura.\",\n      whyReview: \"Porque fazemos isto?\",\n      whyReviewText: \"Na Easy US LLC, levamos muito a s\u00E9rio a seguran\u00E7a dos nossos clientes. Este processo permite-nos verificar que todas as informa\u00E7\u00F5es est\u00E3o corretas e que a sua conta est\u00E1 devidamente protegida.\",\n      duringProcess: \"Durante este breve per\u00EDodo, as fun\u00E7\u00F5es da sua conta estar\u00E3o temporariamente limitadas. Isto significa que n\u00E3o poder\u00E1 fazer novos pedidos nem modificar informa\u00E7\u00F5es existentes, mas n\u00E3o se preocupe: esta situa\u00E7\u00E3o \u00E9 tempor\u00E1ria e n\u00E3o afetar\u00E1 nenhum processo j\u00E1 em curso.\",\n      whatHappens: \"O que acontece agora?\",\n      step1: \"A nossa equipa ir\u00E1 rever as informa\u00E7\u00F5es da sua conta (normalmente dentro de 24-48 horas \u00FAteis)\",\n      step2: \"Notific\u00E1-lo-emos por este mesmo e-mail assim que a verifica\u00E7\u00E3o estiver conclu\u00EDda\",\n      step3: \"Se precisarmos de documentos adicionais, inform\u00E1-lo-emos de forma clara e simples\",\n      teamReviewing: \"Entretanto, se tiver alguma d\u00FAvida ou precisar de ajuda, n\u00E3o hesite em responder a este e-mail. Estamos aqui para ajud\u00E1-lo em tudo o que precisar.\",\n      patience: \"Obrigado pela sua paci\u00EAncia e confian\u00E7a. Sabemos que o seu tempo \u00E9 valioso e faremos tudo o poss\u00EDvel para resolver isto o mais rapidamente poss\u00EDvel.\",\n      closing: \"Com carinho, a equipa da Easy US LLC\"\n    },\n    accountVip: {\n      updatedToVip: \"A sua conta foi atualizada para o estado VIP.\",\n      benefits: \"Benef\u00EDcios VIP:\",\n      priorityAttention: \"Aten\u00E7\u00E3o priorit\u00E1ria e processamento acelerado\",\n      preferentialTracking: \"Acompanhamento preferencial pela nossa equipa\",\n      fullAccess: \"Acesso completo a todos os servi\u00E7os\",\n      viewDashboard: \"Ver a Minha \u00C1rea de Cliente\"\n    },\n    accountReactivated: {\n      reactivated: \"A sua conta foi reativada com sucesso.\",\n      canAccess: \"Agora pode aceder \u00E0 sua \u00C1rea de Cliente e utilizar todos os nossos servi\u00E7os normalmente.\",\n      viewDashboard: \"Ver a Minha \u00C1rea de Cliente\"\n    },\n    accountDeactivated: {\n      deactivated: \"Lamentamos informar que a sua conta foi desativada.\",\n      cannotAccess: \"Enquanto a sua conta permanecer neste estado, n\u00E3o poder\u00E1 aceder \u00E0 sua \u00C1rea de Cliente nem realizar opera\u00E7\u00F5es atrav\u00E9s da nossa plataforma.\",\n      contactSupport: \"Se acredita que se trata de um erro ou deseja obter mais informa\u00E7\u00F5es, contacte a nossa equipa de suporte respondendo a este e-mail.\"\n    },\n    confirmation: {\n      greatNews: \"\u00D3timas not\u00EDcias! Recebemos o seu pedido e j\u00E1 estamos a trabalhar nele. A partir de agora, a nossa equipa trata de tudo.\",\n      details: \"Detalhes do pedido\",\n      reference: \"Refer\u00EAncia:\",\n      service: \"Servi\u00E7o:\",\n      company: \"Empresa:\",\n      state: \"Estado:\",\n      currentStatus: \"Estado atual:\",\n      inReview: \"Em revis\u00E3o\",\n      whatNow: \"O que acontece agora?\",\n      validatingInfo: \"A nossa equipa est\u00E1 a validar todas as informa\u00E7\u00F5es que forneceu. Nas pr\u00F3ximas horas receber\u00E1 atualiza\u00E7\u00F5es sobre o progresso do seu pedido diretamente no seu e-mail. Tamb\u00E9m pode acompanhar o estado em tempo real a partir da sua \u00C1rea de Cliente.\",\n      nextSteps: \"Pr\u00F3ximos passos\",\n      step1: \"Verificaremos que todas as informa\u00E7\u00F5es est\u00E3o corretas\",\n      step2: \"Iniciaremos os procedimentos junto das autoridades competentes\",\n      step3: \"Mant\u00EA-lo-emos informado em cada etapa do processo\",\n      trackButton: \"Ver o estado do meu pedido\",\n      questionRef: \"Tem alguma d\u00FAvida? Responda simplesmente a este e-mail mencionando a sua refer\u00EAncia e teremos todo o prazer em ajudar.\"\n    },\n    autoReply: {\n      receivedMessage: \"A sua mensagem foi recebida com sucesso.\",\n      ticketNumber: \"N\u00FAmero do ticket\",\n      estimatedResponse: \"Tempo de resposta estimado: <strong>24-48 horas \u00FAteis</strong>\",\n      responding: \"A nossa equipa analisar\u00E1 a sua consulta e responder\u00E1 o mais brevemente poss\u00EDvel. Se precisar de adicionar informa\u00E7\u00F5es adicionais, responda diretamente a este e-mail.\",\n      seeMessages: \"Ver mensagens\"\n    },\n    orderUpdate: {\n      statusChanged: \"O estado da sua encomenda foi atualizado.\",\n      orderLabel: \"Encomenda:\",\n      newStatus: \"Novo estado:\",\n      statusPending: \"Pendente\",\n      statusProcessing: \"Em processamento\",\n      statusPaid: \"Pago\",\n      statusFiled: \"Registado\",\n      statusDocumentsReady: \"Documentos prontos\",\n      statusCompleted: \"Conclu\u00EDdo\",\n      statusCancelled: \"Cancelado\",\n      clarification: \"Para qualquer esclarecimento sobre esta atualiza\u00E7\u00E3o, responda diretamente a este e-mail.\",\n      trackButton: \"Ver detalhes completos\"\n    },\n    orderCompleted: {\n      llcReady: \"A sua LLC est\u00E1 pronta!\",\n      congratulations: \"Parab\u00E9ns! A sua encomenda foi conclu\u00EDda com sucesso. Tudo est\u00E1 pronto para come\u00E7ar a operar a sua empresa nos Estados Unidos.\",\n      docsReady: \"A sua documenta\u00E7\u00E3o est\u00E1 pronta\",\n      accessDocuments: \"Agora pode aceder e descarregar todos os documentos da sua empresa a partir do seu Centro de Documenta\u00E7\u00E3o.\",\n      whatYouFind: \"O que vai encontrar?\",\n      documentList: \"Documentos dispon\u00EDveis:\",\n      articlesOrg: \"Articles of Organization (documento de constitui\u00E7\u00E3o)\",\n      einLetter: \"Carta EIN do IRS\",\n      registeredAgent: \"Informa\u00E7\u00F5es do agente registado\",\n      additionalGuides: \"Guias e documentos adicionais de acordo com o seu servi\u00E7o\",\n      viewDocuments: \"Ver Os Meus Documentos\",\n      nextSteps: \"Pr\u00F3ximos passos:\",\n      activateBanking: \"Ativar conta banc\u00E1ria (se solicitado)\",\n      operatingAgreement: \"Gerar o seu Operating Agreement\",\n      trackExpenses: \"Come\u00E7ar a registar receitas e despesas\",\n      hereForYou: \"Lembre-se de que continuamos aqui para ajud\u00E1-lo em tudo o que precisar. Se tiver d\u00FAvidas sobre os pr\u00F3ximos passos, como abrir uma conta banc\u00E1ria ou configurar o seu gateway de pagamento, n\u00E3o hesite em contactar-nos.\",\n      feedbackRequest: \"A sua experi\u00EAncia \u00E9 muito importante para n\u00F3s. Se tiver um momento, adorar\u00EDamos conhecer a sua opini\u00E3o sobre o nosso servi\u00E7o.\"\n    },\n    noteReceived: {\n      teamNote: \"Tem uma nova mensagem da nossa equipa\",\n      relatedToOrder: \"relacionada com a sua encomenda\",\n      respondNote: \"Pode responder diretamente a este e-mail ou aceder \u00E0 sua \u00C1rea de Cliente para ver o hist\u00F3rico completo.\",\n      viewClientArea: \"Ver a Minha \u00C1rea de Cliente\"\n    },\n    adminNote: {\n      messageAbout: \"Tem uma mensagem importante sobre o seu pedido:\",\n      viewTicket: \"Ver ticket\",\n      viewClientArea: \"Ver a Minha \u00C1rea de Cliente\"\n    },\n    paymentRequest: {\n      paymentRequired: \"Foi gerado um pedido de pagamento para prosseguir com o seu processo\",\n      messageLabel: \"Mensagem:\",\n      amount: \"no valor de\",\n      payNow: \"Efetuar pagamento\",\n      buttonFallback: \"Se o bot\u00E3o n\u00E3o funcionar, copie e cole este link:\",\n      securePayment: \"O pagamento \u00E9 processado de forma segura atrav\u00E9s do Stripe.\"\n    },\n    documentRequest: {\n      needDocument: \"A nossa equipa necessita que carregue o seguinte documento:\",\n      messageLabel: \"Mensagem:\",\n      documentType: \"Documento solicitado:\",\n      referenceTicket: \"Ticket de refer\u00EAncia:\",\n      important: \"Importante:\",\n      uploadInstruction: \"Por favor, carregue o documento solicitado o mais brevemente poss\u00EDvel para evitar atrasos no processo.\",\n      uploadButton: \"Carregar documento\"\n    },\n    documentUploaded: {\n      documentReceived: \"Adicion\u00E1mos um novo documento ao seu processo:\",\n      forOrder: \"Encomenda:\",\n      accessDownload: \"Pode aceder e descarregar este documento a partir da sua \u00C1rea de Cliente.\",\n      reviewing: \"A nossa equipa ir\u00E1 analis\u00E1-lo e notific\u00E1-lo-\u00E1 se for necess\u00E1ria alguma a\u00E7\u00E3o adicional.\",\n      viewDocuments: \"Ver Os Meus Documentos\",\n      trackButton: \"Ver estado do pedido\"\n    },\n    messageReply: {\n      newReply: \"Tem uma nova resposta na sua conversa:\",\n      repliedToQuery: \"Respondemos \u00E0 sua consulta\",\n      ticket: \"Ticket:\",\n      viewConversation: \"Ver conversa\",\n      viewClientArea: \"Ver a Minha \u00C1rea de Cliente\"\n    },\n    passwordChangeOtp: {\n      passwordChangeRequest: \"Solicitou a altera\u00E7\u00E3o da sua palavra-passe. Utilize o seguinte c\u00F3digo para verificar a sua identidade:\",\n      useCode: \"Utilize o seguinte c\u00F3digo para confirmar a altera\u00E7\u00E3o:\",\n      yourCode: \"O seu c\u00F3digo de verifica\u00E7\u00E3o:\",\n      important: \"Importante:\",\n      validFor: \"Este c\u00F3digo expira em <strong>10 minutos</strong>\",\n      doNotShare: \"N\u00E3o o partilhe com ningu\u00E9m\",\n      notRequested: \"Se n\u00E3o solicitou esta altera\u00E7\u00E3o, ignore esta mensagem.\"\n    },\n    profileChangeOtp: {\n      title: \"Verifica\u00E7\u00E3o de Identidade\",\n      sensitiveChangeRequest: \"Foi solicitada uma altera\u00E7\u00E3o nos dados sens\u00EDveis do seu perfil. Para confirmar a sua identidade, utilize o seguinte c\u00F3digo de verifica\u00E7\u00E3o:\",\n      yourCode: \"O seu c\u00F3digo de verifica\u00E7\u00E3o:\",\n      important: \"Importante:\",\n      personalAndConfidential: \"Este c\u00F3digo \u00E9 pessoal e confidencial\",\n      validFor: \"V\u00E1lido por <strong>24 horas</strong>\",\n      doNotShare: \"N\u00E3o o partilhe com ningu\u00E9m\",\n      ignoreMessage: \"Se n\u00E3o solicitou esta altera\u00E7\u00E3o, pode ignorar esta mensagem com total tranquilidade.\"\n    },\n    accountLocked: {\n      locked: \"Para sua seguran\u00E7a, a sua conta foi temporariamente bloqueada ap\u00F3s a dete\u00E7\u00E3o de m\u00FAltiplas tentativas de acesso falhadas.\",\n      attempts: \"Para desbloquear a sua conta e verificar a sua identidade, precisamos que nos envie:\",\n      verifyIdentity: \"Para desbloquear a sua conta e verificar a sua identidade, precisamos que nos envie:\",\n      idRequirement: \"Imagem de alta resolu\u00E7\u00E3o do documento de identidade/passaporte (frente e verso)\",\n      birthDateConfirm: \"A sua data de nascimento confirmada\",\n      referenceTicket: \"O seu ID de ticket de refer\u00EAncia \u00E9:\",\n      contactSupport: \"Para desbloquear a sua conta, contacte a nossa equipa de suporte:\",\n      resetPassword: \"Redefinir palavra-passe\",\n      unlockButton: \"Contactar suporte\"\n    },\n    renewalReminder: {\n      reminderText: \"Lembramos que o pacote de manuten\u00E7\u00E3o da sua LLC\",\n      expiresIn: \"Expira em\",\n      dueDate: \"Data de vencimento:\",\n      daysRemaining: \"Dias restantes:\",\n      withoutMaintenance: \"Sem o pacote de manuten\u00E7\u00E3o ativo, a sua LLC pode perder o seu bom estado legal. Isto inclui:\",\n      registeredAgentActive: \"Agente registado ativo\",\n      annualReports: \"Apresenta\u00E7\u00E3o de relat\u00F3rios anuais\",\n      taxCompliance: \"Conformidade fiscal (IRS 1120/5472)\",\n      legalAddress: \"Morada legal nos Estados Unidos\",\n      renewNow: \"Renovar agora\",\n      whatHappens: \"O que acontece se n\u00E3o renovar?\",\n      penalties: \"Poss\u00EDveis penaliza\u00E7\u00F5es e sobretaxas\",\n      agentExpires: \"O seu agente registado expirar\u00E1\",\n      goodStanding: \"A sua LLC pode perder o bom estado\",\n      viewCalendar: \"Ver calend\u00E1rio fiscal\"\n    },\n    registrationOtp: {\n      almostDone: \"Obrigado por se registar na Easy US LLC. O seu c\u00F3digo de verifica\u00E7\u00E3o \u00E9:\",\n      confirmEmail: \"Para completar o registo da sua conta, introduza o seguinte c\u00F3digo de verifica\u00E7\u00E3o:\",\n      yourCode: \"O seu c\u00F3digo de verifica\u00E7\u00E3o:\",\n      important: \"Importante:\",\n      validFor: \"Este c\u00F3digo expira em\",\n      doNotShare: \"N\u00E3o o partilhe com ningu\u00E9m\",\n      clientIdLabel: \"O seu ID de cliente \u00E9:\",\n      ignoreMessage: \"Se n\u00E3o criou uma conta connosco, pode ignorar esta mensagem.\"\n    },\n    operatingAgreementReady: {\n      ready: \"O seu Operating Agreement est\u00E1 pronto!\",\n      generated: \"Temos \u00F3timas not\u00EDcias para si.\",\n      llcData: \"Dados da sua LLC\",\n      companyLabel: \"Empresa:\",\n      stateLabel: \"Estado:\",\n      einLabel: \"EIN:\",\n      whatIs: \"O que \u00E9 o Operating Agreement?\",\n      explanation: \"\u00C9 o documento legal que estabelece as regras de funcionamento da sua LLC, incluindo a estrutura de propriedade, distribui\u00E7\u00E3o de lucros e responsabilidades dos membros.\",\n      fullExplanation: \"\u00C9 o documento legal fundamental da sua LLC. Define como a sua empresa \u00E9 gerida, as responsabilidades do propriet\u00E1rio e as regras de opera\u00E7\u00E3o. Embora em alguns estados n\u00E3o seja obrigat\u00F3rio, \u00E9 altamente recomend\u00E1vel porque:\",\n      reason1: \"Refor\u00E7a a separa\u00E7\u00E3o entre as suas finan\u00E7as pessoais e as da empresa\",\n      reason2: \"\u00C9 exigido por bancos e processadores de pagamento como o Stripe\",\n      reason3: \"Proporciona prote\u00E7\u00E3o legal adicional para si como propriet\u00E1rio\",\n      reason4: \"Documenta oficialmente a estrutura do seu neg\u00F3cio\",\n      generateButton: \"Gerar o meu Operating Agreement\",\n      autoGenerated: \"O documento ser\u00E1 gerado automaticamente com os dados da sua LLC e guardado no seu Centro de Documenta\u00E7\u00E3o para que possa descarreg\u00E1-lo quando precisar.\",\n      viewDocument: \"Ver o meu documento\",\n      tip: \"Dica:\",\n      tipText: \"Guarde uma c\u00F3pia assinada deste documento junto com os outros ficheiros importantes da sua empresa.\"\n    },\n    documentApproved: {\n      title: \"Documento Aprovado\",\n      approved: \"Aprovado\",\n      reviewedAndApproved: \"O seu documento foi revisto e aprovado com sucesso.\",\n      viewDocuments: \"Ver os meus documentos\"\n    },\n    documentRejected: {\n      title: \"Documento Rejeitado - A\u00E7\u00E3o Necess\u00E1ria\",\n      rejected: \"Rejeitado\",\n      reviewedAndRejected: \"O seu documento foi revisto e rejeitado.\",\n      reason: \"Motivo\",\n      pleaseReupload: \"Por favor, aceda ao seu painel de cliente e carregue novamente o documento corrigido.\",\n      viewDocuments: \"Ver os meus documentos\"\n    },\n    profileChangesVerified: {\n      title: \"Altera\u00E7\u00F5es de Perfil Verificadas com OTP\",\n      client: \"Cliente\",\n      email: \"Email\",\n      clientId: \"ID de Cliente\",\n      fieldsModified: \"Campos modificados\",\n      verifiedWithOtp: \"Altera\u00E7\u00E3o verificada com OTP\"\n    },\n    abandonedApplication: {\n      incomplete: \"O seu pedido est\u00E1 incompleto\",\n      noticeText: \"Repar\u00E1mos que come\u00E7ou a preencher o seu pedido de\",\n      importantNote: \"Nota importante:\",\n      draftDeletion: \"O seu rascunho ser\u00E1 automaticamente eliminado se n\u00E3o o completar. Por raz\u00F5es de seguran\u00E7a e prote\u00E7\u00E3o de dados, n\u00E3o podemos manter pedidos incompletos indefinidamente.\",\n      understandDoubts: \"Compreendemos que dar o passo de criar uma LLC pode gerar algumas d\u00FAvidas. Queremos que saiba que estamos aqui para ajud\u00E1-lo em cada passo do processo.\",\n      questionsHelp: \"Se tiver alguma d\u00FAvida ou precisar de assist\u00EAncia para completar o seu pedido, responda simplesmente a este e-mail e teremos todo o prazer em ajudar.\",\n      whyChoose: \"Porqu\u00EA escolher a Easy US LLC?\",\n      reason1: \"Constitui\u00E7\u00E3o completa em 48-72 horas\",\n      reason2: \"Assist\u00EAncia em espanhol durante todo o processo\",\n      reason3: \"Obten\u00E7\u00E3o do EIN inclu\u00EDda\",\n      reason4: \"Ajuda com a abertura de conta banc\u00E1ria\",\n      reason5: \"Suporte cont\u00EDnuo ap\u00F3s a constitui\u00E7\u00E3o\",\n      noMoreReminders: \"Se decidir n\u00E3o continuar, n\u00E3o lhe enviaremos mais lembretes sobre este pedido. A sua privacidade \u00E9 importante para n\u00F3s.\",\n      savedDraft: \"N\u00E3o se preocupe, guard\u00E1mos todo o seu progresso para que possa continuar exatamente de onde parou.\",\n      continueButton: \"Continuar o meu pedido\",\n      tip: \"Dica:\",\n      tipText: \"Complete o seu pedido para que possamos come\u00E7ar a trabalhar na sua LLC o mais rapidamente poss\u00EDvel.\",\n      expiring: \"O seu rascunho expirar\u00E1 em 48 horas se n\u00E3o o completar.\",\n      llcFormation: \"a constitui\u00E7\u00E3o da sua LLC\",\n      maintenancePack: \"pacote de manuten\u00E7\u00E3o\",\n      dontLoseProgress: \"N\u00E3o perca o seu progresso. Retome o seu pedido agora e complete o processo em poucos minutos.\",\n      lastHours: \"\u00FAltimas horas\",\n      autoDeleteWarning: \"O seu pedido ser\u00E1 automaticamente eliminado se n\u00E3o o completar.\"\n    },\n    calculatorResults: {\n      results: \"Resultados do seu c\u00E1lculo\",\n      introText: \"Aqui est\u00E1 o resumo da sua compara\u00E7\u00E3o fiscal solicitada. Analis\u00E1mos os n\u00FAmeros e queremos que tenha toda a informa\u00E7\u00E3o para tomar a melhor decis\u00E3o para o seu neg\u00F3cio.\",\n      summary: \"Resumo da sua an\u00E1lise\",\n      income: \"Rendimento anual:\",\n      expenses: \"Despesas dedut\u00EDveis:\",\n      autonomoTax: \"Impostos como trabalhador independente:\",\n      llcTax: \"Impostos com LLC:\",\n      potentialSavings: \"A sua poupan\u00E7a potencial:\",\n      savings: \"Poupan\u00E7a estimada:\",\n      withLLC: \"Com uma LLC nos Estados Unidos, poderia otimizar significativamente a sua carga fiscal enquanto opera de forma completamente legal. Esta poupan\u00E7a mant\u00E9m-se ano ap\u00F3s ano, o que pode representar uma diferen\u00E7a importante para o seu neg\u00F3cio a longo prazo.\",\n      learnMore: \"Gostaria de saber mais sobre como funciona? Teremos todo o prazer em responder a todas as suas d\u00FAvidas sem qualquer compromisso.\",\n      viewServices: \"Ver os nossos servi\u00E7os\",\n      disclaimer: \"Este c\u00E1lculo \u00E9 indicativo e baseia-se nos dados que forneceu. Para uma an\u00E1lise personalizada da sua situa\u00E7\u00E3o, n\u00E3o hesite em contactar-nos.\"\n    },\n    newsletter: {\n      confirmed: \"A sua subscri\u00E7\u00E3o foi confirmada com sucesso.\",\n      willReceive: \"Receber\u00E1 informa\u00E7\u00F5es relevantes sobre servi\u00E7os, atualiza\u00E7\u00F5es e novidades relacionadas com a Easy US LLC.\",\n      unsubscribe: \"Pode cancelar a subscri\u00E7\u00E3o a qualquer momento atrav\u00E9s do link inclu\u00EDdo nos nossos e-mails.\"\n    },\n    orderEvent: {\n      update: \"A sua encomenda tem uma atualiza\u00E7\u00E3o:\",\n      date: \"Data:\",\n      viewDetails: \"Ver detalhes\"\n    }\n  }\n};\n\nexport function getEmailTranslations(lang: EmailLanguage = 'es'): EmailTranslations {\n  return translations[lang] || translations.es;\n}\n\nexport function getCommonDoubtsText(lang: EmailLanguage = 'es'): string {\n  const t = getEmailTranslations(lang);\n  return t.common.doubts;\n}\n\nexport function getDefaultClientName(lang: EmailLanguage = 'es'): string {\n  const t = getEmailTranslations(lang);\n  return t.common.client;\n}\n\nexport function getWelcomeNotificationTitle(lang: EmailLanguage = 'es'): string {\n  const titles: Record<EmailLanguage, string> = {\n    es: \"\u00A1Bienvenido a Easy US LLC!\",\n    en: \"Welcome to Easy US LLC!\",\n    ca: \"Benvingut a Easy US LLC!\",\n    fr: \"Bienvenue chez Easy US LLC !\",\n    de: \"Willkommen bei Easy US LLC!\",\n    it: \"Benvenuto in Easy US LLC!\",\n    pt: \"Bem-vindo \u00E0 Easy US LLC!\"\n  };\n  return titles[lang] || titles.es;\n}\n\nexport function getWelcomeNotificationMessage(lang: EmailLanguage = 'es'): string {\n  const messages: Record<EmailLanguage, string> = {\n    es: \"Gracias por confiar en nosotros para crear tu empresa en EE.UU. Explora tu panel para comenzar.\",\n    en: \"Thank you for trusting us to create your US business. Explore your dashboard to get started.\",\n    ca: \"Gr\u00E0cies per confiar en nosaltres per crear la teva empresa als EUA. Explora el teu panell per comen\u00E7ar.\",\n    fr: \"Merci de nous faire confiance pour cr\u00E9er votre entreprise aux \u00C9tats-Unis. Explorez votre tableau de bord pour commencer.\",\n    de: \"Vielen Dank, dass Sie uns mit der Gr\u00FCndung Ihres US-Unternehmens vertrauen. Erkunden Sie Ihr Dashboard, um loszulegen.\",\n    it: \"Grazie per aver scelto noi per creare la tua azienda negli USA. Esplora la tua dashboard per iniziare.\",\n    pt: \"Obrigado por confiar em n\u00F3s para criar a sua empresa nos EUA. Explore o seu painel para come\u00E7ar.\"\n  };\n  return messages[lang] || messages.es;\n}\n\nexport function getWelcomeEmailSubject(lang: EmailLanguage = 'es'): string {\n  const subjects: Record<EmailLanguage, string> = {\n    es: \"\u00A1Bienvenido a Easy US LLC!\",\n    en: \"Welcome to Easy US LLC!\",\n    ca: \"Benvingut a Easy US LLC!\",\n    fr: \"Bienvenue chez Easy US LLC !\",\n    de: \"Willkommen bei Easy US LLC!\",\n    it: \"Benvenuto in Easy US LLC!\",\n    pt: \"Bem-vindo \u00E0 Easy US LLC!\"\n  };\n  return subjects[lang] || subjects.es;\n}\n\nexport function getRegistrationOtpSubject(lang: EmailLanguage = 'es'): string {\n  const subjects: Record<EmailLanguage, string> = {\n    es: \"Bienvenido a Easy US LLC - Verifica tu cuenta\",\n    en: \"Welcome to Easy US LLC - Verify your account\",\n    ca: \"Benvingut a Easy US LLC - Verifica el teu compte\",\n    fr: \"Bienvenue chez Easy US LLC - V\u00E9rifiez votre compte\",\n    de: \"Willkommen bei Easy US LLC - Verifizieren Sie Ihr Konto\",\n    it: \"Benvenuto in Easy US LLC - Verifica il tuo account\",\n    pt: \"Bem-vindo \u00E0 Easy US LLC - Verifique a sua conta\"\n  };\n  return subjects[lang] || subjects.es;\n}\n\nexport function getOtpSubject(lang: EmailLanguage = 'es'): string {\n  const subjects: Record<EmailLanguage, string> = {\n    es: \"Tu c\u00F3digo de verificaci\u00F3n | Easy US LLC\",\n    en: \"Your verification code | Easy US LLC\",\n    ca: \"El teu codi de verificaci\u00F3 | Easy US LLC\",\n    fr: \"Votre code de v\u00E9rification | Easy US LLC\",\n    de: \"Ihr Verifizierungscode | Easy US LLC\",\n    it: \"Il tuo codice di verifica | Easy US LLC\",\n    pt: \"O seu c\u00F3digo de verifica\u00E7\u00E3o | Easy US LLC\"\n  };\n  return subjects[lang] || subjects.es;\n}\n\nexport function getSecurityOtpSubject(lang: EmailLanguage = 'es'): string {\n  const subjects: Record<EmailLanguage, string> = {\n    es: \"Verificaci\u00F3n de seguridad - Easy US LLC\",\n    en: \"Security verification - Easy US LLC\",\n    ca: \"Verificaci\u00F3 de seguretat - Easy US LLC\",\n    fr: \"V\u00E9rification de s\u00E9curit\u00E9 - Easy US LLC\",\n    de: \"Sicherheitsverifizierung - Easy US LLC\",\n    it: \"Verifica di sicurezza - Easy US LLC\",\n    pt: \"Verifica\u00E7\u00E3o de seguran\u00E7a - Easy US LLC\"\n  };\n  return subjects[lang] || subjects.es;\n}\n\nexport function getPasswordResetSubject(lang: EmailLanguage = 'es'): string {\n  const subjects: Record<EmailLanguage, string> = {\n    es: \"C\u00F3digo de verificaci\u00F3n - Easy US LLC\",\n    en: \"Verification code - Easy US LLC\",\n    ca: \"Codi de verificaci\u00F3 - Easy US LLC\",\n    fr: \"Code de v\u00E9rification - Easy US LLC\",\n    de: \"Verifizierungscode - Easy US LLC\",\n    it: \"Codice di verifica - Easy US LLC\",\n    pt: \"C\u00F3digo de verifica\u00E7\u00E3o - Easy US LLC\"\n  };\n  return subjects[lang] || subjects.es;\n}\n\nexport function getVerifyEmailSubject(lang: EmailLanguage = 'es'): string {\n  const subjects: Record<EmailLanguage, string> = {\n    es: \"Verifica tu email - Easy US LLC\",\n    en: \"Verify your email - Easy US LLC\",\n    ca: \"Verifica el teu email - Easy US LLC\",\n    fr: \"V\u00E9rifiez votre email - Easy US LLC\",\n    de: \"Verifizieren Sie Ihre E-Mail - Easy US LLC\",\n    it: \"Verifica la tua email - Easy US LLC\",\n    pt: \"Verifique o seu email - Easy US LLC\"\n  };\n  return subjects[lang] || subjects.es;\n}\n\nexport function getAdminNewRegistrationSubject(lang: EmailLanguage = 'es'): string {\n  return `[NUEVA CUENTA]`;\n}\n", "import nodemailer from \"nodemailer\";\nimport { EmailLanguage, getEmailTranslations, getCommonDoubtsText, getDefaultClientName } from \"./email-translations\";\n\nconst domain = \"easyusllc.com\";\nconst companyAddress = `Easy US LLC\n1209 Mountain Road Place Northeast\nSTE R\nAlbuquerque, NM 87110`;\n\nconst EMAIL_LOGO = \"cid:logo-icon\";\n\nfunction getSimpleHeader() {\n  return `\n    <div style=\"background: linear-gradient(180deg, #0A0A0A 0%, #0A0A0A 100%); padding: 35px 20px; text-align: center;\">\n      <a href=\"https://${domain}\" target=\"_blank\" style=\"text-decoration: none; display: inline-block;\">\n        <img src=\"${EMAIL_LOGO}\" alt=\"Easy US LLC\" width=\"70\" height=\"70\" style=\"display: block; margin: 0 auto; border-radius: 50%; border: 0;\" />\n      </a>\n    </div>\n  `;\n}\n\nfunction getSimpleFooter() {\n  return `\n    <div style=\"background-color: #0A0A0A; padding: 35px 25px; text-align: center; color: #F7F7F5;\">\n      <div style=\"width: 40px; height: 3px; background: #6EDC8A; margin: 0 auto 20px; border-radius: 2px;\"></div>\n      <p style=\"margin: 0 0 15px 0; font-size: 12px; color: #9CA3AF; line-height: 1.7;\">1209 Mountain Road Place Northeast, STE R<br>Albuquerque, NM 87110</p>\n      <p style=\"margin: 0; font-size: 11px; color: #6B7280;\">\u00A9 ${new Date().getFullYear()} Easy US LLC</p>\n    </div>\n  `;\n}\n\nfunction getEmailWrapper(content: string, lang: EmailLanguage = 'es') {\n  const doubtsText = getCommonDoubtsText(lang);\n  return `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset=\"utf-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap\" rel=\"stylesheet\">\n    </head>\n    <body style=\"margin: 0; padding: 0; background-color: #F7F7F5;\">\n      <div style=\"background-color: #F7F7F5; padding: 40px 15px;\">\n        <div style=\"font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; max-width: 560px; margin: auto; border-radius: 24px; overflow: hidden; color: #0A0A0A; background-color: #ffffff; box-shadow: 0 4px 24px rgba(0,0,0,0.06);\">\n          ${getSimpleHeader()}\n          <div style=\"padding: 40px 35px;\">\n            ${content}\n            <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280; margin-top: 35px; padding-top: 25px; border-top: 1px solid #E6E9EC;\">${doubtsText}</p>\n          </div>\n          ${getSimpleFooter()}\n        </div>\n      </div>\n    </body>\n    </html>\n  `;\n}\n\n// 1. OTP - C\u00F3digo de verificaci\u00F3n\nexport function getOtpEmailTemplate(otp: string, name?: string, lang: EmailLanguage = 'es', ip?: string) {\n  const t = getEmailTranslations(lang);\n  const clientName = name || t.common.client;\n  const ipSection = ip ? `\n    <p style=\"line-height: 1.7; font-size: 14px; color: #6B7280; margin-bottom: 20px;\">${t.otp.ipDetected} <strong style=\"color: #0A0A0A;\">${ip}</strong></p>\n  ` : '';\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 20px 0;\">${t.common.greeting} ${clientName},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 10px;\">${t.otp.thanks}</p>\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 30px;\">${t.otp.forSecurity}</p>\n    ${ipSection}\n    <div style=\"background: linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%); padding: 30px; border-radius: 16px; margin: 25px 0; text-align: center; border: 2px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 10px 0; font-size: 14px; color: #059669; font-weight: 700; text-transform: uppercase; letter-spacing: 1px;\">${t.otp.yourCode}</p>\n      <p style=\"margin: 0; font-size: 42px; font-weight: 900; color: #0A0A0A; letter-spacing: 12px; font-family: 'SF Mono', 'Consolas', monospace;\">${otp}</p>\n    </div>\n\n    <p style=\"line-height: 1.7; font-size: 13px; color: #6B7280; margin: 20px 0 6px 0;\">${t.otp.important}</p>\n    <p style=\"line-height: 1.7; font-size: 13px; color: #6B7280; margin: 0 0 4px 0;\">\u2014 ${t.otp.personalAndConfidential}</p>\n    <p style=\"line-height: 1.7; font-size: 13px; color: #6B7280; margin: 0 0 4px 0;\">\u2014 ${t.otp.validFor}</p>\n    <p style=\"line-height: 1.7; font-size: 13px; color: #6B7280; margin: 0 0 4px 0;\">\u2014 ${t.otp.doNotShare}</p>\n\n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280; margin-top: 25px;\">${t.otp.ignoreMessage}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 2. Bienvenida - Cuenta creada\nexport function getWelcomeEmailTemplate(name?: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const clientName = name || t.common.client;\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${clientName},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.welcome.welcomeMessage}</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.welcome.accountCreated}</p>\n    \n    <ul style=\"margin: 0 0 25px 0; padding-left: 20px; color: #444; font-size: 14px; line-height: 1.8;\">\n      <li>${t.welcome.realTimeTracking}</li>\n      <li>${t.welcome.documentCenter}</li>\n      <li>${t.welcome.professionalTools}</li>\n      <li>${t.welcome.fiscalCalendar}</li>\n      <li>${t.welcome.directSupport}</li>\n    </ul>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.welcome.hereToHelp}</p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.welcome.exploreButton}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 2b. Cuenta creada - Pendiente verificaci\u00F3n email\nexport function getAccountPendingVerificationTemplate(name?: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const clientName = name || t.common.client;\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${clientName},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.accountPendingVerification.accountCreatedBut}</p>\n    \n    <div style=\"background: #FEF3C7; padding: 20px 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #F59E0B;\">\n      <p style=\"margin: 0 0 12px 0; font-size: 13px; font-weight: 800; color: #92400E; text-transform: uppercase;\">${t.accountPendingVerification.actionRequired}</p>\n      <p style=\"margin: 0; font-size: 14px; color: #92400E; line-height: 1.7;\">${t.accountPendingVerification.accessAndVerify}</p>\n    </div>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.accountPendingVerification.verifyButton}</a>\n    </div>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280;\">${t.accountPendingVerification.whileUnverified}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 3. Cuenta en revisi\u00F3n\nexport function getAccountUnderReviewTemplate(name?: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const clientName = name || t.common.client;\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${clientName},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.accountUnderReview.underReview}</p>\n    \n    <div style=\"background: #F9FAFB; padding: 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 10px 0; font-size: 14px; font-weight: 700; color: #0A0A0A;\">${t.accountUnderReview.whyReview}</p>\n      <p style=\"margin: 0; font-size: 14px; color: #444; line-height: 1.7;\">${t.accountUnderReview.whyReviewText}</p>\n    </div>\n    \n    <div style=\"background: #FEF3C7; padding: 20px 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #F59E0B;\">\n      <p style=\"margin: 0; font-size: 14px; color: #92400E; line-height: 1.7;\">${t.accountUnderReview.duringProcess}</p>\n    </div>\n    \n    <div style=\"background: #F0FDF4; padding: 25px; border-radius: 16px; margin: 25px 0; border: 1px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 15px 0; font-size: 14px; font-weight: 700; color: #0A0A0A;\">${t.accountUnderReview.whatHappens}</p>\n      <ul style=\"margin: 0; padding-left: 20px; font-size: 14px; color: #444; line-height: 1.9;\">\n        <li style=\"margin-bottom: 8px;\">${t.accountUnderReview.step1}</li>\n        <li style=\"margin-bottom: 8px;\">${t.accountUnderReview.step2}</li>\n        <li>${t.accountUnderReview.step3}</li>\n      </ul>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.accountUnderReview.teamReviewing}</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.accountUnderReview.patience}</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #0A0A0A; font-weight: 600; margin-bottom: 0;\">${t.accountUnderReview.closing}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 3b. Cuenta actualizada a VIP\nexport function getAccountVipTemplate(name?: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const clientName = name || t.common.client;\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${clientName},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.accountVip.updatedToVip}</p>\n    \n    <div style=\"background: linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%); padding: 25px; border-radius: 16px; margin: 25px 0; border: 2px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 15px 0; font-size: 15px; color: #0A0A0A; font-weight: 600;\">${t.accountVip.benefits}</p>\n      <ul style=\"margin: 0; padding-left: 20px; font-size: 14px; color: #444; line-height: 1.8;\">\n        <li>${t.accountVip.priorityAttention}</li>\n        <li>${t.accountVip.preferentialTracking}</li>\n        <li>${t.accountVip.fullAccess}</li>\n      </ul>\n    </div>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.accountVip.viewDashboard}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 3c. Cuenta reactivada\nexport function getAccountReactivatedTemplate(name?: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const clientName = name || t.common.client;\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${clientName},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.accountReactivated.reactivated}</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.accountReactivated.canAccess}</p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.accountReactivated.viewDashboard}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 4. Confirmaci\u00F3n de Solicitud (LLC / Mantenimiento)\nexport function getConfirmationEmailTemplate(name: string, requestCode: string, details?: { companyName?: string; state?: string; serviceType?: string }, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.confirmation.greatNews}</p>\n    \n    <div style=\"background: linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%); padding: 25px; border-radius: 16px; margin: 25px 0; border: 2px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 15px 0; font-size: 14px; font-weight: 700; color: #059669; text-transform: uppercase; letter-spacing: 1px;\">${t.confirmation.details}</p>\n      <table style=\"width: 100%; font-size: 14px; border-collapse: collapse;\">\n        <tr>\n          <td style=\"padding: 8px 0; color: #6B7280;\">${t.confirmation.reference}</td>\n          <td style=\"padding: 8px 0; font-weight: 700; text-align: right; color: #0A0A0A;\">${requestCode}</td>\n        </tr>\n        ${details?.serviceType ? `\n        <tr>\n          <td style=\"padding: 8px 0; color: #6B7280;\">${t.confirmation.service}</td>\n          <td style=\"padding: 8px 0; font-weight: 700; text-align: right; color: #0A0A0A;\">${details.serviceType}</td>\n        </tr>` : ''}\n        ${details?.companyName ? `\n        <tr>\n          <td style=\"padding: 8px 0; color: #6B7280;\">${t.confirmation.company}</td>\n          <td style=\"padding: 8px 0; font-weight: 700; text-align: right; color: #0A0A0A;\">${details.companyName}</td>\n        </tr>` : ''}\n        ${details?.state ? `\n        <tr>\n          <td style=\"padding: 8px 0; color: #6B7280;\">${t.confirmation.state}</td>\n          <td style=\"padding: 8px 0; font-weight: 700; text-align: right; color: #0A0A0A;\">${details.state}</td>\n        </tr>` : ''}\n        <tr>\n          <td style=\"padding: 8px 0; color: #6B7280;\">${t.confirmation.currentStatus}</td>\n          <td style=\"padding: 8px 0; font-weight: 700; text-align: right; color: #059669;\">${t.confirmation.inReview}</td>\n        </tr>\n      </table>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 15px;\"><strong>${t.confirmation.whatNow}</strong></p>\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.confirmation.validatingInfo}</p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.confirmation.trackButton}</a>\n    </div>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280;\">${t.confirmation.questionRef}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 5. Auto-respuesta de contacto\nexport function getAutoReplyTemplate(name: string, ticketId: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.autoReply.receivedMessage}</p>\n    \n    <div style=\"background: linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%); padding: 20px 25px; border-radius: 16px; margin: 25px 0; border: 2px solid #6EDC8A; text-align: center;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 13px; color: #6B7280; text-transform: uppercase;\">${t.autoReply.ticketNumber}</p>\n      <p style=\"margin: 0; font-size: 24px; font-weight: 900; color: #0A0A0A; letter-spacing: 2px;\">#${ticketId}</p>\n    </div>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280; margin-bottom: 15px;\">${t.autoReply.estimatedResponse}</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.autoReply.responding}</p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.autoReply.seeMessages}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 8a. Actualizaci\u00F3n de estado de pedido\nexport function getOrderUpdateTemplate(name: string, orderId: string, status: string, description?: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const statusLabels: Record<string, string> = {\n    pending: t.orderUpdate.statusPending,\n    processing: t.orderUpdate.statusProcessing,\n    paid: t.orderUpdate.statusPaid,\n    filed: t.orderUpdate.statusFiled,\n    documents_ready: t.orderUpdate.statusDocumentsReady,\n    completed: t.orderUpdate.statusCompleted,\n    cancelled: t.orderUpdate.statusCancelled,\n  };\n  const translatedStatus = statusLabels[status] || status;\n\n  const statusColors: Record<string, string> = {\n    pending: \"#F59E0B\",\n    processing: \"#3B82F6\",\n    paid: \"#10B981\",\n    filed: \"#8B5CF6\",\n    documents_ready: \"#059669\",\n    completed: \"#059669\",\n    cancelled: \"#EF4444\",\n  };\n  const statusColor = statusColors[status] || \"#6EDC8A\";\n\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.orderUpdate.statusChanged}</p>\n    \n    <div style=\"background: #F9FAFB; padding: 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid ${statusColor};\">\n      <p style=\"margin: 0 0 10px 0; font-size: 13px; color: #6B7280; text-transform: uppercase;\">${t.orderUpdate.orderLabel} <strong>#${orderId}</strong></p>\n      <p style=\"margin: 0; font-size: 16px; font-weight: 700; color: ${statusColor};\">${t.orderUpdate.newStatus} ${translatedStatus}</p>\n    </div>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280; margin-bottom: 25px;\">${t.orderUpdate.clarification}</p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.orderUpdate.trackButton}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 8b. Pedido completado (documentos listos)\nexport function getOrderCompletedTemplate(name: string, orderCode: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <div style=\"background: linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%); padding: 25px; border-radius: 16px; margin: 0 0 25px 0; text-align: center; border: 2px solid #6EDC8A;\">\n      <p style=\"margin: 0; font-size: 20px; font-weight: 800; color: #059669;\">${t.orderCompleted.llcReady}</p>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.orderCompleted.congratulations}</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 15px;\"><strong>${t.orderCompleted.docsReady}</strong></p>\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.orderCompleted.accessDocuments}</p>\n    \n    <div style=\"background: #F9FAFB; padding: 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 15px 0; font-size: 14px; font-weight: 700; color: #0A0A0A; text-transform: uppercase;\">${t.orderCompleted.whatYouFind}</p>\n      <ul style=\"margin: 0; padding-left: 18px; color: #444; font-size: 14px; line-height: 1.8;\">\n        <li>${t.orderCompleted.articlesOrg}</li>\n        <li>${t.orderCompleted.einLetter}</li>\n        <li>${t.orderCompleted.registeredAgent}</li>\n        <li>${t.orderCompleted.additionalGuides}</li>\n      </ul>\n    </div>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.orderCompleted.viewDocuments}</a>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.orderCompleted.hereForYou}</p>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280;\">${t.orderCompleted.feedbackRequest}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 8c1. Nota de equipo recibida\nexport function getNoteReceivedTemplate(name: string, note: string, orderId: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.noteReceived.teamNote} ${t.noteReceived.relatedToOrder} <strong>#${orderId}</strong>:</p>\n    \n    <div style=\"background: #F9FAFB; padding: 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #6EDC8A;\">\n      <p style=\"margin: 0; font-size: 15px; color: #0A0A0A; line-height: 1.7;\">${note}</p>\n    </div>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280; margin-bottom: 25px;\">${t.noteReceived.respondNote}</p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.noteReceived.viewClientArea}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 8c2. Nota administrativa\nexport function getAdminNoteTemplate(name: string, message: string, ticketId: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.adminNote.messageAbout}</p>\n    \n    <div style=\"background: #F9FAFB; padding: 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 10px 0; font-size: 13px; font-weight: 700; color: #6B7280; text-transform: uppercase;\">${t.adminNote.viewTicket} #${ticketId}</p>\n      <p style=\"margin: 0; font-size: 15px; color: #0A0A0A; line-height: 1.7;\">${message}</p>\n    </div>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.adminNote.viewClientArea}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 8c3. Solicitud de pago\nexport function getPaymentRequestTemplate(name: string, amount: string, paymentLink: string, message: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.paymentRequest.paymentRequired} ${t.paymentRequest.amount} <strong>$${amount}</strong>.</p>\n    \n    <div style=\"background: #F9FAFB; padding: 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 13px; font-weight: 700; color: #6B7280; text-transform: uppercase;\">${t.paymentRequest.messageLabel}</p>\n      <p style=\"margin: 0; font-size: 15px; color: #0A0A0A; line-height: 1.7;\">${message}</p>\n    </div>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"${paymentLink}\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.paymentRequest.payNow}</a>\n    </div>\n    \n    <p style=\"line-height: 1.5; font-size: 12px; color: #9CA3AF; word-break: break-all;\">${t.paymentRequest.buttonFallback} ${paymentLink}</p>\n    \n    <p style=\"line-height: 1.6; font-size: 13px; color: #6B7280; margin-top: 20px;\">${t.paymentRequest.securePayment}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 8d. Solicitud de Documentaci\u00F3n\nexport function getDocumentRequestTemplate(name: string, documentType: string, message: string, ticketId: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.documentRequest.needDocument}</p>\n    \n    <div style=\"background: linear-gradient(135deg, #FEF3C7 0%, #FEF9C3 100%); padding: 20px 25px; border-radius: 16px; margin: 25px 0; border: 2px solid #F59E0B; text-align: center;\">\n      <p style=\"margin: 0; font-size: 16px; font-weight: 700; color: #92400E;\">${documentType}</p>\n    </div>\n    \n    <div style=\"background: #F9FAFB; padding: 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 13px; font-weight: 700; color: #6B7280; text-transform: uppercase;\">${t.documentRequest.messageLabel}</p>\n      <p style=\"margin: 0; font-size: 15px; color: #0A0A0A; line-height: 1.7;\">${message}</p>\n    </div>\n    \n    <p style=\"line-height: 1.6; font-size: 13px; color: #6B7280; margin-bottom: 25px;\">${t.documentRequest.referenceTicket} <strong>#${ticketId}</strong></p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.documentRequest.uploadButton}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 8e. Documento Subido por Admin\nexport function getDocumentUploadedTemplate(name: string, documentType: string, orderCode: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.documentUploaded.documentReceived}</p>\n    \n    <div style=\"background: linear-gradient(135deg, #D1FAE5 0%, #ECFDF5 100%); padding: 20px 25px; border-radius: 16px; margin: 25px 0; border: 2px solid #10B981; text-align: center;\">\n      <p style=\"margin: 0; font-size: 16px; font-weight: 700; color: #065F46;\">${documentType}</p>\n      <p style=\"margin: 10px 0 0 0; font-size: 13px; color: #047857;\">${t.documentUploaded.forOrder} ${orderCode}</p>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.documentUploaded.accessDownload}</p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.documentUploaded.viewDocuments}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 8f. Respuesta a consulta (admin a cliente)\nexport function getMessageReplyTemplate(name: string, content: string, ticketId: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const emailContent = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.messageReply.repliedToQuery} (${t.messageReply.ticket} <strong>#${ticketId}</strong>):</p>\n    \n    <div style=\"background: #F9FAFB; padding: 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #6EDC8A;\">\n      <p style=\"margin: 0; font-size: 15px; color: #0A0A0A; line-height: 1.7; white-space: pre-wrap;\">${content}</p>\n    </div>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.messageReply.viewClientArea}</a>\n    </div>\n  `;\n  return getEmailWrapper(emailContent, lang);\n}\n\n// 8f. C\u00F3digo para cambio de contrase\u00F1a\nexport function getPasswordChangeOtpTemplate(name: string, otp: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.passwordChangeOtp.passwordChangeRequest}</p>\n    \n    <div style=\"background: linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%); padding: 30px; border-radius: 16px; margin: 25px 0; text-align: center; border: 2px solid #6EDC8A;\">\n      <p style=\"margin: 0; font-size: 42px; font-weight: 900; color: #0A0A0A; letter-spacing: 12px; font-family: 'SF Mono', 'Consolas', monospace;\">${otp}</p>\n    </div>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280;\">${t.passwordChangeOtp.validFor}</p>\n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280;\">${t.passwordChangeOtp.notRequested}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 8f-b. C\u00F3digo para cambio de datos sensibles del perfil\nexport function getProfileChangeOtpTemplate(name: string, otp: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 20px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 30px;\">${t.profileChangeOtp.sensitiveChangeRequest}</p>\n    \n    <div style=\"background: linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%); padding: 30px; border-radius: 16px; margin: 25px 0; text-align: center; border: 2px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 10px 0; font-size: 14px; color: #059669; font-weight: 700; text-transform: uppercase; letter-spacing: 1px;\">${t.profileChangeOtp.yourCode}</p>\n      <p style=\"margin: 0; font-size: 42px; font-weight: 900; color: #0A0A0A; letter-spacing: 12px; font-family: 'SF Mono', 'Consolas', monospace;\">${otp}</p>\n    </div>\n\n    <div style=\"background: #F9FAFB; padding: 20px 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 12px 0; font-size: 13px; font-weight: 800; color: #0A0A0A; text-transform: uppercase;\">${t.profileChangeOtp.important}</p>\n      <ul style=\"margin: 0; padding-left: 18px; color: #444; font-size: 14px; line-height: 1.8;\">\n        <li style=\"margin-bottom: 6px;\">${t.profileChangeOtp.personalAndConfidential}</li>\n        <li style=\"margin-bottom: 6px;\">${t.profileChangeOtp.validFor}</li>\n        <li>${t.profileChangeOtp.doNotShare}</li>\n      </ul>\n    </div>\n\n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280; margin-top: 25px;\">${t.profileChangeOtp.ignoreMessage}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 8g. Evento de timeline de pedido\nexport function getOrderEventTemplate(name: string, orderId: string, eventType: string, description: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const locale = lang === 'en' ? 'en-US' : lang === 'ca' ? 'ca-ES' : 'es-ES';\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.orderEvent.update} <strong>#${orderId}</strong></p>\n    \n    <div style=\"background: #F9FAFB; padding: 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 10px 0; font-size: 16px; font-weight: 700; color: #0A0A0A;\">${eventType}</p>\n      <p style=\"margin: 0; font-size: 14px; color: #6B7280; line-height: 1.6;\">${description}</p>\n    </div>\n    \n    <p style=\"line-height: 1.5; font-size: 13px; color: #9CA3AF;\">${t.orderEvent.date} ${new Date().toLocaleString(locale)}</p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.orderEvent.viewDetails}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 9. Cuenta Desactivada\nexport function getAccountDeactivatedTemplate(name?: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const clientName = name || t.common.client;\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${clientName},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.accountDeactivated.deactivated}</p>\n    \n    <div style=\"background: #FEE2E2; padding: 20px 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #EF4444;\">\n      <p style=\"margin: 0; font-size: 14px; color: #B91C1C; line-height: 1.7;\">${t.accountDeactivated.cannotAccess}</p>\n    </div>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280;\">${t.accountDeactivated.contactSupport}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 10. Newsletter Bienvenida\nexport function getNewsletterWelcomeTemplate(lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.newsletter.confirmed}</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.newsletter.willReceive}</p>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280;\">${t.newsletter.unsubscribe}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 11. Recordatorio de Renovaci\u00F3n (plantilla \u00FAnica para 60/30/7 d\u00EDas)\nexport function getRenewalReminderTemplate(\n  name: string, \n  companyName: string, \n  daysRemaining: string, \n  renewalDate: string,\n  state: string,\n  lang: EmailLanguage = 'es'\n) {\n  const t = getEmailTranslations(lang);\n  const isUrgent = daysRemaining === \"una semana\" || daysRemaining === \"one week\" || daysRemaining === \"una setmana\";\n  const urgencyColor = isUrgent ? \"#EF4444\" : \"#F59E0B\";\n  const urgencyBg = isUrgent ? \"#FEE2E2\" : \"#FEF3C7\";\n  \n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.renewalReminder.reminderText} <strong>${companyName}</strong> (${state}) vence pronto.</p>\n    \n    <div style=\"background: ${urgencyBg}; padding: 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid ${urgencyColor};\">\n      <p style=\"margin: 0 0 10px 0; font-size: 14px; font-weight: 700; color: ${urgencyColor}; text-transform: uppercase;\">${t.renewalReminder.expiresIn} ${daysRemaining}</p>\n      <p style=\"margin: 0; font-size: 16px; font-weight: 600; color: #0A0A0A;\">${t.renewalReminder.dueDate} ${renewalDate}</p>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.renewalReminder.withoutMaintenance}</p>\n    \n    <ul style=\"margin: 0 0 25px 0; padding-left: 20px; color: #444; font-size: 14px; line-height: 1.8;\">\n      <li>${t.renewalReminder.registeredAgentActive}</li>\n      <li>${t.renewalReminder.annualReports}</li>\n      <li>${t.renewalReminder.taxCompliance}</li>\n      <li>${t.renewalReminder.legalAddress}</li>\n    </ul>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/llc/maintenance\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.renewalReminder.renewNow}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 17. Registro con c\u00F3digo de verificaci\u00F3n\nexport function getRegistrationOtpTemplate(name: string, otp: string, clientId: string, expiryMinutes: number = 15, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.registrationOtp.almostDone}</p>\n    \n    <div style=\"background-color: #0A0A0A; padding: 25px; text-align: center; border-radius: 16px; margin: 25px 0;\">\n      <span style=\"color: #6EDC8A; font-size: 36px; font-weight: 900; letter-spacing: 8px; font-family: monospace;\">${otp}</span>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.registrationOtp.validFor} ${expiryMinutes} ${lang === 'en' ? 'minutes' : lang === 'ca' ? 'minuts' : 'minutos'}.</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.registrationOtp.clientIdLabel} <strong>${clientId}</strong></p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 18. Notificaci\u00F3n admin de nuevo registro\nexport function getAdminNewRegistrationTemplate(clientId: string, firstName: string, lastName: string, email: string, phone?: string) {\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\"><strong>Nueva cuenta creada en el sistema.</strong></p>\n    \n    <div style=\"background-color: #F7F7F5; padding: 20px; border-radius: 16px; border-left: 4px solid #6EDC8A; margin: 25px 0;\">\n      <p style=\"margin: 0 0 10px 0; font-size: 14px;\"><strong>Cliente ID:</strong> ${clientId}</p>\n      <p style=\"margin: 0 0 10px 0; font-size: 14px;\"><strong>Nombre:</strong> ${firstName} ${lastName}</p>\n      <p style=\"margin: 0 0 10px 0; font-size: 14px;\"><strong>Email:</strong> ${email}</p>\n      ${phone ? `<p style=\"margin: 0; font-size: 14px;\"><strong>Tel\u00E9fono:</strong> ${phone}</p>` : ''}\n    </div>\n  `;\n  return getEmailWrapper(content);\n}\n\n// 19. Cuenta bloqueada por seguridad\nexport function getAccountLockedTemplate(name: string, ticketId: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const baseUrl = process.env.BASE_URL || `https://${domain}`;\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.accountLocked.locked}</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.accountLocked.verifyIdentity}</p>\n    \n    <div style=\"background-color: #FFF3E0; padding: 20px; border-radius: 16px; border-left: 4px solid #FF9800; margin: 25px 0;\">\n      <ul style=\"margin: 0; padding-left: 20px; color: #444;\">\n        <li style=\"margin-bottom: 8px;\">${t.accountLocked.idRequirement}</li>\n        <li>${t.accountLocked.birthDateConfirm}</li>\n      </ul>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.accountLocked.referenceTicket} <strong>#${ticketId}</strong></p>\n    \n    <div style=\"text-align: center; margin: 35px 0;\">\n      <a href=\"${baseUrl}/forgot-password\" style=\"background-color: #6EDC8A; color: #0A0A0A; font-weight: 700; font-size: 15px; padding: 16px 40px; border-radius: 50px; text-decoration: none; display: inline-block; box-shadow: 0 4px 15px rgba(110, 220, 138, 0.3);\">${t.accountLocked.resetPassword}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 20. Notificaci\u00F3n admin de pedido LLC completado\nexport function getAdminLLCOrderTemplate(orderData: {\n  orderIdentifier: string;\n  amount: string;\n  paymentMethod: string;\n  ownerFullName?: string;\n  ownerEmail?: string;\n  ownerPhone?: string;\n  ownerBirthDate?: string;\n  ownerIdType?: string;\n  ownerIdNumber?: string;\n  ownerAddress?: string;\n  ownerCity?: string;\n  ownerProvince?: string;\n  ownerPostalCode?: string;\n  ownerCountry?: string;\n  companyName?: string;\n  companyNameOption2?: string;\n  designator?: string;\n  state?: string;\n  businessCategory?: string;\n  businessActivity?: string;\n  companyDescription?: string;\n  isSellingOnline?: string;\n  needsBankAccount?: string;\n  willUseStripe?: string;\n  wantsBoiReport?: string;\n  wantsMaintenancePack?: string;\n  notes?: string;\n}) {\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\"><strong>Nuevo pedido LLC completado.</strong></p>\n    \n    <h3 style=\"font-size: 14px; font-weight: 700; margin: 20px 0 10px; color: #333; border-bottom: 2px solid #6EDC8A; padding-bottom: 5px;\">Informaci\u00F3n del Propietario</h3>\n    <div style=\"background: #F7F7F5; border-left: 4px solid #6EDC8A; padding: 15px; margin: 10px 0; border-radius: 8px;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Nombre:</strong> ${orderData.ownerFullName || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Email:</strong> ${orderData.ownerEmail || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Tel\u00E9fono:</strong> ${orderData.ownerPhone || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Fecha nacimiento:</strong> ${orderData.ownerBirthDate || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Documento:</strong> ${orderData.ownerIdType || 'N/A'} - ${orderData.ownerIdNumber || 'N/A'}</p>\n      <p style=\"margin: 0; font-size: 13px;\"><strong>Direcci\u00F3n:</strong> ${orderData.ownerAddress || 'N/A'}, ${orderData.ownerCity || ''}, ${orderData.ownerProvince || ''} ${orderData.ownerPostalCode || ''}, ${orderData.ownerCountry || ''}</p>\n    </div>\n    \n    <h3 style=\"font-size: 14px; font-weight: 700; margin: 20px 0 10px; color: #333; border-bottom: 2px solid #6EDC8A; padding-bottom: 5px;\">Informaci\u00F3n de la Empresa</h3>\n    <div style=\"background: #F7F7F5; border-left: 4px solid #6EDC8A; padding: 15px; margin: 10px 0; border-radius: 8px;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Empresa:</strong> ${orderData.companyName || 'N/A'} ${orderData.designator || ''}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Alternativo:</strong> ${orderData.companyNameOption2 || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Estado:</strong> ${orderData.state || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Categor\u00EDa:</strong> ${orderData.businessCategory || 'N/A'}</p>\n      <p style=\"margin: 0; font-size: 13px;\"><strong>Actividad:</strong> ${orderData.businessActivity || 'N/A'}</p>\n    </div>\n    \n    <h3 style=\"font-size: 14px; font-weight: 700; margin: 20px 0 10px; color: #333; border-bottom: 2px solid #6EDC8A; padding-bottom: 5px;\">Servicios</h3>\n    <div style=\"background: #F7F7F5; border-left: 4px solid #6EDC8A; padding: 15px; margin: 10px 0; border-radius: 8px;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Vender\u00E1 online:</strong> ${orderData.isSellingOnline || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Cuenta bancaria:</strong> ${orderData.needsBankAccount || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Pasarela:</strong> ${orderData.willUseStripe || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>BOI Report:</strong> ${orderData.wantsBoiReport || 'N/A'}</p>\n      <p style=\"margin: 0; font-size: 13px;\"><strong>Mantenimiento:</strong> ${orderData.wantsMaintenancePack || 'N/A'}</p>\n    </div>\n    \n    <h3 style=\"font-size: 14px; font-weight: 700; margin: 20px 0 10px; color: #333; border-bottom: 2px solid #4CAF50; padding-bottom: 5px;\">Pago</h3>\n    <div style=\"background: #E8F5E9; border-left: 4px solid #4CAF50; padding: 15px; margin: 10px 0; border-radius: 8px;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Referencia:</strong> ${orderData.orderIdentifier}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Importe:</strong> ${orderData.amount}\u20AC</p>\n      <p style=\"margin: 0; font-size: 13px;\"><strong>M\u00E9todo:</strong> ${orderData.paymentMethod}</p>\n    </div>\n    \n    ${orderData.notes ? `\n    <h3 style=\"font-size: 14px; font-weight: 700; margin: 20px 0 10px; color: #333; border-bottom: 2px solid #FF9800; padding-bottom: 5px;\">Notas del Cliente</h3>\n    <div style=\"background: #FFF3E0; border-left: 4px solid #FF9800; padding: 15px; margin: 10px 0; border-radius: 8px;\">\n      <p style=\"margin: 0; font-size: 13px;\">${orderData.notes}</p>\n    </div>\n    ` : ''}\n  `;\n  return getEmailWrapper(content);\n}\n\n// 21. Notificaci\u00F3n admin de pedido mantenimiento completado\nexport function getAdminMaintenanceOrderTemplate(orderData: {\n  orderIdentifier: string;\n  amount: string;\n  paymentMethod: string;\n  ownerFullName?: string;\n  ownerEmail?: string;\n  ownerPhone?: string;\n  companyName?: string;\n  ein?: string;\n  state?: string;\n  creationSource?: string;\n  creationYear?: string;\n  bankAccount?: string;\n  paymentGateway?: string;\n  businessActivity?: string;\n  expectedServices?: string;\n  wantsDissolve?: string;\n  notes?: string;\n}) {\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\"><strong>Nuevo pedido de mantenimiento completado.</strong></p>\n    \n    <h3 style=\"font-size: 14px; font-weight: 700; margin: 20px 0 10px; color: #333; border-bottom: 2px solid #6EDC8A; padding-bottom: 5px;\">Informaci\u00F3n del Propietario</h3>\n    <div style=\"background: #F7F7F5; border-left: 4px solid #6EDC8A; padding: 15px; margin: 10px 0; border-radius: 8px;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Nombre:</strong> ${orderData.ownerFullName || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Email:</strong> ${orderData.ownerEmail || 'N/A'}</p>\n      <p style=\"margin: 0; font-size: 13px;\"><strong>Tel\u00E9fono:</strong> ${orderData.ownerPhone || 'N/A'}</p>\n    </div>\n    \n    <h3 style=\"font-size: 14px; font-weight: 700; margin: 20px 0 10px; color: #333; border-bottom: 2px solid #6EDC8A; padding-bottom: 5px;\">Informaci\u00F3n de la Empresa</h3>\n    <div style=\"background: #F7F7F5; border-left: 4px solid #6EDC8A; padding: 15px; margin: 10px 0; border-radius: 8px;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Empresa:</strong> ${orderData.companyName || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>EIN:</strong> ${orderData.ein || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Estado:</strong> ${orderData.state || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Creado con:</strong> ${orderData.creationSource || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>A\u00F1o creaci\u00F3n:</strong> ${orderData.creationYear || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Cuenta bancaria:</strong> ${orderData.bankAccount || 'N/A'}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Pasarela:</strong> ${orderData.paymentGateway || 'N/A'}</p>\n      <p style=\"margin: 0; font-size: 13px;\"><strong>Actividad:</strong> ${orderData.businessActivity || 'N/A'}</p>\n    </div>\n    \n    <h3 style=\"font-size: 14px; font-weight: 700; margin: 20px 0 10px; color: #333; border-bottom: 2px solid #6EDC8A; padding-bottom: 5px;\">Servicios Solicitados</h3>\n    <div style=\"background: #F7F7F5; border-left: 4px solid #6EDC8A; padding: 15px; margin: 10px 0; border-radius: 8px;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Servicios:</strong> ${orderData.expectedServices || 'N/A'}</p>\n      <p style=\"margin: 0; font-size: 13px;\"><strong>Disolver empresa:</strong> ${orderData.wantsDissolve || 'No'}</p>\n    </div>\n    \n    <h3 style=\"font-size: 14px; font-weight: 700; margin: 20px 0 10px; color: #333; border-bottom: 2px solid #4CAF50; padding-bottom: 5px;\">Pago</h3>\n    <div style=\"background: #E8F5E9; border-left: 4px solid #4CAF50; padding: 15px; margin: 10px 0; border-radius: 8px;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Referencia:</strong> ${orderData.orderIdentifier}</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 13px;\"><strong>Importe:</strong> ${orderData.amount}\u20AC</p>\n      <p style=\"margin: 0; font-size: 13px;\"><strong>M\u00E9todo:</strong> ${orderData.paymentMethod}</p>\n    </div>\n    \n    ${orderData.notes ? `\n    <h3 style=\"font-size: 14px; font-weight: 700; margin: 20px 0 10px; color: #333; border-bottom: 2px solid #FF9800; padding-bottom: 5px;\">Notas del Cliente</h3>\n    <div style=\"background: #FFF3E0; border-left: 4px solid #FF9800; padding: 15px; margin: 10px 0; border-radius: 8px;\">\n      <p style=\"margin: 0; font-size: 13px;\">${orderData.notes}</p>\n    </div>\n    ` : ''}\n  `;\n  return getEmailWrapper(content);\n}\n\n// Password reset by admin notification\nexport function getAdminPasswordResetTemplate(name?: string, lang: EmailLanguage = 'es') {\n  const t = {\n    es: { greeting: `Hola ${name || 'Cliente'},`, body: 'Tu contrase\u00F1a ha sido restablecida por nuestro equipo de soporte.', cta: 'Ahora puedes iniciar sesi\u00F3n con tu nueva contrase\u00F1a', btn: 'Iniciar Sesi\u00F3n', important: 'Importante:', warning: 'Si no solicitaste este cambio, por favor contacta con nuestro equipo de soporte inmediatamente.' },\n    en: { greeting: `Hello ${name || 'Client'},`, body: 'Your password has been reset by our support team.', cta: 'You can now log in with your new password', btn: 'Log In', important: 'Important:', warning: 'If you did not request this change, please contact our support team immediately.' },\n    ca: { greeting: `Hola ${name || 'Client'},`, body: 'La teva contrasenya ha estat restablerta pel nostre equip de suport.', cta: 'Ara pots iniciar sessi\u00F3 amb la teva nova contrasenya', btn: 'Iniciar Sessi\u00F3', important: 'Important:', warning: 'Si no has sol\u00B7licitat aquest canvi, contacta amb el nostre equip de suport immediatament.' },\n    fr: { greeting: `Bonjour ${name || 'Client'},`, body: 'Votre mot de passe a \u00E9t\u00E9 r\u00E9initialis\u00E9 par notre \u00E9quipe de support.', cta: 'Vous pouvez maintenant vous connecter avec votre nouveau mot de passe', btn: 'Se connecter', important: 'Important :', warning: 'Si vous n\\'avez pas demand\u00E9 ce changement, veuillez contacter notre \u00E9quipe de support imm\u00E9diatement.' },\n    de: { greeting: `Hallo ${name || 'Kunde'},`, body: 'Ihr Passwort wurde von unserem Support-Team zur\u00FCckgesetzt.', cta: 'Sie k\u00F6nnen sich jetzt mit Ihrem neuen Passwort anmelden', btn: 'Anmelden', important: 'Wichtig:', warning: 'Wenn Sie diese \u00C4nderung nicht angefordert haben, kontaktieren Sie bitte sofort unser Support-Team.' },\n    it: { greeting: `Ciao ${name || 'Cliente'},`, body: 'La tua password \u00E8 stata reimpostata dal nostro team di supporto.', cta: 'Ora puoi accedere con la tua nuova password', btn: 'Accedi', important: 'Importante:', warning: 'Se non hai richiesto questa modifica, contatta immediatamente il nostro team di supporto.' },\n    pt: { greeting: `Ol\u00E1 ${name || 'Cliente'},`, body: 'A sua palavra-passe foi redefinida pela nossa equipa de suporte.', cta: 'Agora pode iniciar sess\u00E3o com a sua nova palavra-passe', btn: 'Iniciar Sess\u00E3o', important: 'Importante:', warning: 'Se n\u00E3o solicitou esta altera\u00E7\u00E3o, contacte a nossa equipa de suporte imediatamente.' },\n  }[lang] || { greeting: `Hola ${name || 'Cliente'},`, body: 'Tu contrase\u00F1a ha sido restablecida por nuestro equipo de soporte.', cta: 'Ahora puedes iniciar sesi\u00F3n con tu nueva contrase\u00F1a', btn: 'Iniciar Sesi\u00F3n', important: 'Importante:', warning: 'Si no solicitaste este cambio, por favor contacta con nuestro equipo de soporte inmediatamente.' };\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.greeting}</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.body}</p>\n    \n    <div style=\"background: linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%); padding: 25px; border-radius: 16px; margin: 25px 0; text-align: center; border: 2px solid #6EDC8A;\">\n      <p style=\"margin: 0; font-size: 14px; color: #059669; font-weight: 700;\">${t.cta}</p>\n    </div>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/auth/login\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.btn}</a>\n    </div>\n\n    <div style=\"background: #FEF3C7; padding: 20px 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #F59E0B;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 13px; font-weight: 800; color: #92400E; text-transform: uppercase;\">${t.important}</p>\n      <p style=\"margin: 0; font-size: 14px; color: #78350F; line-height: 1.6;\">${t.warning}</p>\n    </div>\n  `;\n  return getEmailWrapper(content);\n}\n\n// 22. Calculadora de Precios - Resultado enviado al cliente\nexport function getCalculatorResultsTemplate(\n  name: string,\n  freelancerTax: string,\n  llcTax: string,\n  savings: string,\n  annualIncome: string,\n  expenses: string,\n  lang: EmailLanguage = 'es'\n) {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.calculatorResults.introText}</p>\n    \n    <div style=\"background: linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%); padding: 25px; border-radius: 16px; margin: 25px 0; border: 2px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 15px 0; font-size: 14px; font-weight: 700; color: #059669; text-transform: uppercase; letter-spacing: 1px;\">${t.calculatorResults.summary}</p>\n      <table style=\"width: 100%; font-size: 14px; border-collapse: collapse;\">\n        <tr>\n          <td style=\"padding: 10px 0; color: #6B7280; border-bottom: 1px solid #D1FAE5;\">${t.calculatorResults.income}</td>\n          <td style=\"padding: 10px 0; font-weight: 700; text-align: right; color: #0A0A0A; border-bottom: 1px solid #D1FAE5;\">${annualIncome}\u20AC</td>\n        </tr>\n        <tr>\n          <td style=\"padding: 10px 0; color: #6B7280; border-bottom: 1px solid #D1FAE5;\">${t.calculatorResults.expenses}</td>\n          <td style=\"padding: 10px 0; font-weight: 700; text-align: right; color: #0A0A0A; border-bottom: 1px solid #D1FAE5;\">${expenses}\u20AC</td>\n        </tr>\n        <tr>\n          <td style=\"padding: 10px 0; color: #6B7280; border-bottom: 1px solid #D1FAE5;\">${t.calculatorResults.autonomoTax}</td>\n          <td style=\"padding: 10px 0; font-weight: 700; text-align: right; color: #EF4444; border-bottom: 1px solid #D1FAE5;\">${freelancerTax}\u20AC</td>\n        </tr>\n        <tr>\n          <td style=\"padding: 10px 0; color: #6B7280; border-bottom: 1px solid #D1FAE5;\">${t.calculatorResults.llcTax}</td>\n          <td style=\"padding: 10px 0; font-weight: 700; text-align: right; color: #059669; border-bottom: 1px solid #D1FAE5;\">${llcTax}\u20AC</td>\n        </tr>\n        <tr>\n          <td style=\"padding: 12px 0; color: #059669; font-weight: 700; font-size: 15px;\">${t.calculatorResults.potentialSavings}</td>\n          <td style=\"padding: 12px 0; font-weight: 900; text-align: right; color: #059669; font-size: 18px;\">${savings}\u20AC/${lang === 'en' ? 'year' : 'a\u00F1o'}</td>\n        </tr>\n      </table>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.calculatorResults.withLLC}</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.calculatorResults.learnMore}</p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/servicios\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.calculatorResults.viewServices}</a>\n    </div>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280; margin-top: 25px;\">${t.calculatorResults.disclaimer}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 23. Operating Agreement listo - Para clientes con EIN asignado\nexport function getOperatingAgreementReadyTemplate(\n  name: string,\n  companyName: string,\n  ein: string,\n  state: string,\n  lang: EmailLanguage = 'es'\n) {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.operatingAgreementReady.generated} ${t.operatingAgreementReady.ready}</p>\n    \n    <div style=\"background: linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%); padding: 25px; border-radius: 16px; margin: 25px 0; border: 2px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 15px 0; font-size: 14px; font-weight: 700; color: #059669; text-transform: uppercase; letter-spacing: 1px;\">${t.operatingAgreementReady.llcData}</p>\n      <table style=\"width: 100%; font-size: 14px; border-collapse: collapse;\">\n        <tr>\n          <td style=\"padding: 8px 0; color: #6B7280;\">${t.operatingAgreementReady.companyLabel}</td>\n          <td style=\"padding: 8px 0; font-weight: 700; text-align: right; color: #0A0A0A;\">${companyName}</td>\n        </tr>\n        <tr>\n          <td style=\"padding: 8px 0; color: #6B7280;\">${t.operatingAgreementReady.stateLabel}</td>\n          <td style=\"padding: 8px 0; font-weight: 700; text-align: right; color: #0A0A0A;\">${state}</td>\n        </tr>\n        <tr>\n          <td style=\"padding: 8px 0; color: #6B7280;\">${t.operatingAgreementReady.einLabel}</td>\n          <td style=\"padding: 8px 0; font-weight: 700; text-align: right; color: #059669;\">${ein}</td>\n        </tr>\n      </table>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 15px;\"><strong>${t.operatingAgreementReady.whatIs}</strong></p>\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.operatingAgreementReady.fullExplanation}</p>\n    \n    <ul style=\"margin: 0 0 25px 0; padding-left: 20px; color: #444; font-size: 14px; line-height: 1.8;\">\n      <li>${t.operatingAgreementReady.reason1}</li>\n      <li>${t.operatingAgreementReady.reason2}</li>\n      <li>${t.operatingAgreementReady.reason3}</li>\n      <li>${t.operatingAgreementReady.reason4}</li>\n    </ul>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/tools/operating-agreement\" style=\"display: inline-block; background: #8B5CF6; color: #FFFFFF; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(139,92,246,0.35);\">${t.operatingAgreementReady.generateButton}</a>\n    </div>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280; margin-top: 25px;\">${t.operatingAgreementReady.autoGenerated}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 22. Document Approved Template\nexport function getDocumentApprovedTemplate(name: string, documentLabel: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <div style=\"background: linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%); padding: 25px; border-radius: 16px; margin: 25px 0; text-align: center; border: 2px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 28px;\">&#10003;</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 18px; font-weight: 800; color: #059669;\">${t.documentApproved.title}</p>\n      <p style=\"margin: 0; font-size: 16px; font-weight: 600; color: #0A0A0A;\">\"${documentLabel}\"</p>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.documentApproved.reviewedAndApproved}</p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.documentApproved.viewDocuments}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 23. Document Rejected Template\nexport function getDocumentRejectedTemplate(name: string, documentLabel: string, reason: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <div style=\"background: linear-gradient(135deg, #FEF2F2 0%, #FEE2E2 100%); padding: 25px; border-radius: 16px; margin: 25px 0; text-align: center; border: 2px solid #F87171;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 28px;\">&#9888;</p>\n      <p style=\"margin: 0 0 8px 0; font-size: 18px; font-weight: 800; color: #DC2626;\">${t.documentRejected.title}</p>\n      <p style=\"margin: 0; font-size: 16px; font-weight: 600; color: #0A0A0A;\">\"${documentLabel}\"</p>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 15px;\">${t.documentRejected.reviewedAndRejected}</p>\n    \n    <div style=\"background: #F9FAFB; padding: 20px 25px; border-radius: 16px; margin: 20px 0; border-left: 4px solid #F87171;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 13px; font-weight: 800; color: #DC2626; text-transform: uppercase;\">${t.documentRejected.reason}</p>\n      <p style=\"margin: 0; font-size: 14px; color: #444; line-height: 1.6;\">${reason}</p>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.documentRejected.pleaseReupload}</p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #F87171; color: #FFFFFF; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(248,113,113,0.35);\">${t.documentRejected.viewDocuments}</a>\n    </div>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 23b. Admin Profile Changes Verified Alert\nexport function getAdminProfileChangesTemplate(clientName: string, clientEmail: string, clientId: string, changedFields: Array<{field: string, oldValue: string, newValue: string}>) {\n  const changesHtml = changedFields.map(f => \n    `<tr>\n      <td style=\"padding: 10px 15px; border-bottom: 1px solid #E5E7EB; font-weight: 600; color: #0A0A0A;\">${f.field}</td>\n      <td style=\"padding: 10px 15px; border-bottom: 1px solid #E5E7EB; color: #6B7280; text-decoration: line-through;\">${f.oldValue}</td>\n      <td style=\"padding: 10px 15px; border-bottom: 1px solid #E5E7EB; color: #059669; font-weight: 600;\">${f.newValue}</td>\n    </tr>`\n  ).join('');\n  \n  const content = `\n    <div style=\"background: linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%); padding: 25px; border-radius: 16px; margin: 0 0 25px 0; text-align: center; border: 2px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 8px 0; font-size: 28px;\">&#128274;</p>\n      <p style=\"margin: 0; font-size: 18px; font-weight: 800; color: #059669;\">Cambios de Perfil Verificados con OTP</p>\n    </div>\n    \n    <div style=\"background: #F9FAFB; padding: 20px 25px; border-radius: 16px; margin: 20px 0;\">\n      <p style=\"margin: 0 0 10px 0; font-size: 14px; color: #444;\"><strong>Cliente:</strong> ${clientName}</p>\n      <p style=\"margin: 0 0 10px 0; font-size: 14px; color: #444;\"><strong>Email:</strong> ${clientEmail}</p>\n      <p style=\"margin: 0; font-size: 14px; color: #444;\"><strong>ID de Cliente:</strong> ${clientId}</p>\n    </div>\n    \n    <p style=\"margin: 20px 0 10px 0; font-size: 14px; font-weight: 800; color: #0A0A0A; text-transform: uppercase;\">Campos modificados:</p>\n    <table style=\"width: 100%; border-collapse: collapse; border-radius: 12px; overflow: hidden; border: 1px solid #E5E7EB;\">\n      <thead>\n        <tr style=\"background: #F3F4F6;\">\n          <th style=\"padding: 10px 15px; text-align: left; font-size: 12px; color: #6B7280; text-transform: uppercase;\">Campo</th>\n          <th style=\"padding: 10px 15px; text-align: left; font-size: 12px; color: #6B7280; text-transform: uppercase;\">Anterior</th>\n          <th style=\"padding: 10px 15px; text-align: left; font-size: 12px; color: #6B7280; text-transform: uppercase;\">Nuevo</th>\n        </tr>\n      </thead>\n      <tbody>\n        ${changesHtml}\n      </tbody>\n    </table>\n    \n    <p style=\"line-height: 1.6; font-size: 13px; color: #9CA3AF; margin-top: 20px;\">Cambio verificado con OTP - ${new Date().toLocaleString('es-ES')}</p>\n  `;\n  return getEmailWrapper(content, 'es');\n}\n\n// 23c. Admin OTP Request Template\nexport function getAdminOtpRequestTemplate(name: string, otp: string, reason?: string, lang: EmailLanguage = 'es') {\n  const t = getEmailTranslations(lang);\n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 20px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${reason || t.profileChangeOtp.sensitiveChangeRequest}</p>\n    \n    <div style=\"background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%); padding: 30px; border-radius: 16px; margin: 25px 0; text-align: center; border: 2px solid #F59E0B;\">\n      <p style=\"margin: 0 0 10px 0; font-size: 14px; color: #92400E; font-weight: 700; text-transform: uppercase; letter-spacing: 1px;\">${t.profileChangeOtp.yourCode}</p>\n      <p style=\"margin: 0; font-size: 42px; font-weight: 900; color: #0A0A0A; letter-spacing: 12px; font-family: 'SF Mono', 'Consolas', monospace;\">${otp}</p>\n    </div>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280; text-align: center;\">${t.profileChangeOtp.validFor}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// 24. Carrito abandonado - Aplicaci\u00F3n incompleta\nexport function getAbandonedApplicationTemplate(\n  name: string,\n  serviceType: string,\n  state?: string,\n  hoursRemaining?: number,\n  lang: EmailLanguage = 'es'\n) {\n  const t = getEmailTranslations(lang);\n  const urgency = hoursRemaining && hoursRemaining <= 12 ? true : false;\n  const urgencyColor = urgency ? \"#EF4444\" : \"#F59E0B\";\n  const urgencyBg = urgency ? \"#FEE2E2\" : \"#FEF3C7\";\n  \n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 20px;\">${t.abandonedApplication.noticeText} <strong>${serviceType}</strong>${state ? ` ${lang === 'en' ? 'in' : 'en'} ${state}` : ''}. ${t.abandonedApplication.savedDraft}</p>\n    \n    ${hoursRemaining ? `\n    <div style=\"background: ${urgencyBg}; padding: 20px 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid ${urgencyColor};\">\n      <p style=\"margin: 0; font-size: 14px; color: ${urgency ? '#B91C1C' : '#92400E'}; line-height: 1.7;\">\n        <strong>${t.abandonedApplication.importantNote}</strong> ${t.abandonedApplication.draftDeletion}\n      </p>\n    </div>\n    ` : ''}\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 15px;\">${t.abandonedApplication.understandDoubts}</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.abandonedApplication.questionsHelp}</p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${domain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.abandonedApplication.continueButton}</a>\n    </div>\n    \n    <div style=\"background: #F9FAFB; padding: 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid #6EDC8A;\">\n      <p style=\"margin: 0 0 12px 0; font-size: 13px; font-weight: 800; color: #0A0A0A; text-transform: uppercase;\">${t.abandonedApplication.whyChoose}</p>\n      <ul style=\"margin: 0; padding-left: 18px; color: #444; font-size: 14px; line-height: 1.8;\">\n        <li>${t.abandonedApplication.reason1}</li>\n        <li>${t.abandonedApplication.reason2}</li>\n        <li>${t.abandonedApplication.reason3}</li>\n        <li>${t.abandonedApplication.reason4}</li>\n        <li>${t.abandonedApplication.reason5}</li>\n      </ul>\n    </div>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280;\">${t.abandonedApplication.noMoreReminders}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\n// Legacy exports for compatibility\nexport interface EmailMetadata {\n  clientId?: string;\n  date?: Date;\n  reference?: string;\n  ip?: string;\n}\n\nexport function getEmailHeader(title: string = \"Easy US LLC\", metadata?: EmailMetadata) {\n  return getSimpleHeader();\n}\n\nexport function getEmailFooter() {\n  return getSimpleFooter();\n}\n\n// Transporter configuration\nconst transporter = nodemailer.createTransport({\n  host: process.env.SMTP_HOST || \"smtp.ionos.es\",\n  port: parseInt(process.env.SMTP_PORT || \"587\"),\n  secure: false,\n  auth: {\n    user: process.env.SMTP_USER,\n    pass: process.env.SMTP_PASS,\n  },\n  tls: {\n    rejectUnauthorized: false\n  },\n  pool: true,\n  maxConnections: 5,\n  maxMessages: 100,\n});\n\n// ============== EMAIL QUEUE SYSTEM ==============\ninterface EmailJob {\n  id: string;\n  to: string;\n  subject: string;\n  html: string;\n  replyTo?: string;\n  retries: number;\n  maxRetries: number;\n  createdAt: number;\n}\n\nconst emailQueue: EmailJob[] = [];\nconst MAX_RETRIES = 3;\nconst MAX_QUEUE_SIZE = 100; // Prevent memory growth\nconst EMAIL_TTL = 3600000; // 1 hour TTL for emails\nconst QUEUE_PROCESS_INTERVAL = 2000; // Process every 2 seconds (with backoff)\nlet isProcessingQueue = false;\nlet lastProcessTime = 0;\n\nfunction generateEmailId(): string {\n  return `email_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n\n// Clean up old emails from queue\nfunction cleanupStaleEmails() {\n  const now = Date.now();\n  let removed = 0;\n  while (emailQueue.length > 0 && emailQueue[0] && (now - emailQueue[0].createdAt) > EMAIL_TTL) {\n    emailQueue.shift();\n    removed++;\n  }\n  if (removed > 0) {\n    console.log(`Cleaned up ${removed} stale emails from queue`);\n  }\n}\n\nasync function processEmailQueue() {\n  // Skip if SMTP not configured\n  if (!process.env.SMTP_USER || !process.env.SMTP_PASS) {\n    // Clear queue when SMTP not configured\n    if (emailQueue.length > 0) {\n      emailQueue.length = 0;\n    }\n    return;\n  }\n  \n  if (isProcessingQueue || emailQueue.length === 0) return;\n  \n  // Backoff: wait at least 1 second between processing attempts\n  const now = Date.now();\n  if (now - lastProcessTime < 1000) return;\n  \n  isProcessingQueue = true;\n  lastProcessTime = now;\n  \n  try {\n    // Cleanup stale emails first\n    cleanupStaleEmails();\n    \n    const job = emailQueue[0];\n    if (!job) {\n      isProcessingQueue = false;\n      return;\n    }\n    \n    try {\n      await transporter.sendMail({\n        from: `\"Easy US LLC\" <no-reply@easyusllc.com>`,\n        replyTo: job.replyTo || \"hola@easyusllc.com\",\n        to: job.to,\n        subject: job.subject,\n        html: job.html,\n      });\n      \n      // Success - remove from queue\n      emailQueue.shift();\n    } catch (error: any) {\n      job.retries++;\n      \n      if (job.retries >= job.maxRetries) {\n        // Max retries reached - remove and log\n        emailQueue.shift();\n        console.error(`Email failed after ${job.maxRetries} retries:`, job.id, job.to);\n      } else {\n        // Move to end of queue for retry (with delay via natural queue order)\n        emailQueue.shift();\n        emailQueue.push(job);\n      }\n    }\n  } finally {\n    isProcessingQueue = false;\n  }\n}\n\n// Start queue processor\nsetInterval(processEmailQueue, QUEUE_PROCESS_INTERVAL);\n\n// Queue an email for sending (with size limit)\nexport function queueEmail({ to, subject, html, replyTo }: { to: string; subject: string; html: string; replyTo?: string }): string | null {\n  // Skip if SMTP not configured\n  if (!process.env.SMTP_USER || !process.env.SMTP_PASS) {\n    return null;\n  }\n  \n  // Prevent unbounded queue growth\n  if (emailQueue.length >= MAX_QUEUE_SIZE) {\n    console.warn(`Email queue full (${MAX_QUEUE_SIZE}), dropping email to: ${to}`);\n    return null;\n  }\n  \n  const job: EmailJob = {\n    id: generateEmailId(),\n    to,\n    subject,\n    html,\n    replyTo,\n    retries: 0,\n    maxRetries: MAX_RETRIES,\n    createdAt: Date.now()\n  };\n  \n  emailQueue.push(job);\n  return job.id;\n}\n\n// Get queue status\nexport function getEmailQueueStatus() {\n  return {\n    pending: emailQueue.length,\n    isProcessing: isProcessingQueue\n  };\n}\n\n// Direct send for critical emails (bypasses queue)\nexport async function sendEmail({ to, subject, html, replyTo }: { to: string; subject: string; html: string; replyTo?: string }) {\n  if (!process.env.SMTP_USER || !process.env.SMTP_PASS) {\n    return;\n  }\n\n  try {\n    const path = await import(\"path\");\n    const logoPath = path.join(process.cwd(), \"client/public/logo-icon.png\");\n\n    const info = await transporter.sendMail({\n      from: `\"Easy US LLC\" <no-reply@easyusllc.com>`,\n      replyTo: replyTo || \"hola@easyusllc.com\",\n      to: to,\n      subject: subject,\n      html,\n      attachments: [\n        {\n          filename: 'logo-icon.png',\n          path: logoPath,\n          cid: 'logo-icon'\n        }\n      ]\n    });\n    return info;\n  } catch (error: any) {\n    // On failure, queue for retry\n    queueEmail({ to, subject, html, replyTo });\n    return null;\n  }\n}\n\n// Template for abandoned application reminder\nexport function getAbandonedApplicationReminderTemplate(\n  name: string,\n  applicationType: 'llc' | 'maintenance',\n  state: string,\n  hoursRemaining: number,\n  lang: EmailLanguage = 'es'\n) {\n  const t = getEmailTranslations(lang);\n  const emailDomain = process.env.REPLIT_DEV_DOMAIN || domain;\n  const serviceLabel = applicationType === 'llc' ? t.abandonedApplication.llcFormation : t.abandonedApplication.maintenancePack;\n  const urgencyColor = hoursRemaining <= 12 ? '#EF4444' : '#F59E0B';\n  const urgencyText = hoursRemaining <= 12 ? t.abandonedApplication.lastHours : `${Math.round(hoursRemaining)} ${lang === 'en' ? 'hours' : lang === 'ca' ? 'hores' : 'horas'}`;\n  \n  const content = `\n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin: 0 0 25px 0;\">${t.common.greeting} ${name},</p>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.abandonedApplication.noticeText} ${serviceLabel} ${lang === 'en' ? 'in' : 'a'} ${state}.</p>\n    \n    <div style=\"background: ${urgencyColor}15; padding: 20px 25px; border-radius: 16px; margin: 25px 0; border-left: 4px solid ${urgencyColor};\">\n      <p style=\"margin: 0; font-size: 14px; color: ${urgencyColor}; line-height: 1.7; font-weight: 600;\">\n        ${t.abandonedApplication.autoDeleteWarning} (${urgencyText})\n      </p>\n    </div>\n    \n    <p style=\"line-height: 1.7; font-size: 15px; color: #444; margin-bottom: 25px;\">${t.abandonedApplication.dontLoseProgress}</p>\n    \n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"https://${emailDomain}/dashboard\" style=\"display: inline-block; background: #6EDC8A; color: #0A0A0A; text-decoration: none; font-weight: 800; font-size: 13px; text-transform: uppercase; padding: 14px 35px; border-radius: 50px; letter-spacing: 0.3px; box-shadow: 0 4px 14px rgba(110,220,138,0.35);\">${t.abandonedApplication.continueButton}</a>\n    </div>\n    \n    <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280;\">${t.abandonedApplication.questionsHelp}</p>\n  `;\n  return getEmailWrapper(content, lang);\n}\n\nexport async function sendTrustpilotEmail({ to, name, orderNumber }: { to: string; name: string; orderNumber: string }) {\n  if (!process.env.SMTP_PASS) {\n    return;\n  }\n\n  const trustpilotBcc = process.env.TRUSTPILOT_BCC_EMAIL || \"easyusllc.com+62fb280c0a@invite.trustpilot.com\";\n  const html = getOrderCompletedTemplate(name, orderNumber);\n\n  try {\n    const path = await import(\"path\");\n    const logoPath = path.join(process.cwd(), \"client/public/logo-icon.png\");\n\n    const info = await transporter.sendMail({\n      from: `\"Easy US LLC\" <no-reply@easyusllc.com>`,\n      replyTo: \"hola@easyusllc.com\",\n      to: to,\n      bcc: trustpilotBcc,\n      subject: `Pedido completado - Documentaci\u00F3n disponible`,\n      html,\n      attachments: [\n        {\n          filename: 'logo-icon.png',\n          path: logoPath,\n          cid: 'logo-icon'\n        }\n      ]\n    });\n    return info;\n  } catch (error: any) {\n    return null;\n  }\n}\n", "import { db } from \"../db\";\nimport { users, llcApplications, maintenanceApplications, messages, userNotifications, applicationDocuments, consultationBookings, orders } from \"@shared/schema\";\nimport { eq } from \"drizzle-orm\";\n\nexport function generate8DigitId(): string {\n  return Math.floor(10000000 + Math.random() * 90000000).toString();\n}\n\nexport async function generateUniqueClientId(): Promise<string> {\n  let attempts = 0;\n  const maxAttempts = 10;\n  \n  while (attempts < maxAttempts) {\n    const clientId = generate8DigitId();\n    const existing = await db.select({ id: users.id }).from(users).where(eq(users.clientId, clientId)).limit(1);\n    if (existing.length === 0) {\n      return clientId;\n    }\n    attempts++;\n  }\n  \n  return Date.now().toString().slice(-8);\n}\n\nexport function generateOrderCode(state: string): string {\n  const statePrefix = getStatePrefix(state);\n  const digits = generate8DigitId();\n  return `${statePrefix}-${digits}`;\n}\n\nexport function getStatePrefix(state: string): string {\n  const stateMap: Record<string, string> = {\n    'New Mexico': 'NM',\n    'new mexico': 'NM',\n    'nm': 'NM',\n    'Wyoming': 'WY',\n    'wyoming': 'WY',\n    'wy': 'WY',\n    'Delaware': 'DE',\n    'delaware': 'DE',\n    'de': 'DE',\n  };\n  return stateMap[state] || stateMap[state.toLowerCase()] || 'US';\n}\n\nexport async function generateUniqueOrderCode(state: string): Promise<string> {\n  let attempts = 0;\n  const maxAttempts = 10;\n  \n  while (attempts < maxAttempts) {\n    const code = generateOrderCode(state);\n    \n    const existingLlc = await db.select({ id: llcApplications.id })\n      .from(llcApplications)\n      .where(eq(llcApplications.requestCode, code))\n      .limit(1);\n    \n    const existingMaint = await db.select({ id: maintenanceApplications.id })\n      .from(maintenanceApplications)\n      .where(eq(maintenanceApplications.requestCode, code))\n      .limit(1);\n    \n    if (existingLlc.length === 0 && existingMaint.length === 0) {\n      return code;\n    }\n    attempts++;\n  }\n  \n  const timestamp = Date.now().toString().slice(-8);\n  return `${getStatePrefix(state)}-${timestamp}`;\n}\n\nexport async function generateUniqueTicketId(): Promise<string> {\n  let attempts = 0;\n  const maxAttempts = 10;\n  \n  while (attempts < maxAttempts) {\n    const ticketId = generate8DigitId();\n    \n    const existingNotif = await db.select({ id: userNotifications.id })\n      .from(userNotifications)\n      .where(eq(userNotifications.ticketId, ticketId))\n      .limit(1);\n    \n    if (existingNotif.length === 0) {\n      return ticketId;\n    }\n    attempts++;\n  }\n  \n  return Date.now().toString().slice(-8);\n}\n\nexport async function generateUniqueMessageId(): Promise<string> {\n  let attempts = 0;\n  const maxAttempts = 10;\n  \n  while (attempts < maxAttempts) {\n    const messageId = generate8DigitId();\n    \n    const existing = await db.select({ id: messages.id })\n      .from(messages)\n      .where(eq(messages.messageId, messageId))\n      .limit(1);\n    \n    if (existing.length === 0) {\n      return messageId;\n    }\n    attempts++;\n  }\n  \n  return Date.now().toString().slice(-8);\n}\n\nexport function generateDocumentId(): string {\n  return generate8DigitId();\n}\n\nexport function formatOrderDisplay(requestCode: string | null | undefined): string {\n  if (requestCode) {\n    return requestCode;\n  }\n  return 'N/A';\n}\n\nexport async function generateUniqueBookingCode(): Promise<string> {\n  let attempts = 0;\n  const maxAttempts = 10;\n  \n  while (attempts < maxAttempts) {\n    const bookingCode = `CON-${generate8DigitId()}`;\n    \n    const existing = await db.select({ id: consultationBookings.id })\n      .from(consultationBookings)\n      .where(eq(consultationBookings.bookingCode, bookingCode))\n      .limit(1);\n    \n    if (existing.length === 0) {\n      return bookingCode;\n    }\n    attempts++;\n  }\n  \n  return `CON-${Date.now().toString().slice(-8)}`;\n}\n\nexport async function generateUniqueAdminOrderCode(state: string): Promise<string> {\n  const statePrefix = getStatePrefix(state);\n  const year = new Date().getFullYear();\n  let attempts = 0;\n  const maxAttempts = 10;\n  \n  while (attempts < maxAttempts) {\n    const digits = generate8DigitId();\n    const code = `${statePrefix}-${year}-${digits}`;\n    \n    const existingLlc = await db.select({ id: llcApplications.id })\n      .from(llcApplications)\n      .where(eq(llcApplications.requestCode, code))\n      .limit(1);\n    \n    const existingMaint = await db.select({ id: maintenanceApplications.id })\n      .from(maintenanceApplications)\n      .where(eq(maintenanceApplications.requestCode, code))\n      .limit(1);\n    \n    const existingOrder = await db.select({ id: orders.id })\n      .from(orders)\n      .where(eq(orders.invoiceNumber, code))\n      .limit(1);\n    \n    if (existingLlc.length === 0 && existingMaint.length === 0 && existingOrder.length === 0) {\n      return code;\n    }\n    attempts++;\n  }\n  \n  return `${statePrefix}-${year}-${Date.now().toString().slice(-8)}`;\n}\n\nexport async function generateUniqueInvoiceNumber(): Promise<string> {\n  const year = new Date().getFullYear();\n  let attempts = 0;\n  const maxAttempts = 10;\n  \n  while (attempts < maxAttempts) {\n    const digits = generate8DigitId();\n    const invoiceNum = `INV-${year}-${digits}`;\n    \n    const existing = await db.select({ id: orders.id })\n      .from(orders)\n      .where(eq(orders.invoiceNumber, invoiceNum))\n      .limit(1);\n    \n    if (existing.length === 0) {\n      return invoiceNum;\n    }\n    attempts++;\n  }\n  \n  return `INV-${year}-${Date.now().toString().slice(-8)}`;\n}\n\nexport function generateDocRequestId(): string {\n  return generate8DigitId();\n}\n", "import { db } from \"../db\";\nimport { sql } from \"drizzle-orm\";\n\ninterface RateLimitConfig {\n  windowMs: number;\n  maxRequests: number;\n}\n\nconst RATE_LIMITS: Record<string, RateLimitConfig> = {\n  login: { windowMs: 900000, maxRequests: 5 },\n  otp: { windowMs: 300000, maxRequests: 3 },\n  register: { windowMs: 3600000, maxRequests: 3 },\n  passwordReset: { windowMs: 600000, maxRequests: 3 },\n  contact: { windowMs: 300000, maxRequests: 5 },\n  general: { windowMs: 60000, maxRequests: 100 },\n  api: { windowMs: 60000, maxRequests: 100 },\n};\n\nconst inMemoryStore = new Map<string, Map<string, number[]>>();\n\nObject.keys(RATE_LIMITS).forEach(key => {\n  inMemoryStore.set(key, new Map());\n});\n\nexport function checkRateLimitInMemory(\n  type: keyof typeof RATE_LIMITS, \n  identifier: string\n): { allowed: boolean; retryAfter?: number } {\n  const config = RATE_LIMITS[type];\n  if (!config) return { allowed: true };\n  \n  const store = inMemoryStore.get(type)!;\n  const now = Date.now();\n  \n  const timestamps = store.get(identifier) || [];\n  const validTimestamps = timestamps.filter(t => now - t < config.windowMs);\n  \n  if (validTimestamps.length >= config.maxRequests) {\n    const oldestValid = Math.min(...validTimestamps);\n    const retryAfter = Math.ceil((config.windowMs - (now - oldestValid)) / 1000);\n    return { allowed: false, retryAfter };\n  }\n  \n  validTimestamps.push(now);\n  store.set(identifier, validTimestamps);\n  return { allowed: true };\n}\n\nexport function cleanupInMemoryRateLimits(): void {\n  const now = Date.now();\n  const storeEntries = Array.from(inMemoryStore.entries());\n  \n  for (const [type, store] of storeEntries) {\n    const config = RATE_LIMITS[type as keyof typeof RATE_LIMITS];\n    if (!config) continue;\n    \n    const ipEntries = Array.from(store.entries());\n    for (const [ip, timestamps] of ipEntries) {\n      const valid = timestamps.filter((t: number) => now - t < config.windowMs);\n      if (valid.length === 0) {\n        store.delete(ip);\n      } else {\n        store.set(ip, valid);\n      }\n    }\n  }\n}\n\nsetInterval(cleanupInMemoryRateLimits, 300000);\n\nexport async function checkRateLimitDb(\n  type: string,\n  identifier: string\n): Promise<{ allowed: boolean; retryAfter?: number }> {\n  const config = RATE_LIMITS[type as keyof typeof RATE_LIMITS] || RATE_LIMITS.general;\n  \n  try {\n    const windowStart = new Date(Date.now() - config.windowMs);\n    \n    const result = await db.execute(sql`\n      SELECT COUNT(*) as count \n      FROM rate_limit_entries \n      WHERE identifier = ${identifier} \n        AND limit_type = ${type}\n        AND created_at > ${windowStart}\n    `);\n    \n    const count = Number((result.rows[0] as any)?.count || 0);\n    \n    if (count >= config.maxRequests) {\n      const retryAfter = Math.ceil(config.windowMs / 1000);\n      return { allowed: false, retryAfter };\n    }\n    \n    await db.execute(sql`\n      INSERT INTO rate_limit_entries (identifier, limit_type, created_at)\n      VALUES (${identifier}, ${type}, NOW())\n    `);\n    \n    return { allowed: true };\n  } catch (error) {\n    console.error(\"Rate limit DB error, falling back to memory:\", error);\n    return checkRateLimitInMemory(type as keyof typeof RATE_LIMITS, identifier);\n  }\n}\n\nexport async function cleanupDbRateLimits(): Promise<void> {\n  try {\n    const oldestAllowed = new Date(Date.now() - 3600000);\n    await db.execute(sql`\n      DELETE FROM rate_limit_entries \n      WHERE created_at < ${oldestAllowed}\n    `);\n  } catch (error) {\n    console.error(\"Rate limit cleanup error:\", error);\n  }\n}\n\nexport function getRateLimitConfig(type: string): RateLimitConfig {\n  return RATE_LIMITS[type as keyof typeof RATE_LIMITS] || RATE_LIMITS.general;\n}\n\nconst isProduction = process.env.NODE_ENV === \"production\";\n\nexport async function checkRateLimit(\n  type: string,\n  identifier: string\n): Promise<{ allowed: boolean; retryAfter?: number }> {\n  if (isProduction) {\n    return checkRateLimitDb(type, identifier);\n  }\n  return checkRateLimitInMemory(type as keyof typeof RATE_LIMITS, identifier);\n}\n\nexport { RATE_LIMITS };\n", "import { db } from \"../db\";\nimport { sql, desc } from \"drizzle-orm\";\nimport { checkRateLimitInMemory, checkRateLimit as checkRateLimitAuto } from \"./rate-limiter\";\nimport { auditLogs } from \"@shared/schema\";\n\nexport { checkRateLimitInMemory as checkRateLimit };\nexport { checkRateLimitAuto };\n\nexport function sanitizeHtml(input: string): string {\n  if (!input || typeof input !== 'string') return '';\n  \n  return input\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#x27;')\n    .replace(/\\//g, '&#x2F;')\n    .replace(/`/g, '&#96;')\n    .trim();\n}\n\nexport function sanitizeObject<T extends Record<string, any>>(obj: T, fieldsToSanitize: (keyof T)[]): T {\n  const result = { ...obj };\n  for (const field of fieldsToSanitize) {\n    if (typeof result[field] === 'string') {\n      result[field] = sanitizeHtml(result[field] as string) as T[keyof T];\n    }\n  }\n  return result;\n}\n\nexport function validateEmail(email: string): boolean {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email) && email.length <= 254;\n}\n\nexport function validatePhone(phone: string): boolean {\n  const phoneRegex = /^[\\d\\s+\\-().]{6,20}$/;\n  return phoneRegex.test(phone);\n}\n\nexport function validatePassword(password: string): { valid: boolean; message?: string } {\n  if (password.length < 8) {\n    return { valid: false, message: \"La contrase\u00F1a debe tener al menos 8 caracteres\" };\n  }\n  if (password.length > 128) {\n    return { valid: false, message: \"La contrase\u00F1a es demasiado larga\" };\n  }\n  if (!/[A-Z]/.test(password)) {\n    return { valid: false, message: \"La contrase\u00F1a debe contener al menos una letra may\u00FAscula\" };\n  }\n  if (!/[a-z]/.test(password)) {\n    return { valid: false, message: \"La contrase\u00F1a debe contener al menos una letra min\u00FAscula\" };\n  }\n  if (!/[0-9]/.test(password)) {\n    return { valid: false, message: \"La contrase\u00F1a debe contener al menos un n\u00FAmero\" };\n  }\n  if (!/[!@#$%^&*()_+\\-=\\[\\]{};':\"\\\\|,.<>\\/?]/.test(password)) {\n    return { valid: false, message: \"La contrase\u00F1a debe contener al menos un s\u00EDmbolo especial (!@#$%^&*...)\" };\n  }\n  return { valid: true };\n}\n\nexport function getPasswordRequirements(): string[] {\n  return [\n    \"M\u00EDnimo 8 caracteres\",\n    \"Al menos una may\u00FAscula (A-Z)\",\n    \"Al menos una min\u00FAscula (a-z)\",\n    \"Al menos un n\u00FAmero (0-9)\",\n    \"Al menos un s\u00EDmbolo (!@#$%^&*...)\"\n  ];\n}\n\nexport type AuditAction = \n  | 'user_login'\n  | 'user_logout'\n  | 'user_register'\n  | 'password_change'\n  | 'password_reset'\n  | 'admin_password_reset'\n  | 'order_created'\n  | 'order_status_change'\n  | 'order_completed'\n  | 'payment_received'\n  | 'payment_link_update'\n  | 'admin_user_update'\n  | 'admin_order_update'\n  | 'admin_send_email'\n  | 'document_upload'\n  | 'document_request'\n  | 'account_locked'\n  | 'account_unlocked'\n  | 'account_status_change'\n  | 'account_flagged_for_review'\n  | 'security_otp_required'\n  | 'ip_order_blocked'\n  | 'backup_completed'\n  | 'backup_failed'\n  | 'admin_create_maintenance_order'\n  | 'admin_create_custom_order'\n  | 'consultation_booked'\n  | 'consultation_cancelled'\n  | 'consultation_type_created'\n  | 'consultation_updated'\n  | 'consultation_rescheduled'\n  | 'accounting_transaction_created'\n  | 'accounting_transaction_updated'\n  | 'accounting_transaction_deleted'\n  | 'admin_documents_download'\n  | 'account_review'\n  | 'order_updated';\n\ninterface AuditLogEntry {\n  action: AuditAction;\n  userId?: string;\n  targetId?: string;\n  ip?: string;\n  userAgent?: string;\n  details?: Record<string, any>;\n  timestamp: Date;\n}\n\nconst memoryAuditLogs: AuditLogEntry[] = [];\nconst MAX_MEMORY_LOGS = 1000;\n\nexport function logAudit(entry: Omit<AuditLogEntry, 'timestamp'>): void {\n  const logEntry: AuditLogEntry = {\n    ...entry,\n    timestamp: new Date(),\n  };\n  \n  memoryAuditLogs.push(logEntry);\n  if (memoryAuditLogs.length > MAX_MEMORY_LOGS) {\n    memoryAuditLogs.shift();\n  }\n  \n  db.insert(auditLogs).values({\n    action: entry.action,\n    userId: entry.userId || null,\n    targetId: entry.targetId || null,\n    ip: entry.ip || null,\n    userAgent: entry.userAgent || null,\n    details: entry.details || null,\n  }).catch(err => {\n    console.error(\"[AUDIT] Failed to persist audit log:\", err.message);\n  });\n  \n  if (process.env.NODE_ENV === 'development') {\n    console.log(`[AUDIT] ${entry.action}:`, {\n      userId: entry.userId,\n      targetId: entry.targetId,\n      ip: entry.ip,\n      details: entry.details\n    });\n  }\n}\n\nexport function getRecentAuditLogs(limit: number = 100): AuditLogEntry[] {\n  return memoryAuditLogs.slice(-limit).reverse();\n}\n\nexport async function getAuditLogsFromDb(options: {\n  limit?: number;\n  offset?: number;\n  action?: string;\n  userId?: string;\n} = {}): Promise<{ logs: any[]; total: number }> {\n  const { limit = 100, offset = 0, action, userId } = options;\n  \n  try {\n    let query = db.select().from(auditLogs).orderBy(desc(auditLogs.createdAt));\n    \n    const logs = await query.limit(limit).offset(offset);\n    \n    const countResult = await db.select({ count: sql<number>`count(*)` }).from(auditLogs);\n    const total = Number(countResult[0]?.count || 0);\n    \n    return { logs, total };\n  } catch (error) {\n    console.error(\"[AUDIT] Failed to fetch logs from DB:\", error);\n    return { logs: [], total: 0 };\n  }\n}\n\nexport async function cleanupOldAuditLogs(daysToKeep: number = 90): Promise<number> {\n  try {\n    const cutoffDate = new Date();\n    cutoffDate.setDate(cutoffDate.getDate() - daysToKeep);\n    \n    const result = await db.execute(sql`\n      DELETE FROM audit_logs \n      WHERE created_at < ${cutoffDate}\n    `);\n    \n    return Number((result as any).rowCount || 0);\n  } catch (error) {\n    console.error(\"[AUDIT] Failed to cleanup old logs:\", error);\n    return 0;\n  }\n}\n\nexport async function checkDatabaseHealth(): Promise<{ healthy: boolean; latencyMs: number; error?: string }> {\n  const start = Date.now();\n  try {\n    await db.execute(sql`SELECT 1`);\n    return { healthy: true, latencyMs: Date.now() - start };\n  } catch (error) {\n    return { \n      healthy: false, \n      latencyMs: Date.now() - start, \n      error: error instanceof Error ? error.message : 'Unknown error' \n    };\n  }\n}\n\nexport async function getSystemHealth(): Promise<{\n  status: 'healthy' | 'degraded' | 'unhealthy';\n  database: { healthy: boolean; latencyMs: number };\n  memory: { usedMB: number; totalMB: number; percentUsed: number };\n  uptime: number;\n}> {\n  const dbHealth = await checkDatabaseHealth();\n  \n  const memUsage = process.memoryUsage();\n  const usedMB = Math.round(memUsage.heapUsed / 1024 / 1024);\n  const totalMB = Math.round(memUsage.heapTotal / 1024 / 1024);\n  const percentUsed = Math.round((memUsage.heapUsed / memUsage.heapTotal) * 100);\n  \n  let status: 'healthy' | 'degraded' | 'unhealthy' = 'healthy';\n  if (!dbHealth.healthy) {\n    status = 'unhealthy';\n  } else if (dbHealth.latencyMs > 1000 || percentUsed > 90) {\n    status = 'degraded';\n  }\n  \n  return {\n    status,\n    database: { healthy: dbHealth.healthy, latencyMs: dbHealth.latencyMs },\n    memory: { usedMB, totalMB, percentUsed },\n    uptime: process.uptime(),\n  };\n}\n\nexport function getClientIp(req: { ip?: string; headers: Record<string, string | string[] | undefined> }): string {\n  const forwarded = req.headers['x-forwarded-for'];\n  if (forwarded) {\n    const ip = Array.isArray(forwarded) ? forwarded[0] : forwarded.split(',')[0];\n    return ip.trim();\n  }\n  return req.ip || 'unknown';\n}\n", "import bcrypt from \"bcrypt\";\nimport crypto from \"crypto\";\nimport { db } from \"../db\";\nimport { users, passwordResetTokens, emailVerificationTokens, messages as messagesTable } from \"@shared/schema\";\nimport { eq, and, gt, sql } from \"drizzle-orm\";\nimport { sendEmail, getRegistrationOtpTemplate, getAdminNewRegistrationTemplate, getAccountLockedTemplate, getOtpEmailTemplate } from \"./email\";\nimport { EmailLanguage, getRegistrationOtpSubject, getOtpSubject, getPasswordResetSubject } from \"./email-translations\";\nimport { validatePassword } from \"./security\";\nimport { generateUniqueClientId, generateUniqueMessageId } from \"./id-generator\";\nexport { generateUniqueClientId };\n\nconst SALT_ROUNDS = 12;\nconst OTP_EXPIRY_MINUTES = 15;\nconst PASSWORD_RESET_EXPIRY_HOURS = 24;\n\n// Admin emails - ADMIN_EMAIL env var + fallback\nconst ADMIN_EMAILS = [\n  process.env.ADMIN_EMAIL?.toLowerCase(),\n  \"afortuny07@gmail.com\"\n].filter(Boolean) as string[];\n\nexport function isAdminEmail(email: string): boolean {\n  return ADMIN_EMAILS.includes(email.toLowerCase());\n}\n\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, SALT_ROUNDS);\n}\n\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n  return bcrypt.compare(password, hash);\n}\n\nexport function generateOtp(): string {\n  return Math.floor(100000 + Math.random() * 900000).toString();\n}\n\nexport function generateToken(): string {\n  return crypto.randomBytes(32).toString(\"hex\");\n}\n\nexport async function createUser(data: {\n  email: string;\n  password: string;\n  firstName: string;\n  lastName: string;\n  phone: string;\n  birthDate?: string;\n  businessActivity?: string;\n  clientId: string;\n  preferredLanguage?: string;\n}): Promise<{ user: typeof users.$inferSelect; verificationToken: string }> {\n  const passwordValidation = validatePassword(data.password);\n  if (!passwordValidation.valid) {\n    throw new Error(passwordValidation.message || \"Contrase\u00F1a no v\u00E1lida\");\n  }\n\n  const existingUser = await db.select().from(users).where(eq(users.email, data.email)).limit(1);\n  if (existingUser.length > 0) {\n    const existing = existingUser[0];\n    if (existing.isActive === false || existing.accountStatus === 'deactivated') {\n      const error = new Error(\"Tu cuenta ha sido desactivada. Contacta con nuestro equipo de soporte para m\u00E1s informaci\u00F3n.\");\n      (error as any).code = \"ACCOUNT_DEACTIVATED\";\n      throw error;\n    }\n    throw new Error(\"El email ya est\u00E1 registrado\");\n  }\n\n  const passwordHash = await hashPassword(data.password);\n  const isAdmin = isAdminEmail(data.email);\n\n  const [newUser] = await db.insert(users).values({\n    id: data.clientId,\n    clientId: data.clientId,\n    email: data.email,\n    passwordHash,\n    firstName: data.firstName,\n    lastName: data.lastName,\n    phone: data.phone,\n    businessActivity: data.businessActivity || null,\n    preferredLanguage: data.preferredLanguage || \"es\",\n    emailVerified: false,\n    isAdmin: isAdmin,\n    accountStatus: \"pending\",\n  }).returning();\n\n  const verificationToken = generateOtp();\n  const expiresAt = new Date(Date.now() + OTP_EXPIRY_MINUTES * 60 * 1000);\n\n  await db.insert(emailVerificationTokens).values({\n    userId: newUser.id,\n    token: verificationToken,\n    expiresAt,\n  });\n\n  const userLang = (data.preferredLanguage || 'es') as EmailLanguage;\n  try {\n    await sendEmail({\n      to: data.email,\n      subject: getRegistrationOtpSubject(userLang),\n      html: getRegistrationOtpTemplate(data.firstName, verificationToken, data.clientId, OTP_EXPIRY_MINUTES, userLang)\n    });\n\n    // Email notification to admin about new registration\n    const adminEmail = process.env.ADMIN_EMAIL || \"afortuny07@gmail.com\";\n    await sendEmail({\n      to: adminEmail,\n      subject: `[NUEVA CUENTA] ${data.firstName} ${data.lastName}`,\n      html: getAdminNewRegistrationTemplate(data.clientId, data.firstName, data.lastName, data.email, data.phone)\n    }).catch(() => {});\n\n  } catch (emailError) {\n    // Email error silenced\n  }\n\n  return { user: newUser, verificationToken };\n}\n\nasync function logActivity(title: string, data: any) {\n  if (process.env.NODE_ENV === 'development') {\n    console.log(`[AUTH] ${title}:`, data);\n  }\n}\n\nexport async function verifyEmailToken(userId: string, token: string): Promise<boolean> {\n  const [tokenRecord] = await db\n    .select()\n    .from(emailVerificationTokens)\n    .where(\n      and(\n        eq(emailVerificationTokens.userId, userId),\n        eq(emailVerificationTokens.token, token),\n        eq(emailVerificationTokens.used, false),\n        gt(emailVerificationTokens.expiresAt, new Date())\n      )\n    )\n    .limit(1);\n\n  if (!tokenRecord) {\n    return false;\n  }\n\n  const [user] = await db.select().from(users).where(eq(users.id, userId)).limit(1);\n  if (!user) {\n    return false;\n  }\n\n  await db.update(emailVerificationTokens)\n    .set({ used: true })\n    .where(eq(emailVerificationTokens.id, tokenRecord.id));\n\n  if (!user.emailVerified && user.accountStatus === \"pending\") {\n    await db.update(users)\n      .set({ \n        emailVerified: true, \n        accountStatus: \"active\",\n        updatedAt: new Date() \n      })\n      .where(eq(users.id, userId));\n  } else if (!user.emailVerified) {\n    await db.update(users)\n      .set({ \n        emailVerified: true, \n        updatedAt: new Date() \n      })\n      .where(eq(users.id, userId));\n  }\n\n  return true;\n}\n\nexport async function loginUser(email: string, password: string): Promise<typeof users.$inferSelect | null> {\n  const [user] = await db.select().from(users).where(eq(users.email, email)).limit(1);\n  \n  if (!user || !user.passwordHash) {\n    return null;\n  }\n\n  // Check if account is locked\n  if (user.lockUntil && user.lockUntil > new Date()) {\n    const error = new Error(\"ACCOUNT_LOCKED_TEMPORARILY\");\n    (error as any).locked = true;\n    (error as any).code = \"ACCOUNT_LOCKED\";\n    throw error;\n  }\n\n  if (user.isActive === false || user.accountStatus === 'deactivated') {\n    const error = new Error(\"ACCOUNT_DEACTIVATED\");\n    (error as any).locked = true;\n    (error as any).code = \"ACCOUNT_DEACTIVATED\";\n    (error as any).status = 403;\n    logActivity(\"Intento de Login en Cuenta Desactivada\", { userId: user.id, email: user.email });\n    throw error;\n  }\n\n  // Allow login for accounts under review, but with restricted access\n  // (restriction is handled in the routes, not here)\n\n  const isValid = await verifyPassword(password, user.passwordHash);\n  \n  if (!isValid) {\n    // Increment login attempts\n    const newAttempts = (user.loginAttempts || 0) + 1;\n    const updates: any = { loginAttempts: newAttempts };\n    \n    if (newAttempts >= 4) {\n      // Deactivate account after 4 failed attempts (permanent until admin review)\n      updates.accountStatus = 'deactivated';\n      updates.isActive = false;\n      updates.lockUntil = null;\n      \n      const msgId = await generateUniqueMessageId();\n\n      // Send deactivation email\n      try {\n        const secLang = ((user as any).preferredLanguage || 'es') as EmailLanguage;\n        const secSubjects: Record<string, string> = { en: 'Security Easy US LLC - Account Deactivated', ca: 'Seguretat Easy US LLC - Compte Desactivat', fr: 'S\u00E9curit\u00E9 Easy US LLC - Compte D\u00E9sactiv\u00E9', de: 'Sicherheit Easy US LLC - Konto Deaktiviert', it: 'Sicurezza Easy US LLC - Account Disattivato', pt: 'Seguran\u00E7a Easy US LLC - Conta Desativada' };\n        await sendEmail({\n          to: user.email!,\n          subject: secSubjects[secLang] || \"Seguridad Easy US LLC - Cuenta Desactivada\",\n          html: getAccountLockedTemplate(user.firstName || '', msgId)\n        });\n\n        // Add to messages for admin visibility\n        await db.insert(messagesTable).values({\n          userId: user.id,\n          name: \"Sistema de Seguridad\",\n          email: \"seguridad@easyusllc.com\",\n          subject: \"Cuenta Desactivada - 4 Intentos Fallidos\",\n          content: `Cuenta desactivada permanentemente por seguridad tras 4 intentos fallidos de inicio de sesi\u00F3n. Se requiere verificaci\u00F3n de identidad para reactivar. Ticket ID: ${msgId}`,\n          status: \"unread\",\n          type: \"support\",\n          messageId: msgId\n        });\n\n        logActivity(\"Cuenta Desactivada por Seguridad\", { userId: user.id, email: user.email, attempts: newAttempts });\n      } catch (e) {\n        console.error(\"Error handling account deactivation:\", e);\n      }\n    }\n    \n    await db.update(users).set(updates).where(eq(users.id, user.id));\n    return null;\n  }\n\n  // Reset attempts on successful login\n  if (user.loginAttempts > 0 || user.lockUntil) {\n    await db.update(users).set({ \n      loginAttempts: 0, \n      lockUntil: null,\n      accountStatus: user.accountStatus,\n      updatedAt: new Date()\n    }).where(eq(users.id, user.id));\n  }\n\n  return user;\n}\n\nexport async function createPasswordResetOtp(email: string): Promise<{ success: boolean; userId?: string }> {\n  const [user] = await db.select().from(users).where(eq(users.email, email)).limit(1);\n  \n  if (!user) {\n    return { success: false };\n  }\n\n  // Generate 6-digit OTP\n  const otp = Math.floor(100000 + Math.random() * 900000).toString();\n  const expiresAt = new Date(Date.now() + OTP_EXPIRY_MINUTES * 60 * 1000);\n\n  await db.insert(passwordResetTokens).values({\n    userId: user.id,\n    token: otp,\n    expiresAt,\n  });\n\n  const lang = ((user as any).preferredLanguage || 'es') as EmailLanguage;\n  try {\n    const { getOtpEmailTemplate } = await import(\"./email\");\n    await sendEmail({\n      to: email,\n      subject: getPasswordResetSubject(lang),\n      html: getOtpEmailTemplate(otp, user.firstName || undefined, lang),\n    });\n  } catch (emailError) {\n    // Email error silenced\n  }\n\n  return { success: true, userId: user.id };\n}\n\nexport async function verifyPasswordResetOtp(email: string, otp: string): Promise<boolean> {\n  const [user] = await db.select().from(users).where(eq(users.email, email)).limit(1);\n  if (!user) return false;\n\n  const [tokenRecord] = await db\n    .select()\n    .from(passwordResetTokens)\n    .where(\n      and(\n        eq(passwordResetTokens.userId, user.id),\n        eq(passwordResetTokens.token, otp),\n        eq(passwordResetTokens.used, false),\n        gt(passwordResetTokens.expiresAt, new Date())\n      )\n    )\n    .orderBy(sql`${passwordResetTokens.createdAt} DESC`)\n    .limit(1);\n\n  return !!tokenRecord;\n}\n\nexport async function resetPasswordWithOtp(email: string, otp: string, newPassword: string): Promise<boolean> {\n  const passwordValidation = validatePassword(newPassword);\n  if (!passwordValidation.valid) {\n    throw new Error(passwordValidation.message || \"Contrase\u00F1a no v\u00E1lida\");\n  }\n\n  const [user] = await db.select().from(users).where(eq(users.email, email)).limit(1);\n  if (!user) return false;\n\n  const [tokenRecord] = await db\n    .select()\n    .from(passwordResetTokens)\n    .where(\n      and(\n        eq(passwordResetTokens.userId, user.id),\n        eq(passwordResetTokens.token, otp),\n        eq(passwordResetTokens.used, false),\n        gt(passwordResetTokens.expiresAt, new Date())\n      )\n    )\n    .limit(1);\n\n  if (!tokenRecord) {\n    return false;\n  }\n\n  const passwordHash = await hashPassword(newPassword);\n\n  await db.update(passwordResetTokens)\n    .set({ used: true })\n    .where(eq(passwordResetTokens.id, tokenRecord.id));\n\n  // Also unlock account if it was locked due to too many attempts\n  await db.update(users)\n    .set({ \n      passwordHash, \n      updatedAt: new Date(),\n      loginAttempts: 0,\n      lockUntil: null,\n      accountStatus: 'active' \n    })\n    .where(eq(users.id, tokenRecord.userId));\n\n  return true;\n}\n\nexport async function resendVerificationEmail(userId: string): Promise<boolean> {\n  const [user] = await db.select().from(users).where(eq(users.id, userId)).limit(1);\n  \n  if (!user || !user.email) {\n    return false;\n  }\n\n  const verificationToken = generateOtp();\n  const expiresAt = new Date(Date.now() + OTP_EXPIRY_MINUTES * 60 * 1000);\n\n  await db.insert(emailVerificationTokens).values({\n    userId: user.id,\n    token: verificationToken,\n    expiresAt,\n  });\n\n  const lang = ((user as any).preferredLanguage || 'es') as EmailLanguage;\n  try {\n    await sendEmail({\n      to: user.email,\n      subject: getOtpSubject(lang),\n      html: getOtpEmailTemplate(verificationToken, user.firstName || undefined, lang)\n    });\n  } catch (emailError) {\n    // Email error silenced\n    return false;\n  }\n\n  return true;\n}\n", "import crypto from \"crypto\";\n\nconst ALGORITHM = \"aes-256-cbc\";\nconst IV_LENGTH = 16;\nconst HASH_ALGORITHM = \"sha256\";\n\nfunction getEncryptionKey(): Buffer {\n  const key = process.env.ENCRYPTION_KEY;\n  const isProduction = process.env.NODE_ENV === \"production\";\n  \n  if (!key && isProduction) {\n    throw new Error(\"ENCRYPTION_KEY environment variable is required in production\");\n  }\n  \n  if (!key) {\n    console.warn(\"\u26A0\uFE0F Using fallback encryption key for development. Set ENCRYPTION_KEY in production.\");\n    return Buffer.from(\"dev_fallback_key_32_chars_long!!\".slice(0, 32));\n  }\n  \n  if (key.length < 32) {\n    throw new Error(\"ENCRYPTION_KEY must be at least 32 characters long\");\n  }\n  \n  return Buffer.from(key.slice(0, 32));\n}\n\nexport function encrypt(text: string): string {\n  if (!text) return \"\";\n  const iv = crypto.randomBytes(IV_LENGTH);\n  const cipher = crypto.createCipheriv(ALGORITHM, getEncryptionKey(), iv);\n  let encrypted = cipher.update(text, \"utf8\");\n  encrypted = Buffer.concat([encrypted, cipher.final()]);\n  return iv.toString(\"hex\") + \":\" + encrypted.toString(\"hex\");\n}\n\nexport function decrypt(text: string): string {\n  if (!text || !text.includes(\":\")) return text;\n  try {\n    const textParts = text.split(\":\");\n    const iv = Buffer.from(textParts.shift()!, \"hex\");\n    const encryptedText = Buffer.from(textParts.join(\":\"), \"hex\");\n    const decipher = crypto.createDecipheriv(ALGORITHM, getEncryptionKey(), iv);\n    let decrypted = decipher.update(encryptedText);\n    decrypted = Buffer.concat([decrypted, decipher.final()]);\n    return decrypted.toString(\"utf8\");\n  } catch (error) {\n    console.error(\"[ENCRYPTION] Decrypt error - returning original text\");\n    return text;\n  }\n}\n\nexport function encryptBuffer(buffer: Buffer): { encrypted: Buffer; iv: string } {\n  const iv = crypto.randomBytes(IV_LENGTH);\n  const cipher = crypto.createCipheriv(ALGORITHM, getEncryptionKey(), iv);\n  const encrypted = Buffer.concat([cipher.update(buffer), cipher.final()]);\n  return { encrypted, iv: iv.toString(\"hex\") };\n}\n\nexport function decryptBuffer(encryptedBuffer: Buffer, ivHex: string): Buffer {\n  const iv = Buffer.from(ivHex, \"hex\");\n  const decipher = crypto.createDecipheriv(ALGORITHM, getEncryptionKey(), iv);\n  return Buffer.concat([decipher.update(encryptedBuffer), decipher.final()]);\n}\n\nexport function generateFileHash(buffer: Buffer): string {\n  return crypto.createHash(HASH_ALGORITHM).update(buffer).digest(\"hex\");\n}\n\nexport function verifyFileIntegrity(buffer: Buffer, expectedHash: string): boolean {\n  const actualHash = generateFileHash(buffer);\n  return actualHash === expectedHash;\n}\n\nexport function encryptSensitiveField(value: string | null | undefined): string | null {\n  if (!value || value.trim() === \"\") return null;\n  return encrypt(value);\n}\n\nexport function decryptSensitiveField(value: string | null | undefined): string | null {\n  if (!value) return null;\n  return decrypt(value);\n}\n\nexport interface EncryptedFileMetadata {\n  iv: string;\n  hash: string;\n  originalSize: number;\n  encryptedAt: string;\n}\n\nexport function encryptFileWithMetadata(buffer: Buffer): { \n  encryptedBuffer: Buffer; \n  metadata: EncryptedFileMetadata;\n} {\n  const hash = generateFileHash(buffer);\n  const { encrypted, iv } = encryptBuffer(buffer);\n  \n  return {\n    encryptedBuffer: encrypted,\n    metadata: {\n      iv,\n      hash,\n      originalSize: buffer.length,\n      encryptedAt: new Date().toISOString()\n    }\n  };\n}\n\nexport function decryptFileWithVerification(\n  encryptedBuffer: Buffer, \n  metadata: EncryptedFileMetadata\n): { buffer: Buffer; verified: boolean } {\n  const decrypted = decryptBuffer(encryptedBuffer, metadata.iv);\n  const verified = verifyFileIntegrity(decrypted, metadata.hash);\n  \n  if (!verified) {\n    console.error(\"[ENCRYPTION] File integrity verification failed!\");\n  }\n  \n  return { buffer: decrypted, verified };\n}\n\nexport function maskSensitiveData(value: string, visibleChars: number = 4): string {\n  if (!value || value.length <= visibleChars) return \"****\";\n  return \"*\".repeat(value.length - visibleChars) + value.slice(-visibleChars);\n}\n\nexport function isEncrypted(text: string): boolean {\n  if (!text) return false;\n  const parts = text.split(\":\");\n  if (parts.length !== 2) return false;\n  return /^[a-f0-9]{32}$/.test(parts[0]);\n}\n", "import { db } from \"./db\";\nimport { llcApplications, orders, userNotifications, users, maintenanceApplications } from \"@shared/schema\";\nimport { eq, and, lte, gte, isNotNull, sql } from \"drizzle-orm\";\nimport { getRenewalReminderTemplate, queueEmail } from \"./lib/email\";\n\nexport interface ComplianceDeadline {\n  type: \"irs_1120\" | \"irs_5472\" | \"annual_report\" | \"agent_renewal\";\n  dueDate: Date;\n  reminderDate: Date;\n  description: string;\n  state?: string;\n}\n\nexport function calculateComplianceDeadlines(formationDate: Date, state: string, hasTaxExtension: boolean = false): ComplianceDeadline[] {\n  const deadlines: ComplianceDeadline[] = [];\n  const formationYear = formationDate.getFullYear();\n\n  // Tax deadlines: April 15 normally, October 15 with 6-month extension\n  const taxMonth = hasTaxExtension ? 9 : 3; // October (9) with extension, April (3) without\n  const taxDay = 15;\n\n  const irs1120DueDate = new Date(formationYear + 1, taxMonth, taxDay);\n  const irs1120ReminderDate = new Date(irs1120DueDate);\n  irs1120ReminderDate.setDate(irs1120ReminderDate.getDate() - 60);\n\n  const extensionNote = hasTaxExtension ? \" (con extensi\u00F3n de 6 meses)\" : \"\";\n\n  deadlines.push({\n    type: \"irs_1120\",\n    dueDate: irs1120DueDate,\n    reminderDate: irs1120ReminderDate,\n    description: `Presentaci\u00F3n del formulario IRS 1120 (Declaraci\u00F3n de impuestos corporativos)${extensionNote}`,\n  });\n\n  const irs5472DueDate = new Date(formationYear + 1, taxMonth, taxDay);\n  const irs5472ReminderDate = new Date(irs5472DueDate);\n  irs5472ReminderDate.setDate(irs5472ReminderDate.getDate() - 60);\n\n  deadlines.push({\n    type: \"irs_5472\",\n    dueDate: irs5472DueDate,\n    reminderDate: irs5472ReminderDate,\n    description: `Presentaci\u00F3n del formulario IRS 5472 (Declaraci\u00F3n de transacciones con propietarios extranjeros)${extensionNote}`,\n  });\n\n  // Annual Report: only Delaware and Wyoming\n  // Delaware: June 1st of the year following formation\n  // Wyoming: Anniversary of LLC formation\n  if (state === \"delaware\" || state === \"DE\" || state === \"Delaware\") {\n    const annualReportDueDate = new Date(formationYear + 1, 5, 1); // June 1st\n    const annualReportReminderDate = new Date(annualReportDueDate);\n    annualReportReminderDate.setDate(annualReportReminderDate.getDate() - 60);\n\n    deadlines.push({\n      type: \"annual_report\",\n      dueDate: annualReportDueDate,\n      reminderDate: annualReportReminderDate,\n      description: \"Informe Anual del estado de Delaware\",\n      state: \"Delaware\",\n    });\n  } else if (state === \"wyoming\" || state === \"WY\" || state === \"Wyoming\") {\n    // Wyoming: Anniversary date of formation\n    const annualReportDueDate = new Date(formationDate);\n    annualReportDueDate.setFullYear(annualReportDueDate.getFullYear() + 1);\n    const annualReportReminderDate = new Date(annualReportDueDate);\n    annualReportReminderDate.setDate(annualReportReminderDate.getDate() - 60);\n\n    deadlines.push({\n      type: \"annual_report\",\n      dueDate: annualReportDueDate,\n      reminderDate: annualReportReminderDate,\n      description: \"Informe Anual del estado de Wyoming\",\n      state: \"Wyoming\",\n    });\n  }\n  // New Mexico: No annual report required\n\n  const agentRenewalDate = new Date(formationDate);\n  agentRenewalDate.setFullYear(agentRenewalDate.getFullYear() + 1);\n  const agentRenewalReminderDate = new Date(agentRenewalDate);\n  agentRenewalReminderDate.setDate(agentRenewalReminderDate.getDate() - 60);\n\n  deadlines.push({\n    type: \"agent_renewal\",\n    dueDate: agentRenewalDate,\n    reminderDate: agentRenewalReminderDate,\n    description: \"Renovaci\u00F3n del Agente Registrado\",\n  });\n\n  return deadlines;\n}\n\nexport async function updateApplicationDeadlines(applicationId: number, formationDate: Date, state: string, hasTaxExtension: boolean = false) {\n  const deadlines = calculateComplianceDeadlines(formationDate, state, hasTaxExtension);\n\n  const irs1120Deadline = deadlines.find(d => d.type === \"irs_1120\");\n  const irs5472Deadline = deadlines.find(d => d.type === \"irs_5472\");\n  const annualReportDeadline = deadlines.find(d => d.type === \"annual_report\");\n  const agentRenewalDeadline = deadlines.find(d => d.type === \"agent_renewal\");\n\n  await db.update(llcApplications).set({\n    llcCreatedDate: formationDate,\n    irs1120DueDate: irs1120Deadline?.dueDate,\n    irs5472DueDate: irs5472Deadline?.dueDate,\n    annualReportDueDate: annualReportDeadline?.dueDate,\n    agentRenewalDate: agentRenewalDeadline?.dueDate,\n    lastUpdated: new Date(),\n  }).where(eq(llcApplications.id, applicationId));\n\n  return deadlines;\n}\n\nexport async function checkAndSendReminders() {\n  const today = new Date();\n  const reminderWindowStart = new Date(today);\n  reminderWindowStart.setDate(reminderWindowStart.getDate() + 55);\n  const reminderWindowEnd = new Date(today);\n  reminderWindowEnd.setDate(reminderWindowEnd.getDate() + 65);\n\n  const applicationsWithIRS1120 = await db.select({\n    application: llcApplications,\n    order: orders,\n  })\n  .from(llcApplications)\n  .innerJoin(orders, eq(llcApplications.orderId, orders.id))\n  .where(\n    and(\n      isNotNull(llcApplications.irs1120DueDate),\n      gte(llcApplications.irs1120DueDate, reminderWindowStart),\n      lte(llcApplications.irs1120DueDate, reminderWindowEnd)\n    )\n  );\n\n  for (const { application, order } of applicationsWithIRS1120) {\n    const daysUntilDue = Math.ceil((application.irs1120DueDate!.getTime() - today.getTime()) / (1000 * 60 * 60 * 24));\n    await createComplianceNotification(\n      order.userId,\n      order.id,\n      application.requestCode || `LLC-${application.id}`,\n      \"irs_1120\",\n      `i18n:ntf.compliance.irs1120.title::{\"days\":\"${daysUntilDue}\"}`,\n      `i18n:ntf.compliance.irs1120.message::{\"companyName\":\"${application.companyName || ''}\",\"dueDate\":\"${formatDate(application.irs1120DueDate!)}\"}`\n    );\n  }\n\n  const applicationsWithIRS5472 = await db.select({\n    application: llcApplications,\n    order: orders,\n  })\n  .from(llcApplications)\n  .innerJoin(orders, eq(llcApplications.orderId, orders.id))\n  .where(\n    and(\n      isNotNull(llcApplications.irs5472DueDate),\n      gte(llcApplications.irs5472DueDate, reminderWindowStart),\n      lte(llcApplications.irs5472DueDate, reminderWindowEnd)\n    )\n  );\n\n  for (const { application, order } of applicationsWithIRS5472) {\n    const daysUntilDue = Math.ceil((application.irs5472DueDate!.getTime() - today.getTime()) / (1000 * 60 * 60 * 24));\n    await createComplianceNotification(\n      order.userId,\n      order.id,\n      application.requestCode || `LLC-${application.id}`,\n      \"irs_5472\",\n      `i18n:ntf.compliance.irs5472.title::{\"days\":\"${daysUntilDue}\"}`,\n      `i18n:ntf.compliance.irs5472.message::{\"companyName\":\"${application.companyName || ''}\",\"dueDate\":\"${formatDate(application.irs5472DueDate!)}\"}`\n    );\n  }\n\n  const applicationsWithAnnualReport = await db.select({\n    application: llcApplications,\n    order: orders,\n  })\n  .from(llcApplications)\n  .innerJoin(orders, eq(llcApplications.orderId, orders.id))\n  .where(\n    and(\n      isNotNull(llcApplications.annualReportDueDate),\n      gte(llcApplications.annualReportDueDate, reminderWindowStart),\n      lte(llcApplications.annualReportDueDate, reminderWindowEnd)\n    )\n  );\n\n  for (const { application, order } of applicationsWithAnnualReport) {\n    const daysUntilDue = Math.ceil((application.annualReportDueDate!.getTime() - today.getTime()) / (1000 * 60 * 60 * 24));\n    const stateLabel = application.state === \"wyoming\" || application.state === \"WY\" ? \"Wyoming\" : \"New Mexico\";\n    await createComplianceNotification(\n      order.userId,\n      order.id,\n      application.requestCode || `LLC-${application.id}`,\n      \"annual_report\",\n      `i18n:ntf.compliance.annualReport.title::{\"stateLabel\":\"${stateLabel}\",\"days\":\"${daysUntilDue}\"}`,\n      `i18n:ntf.compliance.annualReport.message::{\"companyName\":\"${application.companyName || ''}\",\"stateLabel\":\"${stateLabel}\",\"dueDate\":\"${formatDate(application.annualReportDueDate!)}\"}`\n    );\n  }\n\n  const applicationsWithAgentRenewal = await db.select({\n    application: llcApplications,\n    order: orders,\n  })\n  .from(llcApplications)\n  .innerJoin(orders, eq(llcApplications.orderId, orders.id))\n  .where(\n    and(\n      isNotNull(llcApplications.agentRenewalDate),\n      gte(llcApplications.agentRenewalDate, reminderWindowStart),\n      lte(llcApplications.agentRenewalDate, reminderWindowEnd)\n    )\n  );\n\n  for (const { application, order } of applicationsWithAgentRenewal) {\n    const daysUntilDue = Math.ceil((application.agentRenewalDate!.getTime() - today.getTime()) / (1000 * 60 * 60 * 24));\n    await createComplianceNotification(\n      order.userId,\n      order.id,\n      application.requestCode || `LLC-${application.id}`,\n      \"agent_renewal\",\n      `i18n:ntf.compliance.agentRenewal.title::{\"days\":\"${daysUntilDue}\"}`,\n      `i18n:ntf.compliance.agentRenewal.message::{\"companyName\":\"${application.companyName || ''}\",\"dueDate\":\"${formatDate(application.agentRenewalDate!)}\"}`\n    );\n  }\n\n  // Also send renewal reminders for maintenance packages\n  const renewalResult = await sendRenewalReminders();\n  \n  return { checked: true, timestamp: today, renewalRemindersSent: renewalResult.remindersSent };\n}\n\nasync function createComplianceNotification(\n  userId: string,\n  orderId: number,\n  orderCode: string,\n  type: string,\n  title: string,\n  message: string\n) {\n  const ticketId = `COMP-${type.toUpperCase()}-${orderId}-${Date.now()}`;\n\n  const existing = await db.select().from(userNotifications).where(\n    and(\n      eq(userNotifications.userId, userId),\n      eq(userNotifications.orderId, orderId),\n      sql`${userNotifications.type} = ${'compliance_' + type}`,\n      sql`${userNotifications.createdAt} > NOW() - INTERVAL '30 days'`\n    )\n  ).limit(1);\n\n  if (existing.length > 0) {\n    return null;\n  }\n\n  await db.insert(userNotifications).values({\n    userId,\n    orderId,\n    orderCode,\n    ticketId,\n    type: `compliance_${type}`,\n    title,\n    message,\n    isRead: false,\n    actionUrl: `/dashboard/orders/${orderId}`,\n  });\n\n  return ticketId;\n}\n\nfunction formatDate(date: Date): string {\n  return date.toLocaleDateString(\"es-ES\", {\n    day: \"numeric\",\n    month: \"long\",\n    year: \"numeric\"\n  });\n}\n\n// Check for expired renewals - optimized with single query\nexport async function checkExpiredRenewals() {\n  const today = new Date();\n  \n  // Get all completed LLC applications with renewal dates in the past\n  const expiredApplications = await db.select({\n    application: llcApplications,\n    order: orders,\n    user: users,\n  })\n  .from(llcApplications)\n  .innerJoin(orders, eq(llcApplications.orderId, orders.id))\n  .innerJoin(users, eq(orders.userId, users.id))\n  .where(\n    and(\n      isNotNull(llcApplications.agentRenewalDate),\n      lte(llcApplications.agentRenewalDate, today),\n      eq(orders.status, \"completed\"),\n      eq(users.accountStatus, \"active\") // Only check active users\n    )\n  );\n\n  // Get all maintenance applications in a single query\n  const allMaintenanceApps = await db.select({\n    maintApp: maintenanceApplications,\n    maintOrder: orders,\n  })\n  .from(maintenanceApplications)\n  .innerJoin(orders, eq(maintenanceApplications.orderId, orders.id))\n  .where(eq(orders.status, \"completed\"));\n\n  const expiredList = [];\n  \n  for (const { application, order, user } of expiredApplications) {\n    // Check if there's a maintenance app for the same state created within renewal window\n    // (60 days before renewal date or any time after)\n    const renewalDate = new Date(application.agentRenewalDate!);\n    const sixtyDaysBeforeRenewal = new Date(renewalDate);\n    sixtyDaysBeforeRenewal.setDate(sixtyDaysBeforeRenewal.getDate() - 60);\n    \n    const hasRenewal = allMaintenanceApps.some(({ maintApp, maintOrder }) => \n      maintOrder.userId === user.id &&\n      maintApp.state === application.state &&\n      new Date(maintOrder.createdAt!) >= sixtyDaysBeforeRenewal\n    );\n    \n    if (!hasRenewal) {\n      const daysSinceExpiry = Math.ceil((today.getTime() - new Date(application.agentRenewalDate!).getTime()) / (1000 * 60 * 60 * 24));\n      expiredList.push({\n        userId: user.id,\n        clientId: user.clientId,\n        email: user.email,\n        firstName: user.firstName,\n        lastName: user.lastName,\n        companyName: application.companyName,\n        state: application.state,\n        llcCreatedDate: application.llcCreatedDate,\n        agentRenewalDate: application.agentRenewalDate,\n        daysSinceExpiry,\n        orderId: order.id,\n        applicationId: application.id,\n        accountStatus: user.accountStatus,\n      });\n    }\n  }\n\n  return expiredList;\n}\n\n// Get clients needing renewal (within 90 days of expiry or already expired) - optimized\nexport async function getClientsNeedingRenewal() {\n  const today = new Date();\n  const ninetyDaysFromNow = new Date(today);\n  ninetyDaysFromNow.setDate(ninetyDaysFromNow.getDate() + 90);\n\n  const applicationsNeedingRenewal = await db.select({\n    application: llcApplications,\n    order: orders,\n    user: users,\n  })\n  .from(llcApplications)\n  .innerJoin(orders, eq(llcApplications.orderId, orders.id))\n  .innerJoin(users, eq(orders.userId, users.id))\n  .where(\n    and(\n      isNotNull(llcApplications.agentRenewalDate),\n      lte(llcApplications.agentRenewalDate, ninetyDaysFromNow),\n      eq(orders.status, \"completed\"),\n      eq(users.accountStatus, \"active\") // Only check active users\n    )\n  );\n\n  // Get all maintenance applications in a single query\n  const allMaintenanceApps = await db.select({\n    maintApp: maintenanceApplications,\n    maintOrder: orders,\n  })\n  .from(maintenanceApplications)\n  .innerJoin(orders, eq(maintenanceApplications.orderId, orders.id))\n  .where(eq(orders.status, \"completed\"));\n\n  const result = [];\n  \n  for (const { application, order, user } of applicationsNeedingRenewal) {\n    // Check if there's a maintenance app for the same state created within renewal window\n    // (i.e., after formation date but meant to cover the renewal period)\n    const renewalDate = new Date(application.agentRenewalDate!);\n    const sixtyDaysBeforeRenewal = new Date(renewalDate);\n    sixtyDaysBeforeRenewal.setDate(sixtyDaysBeforeRenewal.getDate() - 60);\n    \n    const hasRenewal = allMaintenanceApps.some(({ maintApp, maintOrder }) => \n      maintOrder.userId === user.id &&\n      maintApp.state === application.state &&\n      new Date(maintOrder.createdAt!) >= sixtyDaysBeforeRenewal // Renewal order created within renewal window\n    );\n    \n    if (!hasRenewal) {\n      const daysUntilExpiry = Math.ceil((new Date(application.agentRenewalDate!).getTime() - today.getTime()) / (1000 * 60 * 60 * 24));\n      result.push({\n        userId: user.id,\n        clientId: user.clientId,\n        email: user.email,\n        firstName: user.firstName,\n        lastName: user.lastName,\n        companyName: application.companyName,\n        state: application.state,\n        llcCreatedDate: application.llcCreatedDate,\n        agentRenewalDate: application.agentRenewalDate,\n        daysUntilExpiry,\n        isExpired: daysUntilExpiry < 0,\n        orderId: order.id,\n        applicationId: application.id,\n        accountStatus: user.accountStatus,\n      });\n    }\n  }\n\n  return result.sort((a, b) => a.daysUntilExpiry - b.daysUntilExpiry);\n}\n\n// Send renewal reminder notifications (called by scheduled job)\n// Sends reminders at 60 days, 30 days, and 7 days before renewal date\nexport async function sendRenewalReminders() {\n  const clientsNeedingRenewal = await getClientsNeedingRenewal();\n  let remindersSent = 0;\n\n  for (const client of clientsNeedingRenewal) {\n    // Skip expired clients - they need different handling\n    if (client.daysUntilExpiry < 0) continue;\n    \n    // Send reminders at 60 days, 30 days, and 7 days before expiry\n    const reminderWindows = [\n      { min: 55, max: 65, type: \"renewal_60days\", label: \"60 d\u00EDas\" },\n      { min: 25, max: 35, type: \"renewal_30days\", label: \"30 d\u00EDas\" },\n      { min: 5, max: 10, type: \"renewal_7days\", label: \"una semana\" },\n    ];\n    \n    for (const window of reminderWindows) {\n      if (client.daysUntilExpiry >= window.min && client.daysUntilExpiry <= window.max) {\n        // Create in-app notification (translated on frontend via i18n keys)\n        await createComplianceNotification(\n          client.userId,\n          client.orderId,\n          `LLC-${client.applicationId}`,\n          window.type,\n          `i18n:ntf.compliance.renewalPending.title::{\"label\":\"${window.label}\"}`,\n          `i18n:ntf.compliance.renewalPending.message::{\"companyName\":\"${client.companyName || ''}\",\"dueDate\":\"${formatDate(new Date(client.agentRenewalDate!))}\"}`\n        );\n        \n        // Send email notification\n        if (client.email && client.companyName) {\n          const emailHtml = getRenewalReminderTemplate(\n            client.firstName || \"Cliente\",\n            client.companyName,\n            window.label,\n            formatDate(new Date(client.agentRenewalDate!)),\n            client.state || \"New Mexico\"\n          );\n          queueEmail({\n            to: client.email,\n            subject: `Renovaci\u00F3n LLC ${client.companyName} - Vence en ${window.label}`,\n            html: emailHtml\n          });\n        }\n        \n        remindersSent++;\n        break; // Only one reminder per window per client\n      }\n    }\n  }\n\n  return { remindersSent };\n}\n\nexport function getUpcomingDeadlinesForUser(applications: any[]): any[] {\n  const today = new Date();\n  const deadlines: any[] = [];\n\n  for (const app of applications) {\n    if (app.llcCreatedDate) {\n      const companyName = app.companyName || \"Tu LLC\";\n\n      if (app.irs1120DueDate) {\n        const daysUntil = Math.ceil((new Date(app.irs1120DueDate).getTime() - today.getTime()) / (1000 * 60 * 60 * 24));\n        if (daysUntil > 0 && daysUntil <= 365) {\n          deadlines.push({\n            type: \"irs_1120\",\n            title: \"IRS Form 1120\",\n            description: `Declaraci\u00F3n de impuestos para ${companyName}`,\n            dueDate: app.irs1120DueDate,\n            daysUntil,\n            urgency: daysUntil <= 30 ? \"urgent\" : daysUntil <= 60 ? \"warning\" : \"normal\",\n            applicationId: app.id,\n          });\n        }\n      }\n\n      if (app.irs5472DueDate) {\n        const daysUntil = Math.ceil((new Date(app.irs5472DueDate).getTime() - today.getTime()) / (1000 * 60 * 60 * 24));\n        if (daysUntil > 0 && daysUntil <= 365) {\n          deadlines.push({\n            type: \"irs_5472\",\n            title: \"IRS Form 5472\",\n            description: `Declaraci\u00F3n de transacciones para ${companyName}`,\n            dueDate: app.irs5472DueDate,\n            daysUntil,\n            urgency: daysUntil <= 30 ? \"urgent\" : daysUntil <= 60 ? \"warning\" : \"normal\",\n            applicationId: app.id,\n          });\n        }\n      }\n\n      if (app.annualReportDueDate) {\n        const daysUntil = Math.ceil((new Date(app.annualReportDueDate).getTime() - today.getTime()) / (1000 * 60 * 60 * 24));\n        if (daysUntil > 0 && daysUntil <= 365) {\n          const stateLabel = app.state === \"wyoming\" || app.state === \"WY\" ? \"Wyoming\" : \"Nuevo M\u00E9xico\";\n          deadlines.push({\n            type: \"annual_report\",\n            title: `Informe Anual (${stateLabel})`,\n            description: `Informe anual del estado para ${companyName}`,\n            dueDate: app.annualReportDueDate,\n            daysUntil,\n            urgency: daysUntil <= 30 ? \"urgent\" : daysUntil <= 60 ? \"warning\" : \"normal\",\n            applicationId: app.id,\n            state: stateLabel,\n          });\n        }\n      }\n\n      if (app.agentRenewalDate) {\n        const daysUntil = Math.ceil((new Date(app.agentRenewalDate).getTime() - today.getTime()) / (1000 * 60 * 60 * 24));\n        if (daysUntil > 0 && daysUntil <= 365) {\n          deadlines.push({\n            type: \"agent_renewal\",\n            title: \"Renovaci\u00F3n Agente Registrado\",\n            description: `Renovaci\u00F3n anual del agente para ${companyName}`,\n            dueDate: app.agentRenewalDate,\n            daysUntil,\n            urgency: daysUntil <= 30 ? \"urgent\" : daysUntil <= 60 ? \"warning\" : \"normal\",\n            applicationId: app.id,\n          });\n        }\n      }\n    }\n  }\n\n  return deadlines.sort((a, b) => a.daysUntil - b.daysUntil);\n}\n", "import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\n\nconst rootDir = process.cwd();\n\nexport default defineConfig({\n  plugins: [\n    react(),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(rootDir, \"client\", \"src\"),\n      \"@shared\": path.resolve(rootDir, \"shared\"),\n      \"@assets\": path.resolve(rootDir, \"client\", \"src\", \"assets\"),\n    },\n  },\n  root: path.resolve(rootDir, \"client\"),\n  build: {\n    outDir: path.resolve(rootDir, \"dist/public\"),\n    emptyOutDir: true,\n    reportCompressedSize: false,\n    chunkSizeWarningLimit: 1000,\n    target: 'es2020',\n    minify: 'esbuild',\n    cssMinify: true,\n    cssCodeSplit: true,\n    sourcemap: false,\n    rollupOptions: {\n      output: {\n        manualChunks(id) {\n          if (id.includes('node_modules')) {\n            if (id.includes('react-dom')) return 'react-dom';\n            if (id.includes('react/') || id.includes('/react.')) return 'react-core';\n            if (id.includes('framer-motion')) return 'framer-motion';\n            if (id.includes('@radix-ui')) return 'radix-ui';\n            if (id.includes('lucide-react')) return 'lucide';\n            if (id.includes('@tanstack')) return 'tanstack';\n            if (id.includes('react-hook-form') || id.includes('@hookform')) return 'forms';\n            if (id.includes('zod') || id.includes('drizzle')) return 'validation';\n            if (id.includes('i18next')) return 'i18n';\n            if (id.includes('date-fns')) return 'date-utils';\n            if (id.includes('jspdf')) return 'pdf';\n          }\n          if (id.includes('/components/ui/')) return 'ui-components';\n        },\n        chunkFileNames: 'assets/[name]-[hash].js',\n        entryFileNames: 'assets/[name]-[hash].js',\n        assetFileNames: 'assets/[name]-[hash].[ext]',\n      }\n    }\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n    allowedHosts: true,\n  },\n});\n", "let urlAlphabet =\n  'useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict'\nexport { urlAlphabet }\n", "import crypto from 'crypto'\nimport { urlAlphabet } from './url-alphabet/index.js'\nconst POOL_SIZE_MULTIPLIER = 128\nlet pool, poolOffset\nlet fillPool = bytes => {\n  if (!pool || pool.length < bytes) {\n    pool = Buffer.allocUnsafe(bytes * POOL_SIZE_MULTIPLIER)\n    crypto.randomFillSync(pool)\n    poolOffset = 0\n  } else if (poolOffset + bytes > pool.length) {\n    crypto.randomFillSync(pool)\n    poolOffset = 0\n  }\n  poolOffset += bytes\n}\nlet random = bytes => {\n  fillPool((bytes |= 0))\n  return pool.subarray(poolOffset - bytes, poolOffset)\n}\nlet customRandom = (alphabet, defaultSize, getRandom) => {\n  let mask = (2 << (31 - Math.clz32((alphabet.length - 1) | 1))) - 1\n  let step = Math.ceil((1.6 * mask * defaultSize) / alphabet.length)\n  return (size = defaultSize) => {\n    let id = ''\n    while (true) {\n      let bytes = getRandom(step)\n      let i = step\n      while (i--) {\n        id += alphabet[bytes[i] & mask] || ''\n        if (id.length === size) return id\n      }\n    }\n  }\n}\nlet customAlphabet = (alphabet, size = 21) =>\n  customRandom(alphabet, size, random)\nlet nanoid = (size = 21) => {\n  fillPool((size |= 0))\n  let id = ''\n  for (let i = poolOffset - size; i < poolOffset; i++) {\n    id += urlAlphabet[pool[i] & 63]\n  }\n  return id\n}\nexport { nanoid, customAlphabet, customRandom, urlAlphabet, random }\n", "import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst rootDir = process.cwd();\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        rootDir,\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n", "import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\nimport compression from \"compression\";\nimport { initServerSentry } from \"./lib/sentry\";\nimport { scheduleBackups } from \"./lib/backup\";\nimport { cleanupDbRateLimits } from \"./lib/rate-limiter\";\nimport { setupSitemapRoute } from \"./sitemap\";\n\ninitServerSentry();\n\nconst app = express();\nconst isProduction = process.env.NODE_ENV === \"production\";\n\nconst httpServer = createServer(app);\n\napp.use(compression());\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nfunction getCSP(): string {\n  const baseCSP = {\n    \"default-src\": [\"'self'\"],\n    \"font-src\": [\"'self'\", \"https://fonts.gstatic.com\", \"data:\"],\n    \"img-src\": [\"'self'\", \"data:\", \"blob:\", \"https://*.stripe.com\", \"https://lh3.googleusercontent.com\"],\n    \"connect-src\": [\"'self'\", \"https://api.stripe.com\", \"https://accounts.google.com\", \"wss://*.replit.dev\", \"wss://*.replit.app\"],\n    \"frame-src\": [\"'self'\", \"https://js.stripe.com\", \"https://accounts.google.com\"],\n    \"frame-ancestors\": [\"'self'\", \"https://*.replit.dev\", \"https://*.replit.app\"],\n  };\n\n  if (isProduction) {\n    return [\n      `default-src ${baseCSP[\"default-src\"].join(\" \")}`,\n      `script-src 'self' https://js.stripe.com https://accounts.google.com`,\n      `style-src 'self' 'unsafe-inline' https://fonts.googleapis.com`,\n      `font-src ${baseCSP[\"font-src\"].join(\" \")}`,\n      `img-src ${baseCSP[\"img-src\"].join(\" \")}`,\n      `connect-src ${baseCSP[\"connect-src\"].join(\" \")}`,\n      `frame-src ${baseCSP[\"frame-src\"].join(\" \")}`,\n      `frame-ancestors ${baseCSP[\"frame-ancestors\"].join(\" \")}`,\n    ].join(\"; \");\n  } else {\n    return [\n      `default-src ${baseCSP[\"default-src\"].join(\" \")}`,\n      `script-src 'self' 'unsafe-inline' 'unsafe-eval' https://js.stripe.com https://accounts.google.com`,\n      `style-src 'self' 'unsafe-inline' https://fonts.googleapis.com`,\n      `font-src ${baseCSP[\"font-src\"].join(\" \")}`,\n      `img-src ${baseCSP[\"img-src\"].join(\" \")}`,\n      `connect-src ${baseCSP[\"connect-src\"].join(\" \")}`,\n      `frame-src ${baseCSP[\"frame-src\"].join(\" \")}`,\n      `frame-ancestors ${baseCSP[\"frame-ancestors\"].join(\" \")}`,\n    ].join(\"; \");\n  }\n}\n\napp.use((req, res, next) => {\n  res.setHeader(\"X-Content-Type-Options\", \"nosniff\");\n  res.setHeader(\"X-Frame-Options\", \"SAMEORIGIN\");\n  res.setHeader(\"X-XSS-Protection\", \"1; mode=block\");\n  res.setHeader(\"Strict-Transport-Security\", \"max-age=31536000; includeSubDomains; preload\");\n  res.setHeader(\"Content-Security-Policy\", getCSP());\n  res.setHeader(\"Referrer-Policy\", \"strict-origin-when-cross-origin\");\n  res.setHeader(\"Permissions-Policy\", \"camera=(), microphone=(), geolocation=(), payment=()\");\n  res.setHeader(\"Cross-Origin-Opener-Policy\", \"same-origin-allow-popups\");\n  res.setHeader(\"Cross-Origin-Resource-Policy\", \"same-origin\");\n  \n  // Performance Headers\n  if (req.method === 'GET') {\n    const isAsset = req.path.startsWith('/assets/') || req.path.match(/\\.(jpg|jpeg|png|gif|svg|webp|ico|css|js|woff2|woff)$/);\n    const isStaticFile = req.path.match(/\\.(png|jpg|jpeg|gif|svg|webp|ico|woff2|woff|ttf|eot)$/);\n    const isSeoFile = req.path === '/robots.txt' || req.path.startsWith('/sitemap');\n    const isJS = req.path.match(/\\.js$/);\n    const isCSS = req.path.match(/\\.css$/);\n    \n    if (isAsset) {\n      res.setHeader('Cache-Control', 'public, max-age=31536000, immutable');\n      res.setHeader('Vary', 'Accept-Encoding');\n    } else if (isStaticFile) {\n      res.setHeader('Cache-Control', 'public, max-age=31536000, immutable');\n    } else if (isSeoFile) {\n      res.setHeader('Cache-Control', 'public, max-age=86400, stale-while-revalidate=604800');\n      res.setHeader('X-Robots-Tag', 'all');\n    }\n    \n    // Content-type specific optimizations\n    if (isJS) {\n      res.setHeader('X-Content-Type-Options', 'nosniff');\n    }\n    if (isCSS) {\n      res.setHeader('X-Content-Type-Options', 'nosniff');\n    }\n    \n    res.setHeader(\"X-DNS-Prefetch-Control\", \"on\");\n    \n    // Resource hints via Link header\n    const linkHints = [\n      '</logo-icon.png>; rel=preload; as=image; fetchpriority=high',\n      '<https://fonts.googleapis.com>; rel=preconnect',\n      '<https://fonts.gstatic.com>; rel=preconnect; crossorigin',\n      '<https://js.stripe.com>; rel=preconnect',\n    ];\n    res.setHeader(\"Link\", linkHints.join(', '));\n  }\n  \n  // SEO Headers for main pages\n  const seoPages = ['/', '/servicios', '/faq', '/contacto', '/llc/formation', '/llc/maintenance'];\n  if (seoPages.includes(req.path)) {\n    res.setHeader('X-Robots-Tag', 'index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1');\n    // Append canonical to existing Link header (don't overwrite preconnect hints)\n    const existingLinkRaw = res.getHeader('Link');\n    const existingLink = Array.isArray(existingLinkRaw) ? existingLinkRaw.join(', ') : (existingLinkRaw || '');\n    const canonicalLink = `<https://easyusllc.com${req.path}>; rel=\"canonical\"`;\n    res.setHeader('Link', existingLink ? `${existingLink}, ${canonicalLink}` : canonicalLink);\n  }\n  \n  // Noindex for private/auth pages\n  const noindexPages = ['/dashboard', '/admin', '/auth/forgot-password'];\n  if (noindexPages.some(p => req.path.startsWith(p))) {\n    res.setHeader('X-Robots-Tag', 'noindex, nofollow');\n  }\n  \n  // Prevent caching of API responses\n  if (req.path.startsWith('/api/')) {\n    res.setHeader('Cache-Control', 'no-store, no-cache, must-revalidate, proxy-revalidate');\n    res.setHeader('Pragma', 'no-cache');\n    res.setHeader('Expires', '0');\n  }\n  \n  next();\n});\n\n(async () => {\n  await registerRoutes(httpServer, app);\n  \n  setupSitemapRoute(app);\n\n  // Simple WebSocket logging for admin panel\n  const { WebSocketServer } = await import('ws');\n  const wss = new WebSocketServer({ noServer: true });\n\n  httpServer.on('upgrade', (request, socket, head) => {\n    const { pathname } = new URL(request.url!, `http://${request.headers.host}`);\n    if (pathname === '/ws/logs') {\n      wss.handleUpgrade(request, socket, head, (ws) => {\n        wss.emit('connection', ws, request);\n      });\n    }\n  });\n\n  const originalLog = console.log;\n  console.log = (...args) => {\n    originalLog(...args);\n    const msg = args.map(arg => typeof arg === 'object' ? JSON.stringify(arg) : arg).join(' ');\n    wss.clients.forEach(client => {\n      if (client.readyState === 1) client.send(msg);\n    });\n  };\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    if (!res.headersSent) {\n      res.status(status).json({ message });\n    }\n    \n    // Log error for debugging but don't re-throw to prevent unhandled rejections\n    console.error(`[Error ${status}]`, message, err.stack || '');\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`serving on port ${port}`);\n      if (process.env.NODE_ENV === \"production\") {\n        scheduleBackups();\n      }\n      if (process.env.NODE_ENV === \"production\") {\n        setInterval(async () => {\n          try {\n            await cleanupDbRateLimits();\n          } catch (e) {\n            console.error(\"Rate limit cleanup error:\", e);\n          }\n        }, 300000);\n      }\n    },\n  );\n})();\n", "import type { Express, RequestHandler } from \"express\";\nimport session from \"express-session\";\nimport connectPg from \"connect-pg-simple\";\nimport express from \"express\";\nimport { db } from \"../db\";\nimport { users } from \"@shared/models/auth\";\nimport { userNotifications, messages as messagesTable } from \"@shared/schema\";\nimport { eq, sql, and, inArray, desc, gt } from \"drizzle-orm\";\nimport { sendEmail, getWelcomeEmailTemplate } from \"./email\";\nimport { generateUniqueClientId } from \"./id-generator\";\nimport { EmailLanguage, getWelcomeNotificationTitle, getWelcomeNotificationMessage, getWelcomeEmailSubject, getDefaultClientName, getSecurityOtpSubject } from \"./email-translations\";\nimport { checkRateLimit, logAudit, getClientIp } from \"./security\";\nimport {\n  createUser,\n  loginUser,\n  verifyEmailToken,\n  createPasswordResetOtp,\n  verifyPasswordResetOtp,\n  resetPasswordWithOtp,\n  resendVerificationEmail,\n} from \"./auth-service\";\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  const isProduction = process.env.NODE_ENV === \"production\" || process.env.REPLIT_ENVIRONMENT === \"production\";\n  \n  // Require SESSION_SECRET in production, use random fallback only in development\n  const envSecret = process.env.SESSION_SECRET;\n  if (!envSecret && isProduction) {\n    throw new Error(\"SESSION_SECRET environment variable is required in production\");\n  }\n  const sessionSecret = envSecret || require(\"crypto\").randomBytes(32).toString(\"hex\");\n  if (!envSecret) {\n    console.warn(\"\u26A0\uFE0F Using random session secret for development. Set SESSION_SECRET in production.\");\n  }\n  \n  return session({\n    secret: sessionSecret,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: isProduction,\n      maxAge: sessionTtl,\n      sameSite: isProduction ? \"none\" : \"lax\",\n    },\n  });\n}\n\ndeclare module \"express-session\" {\n  interface SessionData {\n    userId: string;\n    email: string;\n    isAdmin: boolean;\n    isSupport: boolean;\n  }\n}\n\nexport function setupCustomAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  \n  // JSON body parser must be before session and routes\n  app.use(express.json());\n  app.use(express.urlencoded({ extended: true }));\n  \n  app.use(getSession());\n\n  // Register endpoint\n  app.post(\"/api/auth/register\", async (req, res) => {\n    try {\n      const { email, password, firstName, lastName, phone, birthDate, businessActivity, preferredLanguage } = req.body;\n\n      if (!email || !password || !firstName || !lastName || !phone) {\n        return res.status(400).json({ message: \"All fields are required\" });\n      }\n\n      if (password.length < 8) {\n        return res.status(400).json({ message: \"Password must be at least 8 characters\" });\n      }\n\n      const clientId = await generateUniqueClientId();\n      const supportedLangs = ['es', 'en', 'ca', 'fr', 'de', 'it', 'pt'];\n      const lang = supportedLangs.includes(preferredLanguage) ? preferredLanguage : 'es';\n      const { user } = await createUser({\n        email,\n        password,\n        firstName,\n        lastName,\n        phone,\n        birthDate,\n        businessActivity,\n        clientId,\n        preferredLanguage: lang,\n      });\n\n      // NOTIFICATION: Welcome (translated on frontend via i18n keys)\n      const emailLang = lang as EmailLanguage;\n      await db.insert(userNotifications).values({\n        userId: user.id,\n        title: 'i18n:ntf.welcome.title',\n        message: 'i18n:ntf.welcome.message',\n        type: 'info',\n        isRead: false\n      });\n\n      // Send Welcome Email with Client ID (in user's language)\n      sendEmail({\n        to: user.email!,\n        subject: getWelcomeEmailSubject(emailLang),\n        html: getWelcomeEmailTemplate(user.firstName || getDefaultClientName(emailLang), emailLang)\n      }).catch(() => {});\n\n      req.session.userId = user.id;\n      req.session.email = user.email!;\n      req.session.isAdmin = user.isAdmin;\n      req.session.isSupport = user.isSupport;\n\n      // Save session explicitly before responding\n      req.session.save((err) => {\n        if (err) {\n          console.error(\"Session save error:\", err);\n          return res.status(500).json({ message: \"Error saving session\" });\n        }\n        \n        res.json({\n          success: true,\n          user: {\n            id: user.id,\n            email: user.email,\n            firstName: user.firstName,\n            lastName: user.lastName,\n            emailVerified: user.emailVerified,\n          },\n          message: \"Account created. Check your email to verify your account.\",\n        });\n      });\n    } catch (error: any) {\n      console.error(\"Registration error:\", error);\n      res.status(400).json({ message: error.message || \"Error creating account\" });\n    }\n  });\n\n  // Login endpoint with rate limiting and security OTP verification\n  app.post(\"/api/auth/login\", async (req, res) => {\n      try {\n        const ip = getClientIp(req);\n        const rateCheck = checkRateLimit('login', ip);\n        if (!rateCheck.allowed) {\n          return res.status(429).json({ \n            message: `Too many attempts. Wait ${rateCheck.retryAfter} seconds.` \n          });\n        }\n\n        const { email, password, securityOtp } = req.body;\n\n        if (!email || !password) {\n          return res.status(400).json({ message: \"Email and password are required\" });\n        }\n\n        const user = await loginUser(email, password);\n\n        if (!user) {\n          const [existingUser] = await db.select({ id: users.id }).from(users).where(eq(users.email, email.toLowerCase().trim())).limit(1);\n          logAudit({ action: 'user_login', ip, details: { email, success: false } });\n          return res.status(401).json({ \n            message: \"Incorrect email or password\",\n            hint: existingUser ? undefined : \"no_account\"\n          });\n        }\n\n        if (user.accountStatus === 'deactivated') {\n          return res.status(403).json({ message: \"Your account has been deactivated. Contact our customer service for more information.\" });\n        }\n\n        // Check if user has organization docs (skip security OTP if they do)\n        const { applicationDocuments: appDocsTable, orders: ordersTable } = await import(\"@shared/schema\");\n        const userOrders = await db.select({ id: ordersTable.id }).from(ordersTable).where(eq(ordersTable.userId, user.id));\n        const orderIds = userOrders.map(o => o.id);\n        \n        let hasOrgDocs = false;\n        if (orderIds.length > 0) {\n          const orgDocs = await db.select()\n            .from(appDocsTable)\n            .where(\n              and(\n                inArray(appDocsTable.orderId, orderIds),\n                eq(appDocsTable.documentType, \"organization_docs\")\n              )\n            )\n            .limit(1);\n          hasOrgDocs = orgDocs.length > 0;\n        }\n        \n        // Determine if security OTP is required\n        const newLoginCount = (user.loginCount || 0) + 1;\n        const ipChanged = user.lastLoginIp && user.lastLoginIp !== ip;\n        const lastOtpCheck = user.lastSecurityOtpAt ? new Date(user.lastSecurityOtpAt) : null;\n        const daysSinceOtpCheck = lastOtpCheck ? (Date.now() - lastOtpCheck.getTime()) / (1000 * 60 * 60 * 24) : 999;\n        \n        // Require OTP every 3 logins, on IP change, or if marked as required - unless they have org docs\n        const requiresSecurityOtp = !hasOrgDocs && !user.isAdmin && (\n          user.securityOtpRequired ||\n          (newLoginCount % 3 === 0) ||\n          (ipChanged && daysSinceOtpCheck > 1)\n        );\n        \n        if (requiresSecurityOtp && !securityOtp) {\n          // Generate and send security OTP\n          const { contactOtps } = await import(\"@shared/schema\");\n          const { sendEmail, getOtpEmailTemplate } = await import(\"./email\");\n          \n          const otp = Math.floor(100000 + Math.random() * 900000).toString();\n          const expiresAt = new Date(Date.now() + 10 * 60 * 1000);\n          \n          await db.insert(contactOtps).values({\n            email: user.email!,\n            otp,\n            otpType: \"security_verification\",\n            expiresAt,\n          });\n          \n          const secLang = (user.preferredLanguage || 'es') as EmailLanguage;\n          await sendEmail({\n            to: user.email!,\n            subject: getSecurityOtpSubject(secLang),\n            html: getOtpEmailTemplate(otp, user.firstName || undefined, secLang, ip),\n          });\n          \n          return res.status(200).json({ \n            requiresSecurityOtp: true,\n            message: \"For security, we have sent a verification code to your email.\"\n          });\n        }\n        \n        // Verify security OTP if provided\n        if (securityOtp) {\n          const { contactOtps } = await import(\"@shared/schema\");\n          const [otpRecord] = await db.select()\n            .from(contactOtps)\n            .where(\n              and(\n                eq(contactOtps.email, user.email!),\n                eq(contactOtps.otp, securityOtp),\n                eq(contactOtps.otpType, \"security_verification\"),\n                gt(contactOtps.expiresAt, new Date())\n              )\n            )\n            .orderBy(desc(contactOtps.expiresAt))\n            .limit(1);\n          \n          if (!otpRecord) {\n            return res.status(400).json({ message: \"Incorrect or expired verification code.\" });\n          }\n          \n          // Mark OTP as used\n          await db.update(contactOtps).set({ verified: true }).where(eq(contactOtps.id, otpRecord.id));\n        }\n        \n        // Update login tracking\n        await db.update(users)\n          .set({\n            lastLoginIp: ip,\n            loginCount: newLoginCount,\n            securityOtpRequired: false,\n            lastSecurityOtpAt: securityOtp ? new Date() : user.lastSecurityOtpAt,\n            loginAttempts: 0,\n          })\n          .where(eq(users.id, user.id));\n\n        req.session.userId = user.id;\n        req.session.email = user.email!;\n        req.session.isAdmin = user.isAdmin;\n        req.session.isSupport = user.isSupport;\n\n        // Save session explicitly before responding\n        req.session.save((err) => {\n          if (err) {\n            console.error(\"Session save error:\", err);\n            return res.status(500).json({ message: \"Error saving session\" });\n          }\n          \n          logAudit({ action: 'user_login', userId: user.id, ip, details: { email, success: true, loginCount: newLoginCount } });\n          res.json({\n            success: true,\n            user: {\n              id: user.id,\n              email: user.email,\n              firstName: user.firstName,\n              lastName: user.lastName,\n              phone: user.phone,\n              emailVerified: user.emailVerified,\n              isAdmin: user.isAdmin,\n              accountStatus: user.accountStatus,\n              preferredLanguage: user.preferredLanguage || 'es',\n            },\n          });\n        });\n      } catch (error: any) {\n        if (error.locked) {\n          logAudit({ action: 'account_locked', ip: getClientIp(req), details: { reason: 'too_many_attempts' } });\n          return res.status(403).json({ message: error.message });\n        }\n        console.error(\"Login error:\", error);\n        res.status(500).json({ message: \"Error logging in\" });\n      }\n  });\n\n  // Logout endpoint\n  app.post(\"/api/auth/logout\", (req, res) => {\n    req.session.destroy((err) => {\n      if (err) {\n        console.error(\"Logout error:\", err);\n        return res.status(500).json({ message: \"Error logging out\" });\n      }\n      res.clearCookie(\"connect.sid\");\n      res.json({ success: true });\n    });\n  });\n\n  // Also support GET for logout redirect\n  app.get(\"/api/logout\", (req, res) => {\n    req.session.destroy((err) => {\n      res.clearCookie(\"connect.sid\");\n      res.redirect(\"/\");\n    });\n  });\n\n  // Verify email endpoint\n  app.post(\"/api/auth/verify-email\", async (req, res) => {\n    try {\n      const { code } = req.body;\n      const userId = req.session.userId;\n\n      if (!userId) {\n        return res.status(401).json({ message: \"Not authenticated\" });\n      }\n\n      const success = await verifyEmailToken(userId, code);\n\n      if (!success) {\n        return res.status(400).json({ message: \"Invalid or expired code\" });\n      }\n\n      res.json({ success: true, message: \"Email verified successfully\" });\n    } catch (error) {\n      // Email error silenced\n      res.status(500).json({ message: \"Error verifying email\" });\n    }\n  });\n\n  // Resend verification email\n  app.post(\"/api/auth/resend-verification\", async (req, res) => {\n    try {\n      const userId = req.session.userId;\n\n      if (!userId) {\n        return res.status(401).json({ message: \"Not authenticated\" });\n      }\n\n      const success = await resendVerificationEmail(userId);\n\n      if (!success) {\n        return res.status(400).json({ message: \"Error sending code\" });\n      }\n\n      res.json({ success: true, message: \"Code sent\" });\n    } catch (error) {\n      console.error(\"Resend verification error:\", error);\n      res.status(500).json({ message: \"Error sending code\" });\n    }\n  });\n\n  // Request password reset OTP\n  app.post(\"/api/auth/forgot-password\", async (req, res) => {\n    try {\n      const { email } = req.body;\n\n      if (!email) {\n        return res.status(400).json({ message: \"Email is required\" });\n      }\n\n      await createPasswordResetOtp(email);\n\n      // Always return success to prevent email enumeration\n      res.json({\n        success: true,\n        message: \"If the email exists in our system, you will receive a verification code\",\n      });\n    } catch (error) {\n      res.status(500).json({ message: \"Error processing request\" });\n    }\n  });\n\n  // Verify password reset OTP\n  app.post(\"/api/auth/verify-reset-otp\", async (req, res) => {\n    try {\n      const { email, otp } = req.body;\n\n      if (!email || !otp) {\n        return res.status(400).json({ message: \"Email and code are required\" });\n      }\n\n      const isValid = await verifyPasswordResetOtp(email, otp);\n\n      if (!isValid) {\n        return res.status(400).json({ message: \"Invalid or expired code\" });\n      }\n\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ message: \"Error verifying code\" });\n    }\n  });\n\n  // Reset password with OTP\n  app.post(\"/api/auth/reset-password\", async (req, res) => {\n    try {\n      const { email, otp, password } = req.body;\n\n      if (!email || !otp || !password) {\n        return res.status(400).json({ message: \"Email, code and password are required\" });\n      }\n\n      if (password.length < 8) {\n        return res.status(400).json({ message: \"Password must be at least 8 characters\" });\n      }\n\n      const success = await resetPasswordWithOtp(email, otp, password);\n\n      if (!success) {\n        return res.status(400).json({ message: \"Invalid or expired code\" });\n      }\n\n      res.json({ success: true, message: \"Password updated successfully\" });\n    } catch (error) {\n      res.status(500).json({ message: \"Error updating password\" });\n    }\n  });\n\n  // Get current user\n  app.get(\"/api/auth/user\", async (req, res) => {\n    try {\n      const userId = req.session.userId;\n\n      if (!userId) {\n        return res.status(401).json({ message: \"Not authenticated\" });\n      }\n\n      const [user] = await db.select().from(users).where(eq(users.id, userId)).limit(1);\n\n      if (!user) {\n        req.session.destroy(() => {});\n        return res.status(401).json({ message: \"User not found\" });\n      }\n\n      res.json({\n        id: user.id,\n        email: user.email,\n        firstName: user.firstName,\n        lastName: user.lastName,\n        phone: user.phone,\n        address: user.address,\n        streetType: user.streetType,\n        city: user.city,\n        province: user.province,\n        postalCode: user.postalCode,\n        country: user.country,\n        businessActivity: user.businessActivity,\n        idNumber: user.idNumber,\n        idType: user.idType,\n        birthDate: user.birthDate,\n        emailVerified: user.emailVerified,\n        isAdmin: user.isAdmin,\n        isSupport: user.isSupport,\n        accountStatus: user.accountStatus,\n        profileImageUrl: user.profileImageUrl,\n        googleId: user.googleId ? true : false,\n        preferredLanguage: user.preferredLanguage || 'es',\n        createdAt: user.createdAt,\n        pendingProfileChanges: user.pendingProfileChanges || null,\n        pendingChangesExpiresAt: user.pendingChangesExpiresAt || null,\n      });\n    } catch (error) {\n      console.error(\"Get user error:\", error);\n      res.status(500).json({ message: \"Error fetching user\" });\n    }\n  });\n\n  // Update user profile\n  app.patch(\"/api/auth/user\", async (req, res) => {\n    try {\n      const userId = req.session.userId;\n\n      if (!userId) {\n        return res.status(401).json({ message: \"Not authenticated\" });\n      }\n\n      const { firstName, lastName, phone, address, streetType, city, province, postalCode, country, idNumber, idType, businessActivity, preferredLanguage } = req.body;\n      \n      // Get current user to check for significant changes\n      const [currentUser] = await db.select().from(users).where(eq(users.id, userId)).limit(1);\n      if (!currentUser) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      // Count significant field changes (sensitive fields that require review)\n      const sensitiveFields = ['idNumber', 'idType', 'address', 'streetType', 'city', 'province', 'postalCode', 'country'];\n      let significantChanges = 0;\n      \n      const currentValues: Record<string, any> = {\n        idNumber: currentUser.idNumber,\n        idType: currentUser.idType,\n        address: currentUser.address,\n        streetType: currentUser.streetType,\n        city: currentUser.city,\n        province: currentUser.province,\n        postalCode: currentUser.postalCode,\n        country: currentUser.country,\n      };\n      \n      const newValues: Record<string, any> = { idNumber, idType, address, streetType, city, province, postalCode, country };\n      \n      for (const field of sensitiveFields) {\n        const oldVal = currentValues[field] || '';\n        const newVal = newValues[field] || '';\n        if (newVal && oldVal !== newVal) {\n          significantChanges++;\n        }\n      }\n      \n      const updateData: any = {\n        firstName,\n        lastName,\n        phone,\n        address,\n        streetType,\n        city,\n        province,\n        postalCode,\n        country,\n        idNumber,\n        idType,\n        businessActivity,\n        preferredLanguage,\n        updatedAt: new Date(),\n      };\n\n      await db.update(users)\n        .set(updateData)\n        .where(eq(users.id, userId));\n\n      const [updatedUser] = await db.select().from(users).where(eq(users.id, userId)).limit(1);\n\n      res.json({\n        success: true,\n        user: {\n          id: updatedUser.id,\n          email: updatedUser.email,\n          firstName: updatedUser.firstName,\n          lastName: updatedUser.lastName,\n          phone: updatedUser.phone,\n          address: updatedUser.address,\n          streetType: updatedUser.streetType,\n          city: updatedUser.city,\n          province: updatedUser.province,\n          postalCode: updatedUser.postalCode,\n          country: updatedUser.country,\n          idNumber: updatedUser.idNumber,\n          idType: updatedUser.idType,\n          businessActivity: updatedUser.businessActivity,\n          emailVerified: updatedUser.emailVerified,\n          accountStatus: updatedUser.accountStatus,\n        },\n        accountUnderReview: false,\n      });\n    } catch (error) {\n      console.error(\"Update user error:\", error);\n      res.status(500).json({ message: \"Error updating profile\" });\n    }\n  });\n}\n\n// Middleware to check if account is under review or deactivated (restricts most actions)\nexport const isNotUnderReview: RequestHandler = async (req, res, next) => {\n  if (!req.session.userId) {\n    return res.status(401).json({ message: \"Not authenticated\" });\n  }\n  \n  const [user] = await db.select().from(users).where(eq(users.id, req.session.userId)).limit(1);\n  \n  if (user?.accountStatus === 'pending') {\n    return res.status(403).json({ \n      message: \"Your account is under review. Our team is performing security checks.\",\n      code: \"ACCOUNT_UNDER_REVIEW\"\n    });\n  }\n  \n  if (user?.accountStatus === 'deactivated') {\n    return res.status(403).json({ \n      message: \"Your account has been deactivated. Contact our support team for more information.\",\n      code: \"ACCOUNT_DEACTIVATED\"\n    });\n  }\n  \n  next();\n};\n\nexport const isAuthenticated: RequestHandler = (req, res, next) => {\n  if (!req.session.userId) {\n    return res.status(401).json({ message: \"Not authenticated\" });\n  }\n  next();\n};\n\nexport const isAdmin: RequestHandler = async (req, res, next) => {\n  if (!req.session.userId) {\n    return res.status(401).json({ message: \"Not authenticated\" });\n  }\n\n  const [user] = await db.select().from(users).where(eq(users.id, req.session.userId)).limit(1);\n\n  if (!user || !user.isAdmin) {\n    return res.status(403).json({ message: \"Not authorized\" });\n  }\n\n  next();\n};\n\nexport const isAdminOrSupport: RequestHandler = async (req, res, next) => {\n  if (!req.session.userId) {\n    return res.status(401).json({ message: \"Not authenticated\" });\n  }\n\n  const [user] = await db.select().from(users).where(eq(users.id, req.session.userId)).limit(1);\n\n  if (!user || (!user.isAdmin && !user.isSupport)) {\n    return res.status(403).json({ message: \"Not authorized\" });\n  }\n\n  next();\n};\n", "import { db } from \"./db\";\nimport { sql } from \"drizzle-orm\";\nimport {\n  products, orders, llcApplications, applicationDocuments, newsletterSubscribers,\n  maintenanceApplications, messages as messagesTable, users, guestVisitors, paymentAccounts,\n  type Product, type Order, type LlcApplication, type ApplicationDocument,\n  type GuestVisitor, type InsertGuestVisitor,\n  type PaymentAccount, type InsertPaymentAccount,\n  insertLlcApplicationSchema, insertApplicationDocumentSchema, insertOrderSchema\n} from \"@shared/schema\";\nimport { eq, desc } from \"drizzle-orm\";\nimport { z } from \"zod\";\nimport { generateUniqueMessageId } from \"./lib/id-generator\";\n\ntype InsertOrder = z.infer<typeof insertOrderSchema>;\ntype InsertLlcApplication = z.infer<typeof insertLlcApplicationSchema>;\ntype InsertApplicationDocument = z.infer<typeof insertApplicationDocumentSchema>;\n\nexport interface IStorage {\n  // Products\n  getProducts(): Promise<Product[]>;\n  getProduct(id: number): Promise<Product | undefined>;\n  createProduct(product: Omit<Product, \"id\">): Promise<Product>;\n\n  // Orders\n  createOrder(order: InsertOrder): Promise<Order>;\n  getOrders(userId: string): Promise<(Order & { product: Product; application: LlcApplication | null })[]>;\n  getOrder(id: number): Promise<(Order & { product?: Product; application?: LlcApplication; user?: any }) | undefined>;\n\n  // LLC Applications\n  createLlcApplication(app: InsertLlcApplication): Promise<LlcApplication>;\n  getLlcApplication(id: number): Promise<LlcApplication | undefined>;\n  getLlcApplicationByOrderId(orderId: number): Promise<LlcApplication | undefined>;\n  getLlcApplicationByRequestCode(code: string): Promise<(LlcApplication & { documents: ApplicationDocument[] }) | undefined>;\n  updateLlcApplication(id: number, updates: Partial<LlcApplication>): Promise<LlcApplication>;\n\n  // Documents\n  createDocument(doc: InsertApplicationDocument): Promise<ApplicationDocument>;\n  getDocumentsByApplicationId(applicationId: number): Promise<ApplicationDocument[]>;\n  getDocumentsByOrderIds(orderIds: number[]): Promise<ApplicationDocument[]>;\n  deleteDocument(id: number): Promise<void>;\n\n  // Newsletter\n  subscribeToNewsletter(email: string): Promise<void>;\n  isSubscribedToNewsletter(email: string): Promise<boolean>;\n\n  // Admin\n  getAllOrders(): Promise<(Order & { product: Product; application: LlcApplication | null; maintenanceApplication: any; user: any })[]>;\n  updateOrderStatus(orderId: number, status: string): Promise<Order>;\n\n  // Messages\n  createMessage(message: any): Promise<any>;\n  getMessagesByUserId(userId: string): Promise<any[]>;\n  getAllMessages(): Promise<any[]>;\n  updateMessageStatus(id: number, status: string): Promise<any>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // Products\n  async getProducts(): Promise<Product[]> {\n    return await db.select().from(products).orderBy(products.price);\n  }\n\n  async getProduct(id: number): Promise<Product | undefined> {\n    const [product] = await db.select().from(products).where(eq(products.id, id));\n    return product;\n  }\n\n  async createProduct(product: Omit<Product, \"id\">): Promise<Product> {\n    const [newProduct] = await db.insert(products).values(product).returning();\n    return newProduct;\n  }\n\n  // Orders\n  async createOrder(order: InsertOrder): Promise<Order> {\n    const [newOrder] = await db.insert(orders).values(order).returning();\n    return newOrder;\n  }\n\n  async getOrders(userId?: string): Promise<any[]> {\n    if (userId) {\n      return await db.query.orders.findMany({\n        where: eq(orders.userId, userId),\n        with: {\n          product: true,\n          application: true,\n          maintenanceApplication: true,\n        },\n        orderBy: desc(orders.createdAt),\n      });\n    }\n    return await db.query.orders.findMany({\n      with: {\n        product: true,\n        application: true,\n        maintenanceApplication: true,\n        user: true,\n      },\n      orderBy: desc(orders.createdAt),\n    });\n  }\n\n  async getOrder(id: number): Promise<(Order & { product?: Product; application?: LlcApplication; maintenanceApplication?: any; user?: any }) | undefined> {\n    const result = await db.query.orders.findFirst({\n      where: eq(orders.id, id),\n      with: {\n        product: true,\n        application: true,\n        maintenanceApplication: true,\n        user: true,\n      },\n    });\n    return result;\n  }\n\n  // LLC Applications\n  async createLlcApplication(app: z.infer<typeof insertLlcApplicationSchema>): Promise<LlcApplication> {\n    const [newApp] = await db.insert(llcApplications).values(app).returning();\n    return newApp;\n  }\n\n  async getLlcApplication(id: number): Promise<LlcApplication | undefined> {\n    const [app] = await db.select().from(llcApplications).where(eq(llcApplications.id, id));\n    return app;\n  }\n\n  async getLlcApplicationByOrderId(orderId: number): Promise<LlcApplication | undefined> {\n    const [app] = await db.select().from(llcApplications).where(eq(llcApplications.orderId, orderId));\n    return app;\n  }\n\n  async getLlcApplicationByRequestCode(code: string): Promise<(LlcApplication & { documents: ApplicationDocument[] }) | undefined> {\n    const result = await db.query.llcApplications.findFirst({\n      where: eq(llcApplications.requestCode, code),\n      with: {\n        documents: true,\n      },\n    });\n    return result as (LlcApplication & { documents: ApplicationDocument[] }) | undefined;\n  }\n\n  async updateLlcApplication(id: number, updates: Partial<LlcApplication>): Promise<LlcApplication> {\n    const [updated] = await db\n      .update(llcApplications)\n      .set({ ...updates, lastUpdated: new Date() })\n      .where(eq(llcApplications.id, id))\n      .returning();\n    return updated;\n  }\n\n  // Documents\n  async createDocument(doc: InsertApplicationDocument): Promise<ApplicationDocument> {\n    const [newDoc] = await db.insert(applicationDocuments).values(doc).returning();\n    return newDoc;\n  }\n\n  async getDocumentsByApplicationId(applicationId: number): Promise<ApplicationDocument[]> {\n    return await db.select().from(applicationDocuments).where(eq(applicationDocuments.applicationId, applicationId));\n  }\n\n  async getDocumentsByOrderIds(orderIds: number[]): Promise<ApplicationDocument[]> {\n    const { inArray } = await import(\"drizzle-orm\");\n    if (orderIds.length === 0) return [];\n    return await db.select().from(applicationDocuments).where(inArray(applicationDocuments.orderId, orderIds));\n  }\n\n  async deleteDocument(id: number): Promise<void> {\n    await db.delete(applicationDocuments).where(eq(applicationDocuments.id, id));\n  }\n\n  // Newsletter\n  async subscribeToNewsletter(email: string): Promise<void> {\n    const subscribed = await this.isSubscribedToNewsletter(email);\n    if (!subscribed) {\n      await db.insert(newsletterSubscribers).values({ email });\n    }\n  }\n\n  async isSubscribedToNewsletter(email: string): Promise<boolean> {\n    const [subscriber] = await db.select().from(newsletterSubscribers).where(eq(newsletterSubscribers.email, email));\n    return !!subscriber;\n  }\n\n  // Admin methods\n  async getAllOrders(): Promise<(Order & { product: Product; application: LlcApplication | null; maintenanceApplication: any; user: any })[]> {\n    return await db.query.orders.findMany({\n      with: {\n        product: true,\n        application: true,\n        maintenanceApplication: true,\n        user: true,\n      },\n      orderBy: desc(orders.createdAt),\n    });\n  }\n\n  async updateOrderStatus(orderId: number, status: string): Promise<Order> {\n    const [updated] = await db\n      .update(orders)\n      .set({ status })\n      .where(eq(orders.id, orderId))\n      .returning();\n    return updated;\n  }\n\n  // Messages\n  async createMessage(message: any): Promise<any> {\n    const { encrypt } = await import(\"./utils/encryption\");\n    const msgId = await generateUniqueMessageId();\n    \n    const encryptedContent = encrypt(message.content);\n    const [newMessage] = await db.insert(messagesTable).values({\n      ...message,\n      messageId: msgId,\n      encryptedContent\n    }).returning();\n    return newMessage;\n  }\n\n  async getMessagesByUserId(userId: string): Promise<any[]> {\n    const messages = await db.query.messages.findMany({\n      where: eq(messagesTable.userId, userId),\n      orderBy: desc(messagesTable.createdAt),\n      with: {\n        replies: true\n      }\n    });\n    return messages.map(msg => ({\n      ...msg,\n      content: msg.content\n        ?.replace(/\\n*Archivo disponible en:.*$/gm, '')\n        ?.replace(/\\n*Archivo:.*\\.(png|jpg|jpeg|pdf)/gim, '')\n        ?.replace(/\\/uploads\\/[^\\s]*/g, '')\n        ?.trim() || msg.content,\n      encryptedContent: undefined\n    }));\n  }\n\n  async getAllMessages(): Promise<any[]> {\n    return await db.query.messages.findMany({\n      orderBy: desc(messagesTable.createdAt),\n      with: {\n        replies: true\n      }\n    });\n  }\n\n  async updateMessageStatus(id: number, status: string): Promise<any> {\n    const [updated] = await db.update(messagesTable)\n      .set({ status })\n      .where(eq(messagesTable.id, id))\n      .returning();\n    return updated;\n  }\n\n  async createGuestVisitor(visitor: InsertGuestVisitor): Promise<GuestVisitor> {\n    const [newVisitor] = await db.insert(guestVisitors).values(visitor).returning();\n    return newVisitor;\n  }\n\n  async getAllGuestVisitors(): Promise<GuestVisitor[]> {\n    return await db.select().from(guestVisitors).orderBy(desc(guestVisitors.createdAt));\n  }\n\n  async deleteGuestVisitor(id: number): Promise<void> {\n    await db.delete(guestVisitors).where(eq(guestVisitors.id, id));\n  }\n\n  async deleteGuestVisitorsByEmail(email: string): Promise<number> {\n    const deleted = await db.delete(guestVisitors).where(eq(guestVisitors.email, email)).returning();\n    return deleted.length;\n  }\n\n  async getGuestVisitorStats(): Promise<{ total: number; withEmail: number; sources: Record<string, number> }> {\n    const all = await db.select().from(guestVisitors);\n    const withEmail = all.filter(v => v.email).length;\n    const sources: Record<string, number> = {};\n    for (const v of all) {\n      sources[v.source] = (sources[v.source] || 0) + 1;\n    }\n    return { total: all.length, withEmail, sources };\n  }\n\n  async getPaymentAccounts(): Promise<PaymentAccount[]> {\n    return await db.select().from(paymentAccounts).orderBy(paymentAccounts.sortOrder);\n  }\n\n  async getActivePaymentAccounts(): Promise<PaymentAccount[]> {\n    return await db.select().from(paymentAccounts).where(eq(paymentAccounts.isActive, true)).orderBy(paymentAccounts.sortOrder);\n  }\n\n  async createPaymentAccount(account: InsertPaymentAccount): Promise<PaymentAccount> {\n    const [newAccount] = await db.insert(paymentAccounts).values(account).returning();\n    return newAccount;\n  }\n\n  async updatePaymentAccount(id: number, updates: Partial<InsertPaymentAccount>): Promise<PaymentAccount> {\n    const [updated] = await db.update(paymentAccounts).set(updates).where(eq(paymentAccounts.id, id)).returning();\n    return updated;\n  }\n\n  async deletePaymentAccount(id: number): Promise<void> {\n    await db.delete(paymentAccounts).where(eq(paymentAccounts.id, id));\n  }\n}\n\nexport const storage = new DatabaseStorage();\n", "import type { Express } from \"express\";\nimport type { Server } from \"http\";\nimport { setupCustomAuth } from \"./lib/custom-auth\";\nimport { storage } from \"./storage\";\nimport { db } from \"./db\";\nimport { contactOtps } from \"@shared/schema\";\nimport { sql } from \"drizzle-orm\";\nimport { getSystemHealth } from \"./lib/security\";\nimport { setupOAuth } from \"./oauth\";\nimport { checkAndSendReminders } from \"./calendar-service\";\nimport { processAbandonedApplications } from \"./lib/abandoned-service\";\nimport { startBackupService } from \"./lib/backup-service\";\nimport { csrfMiddleware, getCsrfToken, validateCsrf } from \"./lib/csrf\";\nimport { checkRateLimit as checkApiRateLimit } from \"./lib/rate-limiter\";\nimport { registerObjectStorageRoutes } from \"./replit_integrations/object_storage\";\nimport { startIpTrackerCleanup } from \"./routes/shared\";\nimport { registerAdminOrderRoutes } from \"./routes/admin-orders\";\nimport { registerAdminUserRoutes } from \"./routes/admin-users\";\nimport { registerAdminBillingRoutes } from \"./routes/admin-billing\";\nimport { registerAdminCommsRoutes } from \"./routes/admin-comms\";\nimport { registerAdminDocumentsRoutes } from \"./routes/admin-documents\";\nimport { registerConsultationRoutes } from \"./routes/consultations\";\nimport { registerUserProfileRoutes } from \"./routes/user-profile\";\nimport { registerOrderRoutes } from \"./routes/orders\";\nimport { registerLlcRoutes } from \"./routes/llc\";\nimport { registerMaintenanceRoutes } from \"./routes/maintenance\";\nimport { registerAccountingRoutes } from \"./routes/accounting\";\nimport { registerMessageRoutes } from \"./routes/messages\";\nimport { registerContactRoutes } from \"./routes/contact\";\nimport { registerAuthExtRoutes } from \"./routes/auth-ext\";\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  // Cleanup expired OTPs every 10 minutes\n  setInterval(async () => {\n    try {\n      // Use a timeout for the query to prevent it from hanging and potentially causing connection termination\n      const cleanupPromise = db.delete(contactOtps).where(\n        sql`${contactOtps.expiresAt} < NOW()`\n      );\n      \n      const timeoutPromise = new Promise((_, reject) => \n        setTimeout(() => reject(new Error('OTP cleanup query timeout')), 15000)\n      );\n\n      await Promise.race([cleanupPromise, timeoutPromise]);\n    } catch (e) {\n      console.error(\"OTP cleanup error:\", e);\n    }\n  }, 600000);\n  \n  app.use(\"/api/\", async (req, res, next) => {\n    const ip = req.ip || req.headers['x-forwarded-for']?.toString().split(',')[0] || \"unknown\";\n    \n    const rateCheck = await checkApiRateLimit('api', ip);\n    if (!rateCheck.allowed) {\n      res.setHeader('Retry-After', String(rateCheck.retryAfter || 60));\n      return res.status(429).json({ message: \"Too many requests. Please wait a minute.\" });\n    }\n    \n    next();\n  });\n  \n  // Start IP tracker cleanup (hourly)\n  startIpTrackerCleanup();\n\n  // Set up Custom Auth\n  setupCustomAuth(app);\n\n  // Set up Google OAuth\n  setupOAuth(app);\n  \n  // Set up Object Storage routes for file uploads\n  registerObjectStorageRoutes(app);\n\n  // CSRF Protection - initialize token first\n  app.use(csrfMiddleware);\n  \n  // CSRF Token endpoint\n  app.get(\"/api/csrf-token\", (req, res) => {\n    getCsrfToken(req, res);\n  });\n  \n  // CSRF Validation for ALL state-changing endpoints (must be after csrfMiddleware)\n  const csrfExemptPaths = [\n    \"/api/stripe/webhook\",\n    \"/api/webhook\",\n  ];\n  \n  app.use((req, res, next) => {\n    const isExempt = csrfExemptPaths.some(path => req.path.startsWith(path));\n    const isMutatingMethod = ![\"GET\", \"HEAD\", \"OPTIONS\"].includes(req.method);\n    const isApiRoute = req.path.startsWith(\"/api/\");\n    \n    if (isApiRoute && isMutatingMethod && !isExempt) {\n      return validateCsrf(req, res, next);\n    }\n    next();\n  });\n\n  // Schedule compliance reminder checks every hour\n  setInterval(async () => {\n    try {\n      await checkAndSendReminders();\n    } catch (e) {\n      console.error(\"Compliance reminder check error:\", e);\n    }\n    try {\n      await processAbandonedApplications();\n    } catch (e) {\n      console.error(\"Abandoned applications check error:\", e);\n    }\n  }, 3600000);\n\n  // Run initial reminder check on startup (after 30 seconds to allow DB to be ready)\n  setTimeout(async () => {\n    try {\n      await checkAndSendReminders();\n      console.log(\"Initial compliance reminder check completed\");\n    } catch (e) {\n      console.error(\"Initial compliance reminder check error:\", e);\n    }\n    try {\n      await processAbandonedApplications();\n      console.log(\"Initial abandoned applications check completed\");\n    } catch (e) {\n      console.error(\"Initial abandoned applications check error:\", e);\n    }\n    \n    // Start backup service for Object Storage\n    startBackupService();\n  }, 30000);\n\n  // Health check endpoint for deployment with database verification\n  app.get(\"/api/healthz\", async (_req, res) => {\n    try {\n      const health = await getSystemHealth();\n      if (health.status === 'unhealthy') {\n        return res.status(503).json(health);\n      }\n      res.status(200).json(health);\n    } catch (error) {\n      res.status(503).json({ status: 'unhealthy', error: 'Health check failed' });\n    }\n  });\n\n    // === Activity Tracking ===\n    app.post(\"/api/activity/track\", async (req, res) => {\n      const { action, details } = req.body;\n      if (action === \"CLICK_ELEGIR_ESTADO\") {\n        if (process.env.NODE_ENV === 'development') {\n          console.log(`[LOG] Selecci\u00F3n de Estado:`, { \"Detalles\": details });\n        }\n      }\n      res.json({ success: true });\n    });\n\n  // === API Routes ===\n\n  // Admin Orders (extracted to server/routes/admin-orders.ts)\n  registerAdminOrderRoutes(app);\n\n  // Admin Users (extracted to server/routes/admin-users.ts)\n  registerAdminUserRoutes(app);\n\n  // Admin Billing (extracted to server/routes/admin-billing.ts)\n  registerAdminBillingRoutes(app);\n\n  // Admin Communications (newsletter, consultations, guests, messages)\n  registerAdminCommsRoutes(app);\n\n  // Admin Documents (extracted to server/routes/admin-documents.ts)\n  registerAdminDocumentsRoutes(app);\n\n  // User Profile, Documents, Notifications, Password (extracted to server/routes/user-profile.ts)\n  registerUserProfileRoutes(app);\n\n  // Orders (extracted to server/routes/orders.ts)\n  registerOrderRoutes(app);\n\n  // Messages API (extracted to server/routes/messages.ts)\n  registerMessageRoutes(app);\n\n  // LLC Applications (extracted to server/routes/llc.ts)\n  registerLlcRoutes(app);\n\n  // Maintenance (extracted to server/routes/maintenance.ts)\n  registerMaintenanceRoutes(app);\n\n  // Contact & Newsletter (extracted to server/routes/contact.ts)\n  registerContactRoutes(app);\n\n  // Auth Extension Routes (registration OTP, password reset)\n  registerAuthExtRoutes(app);\n\n  // Consultation Booking System (extracted to server/routes/consultations.ts)\n  registerConsultationRoutes(app);\n\n  // Accounting (extracted to server/routes/accounting.ts)\n  registerAccountingRoutes(app);\n\n  // Seed Data\n  try {\n    await seedDatabase();\n  } catch (e) {\n    console.error(\"Database seeding error:\", e);\n  }\n\n  return httpServer;\n}\n\nasync function seedDatabase() {\n  const existingProducts = await storage.getProducts();\n  if (existingProducts.length === 0) {\n    await storage.createProduct({\n      name: \"New Mexico LLC\",\n      description: \"Constituci\u00F3n r\u00E1pida en el estado m\u00E1s eficiente. Ideal para bajo coste de mantenimiento.\",\n      price: 73900,\n      features: [\n        \"Tasas del estado pagadas\",\n        \"Registered Agent (12 meses)\",\n        \"Articles of Organization oficiales\",\n        \"Operating Agreement profesional\",\n        \"EIN del IRS\",\n        \"BOI Report presentado\",\n        \"Declaraciones fiscales a\u00F1o 1\",\n        \"Soporte completo 12 meses\"\n      ],\n    });\n    await storage.createProduct({\n      name: \"Wyoming LLC\",\n      description: \"Constituci\u00F3n premium en el estado m\u00E1s prestigioso de USA. M\u00E1xima privacidad y protecci\u00F3n.\",\n      price: 89900,\n      features: [\n        \"Tasas del estado pagadas\",\n        \"Registered Agent (12 meses)\",\n        \"EIN del IRS garantizado\",\n        \"Articles of Organization oficiales\",\n        \"Operating Agreement profesional\",\n        \"BOI Report presentado\",\n        \"Annual Report a\u00F1o 1\",\n        \"Declaraciones fiscales a\u00F1o 1\",\n        \"Soporte completo 12 meses\"\n      ],\n    });\n    await storage.createProduct({\n      name: \"Delaware LLC\",\n      description: \"El est\u00E1ndar para startups y empresas tecnol\u00F3gicas. Reconocimiento legal global.\",\n      price: 139900,\n      features: [\n        \"Tasas del estado pagadas\",\n        \"Registered Agent (12 meses)\",\n        \"Articles of Organization oficiales\",\n        \"Operating Agreement profesional\",\n        \"EIN del IRS\",\n        \"BOI Report presentado\",\n        \"Declaraciones fiscales a\u00F1o 1\",\n        \"Soporte completo 12 meses\"\n      ],\n    });\n  }\n}\n", "import { OAuth2Client } from \"google-auth-library\";\nimport { db } from \"./db\";\nimport { users } from \"@shared/schema\";\nimport { eq } from \"drizzle-orm\";\nimport type { Express, Request, Response } from \"express\";\nimport crypto from \"crypto\";\nimport { isAdminEmail } from \"./lib/auth-service\";\nimport { generateUniqueClientId } from \"./lib/id-generator\";\n\nconst GOOGLE_CLIENT_ID = process.env.GOOGLE_CLIENT_ID;\nconst GOOGLE_CLIENT_SECRET = process.env.GOOGLE_CLIENT_SECRET;\n\nconst googleClient = GOOGLE_CLIENT_ID ? new OAuth2Client(GOOGLE_CLIENT_ID) : null;\n\ndeclare module \"express-session\" {\n  interface SessionData {\n    oauthState?: string;\n    oauthAction?: \"login\" | \"connect\";\n  }\n}\n\nasync function findOrCreateUserByGoogle(profile: {\n  googleId: string;\n  email: string;\n  firstName?: string;\n  lastName?: string;\n  profileImageUrl?: string;\n}) {\n  const existingByGoogle = await db.select().from(users).where(eq(users.googleId, profile.googleId)).limit(1);\n  if (existingByGoogle.length > 0) {\n    return existingByGoogle[0];\n  }\n\n  const existingByEmail = await db.select().from(users).where(eq(users.email, profile.email)).limit(1);\n  if (existingByEmail.length > 0) {\n    await db.update(users).set({ \n      googleId: profile.googleId,\n      emailVerified: true,\n      profileImageUrl: profile.profileImageUrl || existingByEmail[0].profileImageUrl,\n      updatedAt: new Date()\n    }).where(eq(users.id, existingByEmail[0].id));\n    return { ...existingByEmail[0], googleId: profile.googleId, emailVerified: true };\n  }\n\n  const newUser = await db.insert(users).values({\n    email: profile.email,\n    firstName: profile.firstName,\n    lastName: profile.lastName,\n    profileImageUrl: profile.profileImageUrl,\n    googleId: profile.googleId,\n    emailVerified: true,\n    clientId: await generateUniqueClientId(),\n    isActive: true,\n    accountStatus: \"active\",\n    isAdmin: isAdminEmail(profile.email),\n  }).returning();\n\n  return newUser[0];\n}\n\nexport function setupOAuth(app: Express) {\n  app.get(\"/api/auth/google\", async (req: Request, res: Response) => {\n    const isConnect = req.query.connect === \"true\";\n    \n    if (isConnect && !req.session.userId) {\n      return res.redirect(\"/login?error=login_required\");\n    }\n    \n    if (!GOOGLE_CLIENT_ID || !GOOGLE_CLIENT_SECRET) {\n      return res.redirect(\"/login?error=google_not_configured\");\n    }\n\n    const protocol = req.headers[\"x-forwarded-proto\"] || req.protocol;\n    const host = req.headers.host || process.env.REPLIT_DEV_DOMAIN || `localhost:${process.env.PORT || 5000}`;\n    const redirectUri = `${protocol}://${host}/api/auth/google/callback`;\n\n    const oauthState = crypto.randomBytes(32).toString(\"hex\");\n    req.session.oauthState = oauthState;\n    req.session.oauthAction = isConnect ? \"connect\" : \"login\";\n    \n    await new Promise<void>((resolve, reject) => {\n      req.session.save((err) => {\n        if (err) reject(err);\n        else resolve();\n      });\n    });\n    \n    const authUrl = new URL(\"https://accounts.google.com/o/oauth2/v2/auth\");\n    authUrl.searchParams.set(\"client_id\", GOOGLE_CLIENT_ID);\n    authUrl.searchParams.set(\"redirect_uri\", redirectUri);\n    authUrl.searchParams.set(\"response_type\", \"code\");\n    authUrl.searchParams.set(\"scope\", \"openid email profile\");\n    authUrl.searchParams.set(\"state\", oauthState);\n    authUrl.searchParams.set(\"access_type\", \"offline\");\n    authUrl.searchParams.set(\"prompt\", \"select_account\");\n\n    return res.redirect(authUrl.toString());\n  });\n\n  app.get(\"/api/auth/google/callback\", async (req: Request, res: Response) => {\n    try {\n      const { code, state, error } = req.query;\n      \n      const expectedState = req.session.oauthState;\n      const action = req.session.oauthAction;\n      \n      delete req.session.oauthState;\n      delete req.session.oauthAction;\n      \n      if (error) {\n        console.error(\"Google OAuth error:\", error);\n        return res.redirect(\"/login?error=oauth_denied\");\n      }\n\n      if (!state || state !== expectedState) {\n        console.error(\"OAuth state mismatch:\", { state, expectedState });\n        return res.redirect(\"/login?error=invalid_state\");\n      }\n\n      if (!code || typeof code !== \"string\") {\n        return res.redirect(\"/login?error=no_code\");\n      }\n\n      if (!GOOGLE_CLIENT_ID || !GOOGLE_CLIENT_SECRET) {\n        return res.redirect(\"/login?error=google_not_configured\");\n      }\n\n      const protocol = req.headers[\"x-forwarded-proto\"] || req.protocol;\n      const host = req.headers.host || process.env.REPLIT_DEV_DOMAIN || `localhost:${process.env.PORT || 5000}`;\n      const redirectUri = `${protocol}://${host}/api/auth/google/callback`;\n\n      const tokenResponse = await fetch(\"https://oauth2.googleapis.com/token\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\n        body: new URLSearchParams({\n          client_id: GOOGLE_CLIENT_ID,\n          client_secret: GOOGLE_CLIENT_SECRET,\n          code,\n          grant_type: \"authorization_code\",\n          redirect_uri: redirectUri,\n        }),\n      });\n\n      if (!tokenResponse.ok) {\n        const errorData = await tokenResponse.text();\n        console.error(\"Token exchange failed:\", errorData);\n        return res.redirect(\"/login?error=token_exchange_failed\");\n      }\n\n      const tokens = await tokenResponse.json();\n      const idToken = tokens.id_token;\n\n      if (!idToken) {\n        return res.redirect(\"/login?error=no_id_token\");\n      }\n\n      const ticket = await googleClient!.verifyIdToken({\n        idToken,\n        audience: GOOGLE_CLIENT_ID,\n      });\n\n      const payload = ticket.getPayload();\n      if (!payload || !payload.email) {\n        return res.redirect(\"/login?error=invalid_token\");\n      }\n\n      const isConnect = action === \"connect\";\n\n      if (isConnect && req.session.userId) {\n        const [existingUser] = await db.select().from(users).where(eq(users.id, req.session.userId)).limit(1);\n        if (existingUser) {\n          await db.update(users).set({ \n            googleId: payload.sub, \n            updatedAt: new Date() \n          }).where(eq(users.id, existingUser.id));\n          return res.redirect(\"/dashboard?connected=google\");\n        }\n      }\n\n      const user = await findOrCreateUserByGoogle({\n        googleId: payload.sub,\n        email: payload.email,\n        firstName: payload.given_name,\n        lastName: payload.family_name,\n        profileImageUrl: payload.picture,\n      });\n\n      if (!user.isActive || user.accountStatus === \"deactivated\") {\n        return res.redirect(\"/login?error=account_deactivated\");\n      }\n\n      req.session.userId = user.id;\n      await new Promise<void>((resolve, reject) => {\n        req.session.save((err) => {\n          if (err) reject(err);\n          else resolve();\n        });\n      });\n\n      return res.redirect(\"/dashboard\");\n    } catch (error) {\n      console.error(\"Google OAuth callback error:\", error);\n      return res.redirect(\"/login?error=auth_failed\");\n    }\n  });\n\n  app.post(\"/api/auth/google\", async (req: Request, res: Response) => {\n    try {\n      const { credential } = req.body;\n\n      if (!credential) {\n        return res.status(400).json({ message: \"Google credential required\" });\n      }\n\n      if (!googleClient || !GOOGLE_CLIENT_ID) {\n        return res.status(503).json({ message: \"Google OAuth is not configured\" });\n      }\n\n      const ticket = await googleClient.verifyIdToken({\n        idToken: credential,\n        audience: GOOGLE_CLIENT_ID,\n      });\n\n      const payload = ticket.getPayload();\n      if (!payload || !payload.email) {\n        return res.status(400).json({ message: \"Invalid Google token\" });\n      }\n\n      const user = await findOrCreateUserByGoogle({\n        googleId: payload.sub,\n        email: payload.email,\n        firstName: payload.given_name,\n        lastName: payload.family_name,\n        profileImageUrl: payload.picture,\n      });\n\n      if (!user.isActive || user.accountStatus === \"deactivated\") {\n        return res.status(403).json({ message: \"Account deactivated\" });\n      }\n\n      req.session.userId = user.id;\n      req.session.email = user.email || undefined;\n      req.session.isAdmin = user.isAdmin || false;\n      req.session.isSupport = (user as any).isSupport || false;\n      \n      await new Promise<void>((resolve, reject) => {\n        req.session.save((err) => {\n          if (err) reject(err);\n          else resolve();\n        });\n      });\n\n      return res.json({\n        message: \"Login successful\",\n        user: {\n          id: user.id,\n          email: user.email,\n          firstName: user.firstName,\n          lastName: user.lastName,\n          profileImageUrl: user.profileImageUrl,\n          clientId: user.clientId,\n          isAdmin: user.isAdmin,\n          emailVerified: user.emailVerified,\n          googleId: user.googleId ? true : false,\n        }\n      });\n    } catch (error) {\n      console.error(\"Error en autenticacion de Google:\", error);\n      return res.status(401).json({ message: \"Error verifying Google credential\" });\n    }\n  });\n\n  app.post(\"/api/auth/connect/google\", async (req: Request, res: Response) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: \"Not authenticated\" });\n      }\n\n      const { credential } = req.body;\n      if (!credential || !googleClient || !GOOGLE_CLIENT_ID) {\n        return res.status(400).json({ message: \"Google credential required\" });\n      }\n\n      const ticket = await googleClient.verifyIdToken({\n        idToken: credential,\n        audience: GOOGLE_CLIENT_ID,\n      });\n\n      const payload = ticket.getPayload();\n      if (!payload) {\n        return res.status(400).json({ message: \"Invalid token\" });\n      }\n\n      const existingUser = await db.select().from(users).where(eq(users.googleId, payload.sub)).limit(1);\n      if (existingUser.length > 0 && existingUser[0].id !== req.session.userId) {\n        return res.status(409).json({ message: \"This Google account is already linked to another user\" });\n      }\n\n      await db.update(users).set({ \n        googleId: payload.sub,\n        updatedAt: new Date()\n      }).where(eq(users.id, req.session.userId));\n\n      return res.json({ message: \"Google account linked successfully\" });\n    } catch (error) {\n      console.error(\"Error conectando Google:\", error);\n      return res.status(500).json({ message: \"Error linking Google account\" });\n    }\n  });\n\n  app.post(\"/api/auth/disconnect/google\", async (req: Request, res: Response) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: \"Not authenticated\" });\n      }\n\n      const userId = req.session.userId;\n      const user = await db.select().from(users).where(eq(users.id, userId)).limit(1);\n\n      if (user.length === 0) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      if (!user[0].passwordHash) {\n        return res.status(400).json({ \n          message: \"You must have a password configured before unlinking Google\" \n        });\n      }\n\n      await db.update(users).set({ \n        googleId: null,\n        updatedAt: new Date()\n      }).where(eq(users.id, userId));\n\n      return res.json({ message: \"Google account unlinked successfully\" });\n    } catch (error) {\n      console.error(\"Error desconectando Google:\", error);\n      return res.status(500).json({ message: \"Error unlinking Google account\" });\n    }\n  });\n}\n", "import { db } from \"../db\";\nimport { llcApplications, maintenanceApplications, orders, users } from \"@shared/schema\";\nimport { eq, and, lt, isNull, isNotNull, or } from \"drizzle-orm\";\nimport { sendEmail, getAbandonedApplicationReminderTemplate } from \"./email\";\n\nconst ABANDONMENT_THRESHOLD_HOURS = 48;\nconst REMINDER_INTERVAL_HOURS = 12;\nconst MAX_REMINDERS = 3;\n\nasync function markAsAbandoned() {\n  const cutoffDate = new Date(Date.now() - 24 * 60 * 60 * 1000);\n  \n  await db.update(llcApplications)\n    .set({ abandonedAt: new Date() })\n    .where(and(\n      eq(llcApplications.status, \"draft\"),\n      lt(llcApplications.lastUpdated, cutoffDate),\n      isNull(llcApplications.abandonedAt)\n    ));\n  \n  await db.update(maintenanceApplications)\n    .set({ abandonedAt: new Date() })\n    .where(and(\n      eq(maintenanceApplications.status, \"draft\"),\n      lt(maintenanceApplications.lastUpdated, cutoffDate),\n      isNull(maintenanceApplications.abandonedAt)\n    ));\n}\n\nasync function sendReminders() {\n  const now = new Date();\n  const reminderCutoff = new Date(now.getTime() - REMINDER_INTERVAL_HOURS * 60 * 60 * 1000);\n  const deletionThreshold = new Date(now.getTime() - ABANDONMENT_THRESHOLD_HOURS * 60 * 60 * 1000);\n  \n  const abandonedLlcApps = await db.select({\n    id: llcApplications.id,\n    ownerEmail: llcApplications.ownerEmail,\n    ownerFullName: llcApplications.ownerFullName,\n    state: llcApplications.state,\n    abandonedAt: llcApplications.abandonedAt,\n    remindersSent: llcApplications.remindersSent,\n    lastReminderAt: llcApplications.lastReminderAt,\n    orderId: llcApplications.orderId,\n  })\n  .from(llcApplications)\n  .where(and(\n    eq(llcApplications.status, \"draft\"),\n    isNotNull(llcApplications.abandonedAt),\n    lt(llcApplications.remindersSent, MAX_REMINDERS),\n    or(\n      isNull(llcApplications.lastReminderAt),\n      lt(llcApplications.lastReminderAt, reminderCutoff)\n    )\n  ))\n  .limit(20);\n  \n  for (const app of abandonedLlcApps) {\n    if (!app.ownerEmail || !app.abandonedAt) continue;\n    \n    const hoursRemaining = Math.max(0, \n      ABANDONMENT_THRESHOLD_HOURS - ((now.getTime() - app.abandonedAt.getTime()) / (60 * 60 * 1000))\n    );\n    \n    if (hoursRemaining <= 0) continue;\n    \n    const name = app.ownerFullName || \"Cliente\";\n    const state = app.state || \"EE.UU.\";\n    \n    const html = getAbandonedApplicationReminderTemplate(name, 'llc', state, hoursRemaining);\n    \n    await sendEmail({\n      to: app.ownerEmail,\n      subject: `Tu solicitud de LLC est\u00E1 pendiente - Compl\u00E9tala ahora`,\n      html,\n    });\n    \n    await db.update(llcApplications)\n      .set({ \n        remindersSent: (app.remindersSent || 0) + 1,\n        lastReminderAt: now \n      })\n      .where(eq(llcApplications.id, app.id));\n  }\n  \n  const abandonedMaintApps = await db.select({\n    id: maintenanceApplications.id,\n    ownerEmail: maintenanceApplications.ownerEmail,\n    ownerFullName: maintenanceApplications.ownerFullName,\n    state: maintenanceApplications.state,\n    abandonedAt: maintenanceApplications.abandonedAt,\n    remindersSent: maintenanceApplications.remindersSent,\n    lastReminderAt: maintenanceApplications.lastReminderAt,\n    orderId: maintenanceApplications.orderId,\n  })\n  .from(maintenanceApplications)\n  .where(and(\n    eq(maintenanceApplications.status, \"draft\"),\n    isNotNull(maintenanceApplications.abandonedAt),\n    lt(maintenanceApplications.remindersSent, MAX_REMINDERS),\n    or(\n      isNull(maintenanceApplications.lastReminderAt),\n      lt(maintenanceApplications.lastReminderAt, reminderCutoff)\n    )\n  ))\n  .limit(20);\n  \n  for (const app of abandonedMaintApps) {\n    if (!app.ownerEmail || !app.abandonedAt) continue;\n    \n    const hoursRemaining = Math.max(0, \n      ABANDONMENT_THRESHOLD_HOURS - ((now.getTime() - app.abandonedAt.getTime()) / (60 * 60 * 1000))\n    );\n    \n    if (hoursRemaining <= 0) continue;\n    \n    const name = app.ownerFullName || \"Cliente\";\n    const state = app.state || \"EE.UU.\";\n    \n    const html = getAbandonedApplicationReminderTemplate(name, 'maintenance', state, hoursRemaining);\n    \n    await sendEmail({\n      to: app.ownerEmail,\n      subject: `Tu solicitud de mantenimiento est\u00E1 pendiente - Compl\u00E9tala ahora`,\n      html,\n    });\n    \n    await db.update(maintenanceApplications)\n      .set({ \n        remindersSent: (app.remindersSent || 0) + 1,\n        lastReminderAt: now \n      })\n      .where(eq(maintenanceApplications.id, app.id));\n  }\n}\n\nasync function cleanupAbandonedApplications() {\n  const deletionThreshold = new Date(Date.now() - ABANDONMENT_THRESHOLD_HOURS * 60 * 60 * 1000);\n  \n  const llcToDelete = await db.select({ id: llcApplications.id, orderId: llcApplications.orderId })\n    .from(llcApplications)\n    .where(and(\n      eq(llcApplications.status, \"draft\"),\n      lt(llcApplications.abandonedAt, deletionThreshold)\n    ));\n  \n  for (const app of llcToDelete) {\n    await db.delete(llcApplications).where(eq(llcApplications.id, app.id));\n    await db.delete(orders).where(eq(orders.id, app.orderId));\n  }\n  \n  const maintToDelete = await db.select({ id: maintenanceApplications.id, orderId: maintenanceApplications.orderId })\n    .from(maintenanceApplications)\n    .where(and(\n      eq(maintenanceApplications.status, \"draft\"),\n      lt(maintenanceApplications.abandonedAt, deletionThreshold)\n    ));\n  \n  for (const app of maintToDelete) {\n    await db.delete(maintenanceApplications).where(eq(maintenanceApplications.id, app.id));\n    await db.delete(orders).where(eq(orders.id, app.orderId));\n  }\n  \n  if (llcToDelete.length > 0 || maintToDelete.length > 0) {\n    console.log(`[Abandoned Cleanup] Deleted ${llcToDelete.length} LLC apps and ${maintToDelete.length} maintenance apps`);\n  }\n}\n\nexport async function processAbandonedApplications() {\n  try {\n    await markAsAbandoned();\n    await sendReminders();\n    await cleanupAbandonedApplications();\n  } catch (error) {\n    console.error(\"[Abandoned Service] Error:\", error);\n  }\n}\n", "import fs from \"fs\";\nimport path from \"path\";\nimport { objectStorageClient, ObjectStorageService } from \"../replit_integrations/object_storage\";\nimport { logAudit } from \"./security\";\n\nconst UPLOADS_DIR = path.join(process.cwd(), \"uploads\");\nconst BACKUP_INTERVAL = 60 * 60 * 1000; // 1 hour\nconst BACKUP_TRACKING_FILE = path.join(process.cwd(), \".backup-state.json\");\nconst BACKUP_TEMP_FILE = path.join(process.cwd(), \".backup-state.json.tmp\");\n\ninterface BackupFileState {\n  size: number;\n  mtimeMs: number;\n  objectPath: string;\n}\n\ninterface BackupState {\n  lastBackup: string;\n  backedUpFiles: Record<string, BackupFileState>;\n}\n\nfunction loadBackupState(): BackupState {\n  try {\n    if (fs.existsSync(BACKUP_TRACKING_FILE)) {\n      const content = fs.readFileSync(BACKUP_TRACKING_FILE, \"utf-8\");\n      const parsed = JSON.parse(content);\n      if (parsed && typeof parsed.backedUpFiles === \"object\") {\n        return parsed as BackupState;\n      }\n    }\n  } catch (error) {\n    console.error(\"[Backup] Error loading backup state:\", error);\n  }\n  return { lastBackup: \"\", backedUpFiles: {} };\n}\n\nfunction saveBackupStateAtomic(state: BackupState): void {\n  try {\n    const content = JSON.stringify(state, null, 2);\n    fs.writeFileSync(BACKUP_TEMP_FILE, content, \"utf-8\");\n    fs.renameSync(BACKUP_TEMP_FILE, BACKUP_TRACKING_FILE);\n  } catch (error) {\n    console.error(\"[Backup] Error saving backup state:\", error);\n    try {\n      if (fs.existsSync(BACKUP_TEMP_FILE)) {\n        fs.unlinkSync(BACKUP_TEMP_FILE);\n      }\n    } catch {}\n  }\n}\n\nfunction getAllFiles(dir: string, fileList: string[] = []): string[] {\n  if (!fs.existsSync(dir)) {\n    return fileList;\n  }\n  \n  const files = fs.readdirSync(dir);\n  for (const file of files) {\n    const filePath = path.join(dir, file);\n    try {\n      const stat = fs.statSync(filePath);\n      if (stat.isDirectory()) {\n        getAllFiles(filePath, fileList);\n      } else {\n        fileList.push(filePath);\n      }\n    } catch {\n      continue;\n    }\n  }\n  return fileList;\n}\n\nasync function backupFile(\n  filePath: string,\n  state: BackupState,\n  objectStorageService: ObjectStorageService\n): Promise<{ backed: boolean; error?: string }> {\n  try {\n    const stat = fs.statSync(filePath);\n    const relativePath = path.relative(UPLOADS_DIR, filePath);\n    const stateKey = relativePath;\n    \n    const existingBackup = state.backedUpFiles[stateKey];\n    if (existingBackup) {\n      if (\n        existingBackup.size === stat.size &&\n        existingBackup.mtimeMs === stat.mtimeMs\n      ) {\n        return { backed: false };\n      }\n    }\n    \n    const privateDir = objectStorageService.getPrivateObjectDir();\n    const objectPath = `${privateDir}/backups/${relativePath}`;\n    const { bucketName, objectName } = parseObjectPath(objectPath);\n    \n    const bucket = objectStorageClient.bucket(bucketName);\n    const file = bucket.file(objectName);\n    \n    const fileContent = fs.readFileSync(filePath);\n    await file.save(fileContent, {\n      metadata: {\n        contentType: getContentType(filePath),\n        metadata: {\n          originalPath: relativePath,\n          backupDate: new Date().toISOString(),\n        },\n      },\n    });\n    \n    state.backedUpFiles[stateKey] = {\n      size: stat.size,\n      mtimeMs: stat.mtimeMs,\n      objectPath,\n    };\n    \n    return { backed: true };\n  } catch (error) {\n    const errorMsg = error instanceof Error ? error.message : \"Unknown error\";\n    console.error(`[Backup] Error backing up ${filePath}:`, errorMsg);\n    return { backed: false, error: errorMsg };\n  }\n}\n\nfunction parseObjectPath(pathStr: string): { bucketName: string; objectName: string } {\n  if (!pathStr.startsWith(\"/\")) {\n    pathStr = `/${pathStr}`;\n  }\n  const parts = pathStr.split(\"/\");\n  if (parts.length < 3) {\n    throw new Error(\"Invalid path: must contain at least a bucket name\");\n  }\n  return {\n    bucketName: parts[1],\n    objectName: parts.slice(2).join(\"/\"),\n  };\n}\n\nfunction getContentType(filePath: string): string {\n  const ext = path.extname(filePath).toLowerCase();\n  const mimeTypes: Record<string, string> = {\n    \".pdf\": \"application/pdf\",\n    \".jpg\": \"image/jpeg\",\n    \".jpeg\": \"image/jpeg\",\n    \".png\": \"image/png\",\n    \".gif\": \"image/gif\",\n    \".doc\": \"application/msword\",\n    \".docx\": \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n    \".txt\": \"text/plain\",\n  };\n  return mimeTypes[ext] || \"application/octet-stream\";\n}\n\nfunction pruneDeletedFiles(state: BackupState, currentFiles: Set<string>): number {\n  let pruned = 0;\n  const toDelete: string[] = [];\n  \n  for (const key of Object.keys(state.backedUpFiles)) {\n    if (!currentFiles.has(key)) {\n      toDelete.push(key);\n    }\n  }\n  \n  for (const key of toDelete) {\n    delete state.backedUpFiles[key];\n    pruned++;\n  }\n  \n  return pruned;\n}\n\nexport async function runBackup(): Promise<{ backedUp: number; skipped: number; errors: number; pruned: number }> {\n  const objectStorageService = new ObjectStorageService();\n  const state = loadBackupState();\n  \n  let backedUp = 0;\n  let skipped = 0;\n  let errors = 0;\n  const failedFiles: string[] = [];\n  \n  try {\n    const files = getAllFiles(UPLOADS_DIR);\n    const currentFiles = new Set<string>(\n      files.map(f => path.relative(UPLOADS_DIR, f))\n    );\n    \n    const pruned = pruneDeletedFiles(state, currentFiles);\n    \n    for (const filePath of files) {\n      const result = await backupFile(filePath, state, objectStorageService);\n      if (result.error) {\n        errors++;\n        failedFiles.push(path.relative(UPLOADS_DIR, filePath));\n      } else if (result.backed) {\n        backedUp++;\n      } else {\n        skipped++;\n      }\n    }\n    \n    state.lastBackup = new Date().toISOString();\n    saveBackupStateAtomic(state);\n    \n    logAudit({\n      action: \"backup_completed\",\n      details: { \n        backedUp, \n        skipped, \n        errors, \n        pruned,\n        totalFiles: files.length,\n        failedFiles: failedFiles.length > 0 ? failedFiles.slice(0, 10) : undefined\n      },\n    });\n    \n    console.log(`[Backup] Completed: ${backedUp} backed up, ${skipped} skipped, ${errors} errors, ${pruned} pruned`);\n    return { backedUp, skipped, errors, pruned };\n  } catch (error) {\n    console.error(\"[Backup] Error during backup:\", error);\n    logAudit({\n      action: \"backup_failed\",\n      details: { \n        error: error instanceof Error ? error.message : \"Unknown error\",\n        backedUp,\n        skipped,\n        errors\n      },\n    });\n    return { backedUp, skipped, errors, pruned: 0 };\n  }\n}\n\nexport function startBackupService(): void {\n  console.log(\"[Backup] Starting backup service...\");\n  \n  setTimeout(() => {\n    runBackup().catch(console.error);\n  }, 5000);\n  \n  setInterval(() => {\n    runBackup().catch(console.error);\n  }, BACKUP_INTERVAL);\n  \n  console.log(`[Backup] Service started. Will backup every ${BACKUP_INTERVAL / 1000 / 60} minutes.`);\n}\n\nexport function getBackupStatus(): BackupState {\n  return loadBackupState();\n}\n", "import { Storage, File } from \"@google-cloud/storage\";\nimport { Response } from \"express\";\nimport { randomUUID } from \"crypto\";\nimport {\n  ObjectAclPolicy,\n  ObjectPermission,\n  canAccessObject,\n  getObjectAclPolicy,\n  setObjectAclPolicy,\n} from \"./objectAcl\";\n\nconst REPLIT_SIDECAR_ENDPOINT = \"http://127.0.0.1:1106\";\n\n// The object storage client is used to interact with the object storage service.\nexport const objectStorageClient = new Storage({\n  credentials: {\n    audience: \"replit\",\n    subject_token_type: \"access_token\",\n    token_url: `${REPLIT_SIDECAR_ENDPOINT}/token`,\n    type: \"external_account\",\n    credential_source: {\n      url: `${REPLIT_SIDECAR_ENDPOINT}/credential`,\n      format: {\n        type: \"json\",\n        subject_token_field_name: \"access_token\",\n      },\n    },\n    universe_domain: \"googleapis.com\",\n  },\n  projectId: \"\",\n});\n\nexport class ObjectNotFoundError extends Error {\n  constructor() {\n    super(\"Object not found\");\n    this.name = \"ObjectNotFoundError\";\n    Object.setPrototypeOf(this, ObjectNotFoundError.prototype);\n  }\n}\n\n// The object storage service is used to interact with the object storage service.\nexport class ObjectStorageService {\n  constructor() {}\n\n  // Gets the public object search paths.\n  getPublicObjectSearchPaths(): Array<string> {\n    const pathsStr = process.env.PUBLIC_OBJECT_SEARCH_PATHS || \"\";\n    const paths = Array.from(\n      new Set(\n        pathsStr\n          .split(\",\")\n          .map((path) => path.trim())\n          .filter((path) => path.length > 0)\n      )\n    );\n    if (paths.length === 0) {\n      throw new Error(\n        \"PUBLIC_OBJECT_SEARCH_PATHS not set. Create a bucket in 'Object Storage' \" +\n          \"tool and set PUBLIC_OBJECT_SEARCH_PATHS env var (comma-separated paths).\"\n      );\n    }\n    return paths;\n  }\n\n  // Gets the private object directory.\n  getPrivateObjectDir(): string {\n    const dir = process.env.PRIVATE_OBJECT_DIR || \"\";\n    if (!dir) {\n      throw new Error(\n        \"PRIVATE_OBJECT_DIR not set. Create a bucket in 'Object Storage' \" +\n          \"tool and set PRIVATE_OBJECT_DIR env var.\"\n      );\n    }\n    return dir;\n  }\n\n  // Search for a public object from the search paths.\n  async searchPublicObject(filePath: string): Promise<File | null> {\n    for (const searchPath of this.getPublicObjectSearchPaths()) {\n      const fullPath = `${searchPath}/${filePath}`;\n\n      // Full path format: /<bucket_name>/<object_name>\n      const { bucketName, objectName } = parseObjectPath(fullPath);\n      const bucket = objectStorageClient.bucket(bucketName);\n      const file = bucket.file(objectName);\n\n      // Check if file exists\n      const [exists] = await file.exists();\n      if (exists) {\n        return file;\n      }\n    }\n\n    return null;\n  }\n\n  // Downloads an object to the response.\n  async downloadObject(file: File, res: Response, cacheTtlSec: number = 3600) {\n    try {\n      // Get file metadata\n      const [metadata] = await file.getMetadata();\n      // Get the ACL policy for the object.\n      const aclPolicy = await getObjectAclPolicy(file);\n      const isPublic = aclPolicy?.visibility === \"public\";\n      // Set appropriate headers\n      res.set({\n        \"Content-Type\": metadata.contentType || \"application/octet-stream\",\n        \"Content-Length\": metadata.size,\n        \"Cache-Control\": `${\n          isPublic ? \"public\" : \"private\"\n        }, max-age=${cacheTtlSec}`,\n      });\n\n      // Stream the file to the response\n      const stream = file.createReadStream();\n\n      stream.on(\"error\", (err) => {\n        console.error(\"Stream error:\", err);\n        if (!res.headersSent) {\n          res.status(500).json({ error: \"Error streaming file\" });\n        }\n      });\n\n      stream.pipe(res);\n    } catch (error) {\n      console.error(\"Error downloading file:\", error);\n      if (!res.headersSent) {\n        res.status(500).json({ error: \"Error downloading file\" });\n      }\n    }\n  }\n\n  // Gets the upload URL for an object entity.\n  async getObjectEntityUploadURL(): Promise<string> {\n    const privateObjectDir = this.getPrivateObjectDir();\n    if (!privateObjectDir) {\n      throw new Error(\n        \"PRIVATE_OBJECT_DIR not set. Create a bucket in 'Object Storage' \" +\n          \"tool and set PRIVATE_OBJECT_DIR env var.\"\n      );\n    }\n\n    const objectId = randomUUID();\n    const fullPath = `${privateObjectDir}/uploads/${objectId}`;\n\n    const { bucketName, objectName } = parseObjectPath(fullPath);\n\n    // Sign URL for PUT method with TTL\n    return signObjectURL({\n      bucketName,\n      objectName,\n      method: \"PUT\",\n      ttlSec: 900,\n    });\n  }\n\n  // Gets the object entity file from the object path.\n  async getObjectEntityFile(objectPath: string): Promise<File> {\n    if (!objectPath.startsWith(\"/objects/\")) {\n      throw new ObjectNotFoundError();\n    }\n\n    const parts = objectPath.slice(1).split(\"/\");\n    if (parts.length < 2) {\n      throw new ObjectNotFoundError();\n    }\n\n    const entityId = parts.slice(1).join(\"/\");\n    let entityDir = this.getPrivateObjectDir();\n    if (!entityDir.endsWith(\"/\")) {\n      entityDir = `${entityDir}/`;\n    }\n    const objectEntityPath = `${entityDir}${entityId}`;\n    const { bucketName, objectName } = parseObjectPath(objectEntityPath);\n    const bucket = objectStorageClient.bucket(bucketName);\n    const objectFile = bucket.file(objectName);\n    const [exists] = await objectFile.exists();\n    if (!exists) {\n      throw new ObjectNotFoundError();\n    }\n    return objectFile;\n  }\n\n  normalizeObjectEntityPath(\n    rawPath: string,\n  ): string {\n    if (!rawPath.startsWith(\"https://storage.googleapis.com/\")) {\n      return rawPath;\n    }\n  \n    // Extract the path from the URL by removing query parameters and domain\n    const url = new URL(rawPath);\n    const rawObjectPath = url.pathname;\n  \n    let objectEntityDir = this.getPrivateObjectDir();\n    if (!objectEntityDir.endsWith(\"/\")) {\n      objectEntityDir = `${objectEntityDir}/`;\n    }\n  \n    if (!rawObjectPath.startsWith(objectEntityDir)) {\n      return rawObjectPath;\n    }\n  \n    // Extract the entity ID from the path\n    const entityId = rawObjectPath.slice(objectEntityDir.length);\n    return `/objects/${entityId}`;\n  }\n\n  // Tries to set the ACL policy for the object entity and return the normalized path.\n  async trySetObjectEntityAclPolicy(\n    rawPath: string,\n    aclPolicy: ObjectAclPolicy\n  ): Promise<string> {\n    const normalizedPath = this.normalizeObjectEntityPath(rawPath);\n    if (!normalizedPath.startsWith(\"/\")) {\n      return normalizedPath;\n    }\n\n    const objectFile = await this.getObjectEntityFile(normalizedPath);\n    await setObjectAclPolicy(objectFile, aclPolicy);\n    return normalizedPath;\n  }\n\n  // Checks if the user can access the object entity.\n  async canAccessObjectEntity({\n    userId,\n    objectFile,\n    requestedPermission,\n  }: {\n    userId?: string;\n    objectFile: File;\n    requestedPermission?: ObjectPermission;\n  }): Promise<boolean> {\n    return canAccessObject({\n      userId,\n      objectFile,\n      requestedPermission: requestedPermission ?? ObjectPermission.READ,\n    });\n  }\n}\n\nfunction parseObjectPath(path: string): {\n  bucketName: string;\n  objectName: string;\n} {\n  if (!path.startsWith(\"/\")) {\n    path = `/${path}`;\n  }\n  const pathParts = path.split(\"/\");\n  if (pathParts.length < 3) {\n    throw new Error(\"Invalid path: must contain at least a bucket name\");\n  }\n\n  const bucketName = pathParts[1];\n  const objectName = pathParts.slice(2).join(\"/\");\n\n  return {\n    bucketName,\n    objectName,\n  };\n}\n\nasync function signObjectURL({\n  bucketName,\n  objectName,\n  method,\n  ttlSec,\n}: {\n  bucketName: string;\n  objectName: string;\n  method: \"GET\" | \"PUT\" | \"DELETE\" | \"HEAD\";\n  ttlSec: number;\n}): Promise<string> {\n  const request = {\n    bucket_name: bucketName,\n    object_name: objectName,\n    method,\n    expires_at: new Date(Date.now() + ttlSec * 1000).toISOString(),\n  };\n  const response = await fetch(\n    `${REPLIT_SIDECAR_ENDPOINT}/object-storage/signed-object-url`,\n    {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(request),\n    }\n  );\n  if (!response.ok) {\n    throw new Error(\n      `Failed to sign object URL, errorcode: ${response.status}, ` +\n        `make sure you're running on Replit`\n    );\n  }\n\n  const { signed_url: signedURL } = await response.json();\n  return signedURL;\n}\n\n", "import { File } from \"@google-cloud/storage\";\n\nconst ACL_POLICY_METADATA_KEY = \"custom:aclPolicy\";\n\n// The type of the access group.\n//\n// Can be flexibly defined according to the use case.\n//\n// Examples:\n// - USER_LIST: the users from a list stored in the database;\n// - EMAIL_DOMAIN: the users whose email is in a specific domain;\n// - GROUP_MEMBER: the users who are members of a specific group;\n// - SUBSCRIBER: the users who are subscribers of a specific service / content\n//   creator.\nexport enum ObjectAccessGroupType {}\n\n// The logic user group that can access the object.\nexport interface ObjectAccessGroup {\n  // The type of the access group.\n  type: ObjectAccessGroupType;\n  // The logic id that is enough to identify the qualified group members.\n  //\n  // It may have different format for different types. For example:\n  // - for USER_LIST, the id could be the user list db entity id, and the\n  //   user list db entity could contain a bunch of user ids. User needs\n  //   to be a member of the user list to be able to access the object.\n  // - for EMAIL_DOMAIN, the id could be the email domain, and the user needs\n  //   to have an email with the domain to be able to access the object.\n  // - for GROUP_MEMBER, the id could be the group db entity id, and the\n  //   group db entity could contain a bunch of user ids. User needs to be\n  //   a member of the group to be able to access the object.\n  // - for SUBSCRIBER, the id could be the subscriber db entity id, and the\n  //   subscriber db entity could contain a bunch of user ids. User needs to\n  //   be a subscriber to be able to access the object.\n  id: string;\n}\n\nexport enum ObjectPermission {\n  READ = \"read\",\n  WRITE = \"write\",\n}\n\nexport interface ObjectAclRule {\n  group: ObjectAccessGroup;\n  permission: ObjectPermission;\n}\n\n// The ACL policy of the object.\n// This would be set as part of the object custom metadata:\n// - key: \"custom:aclPolicy\"\n// - value: JSON string of the ObjectAclPolicy object.\nexport interface ObjectAclPolicy {\n  owner: string;\n  visibility: \"public\" | \"private\";\n  aclRules?: Array<ObjectAclRule>;\n}\n\n// Check if the requested permission is allowed based on the granted permission.\nfunction isPermissionAllowed(\n  requested: ObjectPermission,\n  granted: ObjectPermission,\n): boolean {\n  // Users granted with read or write permissions can read the object.\n  if (requested === ObjectPermission.READ) {\n    return [ObjectPermission.READ, ObjectPermission.WRITE].includes(granted);\n  }\n\n  // Only users granted with write permissions can write the object.\n  return granted === ObjectPermission.WRITE;\n}\n\n// The base class for all access groups.\n//\n// Different types of access groups can be implemented according to the use case.\nabstract class BaseObjectAccessGroup implements ObjectAccessGroup {\n  constructor(\n    public readonly type: ObjectAccessGroupType,\n    public readonly id: string,\n  ) {}\n\n  // Check if the user is a member of the group.\n  public abstract hasMember(userId: string): Promise<boolean>;\n}\n\nfunction createObjectAccessGroup(\n  group: ObjectAccessGroup,\n): BaseObjectAccessGroup {\n  switch (group.type) {\n    // Implement the case for each type of access group to instantiate.\n    //\n    // For example:\n    // case \"USER_LIST\":\n    //   return new UserListAccessGroup(group.id);\n    // case \"EMAIL_DOMAIN\":\n    //   return new EmailDomainAccessGroup(group.id);\n    // case \"GROUP_MEMBER\":\n    //   return new GroupMemberAccessGroup(group.id);\n    // case \"SUBSCRIBER\":\n    //   return new SubscriberAccessGroup(group.id);\n    default:\n      throw new Error(`Unknown access group type: ${group.type}`);\n  }\n}\n\n// Sets the ACL policy to the object metadata.\nexport async function setObjectAclPolicy(\n  objectFile: File,\n  aclPolicy: ObjectAclPolicy,\n): Promise<void> {\n  const [exists] = await objectFile.exists();\n  if (!exists) {\n    throw new Error(`Object not found: ${objectFile.name}`);\n  }\n\n  await objectFile.setMetadata({\n    metadata: {\n      [ACL_POLICY_METADATA_KEY]: JSON.stringify(aclPolicy),\n    },\n  });\n}\n\n// Gets the ACL policy from the object metadata.\nexport async function getObjectAclPolicy(\n  objectFile: File,\n): Promise<ObjectAclPolicy | null> {\n  const [metadata] = await objectFile.getMetadata();\n  const aclPolicy = metadata?.metadata?.[ACL_POLICY_METADATA_KEY];\n  if (!aclPolicy) {\n    return null;\n  }\n  return JSON.parse(aclPolicy as string);\n}\n\n// Checks if the user can access the object.\nexport async function canAccessObject({\n  userId,\n  objectFile,\n  requestedPermission,\n}: {\n  userId?: string;\n  objectFile: File;\n  requestedPermission: ObjectPermission;\n}): Promise<boolean> {\n  // When this function is called, the acl policy is required.\n  const aclPolicy = await getObjectAclPolicy(objectFile);\n  if (!aclPolicy) {\n    return false;\n  }\n\n  // Public objects are always accessible for read.\n  if (\n    aclPolicy.visibility === \"public\" &&\n    requestedPermission === ObjectPermission.READ\n  ) {\n    return true;\n  }\n\n  // Access control requires the user id.\n  if (!userId) {\n    return false;\n  }\n\n  // The owner of the object can always access it.\n  if (aclPolicy.owner === userId) {\n    return true;\n  }\n\n  // Go through the ACL rules to check if the user has the required permission.\n  for (const rule of aclPolicy.aclRules || []) {\n    const accessGroup = createObjectAccessGroup(rule.group);\n    if (\n      (await accessGroup.hasMember(userId)) &&\n      isPermissionAllowed(requestedPermission, rule.permission)\n    ) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n", "import type { Express } from \"express\";\nimport { ObjectStorageService, ObjectNotFoundError } from \"./objectStorage\";\n\n/**\n * Register object storage routes for file uploads.\n *\n * This provides example routes for the presigned URL upload flow:\n * 1. POST /api/uploads/request-url - Get a presigned URL for uploading\n * 2. The client then uploads directly to the presigned URL\n *\n * IMPORTANT: These are example routes. Customize based on your use case:\n * - Add authentication middleware for protected uploads\n * - Add file metadata storage (save to database after upload)\n * - Add ACL policies for access control\n */\nexport function registerObjectStorageRoutes(app: Express): void {\n  const objectStorageService = new ObjectStorageService();\n\n  /**\n   * Request a presigned URL for file upload.\n   *\n   * Request body (JSON):\n   * {\n   *   \"name\": \"filename.jpg\",\n   *   \"size\": 12345,\n   *   \"contentType\": \"image/jpeg\"\n   * }\n   *\n   * Response:\n   * {\n   *   \"uploadURL\": \"https://storage.googleapis.com/...\",\n   *   \"objectPath\": \"/objects/uploads/uuid\"\n   * }\n   *\n   * IMPORTANT: The client should NOT send the file to this endpoint.\n   * Send JSON metadata only, then upload the file directly to uploadURL.\n   */\n  app.post(\"/api/uploads/request-url\", async (req, res) => {\n    try {\n      const { name, size, contentType } = req.body;\n\n      if (!name) {\n        return res.status(400).json({\n          error: \"Missing required field: name\",\n        });\n      }\n\n      const uploadURL = await objectStorageService.getObjectEntityUploadURL();\n\n      // Extract object path from the presigned URL for later reference\n      const objectPath = objectStorageService.normalizeObjectEntityPath(uploadURL);\n\n      res.json({\n        uploadURL,\n        objectPath,\n        // Echo back the metadata for client convenience\n        metadata: { name, size, contentType },\n      });\n    } catch (error) {\n      console.error(\"Error generating upload URL:\", error);\n      res.status(500).json({ error: \"Failed to generate upload URL\" });\n    }\n  });\n\n  /**\n   * Serve uploaded objects.\n   *\n   * GET /objects/:objectPath(*)\n   *\n   * This serves files from object storage. For public files, no auth needed.\n   * For protected files, add authentication middleware and ACL checks.\n   */\n  app.get(\"/objects/:objectPath(*)\", async (req, res) => {\n    try {\n      const objectFile = await objectStorageService.getObjectEntityFile(req.path);\n      await objectStorageService.downloadObject(objectFile, res);\n    } catch (error) {\n      console.error(\"Error serving object:\", error);\n      if (error instanceof ObjectNotFoundError) {\n        return res.status(404).json({ error: \"Object not found\" });\n      }\n      return res.status(500).json({ error: \"Failed to serve object\" });\n    }\n  });\n}\n\n", "import type { Request, Response, NextFunction } from \"express\";\nimport crypto from \"crypto\";\n\nconst CSRF_TOKEN_LENGTH = 32;\nconst CSRF_HEADER = \"x-csrf-token\";\nconst CSRF_COOKIE = \"csrf_token\";\n\ndeclare module \"express-session\" {\n  interface SessionData {\n    csrfToken?: string;\n  }\n}\n\nexport function generateCsrfToken(): string {\n  return crypto.randomBytes(CSRF_TOKEN_LENGTH).toString(\"hex\");\n}\n\nexport function csrfMiddleware(req: Request, res: Response, next: NextFunction) {\n  if (!req.session.csrfToken) {\n    req.session.csrfToken = generateCsrfToken();\n  }\n  \n  res.locals.csrfToken = req.session.csrfToken;\n  next();\n}\n\nexport function validateCsrf(req: Request, res: Response, next: NextFunction) {\n  const safeMethods = [\"GET\", \"HEAD\", \"OPTIONS\"];\n  \n  if (safeMethods.includes(req.method)) {\n    return next();\n  }\n  \n  const tokenFromHeader = req.headers[CSRF_HEADER] as string;\n  const tokenFromBody = req.body?._csrf;\n  const tokenFromQuery = req.query?._csrf as string;\n  const submittedToken = tokenFromHeader || tokenFromBody || tokenFromQuery;\n  \n  if (!submittedToken || submittedToken !== req.session.csrfToken) {\n    return res.status(403).json({ \n      code: \"CSRF_INVALID\",\n      message: \"Token CSRF inv\u00E1lido. Por favor, recarga la p\u00E1gina e intenta de nuevo.\" \n    });\n  }\n  \n  next();\n}\n\nexport function getCsrfToken(req: Request, res: Response) {\n  if (!req.session.csrfToken) {\n    req.session.csrfToken = generateCsrfToken();\n  }\n  res.json({ csrfToken: req.session.csrfToken });\n}\n", "import type { Express, Request, Response, NextFunction } from \"express\";\nimport { db } from \"../db\";\nimport { storage } from \"../storage\";\nimport { orders as ordersTable, users as usersTable } from \"@shared/schema\";\nimport { and, eq, gt, sql } from \"drizzle-orm\";\nimport { logAudit, getClientIp } from \"../lib/security\";\nimport { isAuthenticated, isAdmin, isAdminOrSupport, isNotUnderReview } from \"../lib/custom-auth\";\n\ninterface CacheEntry<T> {\n  data: T;\n  timestamp: number;\n}\n\nconst statsCache = new Map<string, CacheEntry<any>>();\nconst STATS_CACHE_TTL = 30000;\n\nexport function getCachedData<T>(key: string): T | null {\n  const entry = statsCache.get(key);\n  if (entry && Date.now() - entry.timestamp < STATS_CACHE_TTL) {\n    return entry.data as T;\n  }\n  return null;\n}\n\nexport function setCachedData<T>(key: string, data: T): void {\n  statsCache.set(key, { data, timestamp: Date.now() });\n}\n\nconst ipOrderTracker = new Map<string, number[]>();\nconst IP_BLOCK_THRESHOLD = 7;\nconst IP_BLOCK_DURATION = 24 * 60 * 60 * 1000;\n\nexport function startIpTrackerCleanup() {\n  setInterval(() => {\n    const cutoff = Date.now() - IP_BLOCK_DURATION;\n    ipOrderTracker.forEach((timestamps, ip) => {\n      const valid = timestamps.filter(t => t > cutoff);\n      if (valid.length === 0) {\n        ipOrderTracker.delete(ip);\n      } else {\n        ipOrderTracker.set(ip, valid);\n      }\n    });\n  }, 3600000);\n}\n\nexport function isIpBlockedFromOrders(ip: string): { blocked: boolean; ordersCount?: number } {\n  const timestamps = ipOrderTracker.get(ip) || [];\n  const cutoff = Date.now() - IP_BLOCK_DURATION;\n  const recentCount = timestamps.filter(t => t > cutoff).length;\n  return { blocked: recentCount >= IP_BLOCK_THRESHOLD, ordersCount: recentCount };\n}\n\nexport function trackOrderByIp(ip: string): void {\n  const timestamps = ipOrderTracker.get(ip) || [];\n  timestamps.push(Date.now());\n  ipOrderTracker.set(ip, timestamps);\n}\n\nexport async function detectSuspiciousOrderActivity(userId: string): Promise<{ suspicious: boolean; reason?: string }> {\n  const oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);\n  const recentOrders = await db.select({ id: ordersTable.id, createdAt: ordersTable.createdAt })\n    .from(ordersTable)\n    .where(\n      and(\n        eq(ordersTable.userId, userId),\n        gt(ordersTable.createdAt, oneDayAgo)\n      )\n    );\n  \n  if (recentOrders.length >= 7) {\n    return { suspicious: true, reason: `Created ${recentOrders.length} orders in 24 hours` };\n  }\n  \n  const oneHourAgo = new Date(Date.now() - 60 * 60 * 1000);\n  const veryRecentOrders = recentOrders.filter(o => o.createdAt && new Date(o.createdAt) > oneHourAgo);\n  if (veryRecentOrders.length >= 4) {\n    return { suspicious: true, reason: `Created ${veryRecentOrders.length} orders in 1 hour` };\n  }\n  \n  return { suspicious: false };\n}\n\nexport async function flagAccountForReview(userId: string, reason: string): Promise<void> {\n  await db.update(usersTable)\n    .set({ \n      accountStatus: 'pending',\n      securityOtpRequired: true,\n      internalNotes: sql`COALESCE(${usersTable.internalNotes}, '') || E'\\n[' || NOW() || '] SECURITY FLAG: ' || ${reason}`\n    })\n    .where(eq(usersTable.id, userId));\n  \n  logAudit({ \n    action: 'account_flagged_for_review', \n    userId, \n    details: { reason }\n  });\n}\n\nexport const logActivity = async (title: string, data: any, _req?: any) => {\n  if (process.env.NODE_ENV === 'development') {\n    console.log(`[LOG] ${title}:`, data);\n  }\n};\n\nexport const asyncHandler = (fn: any) => (req: any, res: any, next: any) => {\n  Promise.resolve(fn(req, res, next)).catch(next);\n};\n\nexport { db, storage, isAuthenticated, isAdmin, isAdminOrSupport, isNotUnderReview, logAudit, getClientIp };\n", "import type { Express } from \"express\";\nimport type { Request, Response } from \"express\";\nimport { z } from \"zod\";\nimport { and, eq, desc, sql } from \"drizzle-orm\";\nimport { asyncHandler, db, storage, isAdmin, isAdminOrSupport, logAudit } from \"./shared\";\nimport { orders as ordersTable, users as usersTable, maintenanceApplications, orderEvents, userNotifications, llcApplications as llcApplicationsTable, applicationDocuments as applicationDocumentsTable } from \"@shared/schema\";\nimport { sendEmail, sendTrustpilotEmail, getOrderUpdateTemplate } from \"../lib/email\";\nimport { updateApplicationDeadlines } from \"../calendar-service\";\n\nexport function registerAdminOrderRoutes(app: Express) {\n  // Admin Orders\n  app.get(\"/api/admin/orders\", isAdminOrSupport, async (req, res) => {\n    try {\n      const allOrders = await storage.getAllOrders();\n      res.json(allOrders);\n    } catch (error) {\n      console.error(\"Admin orders error:\", error);\n      res.status(500).json({ message: \"Error fetching orders\" });\n    }\n  });\n\n  app.patch(\"/api/admin/orders/:id/status\", isAdminOrSupport, asyncHandler(async (req: Request, res: Response) => {\n    const orderId = Number(req.params.id);\n    const { status } = z.object({ status: z.string() }).parse(req.body);\n    \n    const [updatedOrder] = await db.update(ordersTable)\n      .set({ status })\n      .where(eq(ordersTable.id, orderId))\n      .returning();\n    \n    // Audit log for order status change\n    logAudit({ \n      action: 'order_status_change', \n      userId: req.session?.userId, \n      targetId: String(orderId),\n      details: { newStatus: status } \n    });\n    \n    const order = await storage.getOrder(orderId);\n    if (order?.user?.email) {\n      const userLang = (order.user.preferredLanguage as string) || 'es';\n      \n      const statusLabelsI18n: Record<string, Record<string, string>> = {\n        pending: { es: \"Pendiente\", en: \"Pending\", ca: \"Pendent\", fr: \"En attente\", de: \"Ausstehend\", it: \"In sospeso\", pt: \"Pendente\" },\n        paid: { es: \"Pagado\", en: \"Paid\", ca: \"Pagat\", fr: \"Pay\u00E9\", de: \"Bezahlt\", it: \"Pagato\", pt: \"Pago\" },\n        processing: { es: \"En proceso\", en: \"Processing\", ca: \"En proc\u00E9s\", fr: \"En cours\", de: \"In Bearbeitung\", it: \"In elaborazione\", pt: \"Em processamento\" },\n        filed: { es: \"Presentado\", en: \"Filed\", ca: \"Presentat\", fr: \"D\u00E9pos\u00E9\", de: \"Eingereicht\", it: \"Presentato\", pt: \"Apresentado\" },\n        documents_ready: { es: \"Documentos listos\", en: \"Documents ready\", ca: \"Documents preparats\", fr: \"Documents pr\u00EAts\", de: \"Dokumente bereit\", it: \"Documenti pronti\", pt: \"Documentos prontos\" },\n        completed: { es: \"Completado\", en: \"Completed\", ca: \"Completat\", fr: \"Termin\u00E9\", de: \"Abgeschlossen\", it: \"Completato\", pt: \"Conclu\u00EDdo\" },\n        cancelled: { es: \"Cancelado\", en: \"Cancelled\", ca: \"Cancel\u00B7lat\", fr: \"Annul\u00E9\", de: \"Storniert\", it: \"Annullato\", pt: \"Cancelado\" }\n      };\n      \n      const statusLabel = statusLabelsI18n[status]?.[userLang] || statusLabelsI18n[status]?.es || status.replace(/_/g, \" \");\n\n      if (status === 'completed' && order.userId) {\n        await db.update(usersTable)\n          .set({ accountStatus: 'vip' })\n          .where(eq(usersTable.id, order.userId));\n        \n        const orderCode = order.application?.requestCode || order.maintenanceApplication?.requestCode || order.invoiceNumber || `#${order.id}`;\n        sendTrustpilotEmail({\n          to: order.user.email,\n          name: order.user.firstName || \"Cliente\",\n          orderNumber: orderCode\n        }).catch(() => {});\n      }\n\n      if (status === 'filed' && order.application) {\n        const formationDate = new Date();\n        const state = order.application.state || \"new_mexico\";\n        const hasTaxExtension = order.application.hasTaxExtension || false;\n        await updateApplicationDeadlines(order.application.id, formationDate, state, hasTaxExtension);\n      }\n\n      if (status === 'cancelled' && order.application) {\n        await db.update(llcApplicationsTable).set({\n          irs1120DueDate: null,\n          irs5472DueDate: null,\n          annualReportDueDate: null,\n          agentRenewalDate: null,\n        }).where(eq(llcApplicationsTable.id, order.application.id));\n      }\n\n      const orderCode = order.application?.requestCode || order.maintenanceApplication?.requestCode || order.invoiceNumber || `#${order.id}`;\n      \n      const messageKey = status === 'completed' ? 'ntf.orderUpdateCompleted.message' : 'ntf.orderUpdate.message';\n      \n      await db.insert(userNotifications).values({\n        userId: order.userId,\n        orderId: order.id,\n        orderCode,\n        title: `i18n:ntf.orderUpdate.title::{\"statusLabel\":\"@ntf.orderStatus.${status}\"}`,\n        message: `i18n:${messageKey}::{\"orderCode\":\"${orderCode}\",\"statusLabel\":\"@ntf.orderStatus.${status}\"}`,\n        type: 'update',\n        isRead: false\n      });\n\n      await db.insert(orderEvents).values({\n        orderId: order.id,\n        eventType: statusLabel,\n        description: `${statusLabel} \u2014 ${orderCode}`,\n        createdBy: req.session.userId\n      });\n\n      const emailSubjects: Record<string, string> = {\n        es: `Actualizaci\u00F3n de estado - Pedido ${order.invoiceNumber || `#${order.id}`}`,\n        en: `Status update - Order ${order.invoiceNumber || `#${order.id}`}`,\n        ca: `Actualitzaci\u00F3 d'estat - Comanda ${order.invoiceNumber || `#${order.id}`}`,\n        fr: `Mise \u00E0 jour - Commande ${order.invoiceNumber || `#${order.id}`}`,\n        de: `Statusaktualisierung - Bestellung ${order.invoiceNumber || `#${order.id}`}`,\n        it: `Aggiornamento stato - Ordine ${order.invoiceNumber || `#${order.id}`}`,\n        pt: `Atualiza\u00E7\u00E3o de estado - Pedido ${order.invoiceNumber || `#${order.id}`}`\n      };\n\n      const emailBodies: Record<string, string> = {\n        es: `Tu pedido ha pasado a estado: ${statusLabel}. Puedes ver los detalles en tu \u00E1rea de clientes.`,\n        en: `Your order status has been updated to: ${statusLabel}. You can view the details in your dashboard.`,\n        ca: `La teva comanda ha passat a estat: ${statusLabel}. Pots veure els detalls a la teva \u00E0rea de clients.`,\n        fr: `Votre commande est pass\u00E9e \u00E0 l'\u00E9tat : ${statusLabel}. Vous pouvez consulter les d\u00E9tails dans votre espace client.`,\n        de: `Ihr Bestellstatus wurde auf ${statusLabel} aktualisiert. Sie k\u00F6nnen die Details in Ihrem Dashboard einsehen.`,\n        it: `Il tuo ordine \u00E8 passato allo stato: ${statusLabel}. Puoi visualizzare i dettagli nella tua area clienti.`,\n        pt: `O seu pedido foi atualizado para: ${statusLabel}. Pode ver os detalhes na sua \u00E1rea de clientes.`\n      };\n\n      sendEmail({\n        to: order.user.email,\n        subject: emailSubjects[userLang] || emailSubjects.es,\n        html: getOrderUpdateTemplate(\n          order.user.firstName || \"Cliente\",\n          order.invoiceNumber || `#${order.id}`,\n          status,\n          emailBodies[userLang] || emailBodies.es,\n          userLang as any\n        )\n      }).catch(() => {});\n    }\n    res.json(updatedOrder);\n  }));\n\n  app.patch(\"/api/admin/orders/:id/inline\", isAdminOrSupport, asyncHandler(async (req: Request, res: Response) => {\n    const orderId = Number(req.params.id);\n    const body = z.object({\n      amount: z.number().optional(),\n      companyName: z.string().optional(),\n      state: z.string().optional(),\n      ownerFullName: z.string().optional(),\n      ownerEmail: z.string().optional(),\n      ownerPhone: z.string().optional(),\n      businessCategory: z.string().optional(),\n      ein: z.string().optional(),\n      notes: z.string().optional(),\n    }).parse(req.body);\n\n    const [order] = await db.select().from(ordersTable).where(eq(ordersTable.id, orderId));\n    if (!order) return res.status(404).json({ message: \"Order not found\" });\n\n    if (body.amount !== undefined) {\n      await db.update(ordersTable).set({ amount: body.amount }).where(eq(ordersTable.id, orderId));\n    }\n\n    const appFields: Record<string, string | undefined> = {};\n    if (body.companyName !== undefined) appFields.companyName = body.companyName;\n    if (body.state !== undefined) appFields.state = body.state;\n    if (body.ownerFullName !== undefined) appFields.ownerFullName = body.ownerFullName;\n    if (body.ownerEmail !== undefined) appFields.ownerEmail = body.ownerEmail;\n    if (body.ownerPhone !== undefined) appFields.ownerPhone = body.ownerPhone;\n    if (body.businessCategory !== undefined) appFields.businessCategory = body.businessCategory;\n\n    if (Object.keys(appFields).length > 0) {\n      const [llcApp] = await db.select().from(llcApplicationsTable).where(eq(llcApplicationsTable.orderId, orderId));\n      if (llcApp) {\n        await db.update(llcApplicationsTable).set(appFields).where(eq(llcApplicationsTable.id, llcApp.id));\n      }\n      const [maintApp] = await db.select().from(maintenanceApplications).where(eq(maintenanceApplications.orderId, orderId));\n      if (maintApp) {\n        const maintFields: Record<string, string | undefined> = { ...appFields };\n        if (body.ein !== undefined) maintFields.ein = body.ein;\n        await db.update(maintenanceApplications).set(maintFields).where(eq(maintenanceApplications.id, maintApp.id));\n      }\n    }\n\n    logAudit({\n      action: 'order_updated',\n      userId: req.session?.userId,\n      targetId: orderId.toString(),\n      details: { orderId, changedFields: Object.keys(body) }\n    });\n    res.json({ success: true });\n  }));\n\n  // Update payment link on order (admin only)\n  app.patch(\"/api/admin/orders/:id/payment-link\", isAdminOrSupport, asyncHandler(async (req: Request, res: Response) => {\n    const orderId = Number(req.params.id);\n    const { paymentLink, paymentStatus, paymentDueDate } = z.object({\n      paymentLink: z.string().url().optional().nullable(),\n      paymentStatus: z.enum(['pending', 'paid', 'overdue', 'cancelled']).optional(),\n      paymentDueDate: z.string().optional().nullable()\n    }).parse(req.body);\n\n    const updateData: Record<string, unknown> = {};\n    if (paymentLink !== undefined) updateData.paymentLink = paymentLink;\n    if (paymentStatus) updateData.paymentStatus = paymentStatus;\n    if (paymentDueDate !== undefined) updateData.paymentDueDate = paymentDueDate ? new Date(paymentDueDate) : null;\n    if (paymentStatus === 'paid') updateData.paidAt = new Date();\n\n    const [updatedOrder] = await db.update(ordersTable)\n      .set(updateData)\n      .where(eq(ordersTable.id, orderId))\n      .returning();\n\n    if (!updatedOrder) {\n      return res.status(404).json({ message: \"Order not found\" });\n    }\n\n    logAudit({\n      action: 'payment_link_update',\n      userId: req.session?.userId,\n      targetId: String(orderId),\n      details: { paymentLink, paymentStatus }\n    });\n\n    res.json(updatedOrder);\n  }));\n\n  // Delete order (admin only) - Full cascade deletion\n  app.delete(\"/api/admin/orders/:id\", isAdmin, asyncHandler(async (req: Request, res: Response) => {\n    const orderId = Number(req.params.id);\n    \n    // Get order details before deletion for logging\n    const order = await storage.getOrder(orderId);\n    if (!order) {\n      return res.status(404).json({ message: \"Order not found\" });\n    }\n    \n    // Use transaction for safe cascade deletion\n    await db.transaction(async (tx) => {\n      // Delete order events\n      await tx.delete(orderEvents).where(eq(orderEvents.orderId, orderId));\n      \n      // Delete application documents\n      await tx.delete(applicationDocumentsTable).where(eq(applicationDocumentsTable.orderId, orderId));\n      \n      // Delete user notifications related to this order\n      if (order.userId) {\n        await tx.delete(userNotifications).where(\n          and(\n            eq(userNotifications.userId, order.userId),\n            sql`${userNotifications.message} LIKE ${'%' + (order.invoiceNumber || `#${orderId}`) + '%'}`\n          )\n        );\n      }\n      \n      // Delete the LLC application if exists\n      if (order.application?.id) {\n        await tx.delete(llcApplicationsTable).where(eq(llcApplicationsTable.id, order.application.id));\n      }\n      \n      // Finally delete the order\n      await tx.delete(ordersTable).where(eq(ordersTable.id, orderId));\n    });\n    \n    res.json({ success: true, message: \"Order deleted successfully\" });\n  }));\n\n  // Get incomplete/draft applications for admin\n  app.get(\"/api/admin/incomplete-applications\", isAdminOrSupport, async (req, res) => {\n    try {\n      const llcDrafts = await db.select({\n        id: llcApplicationsTable.id,\n        orderId: llcApplicationsTable.orderId,\n        requestCode: llcApplicationsTable.requestCode,\n        ownerFullName: llcApplicationsTable.ownerFullName,\n        ownerEmail: llcApplicationsTable.ownerEmail,\n        ownerPhone: llcApplicationsTable.ownerPhone,\n        companyName: llcApplicationsTable.companyName,\n        state: llcApplicationsTable.state,\n        status: llcApplicationsTable.status,\n        abandonedAt: llcApplicationsTable.abandonedAt,\n        remindersSent: llcApplicationsTable.remindersSent,\n        lastUpdated: llcApplicationsTable.lastUpdated,\n      })\n      .from(llcApplicationsTable)\n      .where(eq(llcApplicationsTable.status, \"draft\"))\n      .orderBy(desc(llcApplicationsTable.lastUpdated));\n      \n      const maintDrafts = await db.select({\n        id: maintenanceApplications.id,\n        orderId: maintenanceApplications.orderId,\n        requestCode: maintenanceApplications.requestCode,\n        ownerFullName: maintenanceApplications.ownerFullName,\n        ownerEmail: maintenanceApplications.ownerEmail,\n        ownerPhone: maintenanceApplications.ownerPhone,\n        companyName: maintenanceApplications.companyName,\n        state: maintenanceApplications.state,\n        status: maintenanceApplications.status,\n        abandonedAt: maintenanceApplications.abandonedAt,\n        remindersSent: maintenanceApplications.remindersSent,\n        lastUpdated: maintenanceApplications.lastUpdated,\n      })\n      .from(maintenanceApplications)\n      .where(eq(maintenanceApplications.status, \"draft\"))\n      .orderBy(desc(maintenanceApplications.lastUpdated));\n      \n      res.json({\n        llc: llcDrafts.map(d => ({ ...d, type: 'llc' })),\n        maintenance: maintDrafts.map(d => ({ ...d, type: 'maintenance' })),\n      });\n    } catch (error) {\n      console.error(\"Error fetching incomplete applications:\", error);\n      res.status(500).json({ message: \"Error fetching incomplete applications\" });\n    }\n  });\n\n  // Delete incomplete application (admin only) - with full cascade cleanup\n  app.delete(\"/api/admin/incomplete-applications/:type/:id\", isAdmin, asyncHandler(async (req: Request, res: Response) => {\n    const { type, id } = req.params;\n    const appId = Number(id);\n    \n    if (type === 'llc') {\n      const [app] = await db.select({ orderId: llcApplicationsTable.orderId })\n        .from(llcApplicationsTable)\n        .where(and(eq(llcApplicationsTable.id, appId), eq(llcApplicationsTable.status, \"draft\")));\n      \n      if (!app) {\n        return res.status(404).json({ message: \"Request not found\" });\n      }\n      \n      // Cascade delete: documents, notifications, events, application, order\n      await db.delete(applicationDocumentsTable).where(eq(applicationDocumentsTable.orderId, app.orderId));\n      await db.delete(orderEvents).where(eq(orderEvents.orderId, app.orderId));\n      await db.delete(llcApplicationsTable).where(eq(llcApplicationsTable.id, appId));\n      await db.delete(ordersTable).where(eq(ordersTable.id, app.orderId));\n    } else if (type === 'maintenance') {\n      const [app] = await db.select({ orderId: maintenanceApplications.orderId })\n        .from(maintenanceApplications)\n        .where(and(eq(maintenanceApplications.id, appId), eq(maintenanceApplications.status, \"draft\")));\n      \n      if (!app) {\n        return res.status(404).json({ message: \"Request not found\" });\n      }\n      \n      // Cascade delete: documents, notifications, events, application, order\n      await db.delete(applicationDocumentsTable).where(eq(applicationDocumentsTable.orderId, app.orderId));\n      await db.delete(orderEvents).where(eq(orderEvents.orderId, app.orderId));\n      await db.delete(maintenanceApplications).where(eq(maintenanceApplications.id, appId));\n      await db.delete(ordersTable).where(eq(ordersTable.id, app.orderId));\n    } else {\n      return res.status(400).json({ message: \"Invalid request type\" });\n    }\n    \n    res.json({ success: true, message: \"Incomplete request deleted\" });\n  }));\n\n  // Update LLC important dates with automatic calculation\n  app.patch(\"/api/admin/llc/:appId/dates\", isAdminOrSupport, asyncHandler(async (req: Request, res: Response) => {\n    const appId = Number(req.params.appId);\n    const { field, value } = z.object({ \n      field: z.enum(['llcCreatedDate', 'agentRenewalDate', 'irs1120DueDate', 'irs5472DueDate', 'annualReportDueDate', 'ein', 'registrationNumber', 'llcAddress', 'ownerSharePercentage', 'agentStatus', 'boiStatus', 'boiFiledDate']),\n      value: z.string()\n    }).parse(req.body);\n    \n    // Handle text fields (EIN, registration number, address, share percentage, agent status, BOI status)\n    const textFields = ['ein', 'registrationNumber', 'llcAddress', 'ownerSharePercentage', 'agentStatus', 'boiStatus'];\n    if (textFields.includes(field)) {\n      const updateData: Record<string, string | null> = {};\n      updateData[field] = value || null;\n      \n      // If marking agent as renewed, update the renewal date to next year\n      if (field === 'agentStatus' && value === 'renewed') {\n        const [app] = await db.select({ agentRenewalDate: llcApplicationsTable.agentRenewalDate })\n          .from(llcApplicationsTable)\n          .where(eq(llcApplicationsTable.id, appId))\n          .limit(1);\n        \n        if (app?.agentRenewalDate) {\n          const newRenewalDate = new Date(app.agentRenewalDate);\n          newRenewalDate.setFullYear(newRenewalDate.getFullYear() + 1);\n          await db.update(llcApplicationsTable)\n            .set({ \n              agentStatus: 'active',\n              agentRenewalDate: newRenewalDate \n            })\n            .where(eq(llcApplicationsTable.id, appId));\n          return res.json({ success: true, newRenewalDate });\n        }\n      }\n      \n      await db.update(llcApplicationsTable)\n        .set(updateData)\n        .where(eq(llcApplicationsTable.id, appId));\n      return res.json({ success: true });\n    }\n    \n    const dateValue = value ? new Date(value) : null;\n    const updateData: Record<string, Date | null> = {};\n    updateData[field] = dateValue;\n    \n    // Auto-calculate other fiscal dates when llcCreatedDate is set\n    if (field === 'llcCreatedDate' && dateValue) {\n      const creationDate = new Date(dateValue);\n      const creationYear = creationDate.getFullYear();\n      const nextYear = creationYear + 1;\n      \n      // Agent renewal: 1 year after creation\n      const agentRenewal = new Date(creationDate);\n      agentRenewal.setFullYear(agentRenewal.getFullYear() + 1);\n      updateData.agentRenewalDate = agentRenewal;\n      \n      // IRS 1120: March 15 of next year\n      updateData.irs1120DueDate = new Date(nextYear, 2, 15);\n      \n      // IRS 5472: April 15 of next year\n      updateData.irs5472DueDate = new Date(nextYear, 3, 15);\n      \n      // Annual Report: Get the LLC state to determine date\n      const [app] = await db.select({ state: llcApplicationsTable.state })\n        .from(llcApplicationsTable)\n        .where(eq(llcApplicationsTable.id, appId))\n        .limit(1);\n      \n      if (app?.state) {\n        // Annual report dates by state\n        // New Mexico: No annual report required\n        // Wyoming: First day of anniversary month\n        // Delaware: March 1\n        if (app.state === 'Wyoming') {\n          const wyomingDate = new Date(creationDate);\n          wyomingDate.setFullYear(wyomingDate.getFullYear() + 1);\n          wyomingDate.setDate(1);\n          updateData.annualReportDueDate = wyomingDate;\n        } else if (app.state === 'Delaware') {\n          updateData.annualReportDueDate = new Date(nextYear, 2, 1); // March 1\n        }\n        // New Mexico: no annual report, leave as null\n      }\n    }\n    \n    await db.update(llcApplicationsTable)\n      .set(updateData)\n      .where(eq(llcApplicationsTable.id, appId));\n    \n    res.json({ success: true });\n  }));\n\n  // Toggle tax extension for LLC application (6 months: Apr 15 -> Oct 15)\n  app.patch(\"/api/admin/llc/:appId/tax-extension\", isAdminOrSupport, asyncHandler(async (req: Request, res: Response) => {\n    const appId = Number(req.params.appId);\n    const { hasTaxExtension } = z.object({ \n      hasTaxExtension: z.boolean()\n    }).parse(req.body);\n    \n    // Get current application data\n    const [app] = await db.select()\n      .from(llcApplicationsTable)\n      .where(eq(llcApplicationsTable.id, appId))\n      .limit(1);\n    \n    if (!app) {\n      return res.status(404).json({ message: \"Application not found\" });\n    }\n    \n    // Update extension flag\n    await db.update(llcApplicationsTable)\n      .set({ hasTaxExtension })\n      .where(eq(llcApplicationsTable.id, appId));\n    \n    // Recalculate tax deadlines if LLC has been created\n    if (app.llcCreatedDate) {\n      const creationDate = new Date(app.llcCreatedDate);\n      const creationYear = creationDate.getFullYear();\n      const nextYear = creationYear + 1;\n      \n      // Tax extension: April 15 normally, October 15 with 6-month extension\n      const taxMonth = hasTaxExtension ? 9 : 3; // October (9) with extension, April (3) without\n      \n      await db.update(llcApplicationsTable)\n        .set({\n          irs1120DueDate: new Date(nextYear, taxMonth, 15),\n          irs5472DueDate: new Date(nextYear, taxMonth, 15),\n        })\n        .where(eq(llcApplicationsTable.id, appId));\n    }\n    \n    res.json({ \n      success: true, \n      hasTaxExtension\n    });\n  }));\n}\n", "import type { Express } from \"express\";\nimport type { Request, Response } from \"express\";\nimport { z } from \"zod\";\nimport { eq, desc, inArray, and, sql } from \"drizzle-orm\";\nimport { asyncHandler, db, isAdmin, isAdminOrSupport, logAudit, logActivity } from \"./shared\";\nimport { users as usersTable, orders as ordersTable, llcApplications as llcApplicationsTable, maintenanceApplications, applicationDocuments as applicationDocumentsTable, orderEvents, userNotifications, messages as messagesTable, messageReplies, contactOtps } from \"@shared/schema\";\nimport { sendEmail, getAccountDeactivatedTemplate, getAccountVipTemplate, getAccountReactivatedTemplate, getAdminPasswordResetTemplate, getAdminOtpRequestTemplate } from \"../lib/email\";\nimport { EmailLanguage, getOtpSubject } from \"../lib/email-translations\";\nimport { validatePassword } from \"../lib/security\";\n\nexport function registerAdminUserRoutes(app: Express) {\n  // Admin Users\n  app.get(\"/api/admin/users\", isAdmin, async (req, res) => {\n    try {\n      const users = await db.select().from(usersTable).orderBy(desc(usersTable.createdAt));\n      res.json(users);\n    } catch (error) {\n      res.status(500).json({ message: \"Error fetching users\" });\n    }\n  });\n\n  app.patch(\"/api/admin/users/:id\", isAdmin, asyncHandler(async (req: Request, res: Response) => {\n    const userId = req.params.id;\n    const updateSchema = z.object({\n      firstName: z.string().min(1).max(100).optional(),\n      lastName: z.string().min(1).max(100).optional(),\n      email: z.string().email().optional(),\n      phone: z.string().max(30).optional().nullable(),\n      address: z.string().optional().nullable(),\n      streetType: z.string().optional().nullable(),\n      city: z.string().optional().nullable(),\n      province: z.string().optional().nullable(),\n      postalCode: z.string().optional().nullable(),\n      country: z.string().optional().nullable(),\n      idNumber: z.string().optional().nullable(),\n      idType: z.enum(['dni', 'nie', 'passport']).optional().nullable(),\n      birthDate: z.string().optional().nullable(),\n      businessActivity: z.string().optional().nullable(),\n      isActive: z.boolean().optional(),\n      isAdmin: z.boolean().optional(),\n      isSupport: z.boolean().optional(),\n      accountStatus: z.enum(['active', 'pending', 'deactivated', 'vip']).optional(),\n      internalNotes: z.string().optional().nullable()\n    });\n    const data = updateSchema.parse(req.body);\n    \n    // Only afortuny07@gmail.com can assign admin/support privileges\n    const SUPER_ADMIN_EMAIL = \"afortuny07@gmail.com\";\n    if (data.isAdmin !== undefined || data.isSupport !== undefined) {\n      const [currentAdmin] = await db.select().from(usersTable).where(eq(usersTable.id, req.session?.userId || '')).limit(1);\n      if (!currentAdmin || currentAdmin.email !== SUPER_ADMIN_EMAIL) {\n        return res.status(403).json({ message: \"Only the main administrator can assign admin or support privileges\" });\n      }\n    }\n    \n    // If setting isAdmin to true, ensure emailVerified is also true\n    const updateData: any = { ...data, updatedAt: new Date() };\n    if (data.isAdmin === true) {\n      updateData.emailVerified = true;\n      updateData.accountStatus = 'active';\n    }\n    \n    const [updated] = await db.update(usersTable).set(updateData).where(eq(usersTable.id, userId)).returning();\n\n    // Audit log for user update\n    logAudit({ \n      action: 'admin_user_update', \n      userId: req.session?.userId, \n      targetId: userId,\n      details: { changes: Object.keys(data) } \n    });\n\n    // Trigger emails based on account status change\n    if (data.accountStatus) {\n      const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n      if (user && user.email) {\n        const uLang = ((user as any).preferredLanguage || 'es') as EmailLanguage;\n        if (data.accountStatus === 'deactivated') {\n          await sendEmail({\n            to: user.email,\n            subject: uLang === 'en' ? \"Account status notification\" : uLang === 'ca' ? \"Notificaci\u00F3 d'estat del compte\" : uLang === 'fr' ? \"Notification de statut de compte\" : uLang === 'de' ? \"Kontostatus-Benachrichtigung\" : uLang === 'it' ? \"Notifica stato account\" : uLang === 'pt' ? \"Notifica\u00E7\u00E3o de estado da conta\" : \"Notificaci\u00F3n de estado de cuenta\",\n            html: getAccountDeactivatedTemplate(user.firstName || undefined, uLang)\n          }).catch(() => {});\n          await db.insert(userNotifications).values({\n            userId,\n            title: 'i18n:ntf.accountDeactivated.title',\n            message: 'i18n:ntf.accountDeactivated.message',\n            type: 'action_required',\n            isRead: false\n          });\n        } else if (data.accountStatus === 'vip') {\n          await sendEmail({\n            to: user.email,\n            subject: uLang === 'en' ? \"Your account has been upgraded to VIP\" : uLang === 'ca' ? \"El teu compte ha estat actualitzat a VIP\" : uLang === 'fr' ? \"Votre compte a \u00E9t\u00E9 mis \u00E0 jour en VIP\" : uLang === 'de' ? \"Ihr Konto wurde auf VIP aktualisiert\" : uLang === 'it' ? \"Il tuo account \u00E8 stato aggiornato a VIP\" : uLang === 'pt' ? \"A sua conta foi atualizada para VIP\" : \"Tu cuenta ha sido actualizada a estado VIP\",\n            html: getAccountVipTemplate(user.firstName || undefined, uLang)\n          }).catch(() => {});\n          await db.insert(userNotifications).values({\n            userId,\n            title: 'i18n:ntf.accountVip.title',\n            message: 'i18n:ntf.accountVip.message',\n            type: 'update',\n            isRead: false\n          });\n        } else if (data.accountStatus === 'active') {\n          await sendEmail({\n            to: user.email,\n            subject: uLang === 'en' ? \"Your account has been reactivated\" : uLang === 'ca' ? \"El teu compte ha estat reactivat\" : uLang === 'fr' ? \"Votre compte a \u00E9t\u00E9 r\u00E9activ\u00E9\" : uLang === 'de' ? \"Ihr Konto wurde reaktiviert\" : uLang === 'it' ? \"Il tuo account \u00E8 stato riattivato\" : uLang === 'pt' ? \"A sua conta foi reativada\" : \"Tu cuenta ha sido reactivada\",\n            html: getAccountReactivatedTemplate(user.firstName || undefined, uLang)\n          }).catch(() => {});\n          await db.insert(userNotifications).values({\n            userId,\n            title: 'i18n:ntf.accountActivated.title',\n            message: 'i18n:ntf.accountActivated.message',\n            type: 'update',\n            isRead: false\n          });\n        }\n      }\n    }\n\n    // Log account changes to admin\n    if (data.accountStatus || data.isActive !== undefined) {\n      logActivity(\"Cambio Cr\u00EDtico de Cuenta\", { \n        userId, \n        \"Nuevo Estado\": data.accountStatus, \n        \"Activo\": data.isActive,\n        adminId: (req as any).session.userId \n      }, req);\n    }\n\n    res.json(updated);\n  }));\n\n  app.delete(\"/api/admin/users/:id\", isAdmin, async (req, res) => {\n    try {\n      const userId = req.params.id;\n      \n      // Cascade delete all user-related data for security and data integrity\n      // 1. Get all orders for this user\n      const userOrders = await db.select({ id: ordersTable.id }).from(ordersTable).where(eq(ordersTable.userId, userId));\n      const orderIds = userOrders.map(o => o.id);\n      \n      // 2. Get all LLC applications from user's orders\n      const userApps = orderIds.length > 0 \n        ? await db.select({ id: llcApplicationsTable.id }).from(llcApplicationsTable).where(inArray(llcApplicationsTable.orderId, orderIds))\n        : [];\n      const appIds = userApps.map(a => a.id);\n      \n      // 3. Delete documents associated with orders/applications\n      if (orderIds.length > 0) {\n        await db.delete(applicationDocumentsTable).where(inArray(applicationDocumentsTable.orderId, orderIds));\n      }\n      if (appIds.length > 0) {\n        await db.delete(applicationDocumentsTable).where(inArray(applicationDocumentsTable.applicationId, appIds));\n      }\n      \n      // 4. Delete order events\n      if (orderIds.length > 0) {\n        await db.delete(orderEvents).where(inArray(orderEvents.orderId, orderIds));\n      }\n      \n      // 5. Delete user notifications\n      await db.delete(userNotifications).where(eq(userNotifications.userId, userId));\n      \n      // 6. Delete message replies and messages\n      const userMessages = await db.select({ id: messagesTable.id }).from(messagesTable).where(eq(messagesTable.userId, userId));\n      const messageIds = userMessages.map(m => m.id);\n      if (messageIds.length > 0) {\n        await db.delete(messageReplies).where(inArray(messageReplies.messageId, messageIds));\n      }\n      await db.delete(messagesTable).where(eq(messagesTable.userId, userId));\n      \n      // 7. Delete maintenance applications from user's orders\n      if (orderIds.length > 0) {\n        await db.delete(maintenanceApplications).where(inArray(maintenanceApplications.orderId, orderIds));\n      }\n      \n      // 8. Delete LLC applications from user's orders\n      if (orderIds.length > 0) {\n        await db.delete(llcApplicationsTable).where(inArray(llcApplicationsTable.orderId, orderIds));\n      }\n      \n      // 9. Delete orders\n      await db.delete(ordersTable).where(eq(ordersTable.userId, userId));\n      \n      // 10. Finally delete the user\n      await db.delete(usersTable).where(eq(usersTable.id, userId));\n      \n      logAudit({ \n        action: 'admin_user_update', \n        userId: req.session?.userId, \n        targetId: userId,\n        details: { action: 'cascade_delete', deletedOrders: orderIds.length, deletedApps: appIds.length } \n      });\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting user:\", error);\n      res.status(500).json({ message: \"Error deleting user\" });\n    }\n  });\n\n  app.post(\"/api/admin/users/create\", isAdmin, asyncHandler(async (req: Request, res: Response) => {\n    const schema = z.object({\n      firstName: z.string().optional(),\n      lastName: z.string().optional(),\n      email: z.string().email(),\n      phone: z.string().optional(),\n      password: z.string().min(6)\n    });\n    const { firstName, lastName, email, phone, password } = schema.parse(req.body);\n    \n    const existing = await db.select().from(usersTable).where(eq(usersTable.email, email)).limit(1);\n    if (existing.length > 0) {\n      return res.status(400).json({ message: \"Email is already registered\" });\n    }\n    \n    const bcrypt = await import(\"bcrypt\");\n    const hashedPassword = await bcrypt.hash(password, 10);\n    \n    const [newUser] = await db.insert(usersTable).values({\n      email,\n      firstName: firstName || null,\n      lastName: lastName || null,\n      phone: phone || null,\n      passwordHash: hashedPassword,\n      emailVerified: true,\n      accountStatus: 'active'\n    }).returning();\n    \n    res.json({ success: true, userId: newUser.id });\n  }));\n\n  // Admin reset client password\n  app.post(\"/api/admin/users/:id/reset-password\", isAdmin, asyncHandler(async (req: Request, res: Response) => {\n    const userId = req.params.id;\n    const { newPassword } = req.body;\n    \n    if (!newPassword) {\n      return res.status(400).json({ message: \"Password is required\" });\n    }\n    \n    const passwordValidation = validatePassword(newPassword);\n    if (!passwordValidation.valid) {\n      return res.status(400).json({ message: passwordValidation.message });\n    }\n    \n    const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n    \n    const bcrypt = await import(\"bcrypt\");\n    const hashedPassword = await bcrypt.hash(newPassword, 10);\n    \n    await db.update(usersTable).set({ \n      passwordHash: hashedPassword, \n      updatedAt: new Date() \n    }).where(eq(usersTable.id, userId));\n    \n    logAudit({ \n      action: 'admin_password_reset', \n      userId: req.session?.userId, \n      targetId: userId,\n      details: { email: user.email }\n    });\n    \n    // Send email notification to user\n    if (user.email) {\n      const rpLang = ((user as any).preferredLanguage || 'es') as EmailLanguage;\n      await sendEmail({\n        to: user.email,\n        subject: rpLang === 'en' ? \"Your password has been reset\" : rpLang === 'ca' ? \"La teva contrasenya ha estat restablerta\" : rpLang === 'fr' ? \"Votre mot de passe a \u00E9t\u00E9 r\u00E9initialis\u00E9\" : rpLang === 'de' ? \"Ihr Passwort wurde zur\u00FCckgesetzt\" : rpLang === 'it' ? \"La tua password \u00E8 stata reimpostata\" : rpLang === 'pt' ? \"A sua palavra-passe foi redefinida\" : \"Tu contrase\u00F1a ha sido restablecida\",\n        html: getAdminPasswordResetTemplate(user.firstName || '', rpLang)\n      }).catch(() => {});\n    }\n    \n    res.json({ success: true });\n  }));\n\n  // Download all user documents as ZIP\n  app.get(\"/api/admin/users/:id/documents/download\", isAdminOrSupport, asyncHandler(async (req: Request, res: Response) => {\n    const userId = req.params.id;\n    const archiver = await import(\"archiver\");\n    const path = await import(\"path\");\n    const fs = await import(\"fs\");\n    \n    // Get user info\n    const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n    \n    // Get all documents for this user\n    const documents = await db.select()\n      .from(applicationDocumentsTable)\n      .where(eq(applicationDocumentsTable.userId, userId));\n    \n    if (documents.length === 0) {\n      return res.status(404).json({ message: \"No documents found for this user\" });\n    }\n    \n    // Create ZIP archive\n    const archive = archiver.default('zip', { zlib: { level: 9 } });\n    \n    res.setHeader('Content-Type', 'application/zip');\n    res.setHeader('Content-Disposition', `attachment; filename=\"documentos_${user.firstName || 'cliente'}_${user.clientId || userId}.zip\"`);\n    \n    archive.pipe(res);\n    \n    for (const doc of documents) {\n      const filePath = path.join(process.cwd(), doc.fileUrl);\n      if (fs.existsSync(filePath)) {\n        archive.file(filePath, { name: doc.fileName });\n      }\n    }\n    \n    await archive.finalize();\n    \n    logAudit({\n      action: 'admin_documents_download',\n      userId: req.session?.userId,\n      targetId: userId,\n      details: { documentCount: documents.length }\n    });\n  }));\n\n  // Deactivate user account (for clients who don't renew)\n  app.patch(\"/api/admin/users/:id/deactivate\", isAdmin, asyncHandler(async (req: Request, res: Response) => {\n    const userId = req.params.id;\n    const { reason, confirmDeactivation } = req.body;\n    \n    // Require explicit confirmation\n    if (!confirmDeactivation) {\n      return res.status(400).json({ message: \"Explicit confirmation required (confirmDeactivation: true)\" });\n    }\n    \n    const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n    \n    // Cannot deactivate admin users\n    if (user.isAdmin) {\n      return res.status(403).json({ message: \"Cannot deactivate an administrator\" });\n    }\n    \n    // Check if user is already deactivated\n    if (user.accountStatus === 'deactivated') {\n      return res.status(400).json({ message: \"User is already deactivated\" });\n    }\n    \n    // Check for any recent paid orders (within last 30 days)\n    const recentOrders = await db.select().from(ordersTable)\n      .where(and(\n        eq(ordersTable.userId, userId),\n        eq(ordersTable.status, 'paid'),\n        sql`${ordersTable.paidAt} > NOW() - INTERVAL '30 days'`\n      )).limit(1);\n    \n    if (recentOrders.length > 0) {\n      return res.status(400).json({ \n        message: \"Cannot deactivate: user has a recent payment in the last 30 days\" \n      });\n    }\n    \n    const sanitizedReason = reason ? String(reason).slice(0, 500) : 'No renov\u00F3 mantenimiento';\n    \n    await db.update(usersTable).set({\n      accountStatus: 'deactivated',\n      internalNotes: user.internalNotes \n        ? `${user.internalNotes}\\n[${new Date().toISOString()}] Desactivado por admin: ${sanitizedReason}`\n        : `[${new Date().toISOString()}] Desactivado por admin: ${sanitizedReason}`,\n      updatedAt: new Date(),\n    }).where(eq(usersTable.id, userId));\n    \n    logActivity(\"Usuario Desactivado\", { \n      \"Usuario ID\": userId,\n      \"ClientID\": user.clientId,\n      \"Email\": user.email,\n      \"Estado Anterior\": user.accountStatus,\n      \"Raz\u00F3n\": sanitizedReason,\n      \"Admin\": (req as any).session?.userId\n    });\n    \n    res.json({ success: true, message: \"User deactivated successfully\" });\n  }));\n  \n  // Reactivate user account\n  app.patch(\"/api/admin/users/:id/reactivate\", isAdmin, asyncHandler(async (req: Request, res: Response) => {\n    const userId = req.params.id;\n    const { reason } = req.body;\n    \n    const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n    \n    if (user.accountStatus !== 'deactivated') {\n      return res.status(400).json({ message: \"User is not deactivated\" });\n    }\n    \n    const sanitizedReason = reason ? String(reason).slice(0, 500) : 'Reactivado por admin';\n    \n    await db.update(usersTable).set({\n      accountStatus: 'active',\n      internalNotes: user.internalNotes \n        ? `${user.internalNotes}\\n[${new Date().toISOString()}] Reactivado: ${sanitizedReason}`\n        : `[${new Date().toISOString()}] Reactivado: ${sanitizedReason}`,\n      updatedAt: new Date(),\n    }).where(eq(usersTable.id, userId));\n    \n    logActivity(\"Usuario Reactivado\", { \n      \"Usuario ID\": userId,\n      \"Email\": user.email,\n      \"Raz\u00F3n\": sanitizedReason\n    });\n    \n    res.json({ success: true, message: \"User reactivated successfully\" });\n  }));\n\n  // Admin: Request OTP verification from a client\n  app.post(\"/api/admin/users/:userId/request-otp\", isAdmin, asyncHandler(async (req: Request, res: Response) => {\n    const { userId } = req.params;\n    const { reason } = req.body;\n    \n    const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n    if (!user || !user.email) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n    \n    const otp = Math.floor(100000 + Math.random() * 900000).toString();\n    const expiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000);\n    const userEmail = user.email;\n    \n    await db.insert(contactOtps).values({\n      email: userEmail,\n      otp,\n      otpType: \"profile_change\",\n      expiresAt,\n      verified: false\n    });\n    \n    const userLang = ((user as any).preferredLanguage || 'es') as EmailLanguage;\n    sendEmail({\n      to: userEmail,\n      subject: getOtpSubject(userLang),\n      html: getAdminOtpRequestTemplate(\n        user.firstName || 'Cliente',\n        otp,\n        reason,\n        userLang\n      )\n    }).catch(console.error);\n    \n    logActivity(\"OTP Verification Requested\", {\n      \"Admin\": (req as any).session?.userId || \"unknown\",\n      \"Target User\": userId,\n      \"Email\": user.email,\n      \"Reason\": reason || \"Admin request\"\n    });\n    \n    res.json({ success: true, message: \"OTP verification email sent to client\" });\n  }));\n}\n", "import type { Express } from \"express\";\nimport type { Request, Response } from \"express\";\nimport { z } from \"zod\";\nimport { and, or, eq, desc, sql } from \"drizzle-orm\";\nimport { asyncHandler, db, storage, isAdmin, logAudit, getCachedData, setCachedData } from \"./shared\";\nimport { users as usersTable, maintenanceApplications, newsletterSubscribers, messages as messagesTable, orderEvents, userNotifications, orders as ordersTable, llcApplications as llcApplicationsTable, applicationDocuments as applicationDocumentsTable, discountCodes, accountingTransactions, auditLogs } from \"@shared/schema\";\n\nexport function registerAdminBillingRoutes(app: Express) {\n  app.post(\"/api/admin/orders/create\", isAdmin, asyncHandler(async (req: Request, res: Response) => {\n    const validStates = [\"New Mexico\", \"Wyoming\", \"Delaware\"] as const;\n    const schema = z.object({\n      userId: z.string().uuid(),\n      state: z.enum(validStates),\n      amount: z.string().or(z.number()).refine(val => Number(val) > 0, { message: \"Amount must be greater than 0\" })\n    });\n    const { userId, state, amount } = schema.parse(req.body);\n    \n    const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n    \n    const productMap: Record<string, { id: number; name: string }> = {\n      \"New Mexico\": { id: 1, name: \"LLC New Mexico\" },\n      \"Wyoming\": { id: 2, name: \"LLC Wyoming\" },\n      \"Delaware\": { id: 3, name: \"LLC Delaware\" }\n    };\n    const product = productMap[state];\n    const amountCents = Math.round(Number(amount) * 100);\n    \n    const { generateUniqueAdminOrderCode } = await import(\"../lib/id-generator\");\n    const invoiceNumber = await generateUniqueAdminOrderCode(state);\n    \n    const [order] = await db.insert(ordersTable).values({\n      userId,\n      productId: product.id,\n      amount: amountCents,\n      status: 'pending',\n      invoiceNumber\n    }).returning();\n    \n    // Create LLC application so order shows in client dashboard (as 'submitted' not 'draft' since admin created it)\n    await db.insert(llcApplicationsTable).values({\n      orderId: order.id,\n      requestCode: invoiceNumber,\n      ownerFullName: user.firstName && user.lastName ? `${user.firstName} ${user.lastName}` : null,\n      ownerEmail: user.email,\n      ownerPhone: user.phone,\n      state,\n      status: 'submitted'\n    });\n    \n    await db.insert(orderEvents).values({\n      orderId: order.id,\n      eventType: 'order_created',\n      description: `Pedido ${invoiceNumber} creado por administrador`\n    });\n    \n    await db.insert(userNotifications).values({\n      userId,\n      orderId: order.id,\n      orderCode: invoiceNumber,\n      title: 'i18n:ntf.orderCreatedAdmin.title',\n      message: `i18n:ntf.orderCreatedAdmin.message::{\"invoiceNumber\":\"${invoiceNumber}\",\"productName\":\"${product.name}\"}`,\n      type: 'info',\n      isRead: false\n    });\n    \n    res.json({ success: true, orderId: order.id, invoiceNumber });\n  }));\n\n  // Admin create maintenance order\n  app.post(\"/api/admin/orders/create-maintenance\", isAdmin, asyncHandler(async (req: Request, res: Response) => {\n    const validStates = [\"New Mexico\", \"Wyoming\", \"Delaware\"] as const;\n    const schema = z.object({\n      userId: z.string().uuid(),\n      state: z.enum(validStates),\n      amount: z.string().or(z.number()).refine(val => Number(val) > 0, { message: \"Amount must be greater than 0\" })\n    });\n    const { userId, state, amount } = schema.parse(req.body);\n    \n    const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n    \n    // Maintenance product IDs: NM=4, WY=5, DE=6\n    const productMap: Record<string, { id: number; name: string }> = {\n      \"New Mexico\": { id: 4, name: \"Mantenimiento Anual New Mexico\" },\n      \"Wyoming\": { id: 5, name: \"Mantenimiento Anual Wyoming\" },\n      \"Delaware\": { id: 6, name: \"Mantenimiento Anual Delaware\" }\n    };\n    const product = productMap[state];\n    const amountCents = Math.round(Number(amount) * 100);\n    \n    const { generateUniqueAdminOrderCode } = await import(\"../lib/id-generator\");\n    const invoiceNumber = `M-${await generateUniqueAdminOrderCode(state)}`;\n    \n    const [order] = await db.insert(ordersTable).values({\n      userId,\n      productId: product.id,\n      amount: amountCents,\n      status: 'pending',\n      invoiceNumber\n    }).returning();\n    \n    // Create maintenance application so order shows in client dashboard\n    await db.insert(maintenanceApplications).values({\n      orderId: order.id,\n      requestCode: invoiceNumber,\n      ownerFullName: user.firstName && user.lastName ? `${user.firstName} ${user.lastName}` : null,\n      ownerEmail: user.email,\n      ownerPhone: user.phone,\n      state,\n      status: 'submitted'\n    });\n    \n    await db.insert(orderEvents).values({\n      orderId: order.id,\n      eventType: 'order_created',\n      description: `Pedido de mantenimiento ${invoiceNumber} creado por administrador`\n    });\n    \n    await db.insert(userNotifications).values({\n      userId,\n      orderId: order.id,\n      orderCode: invoiceNumber,\n      title: 'i18n:ntf.maintenanceCreatedAdmin.title',\n      message: `i18n:ntf.maintenanceCreatedAdmin.message::{\"invoiceNumber\":\"${invoiceNumber}\",\"productName\":\"${product.name}\"}`,\n      type: 'info',\n      isRead: false\n    });\n    \n    // Audit log\n    logAudit({\n      action: 'admin_create_maintenance_order',\n      userId: req.session?.userId,\n      targetId: String(order.id),\n      details: { userId, state, amount: amountCents, invoiceNumber }\n    });\n    \n    res.json({ success: true, orderId: order.id, invoiceNumber });\n  }));\n\n  app.post(\"/api/admin/orders/create-custom\", isAdmin, asyncHandler(async (req: Request, res: Response) => {\n    const schema = z.object({\n      userId: z.string().uuid(),\n      concept: z.string().min(1, \"Concept is required\"),\n      amount: z.string().or(z.number()).refine(val => Number(val) > 0, { message: \"Amount must be greater than 0\" }),\n    });\n    const { userId, concept, amount } = schema.parse(req.body);\n    \n    const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n    \n    const amountCents = Math.round(Number(amount) * 100);\n    \n    const { generate8DigitId } = await import(\"../lib/id-generator\");\n    const invoiceNumber = `CUST-${generate8DigitId()}`;\n    \n    const [order] = await db.insert(ordersTable).values({\n      userId,\n      productId: 1,\n      amount: amountCents,\n      status: 'pending',\n      invoiceNumber\n    }).returning();\n    \n    await db.insert(orderEvents).values({\n      orderId: order.id,\n      eventType: 'order_created',\n      description: `Custom order: ${concept}`\n    });\n    \n    await db.insert(userNotifications).values({\n      userId,\n      orderId: order.id,\n      orderCode: invoiceNumber,\n      title: 'i18n:ntf.orderCreatedAdmin.title',\n      message: `i18n:ntf.orderCreatedAdmin.message::{\"invoiceNumber\":\"${invoiceNumber}\",\"productName\":\"${concept}\"}`,\n      type: 'info',\n      isRead: false\n    });\n    \n    logAudit({\n      action: 'admin_create_custom_order',\n      userId: req.session?.userId,\n      targetId: String(order.id),\n      details: { userId, concept, amount: amountCents, invoiceNumber }\n    });\n    \n    res.json({ success: true, orderId: order.id, invoiceNumber });\n  }));\n\n  app.get(\"/api/admin/system-stats\", isAdmin, async (req, res) => {\n    try {\n      // Check cache first\n      const cached = getCachedData<any>('system-stats');\n      if (cached) {\n        return res.json(cached);\n      }\n      \n      // Core metrics - parallel queries for performance\n      const [\n        salesResult,\n        pendingSalesResult,\n        userResult,\n        orderResult,\n        pendingOrdersResult,\n        completedOrdersResult,\n        processingOrdersResult,\n        subscriberResult,\n        pendingAccountsResult,\n        activeAccountsResult,\n        vipAccountsResult,\n        deactivatedAccountsResult,\n        messagesResult,\n        pendingMessagesResult,\n        docsResult,\n        pendingDocsResult\n      ] = await Promise.all([\n        db.select({ total: sql<number>`COALESCE(sum(amount), 0)` }).from(ordersTable).where(eq(ordersTable.status, 'completed')),\n        db.select({ total: sql<number>`COALESCE(sum(amount), 0)` }).from(ordersTable).where(eq(ordersTable.status, 'pending')),\n        db.select({ count: sql<number>`count(*)` }).from(usersTable),\n        db.select({ count: sql<number>`count(*)` }).from(ordersTable),\n        db.select({ count: sql<number>`count(*)` }).from(ordersTable).where(eq(ordersTable.status, 'pending')),\n        db.select({ count: sql<number>`count(*)` }).from(ordersTable).where(eq(ordersTable.status, 'completed')),\n        db.select({ count: sql<number>`count(*)` }).from(ordersTable).where(eq(ordersTable.status, 'processing')),\n        db.select({ count: sql<number>`count(*)` }).from(newsletterSubscribers),\n        db.select({ count: sql<number>`count(*)` }).from(usersTable).where(eq(usersTable.accountStatus, 'pending')),\n        db.select({ count: sql<number>`count(*)` }).from(usersTable).where(eq(usersTable.accountStatus, 'active')),\n        db.select({ count: sql<number>`count(*)` }).from(usersTable).where(eq(usersTable.accountStatus, 'vip')),\n        db.select({ count: sql<number>`count(*)` }).from(usersTable).where(eq(usersTable.accountStatus, 'deactivated')),\n        db.select({ count: sql<number>`count(*)` }).from(messagesTable),\n        db.select({ count: sql<number>`count(*)` }).from(messagesTable).where(eq(messagesTable.status, 'pending')),\n        db.select({ count: sql<number>`count(*)` }).from(applicationDocumentsTable),\n        db.select({ count: sql<number>`count(*)` }).from(applicationDocumentsTable).where(eq(applicationDocumentsTable.reviewStatus, 'pending'))\n      ]);\n\n      const totalSales = Number(salesResult[0]?.total || 0);\n      const pendingSales = Number(pendingSalesResult[0]?.total || 0);\n      const userCount = Number(userResult[0]?.count || 0);\n      const orderCount = Number(orderResult[0]?.count || 0);\n      const pendingOrders = Number(pendingOrdersResult[0]?.count || 0);\n      const completedOrders = Number(completedOrdersResult[0]?.count || 0);\n      const processingOrders = Number(processingOrdersResult[0]?.count || 0);\n      const subscriberCount = Number(subscriberResult[0]?.count || 0);\n      const pendingAccounts = Number(pendingAccountsResult[0]?.count || 0);\n      const activeAccounts = Number(activeAccountsResult[0]?.count || 0);\n      const vipAccounts = Number(vipAccountsResult[0]?.count || 0);\n      const deactivatedAccounts = Number(deactivatedAccountsResult[0]?.count || 0);\n      const totalMessages = Number(messagesResult[0]?.count || 0);\n      const pendingMessages = Number(pendingMessagesResult[0]?.count || 0);\n      const totalDocs = Number(docsResult[0]?.count || 0);\n      const pendingDocs = Number(pendingDocsResult[0]?.count || 0);\n\n      // Conversion rate\n      const conversionRate = userCount > 0 ? (orderCount / userCount) * 100 : 0;\n\n      const statsData = { \n        // Sales\n        totalSales,\n        pendingSales,\n        // Orders\n        orderCount,\n        pendingOrders,\n        completedOrders,\n        processingOrders,\n        // Users\n        userCount,\n        pendingAccounts,\n        activeAccounts,\n        vipAccounts,\n        deactivatedAccounts,\n        // Newsletter\n        subscriberCount,\n        // Messages\n        totalMessages,\n        pendingMessages,\n        // Documents\n        totalDocs,\n        pendingDocs,\n        // Metrics\n        conversionRate: Number(conversionRate.toFixed(2))\n      };\n      \n      // Cache the result for 30 seconds\n      setCachedData('system-stats', statsData);\n      \n      res.json(statsData);\n    } catch (error) {\n      console.error(\"System stats error:\", error);\n      res.status(500).json({ message: \"Error fetching system stats\" });\n    }\n  });\n\n  app.get(\"/api/admin/stats\", isAdmin, async (req, res) => {\n    try {\n      const result = await db.select({ total: sql<number>`sum(amount)` }).from(ordersTable).where(eq(ordersTable.status, 'completed'));\n      res.json({ totalSales: Number(result[0]?.total || 0) });\n    } catch (error) {\n      res.status(500).json({ message: \"Error fetching stats\" });\n    }\n  });\n\n  // Audit logs endpoint (persistent from database)\n  app.get(\"/api/admin/audit-logs\", isAdmin, async (req, res) => {\n    try {\n      const limit = Math.min(parseInt(req.query.limit as string) || 100, 500);\n      const offset = parseInt(req.query.offset as string) || 0;\n      const action = req.query.action as string | undefined;\n      const search = req.query.search as string | undefined;\n      \n      const conditions: any[] = [];\n      \n      if (action) {\n        conditions.push(eq(auditLogs.action, action));\n      }\n      \n      if (search) {\n        conditions.push(\n          or(\n            sql`${auditLogs.ip}::text ILIKE ${'%' + search + '%'}`,\n            sql`${auditLogs.userId}::text ILIKE ${'%' + search + '%'}`,\n            sql`${auditLogs.details}::text ILIKE ${'%' + search + '%'}`\n          )\n        );\n      }\n      \n      const whereClause = conditions.length > 0 ? and(...conditions) : undefined;\n      \n      const logsQuery = db.select().from(auditLogs)\n        .orderBy(desc(auditLogs.createdAt))\n        .limit(limit)\n        .offset(offset);\n      \n      const countQuery = db.select({ count: sql<number>`count(*)` }).from(auditLogs);\n      \n      if (whereClause) {\n        logsQuery.where(whereClause);\n        countQuery.where(whereClause);\n      }\n      \n      const [logs, countResult] = await Promise.all([logsQuery, countQuery]);\n      const total = Number(countResult[0]?.count || 0);\n      \n      const distinctActions = await db.selectDistinct({ action: auditLogs.action }).from(auditLogs).orderBy(auditLogs.action);\n      \n      res.json({ logs, total, limit, offset, actions: distinctActions.map(a => a.action) });\n    } catch (error) {\n      console.error(\"Audit logs error:\", error);\n      res.status(500).json({ message: \"Error fetching audit logs\" });\n    }\n  });\n\n  // ============== RENEWAL MANAGEMENT ==============\n  \n  // Get clients needing renewal (within 90 days or expired)\n  app.get(\"/api/admin/renewals\", isAdmin, async (req, res) => {\n    try {\n      const { getClientsNeedingRenewal } = await import(\"../calendar-service\");\n      const clients = await getClientsNeedingRenewal();\n      res.json(clients);\n    } catch (error) {\n      console.error(\"Error fetching renewal clients:\", error);\n      res.status(500).json({ message: \"Error fetching clients pending renewal\" });\n    }\n  });\n\n  // Get only expired clients (past renewal date, no maintenance order)\n  app.get(\"/api/admin/renewals/expired\", isAdmin, async (req, res) => {\n    try {\n      const { checkExpiredRenewals } = await import(\"../calendar-service\");\n      const expiredClients = await checkExpiredRenewals();\n      res.json(expiredClients);\n    } catch (error) {\n      console.error(\"Error fetching expired renewals:\", error);\n      res.status(500).json({ message: \"Error fetching expired renewals\" });\n    }\n  });\n\n  // ============== DISCOUNT CODES ==============\n  \n  // Get all discount codes (admin)\n  app.get(\"/api/admin/discount-codes\", isAdmin, async (req, res) => {\n    try {\n      const codes = await db.select().from(discountCodes).orderBy(desc(discountCodes.createdAt));\n      res.json(codes);\n    } catch (error) {\n      res.status(500).json({ message: \"Error fetching discount codes\" });\n    }\n  });\n\n  // Create discount code (admin)\n  app.post(\"/api/admin/discount-codes\", isAdmin, async (req, res) => {\n    try {\n      const { code, description, discountType, discountValue, minOrderAmount, maxUses, validFrom, validUntil, isActive } = req.body;\n      \n      if (!code || !discountValue) {\n        return res.status(400).json({ message: \"Discount code and value are required\" });\n      }\n\n      const [existing] = await db.select().from(discountCodes).where(eq(discountCodes.code, code.toUpperCase())).limit(1);\n      if (existing) {\n        return res.status(400).json({ message: \"This code already exists\" });\n      }\n\n      const [newCode] = await db.insert(discountCodes).values({\n        code: code.toUpperCase(),\n        description,\n        discountType: discountType || 'percentage',\n        discountValue: parseInt(discountValue),\n        minOrderAmount: minOrderAmount ? parseInt(minOrderAmount) : 0,\n        maxUses: maxUses ? parseInt(maxUses) : null,\n        validFrom: validFrom ? new Date(validFrom) : new Date(),\n        validUntil: validUntil ? new Date(validUntil) : null,\n        isActive: isActive !== false,\n      }).returning();\n\n      res.status(201).json(newCode);\n    } catch (error) {\n      res.status(500).json({ message: \"Error creating discount code\" });\n    }\n  });\n\n  // Update discount code (admin)\n  app.patch(\"/api/admin/discount-codes/:id\", isAdmin, async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      const { code, description, discountType, discountValue, minOrderAmount, maxUses, validFrom, validUntil, isActive } = req.body;\n\n      const updateData: any = {};\n      if (code) updateData.code = code.toUpperCase();\n      if (description !== undefined) updateData.description = description;\n      if (discountType) updateData.discountType = discountType;\n      if (discountValue !== undefined) updateData.discountValue = parseInt(discountValue);\n      if (minOrderAmount !== undefined) updateData.minOrderAmount = parseInt(minOrderAmount);\n      if (maxUses !== undefined) updateData.maxUses = maxUses ? parseInt(maxUses) : null;\n      if (validFrom) updateData.validFrom = new Date(validFrom);\n      if (validUntil !== undefined) updateData.validUntil = validUntil ? new Date(validUntil) : null;\n      if (isActive !== undefined) updateData.isActive = isActive;\n\n      const [updated] = await db.update(discountCodes).set(updateData).where(eq(discountCodes.id, id)).returning();\n      res.json(updated);\n    } catch (error) {\n      res.status(500).json({ message: \"Error updating discount code\" });\n    }\n  });\n\n  // Delete discount code (admin)\n  app.delete(\"/api/admin/discount-codes/:id\", isAdmin, async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      await db.delete(discountCodes).where(eq(discountCodes.id, id));\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ message: \"Error deleting discount code\" });\n    }\n  });\n\n  // ===== Payment Accounts Management =====\n  app.get(\"/api/admin/payment-accounts\", isAdmin, async (req, res) => {\n    try {\n      const accounts = await storage.getPaymentAccounts();\n      res.json(accounts);\n    } catch (error) {\n      res.status(500).json({ message: \"Error fetching payment accounts\" });\n    }\n  });\n\n  app.post(\"/api/admin/payment-accounts\", isAdmin, async (req, res) => {\n    try {\n      const schema = z.object({\n        label: z.string().min(1),\n        holder: z.string().min(1),\n        bankName: z.string().min(1),\n        accountType: z.string().default(\"checking\"),\n        accountNumber: z.string().optional().nullable(),\n        routingNumber: z.string().optional().nullable(),\n        iban: z.string().optional().nullable(),\n        swift: z.string().optional().nullable(),\n        address: z.string().optional().nullable(),\n        isActive: z.boolean().default(true),\n        sortOrder: z.number().default(0),\n      });\n      const data = schema.parse(req.body);\n      const account = await storage.createPaymentAccount(data);\n      res.json(account);\n    } catch (error: any) {\n      res.status(400).json({ message: error.message || \"Error creating payment account\" });\n    }\n  });\n\n  app.patch(\"/api/admin/payment-accounts/:id\", isAdmin, async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      const account = await storage.updatePaymentAccount(id, req.body);\n      res.json(account);\n    } catch (error) {\n      res.status(500).json({ message: \"Error updating payment account\" });\n    }\n  });\n\n  app.delete(\"/api/admin/payment-accounts/:id\", isAdmin, async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      await storage.deletePaymentAccount(id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ message: \"Error deleting payment account\" });\n    }\n  });\n\n  app.get(\"/api/payment-accounts/active\", async (_req, res) => {\n    try {\n      const accounts = await storage.getActivePaymentAccounts();\n      res.json(accounts);\n    } catch (error) {\n      res.status(500).json({ message: \"Error fetching payment accounts\" });\n    }\n  });\n\n  // Validate discount code (public - for checkout)\n  app.post(\"/api/discount-codes/validate\", async (req, res) => {\n    try {\n      const { code, orderAmount } = req.body;\n      \n      if (!code) {\n        return res.status(400).json({ valid: false, message: \"Code required\" });\n      }\n\n      const [discountCode] = await db.select().from(discountCodes).where(eq(discountCodes.code, code.toUpperCase())).limit(1);\n      \n      if (!discountCode) {\n        return res.status(404).json({ valid: false, message: \"Code not found\" });\n      }\n\n      if (!discountCode.isActive) {\n        return res.status(400).json({ valid: false, message: \"Code inactive\" });\n      }\n\n      const now = new Date();\n      if (discountCode.validFrom && new Date(discountCode.validFrom) > now) {\n        return res.status(400).json({ valid: false, message: \"Code not yet valid\" });\n      }\n      if (discountCode.validUntil && new Date(discountCode.validUntil) < now) {\n        return res.status(400).json({ valid: false, message: \"Code expired\" });\n      }\n\n      if (discountCode.maxUses && discountCode.usedCount >= discountCode.maxUses) {\n        return res.status(400).json({ valid: false, message: \"Code exhausted\" });\n      }\n\n      if (discountCode.minOrderAmount && orderAmount && orderAmount < discountCode.minOrderAmount) {\n        return res.status(400).json({ valid: false, message: `Minimum order: ${(discountCode.minOrderAmount / 100).toFixed(2)}\u20AC` });\n      }\n\n      // Calculate discount\n      let discountAmount = 0;\n      if (orderAmount) {\n        if (discountCode.discountType === 'percentage') {\n          discountAmount = Math.round((orderAmount * discountCode.discountValue) / 100);\n        } else {\n          discountAmount = discountCode.discountValue;\n        }\n      }\n\n      res.json({\n        valid: true,\n        code: discountCode.code,\n        discountType: discountCode.discountType,\n        discountValue: discountCode.discountValue,\n        discountAmount,\n        description: discountCode.description,\n      });\n    } catch (error) {\n      res.status(500).json({ valid: false, message: \"Error validating code\" });\n    }\n  });\n\n  // Admin Invoices list for accounting\n  app.get(\"/api/admin/invoices\", isAdmin, async (req, res) => {\n    try {\n      const invoices = await db.select({\n        id: applicationDocumentsTable.id,\n        orderId: applicationDocumentsTable.orderId,\n        fileName: applicationDocumentsTable.fileName,\n        fileUrl: applicationDocumentsTable.fileUrl,\n        uploadedAt: applicationDocumentsTable.uploadedAt,\n        order: {\n          id: ordersTable.id,\n          amount: ordersTable.amount,\n          currency: ordersTable.currency,\n          status: ordersTable.status,\n          invoiceNumber: ordersTable.invoiceNumber,\n          createdAt: ordersTable.createdAt,\n        },\n        user: {\n          id: usersTable.id,\n          firstName: usersTable.firstName,\n          lastName: usersTable.lastName,\n          email: usersTable.email,\n        }\n      })\n        .from(applicationDocumentsTable)\n        .leftJoin(ordersTable, eq(applicationDocumentsTable.orderId, ordersTable.id))\n        .leftJoin(usersTable, eq(ordersTable.userId, usersTable.id))\n        .where(eq(applicationDocumentsTable.documentType, \"invoice\"))\n        .orderBy(desc(applicationDocumentsTable.uploadedAt));\n      res.json(invoices);\n    } catch (error) {\n      console.error(\"Error fetching invoices:\", error);\n      res.status(500).json({ message: \"Error fetching invoices\" });\n    }\n  });\n\n  // Delete invoice (admin only)\n  app.delete(\"/api/admin/invoices/:id\", isAdmin, async (req, res) => {\n    try {\n      const invoiceId = parseInt(req.params.id);\n      await db.delete(applicationDocumentsTable).where(\n        and(\n          eq(applicationDocumentsTable.id, invoiceId),\n          eq(applicationDocumentsTable.documentType, \"invoice\")\n        )\n      );\n      res.json({ success: true, message: \"Invoice deleted\" });\n    } catch (error) {\n      console.error(\"Error deleting invoice:\", error);\n      res.status(500).json({ message: \"Error deleting invoice\" });\n    }\n  });\n\n  // Update invoice order status (admin only)\n  app.patch(\"/api/admin/invoices/:id/status\", isAdmin, async (req, res) => {\n    try {\n      const invoiceId = parseInt(req.params.id);\n      const { status } = z.object({\n        status: z.enum(['pending', 'paid', 'completed', 'cancelled', 'refunded'])\n      }).parse(req.body);\n      \n      const [invoice] = await db.select({ orderId: applicationDocumentsTable.orderId })\n        .from(applicationDocumentsTable)\n        .where(eq(applicationDocumentsTable.id, invoiceId))\n        .limit(1);\n      \n      if (!invoice?.orderId) {\n        return res.status(404).json({ message: \"Invoice or order not found\" });\n      }\n      \n      await db.update(ordersTable).set({ status })\n        .where(eq(ordersTable.id, invoice.orderId));\n      \n      res.json({ success: true, message: \"Status updated\" });\n    } catch (error) {\n      console.error(\"Error updating invoice status:\", error);\n      res.status(500).json({ message: \"Error updating status\" });\n    }\n  });\n\n  // Create standalone invoice for user (not tied to order)\n  app.post(\"/api/admin/invoices/create\", isAdmin, asyncHandler(async (req: Request, res: Response) => {\n    const { userId, concept, amount, currency } = z.object({\n      userId: z.string(),\n      concept: z.string().min(1),\n      amount: z.number().min(1),\n      currency: z.enum([\"EUR\", \"USD\"]).default(\"EUR\")\n    }).parse(req.body);\n    \n    const currencySymbol = currency === \"USD\" ? \"$\" : \"\u20AC\";\n\n    const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n\n    const { generateUniqueInvoiceNumber } = await import(\"../lib/id-generator\");\n    const invoiceNumber = await generateUniqueInvoiceNumber();\n    \n    // Generate invoice HTML\n    const invoiceHtml = `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"utf-8\">\n  <title>Factura ${invoiceNumber}</title>\n  <style>\n    body { font-family: 'Inter', Arial, sans-serif; margin: 0; padding: 40px; color: #0A0A0A; }\n    .header { display: flex; justify-content: space-between; margin-bottom: 40px; }\n    .logo { font-size: 24px; font-weight: 900; color: #0A0A0A; }\n    .logo span { color: #6EDC8A; }\n    .invoice-title { font-size: 32px; font-weight: 900; text-align: right; }\n    .invoice-number { font-size: 14px; color: #6B7280; text-align: right; }\n    .details { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-bottom: 40px; }\n    .section-title { font-size: 12px; color: #6B7280; text-transform: uppercase; margin-bottom: 8px; }\n    .section-content { font-size: 14px; line-height: 1.6; }\n    .items { margin: 40px 0; }\n    .items-header { display: grid; grid-template-columns: 3fr 1fr 1fr; padding: 12px 0; border-bottom: 2px solid #0A0A0A; font-weight: 700; font-size: 12px; text-transform: uppercase; }\n    .items-row { display: grid; grid-template-columns: 3fr 1fr 1fr; padding: 16px 0; border-bottom: 1px solid #E6E9EC; font-size: 14px; }\n    .total-section { text-align: right; margin-top: 24px; }\n    .total-row { font-size: 14px; margin-bottom: 8px; }\n    .total-final { font-size: 24px; font-weight: 900; color: #0A0A0A; }\n    .footer { margin-top: 60px; padding-top: 20px; border-top: 1px solid #E6E9EC; font-size: 11px; color: #6B7280; text-align: center; }\n  </style>\n</head>\n<body>\n  <div class=\"header\">\n    <div>\n      <div class=\"logo\">EASY<span>US</span></div>\n      <p style=\"font-size: 11px; color: #6B7280;\">Fortuny Consulting LLC</p>\n    </div>\n    <div>\n      <div class=\"invoice-title\">FACTURA</div>\n      <div class=\"invoice-number\">${invoiceNumber}</div>\n      <div class=\"invoice-number\">${new Date().toLocaleDateString('es-ES')}</div>\n    </div>\n  </div>\n  <div class=\"details\">\n    <div>\n      <div class=\"section-title\">Facturado a</div>\n      <div class=\"section-content\">\n        <strong>${user.firstName} ${user.lastName}</strong><br>\n        ${user.email}<br>\n        ${user.phone || ''}\n      </div>\n    </div>\n    <div>\n      <div class=\"section-title\">Emitido por</div>\n      <div class=\"section-content\">\n        <strong>Fortuny Consulting LLC</strong><br>\n        1209 Mountain Road Pl NE Ste R<br>\n        Albuquerque, NM 87110\n      </div>\n    </div>\n  </div>\n  <div class=\"items\">\n    <div class=\"items-header\">\n      <span>Concepto</span>\n      <span style=\"text-align:right;\">Cantidad</span>\n      <span style=\"text-align:right;\">Importe</span>\n    </div>\n    <div class=\"items-row\">\n      <span>${concept}</span>\n      <span style=\"text-align:right;\">1</span>\n      <span style=\"text-align:right;\">${(amount / 100).toFixed(2)} ${currencySymbol}</span>\n    </div>\n  </div>\n  <div class=\"total-section\">\n    <div class=\"total-row\">Subtotal: ${(amount / 100).toFixed(2)} ${currencySymbol}</div>\n    <div class=\"total-row\">IVA (0%): 0.00 ${currencySymbol}</div>\n    <div class=\"total-final\">Total: ${(amount / 100).toFixed(2)} ${currencySymbol}</div>\n  </div>\n  <div class=\"footer\">\n    <p>Fortuny Consulting LLC - EIN: 99-1877254</p>\n    <p>1209 Mountain Road Pl NE Ste R, Albuquerque, NM 87110, USA</p>\n    <p>hola@easyusllc.com | www.easyusllc.com</p>\n  </div>\n</body>\n</html>`;\n\n    // Store as document for user - try to find an order, but allow without one\n    const [userOrder] = await db.select().from(ordersTable).where(eq(ordersTable.userId, userId)).limit(1);\n    \n    // Store invoice as accounting transaction instead of document if no order\n    if (userOrder) {\n      await db.insert(applicationDocumentsTable).values({\n        orderId: userOrder.id,\n        fileName: `Factura ${invoiceNumber} - ${concept}`,\n        fileType: \"text/html\",\n        fileUrl: `data:text/html;base64,${Buffer.from(invoiceHtml).toString('base64')}`,\n        documentType: \"invoice\",\n        reviewStatus: \"approved\",\n        uploadedBy: req.session.userId\n      });\n    }\n    \n    // Also record as accounting transaction\n    await db.insert(accountingTransactions).values({\n      type: 'income',\n      category: 'other_income',\n      amount: amount, // amount is already in cents\n      description: `Factura ${invoiceNumber}: ${concept}`,\n      reference: invoiceNumber,\n      transactionDate: new Date(),\n      notes: `Cliente: ${user.firstName} ${user.lastName} (${user.email})`\n    });\n\n    res.json({ success: true, invoiceNumber });\n  }));\n}\n", "import type { Express } from \"express\";\nimport type { Request, Response } from \"express\";\nimport { z } from \"zod\";\nimport { desc, eq, sql } from \"drizzle-orm\";\nimport { db, storage, isAdmin, isAdminOrSupport, getClientIp, asyncHandler } from \"./shared\";\nimport { newsletterSubscribers, calculatorConsultations, messages as messagesTable, messageReplies } from \"@shared/schema\";\nimport { sendEmail } from \"../lib/email\";\n\nexport function registerAdminCommsRoutes(app: Express) {\n  // Admin Newsletter\n  app.get(\"/api/admin/newsletter\", isAdmin, async (req, res) => {\n    try {\n      const subscribers = await db.select().from(newsletterSubscribers).orderBy(desc(newsletterSubscribers.subscribedAt));\n      res.json(subscribers);\n    } catch (error) {\n      res.status(500).json({ message: \"Error\" });\n    }\n  });\n\n  // Delete newsletter subscriber\n  app.delete(\"/api/admin/newsletter/:id\", isAdmin, async (req, res) => {\n    try {\n      const { id } = req.params;\n      await db.delete(newsletterSubscribers).where(eq(newsletterSubscribers.id, parseInt(id)));\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ message: \"Error deleting subscriber\" });\n    }\n  });\n\n  // Calculator consultations - Save consultation + guest record\n  app.post(\"/api/calculator/consultation\", async (req, res) => {\n    try {\n      const { email, income, country, activity, savings } = z.object({\n        email: z.string().email(),\n        income: z.number().min(1),\n        country: z.string(),\n        activity: z.string().optional(),\n        savings: z.number().optional()\n      }).parse(req.body);\n\n      await db.insert(calculatorConsultations).values({\n        email,\n        income,\n        country,\n        activity: activity || null,\n        savings: savings || 0,\n        isRead: false\n      });\n\n      await storage.createGuestVisitor({\n        email,\n        source: 'calculator',\n        ip: getClientIp(req),\n        userAgent: req.headers['user-agent'] || null,\n        language: req.headers['accept-language']?.split(',')[0] || null,\n        page: '/tools/price-calculator',\n        referrer: req.headers['referer'] || null,\n        metadata: JSON.stringify({ income, country, activity: activity || null, savings: savings || 0 }),\n      });\n\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Calculator consultation error:\", error);\n      res.status(500).json({ message: \"Error saving consultation\" });\n    }\n  });\n\n  // Admin: Get calculator consultations\n  app.get(\"/api/admin/calculator-consultations\", isAdmin, async (req, res) => {\n    try {\n      const consultations = await db.select().from(calculatorConsultations).orderBy(desc(calculatorConsultations.createdAt));\n      res.json(consultations);\n    } catch (error) {\n      res.status(500).json({ message: \"Error fetching consultations\" });\n    }\n  });\n\n  // Admin: Mark consultation as read\n  app.patch(\"/api/admin/calculator-consultations/:id/read\", isAdmin, async (req, res) => {\n    try {\n      const { id } = req.params;\n      await db.update(calculatorConsultations).set({ isRead: true }).where(eq(calculatorConsultations.id, parseInt(id)));\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ message: \"Error marking as read\" });\n    }\n  });\n\n  // ============== GUEST VISITOR TRACKING ==============\n\n  app.post(\"/api/guest/track\", async (req, res) => {\n    try {\n      const data = z.object({\n        email: z.string().email().optional(),\n        source: z.string().min(1),\n        page: z.string().optional(),\n        metadata: z.string().optional(),\n      }).parse(req.body);\n\n      await storage.createGuestVisitor({\n        email: data.email || null,\n        source: data.source,\n        ip: getClientIp(req),\n        userAgent: req.headers['user-agent'] || null,\n        language: req.headers['accept-language']?.split(',')[0] || null,\n        page: data.page || null,\n        referrer: req.headers['referer'] || null,\n        metadata: data.metadata || null,\n      });\n\n      res.json({ success: true });\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid tracking data\" });\n    }\n  });\n\n  app.get(\"/api/admin/guests\", isAdmin, async (req, res) => {\n    try {\n      const guests = await storage.getAllGuestVisitors();\n      res.json(guests);\n    } catch (error) {\n      res.status(500).json({ message: \"Error fetching guests\" });\n    }\n  });\n\n  app.get(\"/api/admin/guests/stats\", isAdmin, async (req, res) => {\n    try {\n      const stats = await storage.getGuestVisitorStats();\n      res.json(stats);\n    } catch (error) {\n      res.status(500).json({ message: \"Error fetching guest stats\" });\n    }\n  });\n\n  app.delete(\"/api/admin/guests/:id\", isAdmin, async (req, res) => {\n    try {\n      await storage.deleteGuestVisitor(parseInt(req.params.id));\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ message: \"Error deleting guest\" });\n    }\n  });\n\n  app.delete(\"/api/admin/guests/email/:email\", isAdmin, async (req, res) => {\n    try {\n      const count = await storage.deleteGuestVisitorsByEmail(decodeURIComponent(req.params.email));\n      res.json({ success: true, deleted: count });\n    } catch (error) {\n      res.status(500).json({ message: \"Error deleting guest records\" });\n    }\n  });\n\n  // Admin: Delete calculator consultation\n  app.delete(\"/api/admin/calculator-consultations/:id\", isAdmin, async (req, res) => {\n    try {\n      const { id } = req.params;\n      await db.delete(calculatorConsultations).where(eq(calculatorConsultations.id, parseInt(id)));\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ message: \"Error deleting consultation\" });\n    }\n  });\n\n  // Admin: Get unread calculator consultations count\n  app.get(\"/api/admin/calculator-consultations/unread-count\", isAdmin, async (req, res) => {\n    try {\n      const [result] = await db.select({ count: sql<number>`count(*)` }).from(calculatorConsultations).where(eq(calculatorConsultations.isRead, false));\n      res.json({ count: result?.count || 0 });\n    } catch (error) {\n      res.status(500).json({ message: \"Error\" });\n    }\n  });\n\n  // Broadcast to all newsletter subscribers\n  app.post(\"/api/admin/newsletter/broadcast\", isAdmin, asyncHandler(async (req: Request, res: Response) => {\n    const { subject, message } = z.object({\n      subject: z.string().min(1),\n      message: z.string().min(1)\n    }).parse(req.body);\n\n    const subscribers = await db.select().from(newsletterSubscribers);\n    \n    const html = `\n      <div style=\"font-family: Inter, sans-serif; max-width: 600px; margin: 0 auto; padding: 40px 20px; background: #f7f7f5;\">\n        <div style=\"background: white; padding: 32px; border-radius: 16px;\">\n          <h1 style=\"font-size: 24px; font-weight: 900; color: #0A0A0A; margin: 0 0 24px 0;\">${subject}</h1>\n          <div style=\"font-size: 15px; line-height: 1.6; color: #333;\">${message.replace(/\\n/g, '<br>')}</div>\n          <hr style=\"border: none; border-top: 1px solid #E6E9EC; margin: 32px 0;\" />\n          <p style=\"font-size: 12px; color: #6B7280; margin: 0;\">Easy US LLC - Formaci\u00F3n de empresas en USA</p>\n        </div>\n      </div>\n    `;\n\n    let sent = 0;\n    for (const sub of subscribers) {\n      try {\n        await sendEmail({ to: sub.email, subject, html });\n        sent++;\n      } catch (e) {\n        // Email error silenced\n      }\n    }\n\n    res.json({ success: true, sent, total: subscribers.length });\n  }));\n\n  // Admin Messages\n  app.get(\"/api/admin/messages\", isAdminOrSupport, async (req, res) => {\n    try {\n      const allMessages = await storage.getAllMessages();\n      res.json(allMessages);\n    } catch (error) {\n      res.status(500).json({ message: \"Error\" });\n    }\n  });\n\n  app.patch(\"/api/admin/messages/:id/archive\", isAdminOrSupport, async (req, res) => {\n    try {\n      const updated = await storage.updateMessageStatus(Number(req.params.id), 'archived');\n      res.json(updated);\n    } catch (error) {\n      res.status(500).json({ message: \"Error archiving message\" });\n    }\n  });\n\n  app.delete(\"/api/admin/messages/:id\", isAdmin, async (req, res) => {\n    try {\n      const msgId = Number(req.params.id);\n      await db.delete(messageReplies).where(eq(messageReplies.messageId, msgId));\n      await db.delete(messagesTable).where(eq(messagesTable.id, msgId));\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ message: \"Error deleting message\" });\n    }\n  });\n}\n", "import type { Express } from \"express\";\nimport { z } from \"zod\";\nimport { and, eq, desc } from \"drizzle-orm\";\nimport { db, storage, isAdmin, isAdminOrSupport } from \"./shared\";\nimport { orders as ordersTable, users as usersTable, maintenanceApplications, orderEvents, userNotifications, llcApplications as llcApplicationsTable, applicationDocuments as applicationDocumentsTable, messages as messagesTable } from \"@shared/schema\";\nimport { sendEmail, getDocumentUploadedTemplate, getAdminNoteTemplate, getPaymentRequestTemplate, getDocumentRequestTemplate, getOrderEventTemplate, getDocumentApprovedTemplate, getDocumentRejectedTemplate } from \"../lib/email\";\nimport { EmailLanguage } from \"../lib/email-translations\";\nimport { updateApplicationDeadlines } from \"../calendar-service\";\n\nconst MAX_FILE_SIZE_MB = 5;\nconst MAX_FILE_SIZE_BYTES = MAX_FILE_SIZE_MB * 1024 * 1024;\n\nexport function registerAdminDocumentsRoutes(app: Express) {\n  // Document Management - Upload official docs by Admin\n  app.post(\"/api/admin/documents\", isAdminOrSupport, async (req, res) => {\n    try {\n      const { orderId, fileName, fileUrl, documentType, applicationId } = req.body;\n      const [doc] = await db.insert(applicationDocumentsTable).values({\n        orderId,\n        applicationId,\n        fileName,\n        fileType: \"application/pdf\",\n        fileUrl,\n        documentType: documentType || \"official_filing\",\n        reviewStatus: \"approved\",\n        uploadedBy: (req as any).session.userId\n      }).returning();\n      \n      res.json(doc);\n    } catch (error) {\n      console.error(\"Upload doc error:\", error);\n      res.status(500).json({ message: \"Error uploading document\" });\n    }\n  });\n\n  // Admin upload document file for client (supports orderId OR userId)\n  app.post(\"/api/admin/documents/upload\", isAdminOrSupport, async (req: any, res) => {\n    try {\n      const busboy = (await import('busboy')).default;\n      const bb = busboy({ \n        headers: req.headers,\n        limits: { fileSize: MAX_FILE_SIZE_BYTES }\n      });\n      \n      let fileName = '';\n      let fileBuffer: Buffer | null = null;\n      let fileTruncated = false;\n      let documentType = 'other';\n      let orderId = '';\n      let targetUserId = '';\n      \n      bb.on('field', (name: string, val: string) => {\n        if (name === 'documentType') documentType = val;\n        if (name === 'orderId') orderId = val;\n        if (name === 'userId') targetUserId = val;\n      });\n      \n      // Allowed file extensions and MIME types for security\n      const ALLOWED_EXTENSIONS = ['pdf', 'jpg', 'jpeg', 'png'];\n      const ALLOWED_MIMES = ['application/pdf', 'image/jpeg', 'image/png'];\n      let detectedMime = '';\n      \n      bb.on('file', (name: string, file: any, info: any) => {\n        fileName = info.filename || `documento_${Date.now()}`;\n        detectedMime = info.mimeType || '';\n        const chunks: Buffer[] = [];\n        file.on('data', (data: Buffer) => chunks.push(data));\n        file.on('limit', () => { fileTruncated = true; });\n        file.on('end', () => { fileBuffer = Buffer.concat(chunks); });\n      });\n\n      bb.on('finish', async () => {\n        if (fileTruncated) {\n          return res.status(413).json({ message: `File exceeds the ${MAX_FILE_SIZE_MB}MB size limit` });\n        }\n        \n        // Need either orderId or userId\n        if (!fileBuffer || (!orderId && !targetUserId)) {\n          return res.status(400).json({ message: \"Missing required data (orderId or userId)\" });\n        }\n        \n        // Validate file extension\n        const extCheck = fileName.toLowerCase().split('.').pop() || '';\n        if (!ALLOWED_EXTENSIONS.includes(extCheck)) {\n          return res.status(400).json({ message: \"File type not allowed. Only accepted: PDF, JPG, JPEG, PNG\" });\n        }\n        \n        // Validate MIME type\n        if (!ALLOWED_MIMES.includes(detectedMime)) {\n          return res.status(400).json({ message: \"Invalid file format\" });\n        }\n\n        const fs = await import('fs/promises');\n        const path = await import('path');\n        const uploadDir = path.join(process.cwd(), 'uploads', 'admin-docs');\n        await fs.mkdir(uploadDir, { recursive: true });\n        \n        const identifier = orderId || targetUserId;\n        const safeFileName = `admin_${identifier}_${Date.now()}_${fileName.replace(/[^a-zA-Z0-9.-]/g, '_')}`;\n        const filePath = path.join(uploadDir, safeFileName);\n        await fs.writeFile(filePath, fileBuffer);\n        \n        // Determine file type from extension\n        const ext = fileName.toLowerCase().split('.').pop() || '';\n        const mimeTypes: Record<string, string> = {\n          'pdf': 'application/pdf',\n          'jpg': 'image/jpeg',\n          'jpeg': 'image/jpeg',\n          'png': 'image/png'\n        };\n        const fileType = mimeTypes[ext] || 'application/octet-stream';\n        \n        // Document type labels\n        const docTypeLabels: Record<string, string> = {\n          'articles_of_organization': 'Art\u00EDculos de Organizaci\u00F3n',\n          'certificate_of_formation': 'Certificado de Formaci\u00F3n',\n          'boir': 'BOIR',\n          'ein_document': 'Documento EIN',\n          'operating_agreement': 'Acuerdo Operativo',\n          'invoice': 'Factura',\n          'other': 'Otro Documento'\n        };\n        \n        let finalUserId = targetUserId;\n        let applicationId: number | null = null;\n        let orderCode = '';\n        \n        // If orderId provided, get user from order\n        if (orderId) {\n          const [llcApp] = await db.select().from(llcApplicationsTable).where(eq(llcApplicationsTable.orderId, Number(orderId))).limit(1);\n          applicationId = llcApp?.id || null;\n          \n          const [order] = await db.select().from(ordersTable).where(eq(ordersTable.id, Number(orderId))).limit(1);\n          if (order?.userId) {\n            finalUserId = order.userId;\n            orderCode = llcApp?.requestCode || order.invoiceNumber || `#${order.id}`;\n          }\n        }\n        \n        const [doc] = await db.insert(applicationDocumentsTable).values({\n          orderId: orderId ? Number(orderId) : null,\n          applicationId,\n          userId: finalUserId || null,\n          fileName: docTypeLabels[documentType] || fileName,\n          fileType,\n          fileUrl: `/uploads/admin-docs/${safeFileName}`,\n          documentType: documentType,\n          reviewStatus: 'approved',\n          uploadedBy: req.session.userId\n        }).returning();\n\n        // Notify user (dashboard notification + email)\n        if (finalUserId) {\n          const docLabel = docTypeLabels[documentType] || 'Documento';\n          \n          // Dashboard notification (translated on frontend via i18n keys)\n          const docTypeKey = documentType && ['articles_of_organization', 'certificate_of_formation', 'boir', 'ein_document', 'operating_agreement', 'invoice', 'other'].includes(documentType) ? `@ntf.docTypes.${documentType}` : docLabel;\n          await db.insert(userNotifications).values({\n            userId: finalUserId,\n            orderId: orderId ? Number(orderId) : null,\n            orderCode: orderCode || 'General',\n            title: 'i18n:ntf.docUploaded.title',\n            message: `i18n:ntf.docUploaded.message::{\"docName\":\"${docTypeKey}\"}`,\n            type: 'info',\n            isRead: false\n          });\n          \n          // Send email notification\n          const [user] = await db.select().from(usersTable).where(eq(usersTable.id, finalUserId)).limit(1);\n          if (user?.email) {\n            const docLang = ((user as any).preferredLanguage || 'es') as EmailLanguage;\n            const docSubjects: Record<string, string> = { en: 'New document available', ca: 'Nou document disponible', fr: 'Nouveau document disponible', de: 'Neues Dokument verf\u00FCgbar', it: 'Nuovo documento disponibile', pt: 'Novo documento dispon\u00EDvel' };\n            sendEmail({\n              to: user.email,\n              subject: `${docSubjects[docLang] || 'Nuevo documento disponible'}${orderCode ? ` - ${orderCode}` : ''}`,\n              html: getDocumentUploadedTemplate(user.firstName || '', docLabel, orderCode || '', docLang)\n            }).catch(() => {});\n          }\n        }\n        \n        res.json(doc);\n      });\n\n      req.pipe(bb);\n    } catch (error) {\n      console.error(\"Admin upload doc error:\", error);\n      res.status(500).json({ message: \"Error uploading document\" });\n    }\n  });\n\n  app.get(\"/api/admin/documents\", isAdminOrSupport, async (req, res) => {\n    try {\n      const docs = await db.select().from(applicationDocumentsTable)\n        .leftJoin(ordersTable, eq(applicationDocumentsTable.orderId, ordersTable.id))\n        .leftJoin(usersTable, eq(ordersTable.userId, usersTable.id))\n        .leftJoin(llcApplicationsTable, eq(applicationDocumentsTable.applicationId, llcApplicationsTable.id))\n        .orderBy(desc(applicationDocumentsTable.uploadedAt));\n      res.json(docs.map(d => ({\n        ...d.application_documents,\n        order: d.orders,\n        user: d.users ? { id: d.users.id, firstName: d.users.firstName, lastName: d.users.lastName, email: d.users.email } : null,\n        application: d.llc_applications ? { companyName: d.llc_applications.companyName, state: d.llc_applications.state } : null\n      })));\n    } catch (error) {\n      console.error(\"Admin documents error:\", error);\n      res.status(500).json({ message: \"Error fetching documents\" });\n    }\n  });\n\n  app.patch(\"/api/admin/documents/:id/review\", isAdminOrSupport, async (req, res) => {\n    try {\n      const docId = Number(req.params.id);\n      const { reviewStatus, rejectionReason } = z.object({ \n        reviewStatus: z.enum([\"pending\", \"approved\", \"rejected\", \"action_required\"]),\n        rejectionReason: z.string().optional()\n      }).parse(req.body);\n      \n      const [updated] = await db.update(applicationDocumentsTable)\n        .set({ reviewStatus })\n        .where(eq(applicationDocumentsTable.id, docId))\n        .returning();\n      \n      // Get document details and user info for notification\n      const [docWithOrder] = await db.select({\n        doc: applicationDocumentsTable,\n        order: ordersTable,\n        user: usersTable\n      })\n        .from(applicationDocumentsTable)\n        .leftJoin(ordersTable, eq(applicationDocumentsTable.orderId, ordersTable.id))\n        .leftJoin(usersTable, eq(ordersTable.userId, usersTable.id))\n        .where(eq(applicationDocumentsTable.id, docId))\n        .limit(1);\n      \n      if (docWithOrder?.user) {\n        const docTypeLabels: Record<string, string> = {\n          'id_document': 'Documento de identidad',\n          'proof_of_address': 'Comprobante de domicilio',\n          'passport': 'Pasaporte',\n          'ein_letter': 'Carta EIN',\n          'articles_of_organization': 'Art\u00EDculos de Organizaci\u00F3n',\n          'operating_agreement': 'Acuerdo Operativo',\n          'invoice': 'Factura',\n          'other': 'Otro documento'\n        };\n        const docLabel = docTypeLabels[docWithOrder.doc.documentType] || docWithOrder.doc.fileName;\n        \n        if (reviewStatus === 'approved') {\n          // Notify client: document approved (translated on frontend via i18n keys)\n          const approvedDocKey = docWithOrder.doc.documentType && ['id_document', 'proof_of_address', 'passport', 'ein_letter', 'articles_of_organization', 'operating_agreement', 'invoice', 'other'].includes(docWithOrder.doc.documentType) ? `@ntf.docTypes.${docWithOrder.doc.documentType}` : docLabel;\n          await db.insert(userNotifications).values({\n            userId: docWithOrder.user.id,\n            orderId: docWithOrder.order?.id || null,\n            orderCode: docWithOrder.order?.invoiceNumber || 'General',\n            title: 'i18n:ntf.docApproved.title',\n            message: `i18n:ntf.docApproved.message::{\"docType\":\"${approvedDocKey}\"}`,\n            type: 'success',\n            isRead: false\n          });\n          \n          const userLang = ((docWithOrder.user as any).preferredLanguage || 'es') as EmailLanguage;\n          const approvedSubjects: Record<string, string> = { en: 'Document approved', ca: 'Document aprovat', fr: 'Document approuv\u00E9', de: 'Dokument genehmigt', it: 'Documento approvato', pt: 'Documento aprovado' };\n          sendEmail({\n            to: docWithOrder.user.email!,\n            subject: `${approvedSubjects[userLang] || 'Documento aprobado'} - ${docLabel}`,\n            html: getDocumentApprovedTemplate(\n              docWithOrder.user.firstName || '',\n              docLabel,\n              userLang\n            )\n          }).catch(console.error);\n        } else if (reviewStatus === 'rejected') {\n          // Notify client: document rejected (translated on frontend via i18n keys)\n          const reason = rejectionReason || 'No cumple los requisitos necesarios';\n          const rejectedDocKey = docWithOrder.doc.documentType && ['id_document', 'proof_of_address', 'passport', 'ein_letter', 'articles_of_organization', 'operating_agreement', 'invoice', 'other'].includes(docWithOrder.doc.documentType) ? `@ntf.docTypes.${docWithOrder.doc.documentType}` : docLabel;\n          const safeReason = reason.replace(/\"/g, '\\\\\"').replace(/\\n/g, ' ');\n          await db.insert(userNotifications).values({\n            userId: docWithOrder.user.id,\n            orderId: docWithOrder.order?.id || null,\n            orderCode: docWithOrder.order?.invoiceNumber || 'General',\n            title: 'i18n:ntf.docRejected.title',\n            message: `i18n:ntf.docRejected.message::{\"docType\":\"${rejectedDocKey}\",\"reason\":\"${safeReason}\"}`,\n            type: 'action_required',\n            isRead: false\n          });\n          \n          const rejLang = ((docWithOrder.user as any).preferredLanguage || 'es') as EmailLanguage;\n          const rejSubjects: Record<string, string> = { en: 'Action required - Document rejected', ca: 'Acci\u00F3 requerida - Document rebutjat', fr: 'Action requise - Document rejet\u00E9', de: 'Handlung erforderlich - Dokument abgelehnt', it: 'Azione richiesta - Documento rifiutato', pt: 'A\u00E7\u00E3o necess\u00E1ria - Documento rejeitado' };\n          sendEmail({\n            to: docWithOrder.user.email!,\n            subject: rejSubjects[rejLang] || 'Acci\u00F3n requerida - Documento rechazado',\n            html: getDocumentRejectedTemplate(\n              docWithOrder.user.firstName || '',\n              docLabel,\n              reason,\n              rejLang\n            )\n          }).catch(console.error);\n        }\n      }\n      \n      res.json(updated);\n    } catch (error) {\n      console.error(\"Document review error:\", error);\n      res.status(500).json({ message: \"Error updating document review status\" });\n    }\n  });\n\n  app.delete(\"/api/admin/documents/:id\", isAdmin, async (req, res) => {\n    try {\n      const docId = Number(req.params.id);\n      await db.delete(applicationDocumentsTable).where(eq(applicationDocumentsTable.id, docId));\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ message: \"Error deleting document\" });\n    }\n  });\n\n  app.post(\"/api/admin/applications/:id/set-formation-date\", isAdmin, async (req, res) => {\n    try {\n      const applicationId = parseInt(req.params.id);\n      const { formationDate, state } = z.object({\n        formationDate: z.string(),\n        state: z.string().optional()\n      }).parse(req.body);\n\n      const [app] = await db.select().from(llcApplicationsTable).where(eq(llcApplicationsTable.id, applicationId)).limit(1);\n      if (!app) {\n        return res.status(404).json({ message: \"Application not found\" });\n      }\n\n      const deadlines = await updateApplicationDeadlines(\n        applicationId, \n        new Date(formationDate), \n        state || app.state || \"new_mexico\",\n        app.hasTaxExtension || false\n      );\n\n      res.json({ \n        success: true, \n        message: \"Fechas de cumplimiento calculadas exitosamente\",\n        deadlines \n      });\n    } catch (error) {\n      console.error(\"Error setting formation date:\", error);\n      res.status(500).json({ message: \"Error setting formation date\" });\n    }\n  });\n\n  // User notifications - Unified Note + Email System\n  app.post(\"/api/admin/send-note\", isAdmin, async (req, res) => {\n    try {\n      const { userId, title, message, type } = z.object({\n        userId: z.string(),\n        title: z.string().min(1, \"Title required\"),\n        message: z.string().min(1, \"Mensaje requerido\"),\n        type: z.enum(['update', 'info', 'action_required'])\n      }).parse(req.body);\n\n      const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n      if (!user) return res.status(404).json({ message: \"User not found\" });\n\n      // Generate unique ticket ID (8-digit numeric format)\n      const { generateUniqueTicketId } = await import(\"../lib/id-generator\");\n      const ticketId = await generateUniqueTicketId();\n\n      // Create Notification in system with ticketId\n      await db.insert(userNotifications).values({\n        userId,\n        title,\n        message,\n        type,\n        ticketId,\n        isRead: false\n      });\n\n      // Always send email notification with ticket reference\n      if (user.email) {\n        await sendEmail({\n          to: user.email,\n          subject: `${title} - Ticket #${ticketId}`,\n          html: getAdminNoteTemplate(user.firstName || 'Cliente', `${title}: ${message}`, ticketId, (user.preferredLanguage as any) || 'es')\n        });\n      }\n\n      res.json({ success: true, emailSent: !!user.email, ticketId });\n    } catch (error) {\n      console.error(\"Error sending note:\", error);\n      res.status(500).json({ message: \"Error sending note\" });\n    }\n  });\n\n  // Admin Payment Link system\n  app.post(\"/api/admin/send-payment-link\", isAdmin, async (req, res) => {\n    try {\n      const { userId, paymentLink, message, amount } = z.object({\n        userId: z.string(),\n        paymentLink: z.string().url(),\n        message: z.string(),\n        amount: z.string().optional()\n      }).parse(req.body);\n\n      const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n      if (!user || !user.email) return res.status(404).json({ message: \"User or email not found\" });\n\n      const payLang = ((user as any).preferredLanguage || 'es') as EmailLanguage;\n      await sendEmail({\n        to: user.email,\n        subject: payLang === 'en' ? \"Payment pending - Easy US LLC\" : payLang === 'ca' ? \"Pagament pendent - Easy US LLC\" : payLang === 'fr' ? \"Paiement en attente - Easy US LLC\" : payLang === 'de' ? \"Zahlung ausstehend - Easy US LLC\" : payLang === 'it' ? \"Pagamento in sospeso - Easy US LLC\" : payLang === 'pt' ? \"Pagamento pendente - Easy US LLC\" : \"Pago pendiente - Easy US LLC\",\n        html: getPaymentRequestTemplate(user.firstName || '', amount || '', paymentLink, message, payLang)\n      });\n\n      // Create internal notification (translated on frontend via i18n keys)\n      await db.insert(userNotifications).values({\n        userId,\n        title: 'i18n:ntf.paymentRequested.title',\n        message: `i18n:ntf.paymentRequested.message::{\"amount\":\"${amount || ''}\"}`,\n        type: 'action_required',\n        isRead: false\n      });\n\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Send payment link error:\", error);\n      res.status(500).json({ message: \"Error sending payment link\" });\n    }\n  });\n\n  // Request document from client\n  app.post(\"/api/admin/request-document\", isAdminOrSupport, async (req, res) => {\n    try {\n      const { email, documentType, message, userId } = z.object({\n        email: z.string().email(),\n        documentType: z.string(),\n        message: z.string(),\n        userId: z.string().optional()\n      }).parse(req.body);\n\n      const { generateDocRequestId } = await import(\"../lib/id-generator\");\n      const msgId = generateDocRequestId();\n      \n      const docTypeLabels: Record<string, string> = {\n        'passport': 'Pasaporte / Documento de Identidad',\n        'address_proof': 'Comprobante de Domicilio',\n        'tax_id': 'Identificaci\u00F3n Fiscal',\n        'other': 'Otro Documento'\n      };\n      const docTypeLabel = docTypeLabels[documentType] || documentType;\n      \n      const [reqUser] = userId ? await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1) : [null];\n      const reqLang = ((reqUser as any)?.preferredLanguage || 'es') as EmailLanguage;\n      const reqSubjects: Record<string, string> = { en: 'Action Required: Documentation Request', ca: 'Acci\u00F3 Requerida: Sol\u00B7licitud de Documentaci\u00F3', fr: 'Action Requise : Demande de Documentation', de: 'Handlung Erforderlich: Dokumentationsanfrage', it: 'Azione Richiesta: Richiesta di Documentazione', pt: 'A\u00E7\u00E3o Necess\u00E1ria: Solicita\u00E7\u00E3o de Documenta\u00E7\u00E3o' };\n      await sendEmail({\n        to: email,\n        subject: reqSubjects[reqLang] || 'Acci\u00F3n Requerida: Solicitud de Documentaci\u00F3n',\n        html: getDocumentRequestTemplate(reqUser?.firstName || '', docTypeLabel, message, msgId, reqLang)\n      });\n\n      if (userId) {\n        const reqDocKey = documentType && ['passport', 'address_proof', 'tax_id', 'other'].includes(documentType) ? `@ntf.docTypes.${documentType === 'passport' ? 'passport_id' : documentType}` : docTypeLabel;\n        await db.insert(userNotifications).values({\n          userId,\n          title: 'i18n:ntf.docRequested.title',\n          message: `i18n:ntf.docRequested.message::{\"docType\":\"${reqDocKey}\"}`,\n          type: 'action_required',\n          isRead: false\n        });\n\n        const { encrypt } = await import(\"../utils/encryption\");\n        await db.insert(messagesTable).values({\n          userId,\n          name: \"Easy US LLC (Soporte)\",\n          email: \"soporte@easyusllc.com\",\n          subject: `Solicitud de Documento: ${docTypeLabel}`,\n          content: message,\n          encryptedContent: encrypt(message),\n          type: \"support\",\n          status: \"unread\",\n          messageId: msgId\n        });\n      }\n\n      res.json({ success: true, messageId: msgId });\n    } catch (error) {\n      console.error(\"Request doc error:\", error);\n      res.status(500).json({ message: \"Error requesting document\" });\n    }\n  });\n\n  // Admin invoice preview\n  app.get(\"/api/admin/invoice/:id\", isAdmin, async (req, res) => {\n    const orderId = Number(req.params.id);\n    const order = await storage.getOrder(orderId);\n    if (!order) return res.status(404).json({ message: \"Order not found\" });\n    \n    res.setHeader('Content-Type', 'text/html');\n    res.send(generateInvoiceHtml(order));\n  });\n\n  // Add order event (admin only)\n  app.post(\"/api/admin/orders/:id/events\", isAdmin, async (req: any, res) => {\n    try {\n      const orderId = Number(req.params.id);\n      const { eventType, description } = req.body;\n      \n      const [event] = await db.insert(orderEvents).values({\n        orderId,\n        eventType,\n        description,\n        createdBy: req.session.userId,\n      }).returning();\n      \n      // Get order and user info for email notification\n      const order = await storage.getOrder(orderId);\n      if (order) {\n        const [user] = await db.select().from(usersTable).where(eq(usersTable.id, order.userId)).limit(1);\n        if (user?.email) {\n          const evtLang = ((user as any).preferredLanguage || 'es') as EmailLanguage;\n          sendEmail({\n            to: user.email,\n            subject: evtLang === 'en' ? \"Update on your order\" : evtLang === 'ca' ? \"Actualitzaci\u00F3 del teu pedido\" : evtLang === 'fr' ? \"Mise \u00E0 jour de votre commande\" : evtLang === 'de' ? \"Aktualisierung Ihrer Bestellung\" : evtLang === 'it' ? \"Aggiornamento del tuo ordine\" : evtLang === 'pt' ? \"Atualiza\u00E7\u00E3o do seu pedido\" : \"Actualizaci\u00F3n de tu pedido\",\n            html: getOrderEventTemplate(user.firstName || '', String(orderId), eventType, description, evtLang)\n          }).catch(() => {});\n        }\n      }\n      \n      res.json(event);\n    } catch (error) {\n      console.error(\"Error creating order event:\", error);\n      res.status(500).json({ message: \"Error creating event\" });\n    }\n  });\n\n  // Generate invoice for order\n  app.post(\"/api/admin/orders/:id/generate-invoice\", isAdmin, async (req, res) => {\n    try {\n      const orderId = Number(req.params.id);\n      \n      // Get existing order data\n      const [order] = await db.select().from(ordersTable).where(eq(ordersTable.id, orderId)).limit(1);\n      if (!order) {\n        return res.status(404).json({ message: \"Order not found\" });\n      }\n      \n      // Optional: update amount/currency if provided\n      const updateData: any = { isInvoiceGenerated: true };\n      if (req.body.amount) updateData.amount = req.body.amount;\n      if (req.body.currency) updateData.currency = req.body.currency;\n      \n      const [updatedOrder] = await db.update(ordersTable)\n        .set(updateData)\n        .where(eq(ordersTable.id, orderId))\n        .returning();\n\n      // Automatically make invoice available in documentation center\n      const [llcAppInv] = await db.select().from(llcApplicationsTable).where(eq(llcApplicationsTable.orderId, orderId)).limit(1);\n      const [maintAppInv] = await db.select().from(maintenanceApplications).where(eq(maintenanceApplications.orderId, orderId)).limit(1);\n      const displayInvoiceNumber = llcAppInv?.requestCode || maintAppInv?.requestCode || order.invoiceNumber;\n      \n      // Check if invoice already exists to avoid duplicates\n      const existingDoc = await db.select().from(applicationDocumentsTable)\n        .where(and(eq(applicationDocumentsTable.orderId, orderId), eq(applicationDocumentsTable.documentType, \"invoice\")))\n        .limit(1);\n      \n      if (existingDoc.length === 0) {\n        await db.insert(applicationDocumentsTable).values({\n          orderId,\n          fileName: `Factura ${displayInvoiceNumber}`,\n          fileType: \"application/pdf\",\n          fileUrl: `/api/orders/${orderId}/invoice`,\n          documentType: \"invoice\",\n          reviewStatus: \"approved\",\n          uploadedBy: (req as any).session.userId\n        });\n      }\n      \n      res.json(updatedOrder);\n    } catch (error) {\n      console.error(\"Error generating invoice:\", error);\n      res.status(500).json({ message: \"Error generating invoice\" });\n    }\n  });\n\n  function generateInvoiceHtml(order: any) {\n    const requestCode = order.application?.requestCode || order.maintenanceApplication?.requestCode || order.invoiceNumber;\n    const userName = order.user ? `${order.user.firstName || ''} ${order.user.lastName || ''}`.trim() : 'Cliente';\n    const userEmail = order.user?.email || '';\n    const userPhone = order.user?.phone || '';\n    const userClientId = order.user?.clientId || '';\n    const userAddress = order.user ? [\n      order.user.streetType,\n      order.user.address,\n      order.user.city,\n      order.user.province,\n      order.user.postalCode,\n      order.user.country\n    ].filter(Boolean).join(', ') : '';\n    const userIdNumber = order.user?.idNumber ? `${order.user.idType?.toUpperCase() || 'ID'}: ${order.user.idNumber}` : '';\n    const productName = order.product?.name || 'Servicio de Constituci\u00F3n LLC';\n    const invoiceNumber = requestCode || order.invoiceNumber;\n    \n    return `\n      <!DOCTYPE html>\n      <html lang=\"es\">\n        <head>\n          <meta charset=\"UTF-8\">\n          <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n          <title>Factura ${invoiceNumber}</title>\n          <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap\" rel=\"stylesheet\">\n          <style>\n            @media print { \n              body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } \n              .no-print { display: none !important; }\n              @page { margin: 1cm; }\n            }\n            * { box-sizing: border-box; margin: 0; padding: 0; }\n            body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; padding: 40px; color: #0A0A0A; line-height: 1.6; background: #fff; max-width: 800px; margin: 0 auto; }\n            .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 50px; padding-bottom: 30px; border-bottom: 3px solid #6EDC8A; }\n            .logo-section h1 { font-size: 28px; font-weight: 900; letter-spacing: -0.02em; }\n            .logo-section .subtitle { color: #6B7280; font-size: 13px; margin-top: 4px; }\n            .invoice-info { text-align: right; }\n            .invoice-badge { background: linear-gradient(135deg, #6EDC8A 0%, #4eca70 100%); color: #0A0A0A; padding: 10px 20px; border-radius: 100px; font-weight: 900; font-size: 13px; display: inline-block; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.05em; }\n            .invoice-number { font-size: 20px; font-weight: 800; color: #0A0A0A; }\n            .invoice-date { font-size: 13px; color: #6B7280; margin-top: 4px; }\n            .details-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 50px; margin-bottom: 50px; }\n            .detail-box { background: #F7F7F5; padding: 25px; border-radius: 16px; }\n            .detail-label { font-size: 11px; font-weight: 800; text-transform: uppercase; color: #6EDC8A; margin-bottom: 12px; letter-spacing: 0.08em; }\n            .detail-content p { font-size: 14px; margin-bottom: 4px; }\n            .detail-content strong { font-weight: 700; }\n            .items-table { width: 100%; border-collapse: collapse; margin-bottom: 40px; }\n            .items-table thead th { text-align: left; padding: 16px 12px; font-size: 11px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.05em; color: #6B7280; border-bottom: 2px solid #E6E9EC; }\n            .items-table thead th:last-child { text-align: right; }\n            .items-table tbody td { padding: 20px 12px; font-size: 15px; border-bottom: 1px solid #F7F7F5; }\n            .items-table tbody td:last-child { text-align: right; font-weight: 600; }\n            .totals-section { display: flex; justify-content: flex-end; margin-bottom: 50px; }\n            .totals-box { background: linear-gradient(135deg, #F7F7F5 0%, #E6E9EC 100%); padding: 30px; border-radius: 20px; min-width: 280px; }\n            .totals-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 14px; }\n            .totals-row.final { border-top: 2px solid #0A0A0A; padding-top: 15px; margin-top: 15px; margin-bottom: 0; }\n            .totals-row.final .label { font-size: 12px; font-weight: 800; text-transform: uppercase; color: #6B7280; }\n            .totals-row.final .amount { font-size: 28px; font-weight: 900; color: #0A0A0A; }\n            .footer { text-align: center; padding-top: 30px; border-top: 1px solid #E6E9EC; font-size: 12px; color: #6B7280; }\n            .footer p { margin-bottom: 4px; }\n            .print-controls { text-align: center; margin-bottom: 30px; }\n            .print-btn { background: #6EDC8A; color: #0A0A0A; padding: 14px 35px; border: none; border-radius: 100px; font-weight: 800; cursor: pointer; font-size: 14px; transition: transform 0.15s, box-shadow 0.15s; box-shadow: 0 4px 15px rgba(110, 220, 138, 0.3); }\n            .print-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(110, 220, 138, 0.4); }\n          </style>\n        </head>\n        <body>\n          <div class=\"print-controls no-print\">\n            <button class=\"print-btn\" onclick=\"window.print()\">Imprimir / Descargar PDF</button>\n          </div>\n          \n          <div class=\"header\">\n            <div class=\"logo-section\">\n              <img src=\"cid:logo-icon\" alt=\"Easy US LLC\" style=\"width: 60px; height: 60px; margin-bottom: 10px; border-radius: 12px;\">\n              <h1>Easy US LLC</h1>\n              <p class=\"subtitle\">Servicios de Constituci\u00F3n Empresarial</p>\n            </div>\n            <div class=\"invoice-info\">\n              <div class=\"invoice-badge\">Factura</div>\n              <div class=\"invoice-number\">${invoiceNumber}</div>\n              <div class=\"invoice-date\">Fecha: ${new Date(order.createdAt).toLocaleDateString('es-ES', { day: '2-digit', month: 'long', year: 'numeric' })}</div>\n            </div>\n          </div>\n          \n          <div class=\"details-grid\">\n            <div class=\"detail-box\">\n              <div class=\"detail-label\">Datos del Emisor</div>\n              <div class=\"detail-content\">\n                <p><strong>EASY US LLC</strong></p>\n                <p>FORTUNY CONSULTING LLC</p>\n                <p>1209 Mountain Road Place NE, STE R</p>\n                <p>Albuquerque, NM 87110, USA</p>\n                <p style=\"margin-top: 10px;\">hola@easyusllc.com</p>\n                <p>+34 614 91 69 10</p>\n              </div>\n            </div>\n            <div class=\"detail-box\">\n              <div class=\"detail-label\">Datos del Cliente</div>\n              <div class=\"detail-content\">\n                <p><strong>${userName}</strong></p>\n                ${userClientId ? `<p style=\"font-size: 12px; color: #6B7280;\"><strong>ID Cliente:</strong> ${userClientId}</p>` : ''}\n                ${userIdNumber ? `<p>${userIdNumber}</p>` : ''}\n                <p>${userEmail}</p>\n                ${userPhone ? `<p>${userPhone}</p>` : ''}\n                ${userAddress ? `<p style=\"margin-top: 6px;\">${userAddress}</p>` : ''}\n                <p style=\"margin-top: 10px;\"><strong>Ref. Pedido:</strong> ${requestCode}</p>\n              </div>\n            </div>\n          </div>\n          \n          <table class=\"items-table\">\n            <thead>\n              <tr>\n                <th>Descripci\u00F3n del Servicio</th>\n                <th>Importe</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr>\n                <td><strong>${productName}</strong><br><span style=\"color: #6B7280; font-size: 13px;\">Servicio completo de constituci\u00F3n empresarial en USA</span></td>\n                <td>${((order.originalAmount || order.amount) / 100).toFixed(2)} \u20AC</td>\n              </tr>\n            </tbody>\n          </table>\n          \n          <div class=\"totals-section\">\n            <div class=\"totals-box\">\n              <div class=\"totals-row\">\n                <span>Subtotal</span>\n                <span>${((order.originalAmount || order.amount) / 100).toFixed(2)} \u20AC</span>\n              </div>\n              ${order.discountCode ? `\n              <div class=\"totals-row\" style=\"color: #16a34a;\">\n                <span>Descuento (${order.discountCode})</span>\n                <span>-${(order.discountAmount / 100).toFixed(2)} \u20AC</span>\n              </div>\n              ` : ''}\n              <div class=\"totals-row\">\n                <span>IVA (0%)</span>\n                <span>0.00 \u20AC</span>\n              </div>\n              <div class=\"totals-row final\">\n                <span class=\"label\">Total</span>\n                <span class=\"amount\">${(order.amount / 100).toFixed(2)} \u20AC</span>\n              </div>\n            </div>\n          </div>\n          \n          <div class=\"footer\">\n            <p><strong>EASY US LLC</strong> \u2022 FORTUNY CONSULTING LLC</p>\n            <p>1209 Mountain Road Place NE, STE R, Albuquerque, NM 87110, USA</p>\n            <p>hola@easyusllc.com \u2022 +34 614 91 69 10 \u2022 www.easyusllc.com</p>\n          </div>\n        </body>\n      </html>\n    `;\n  }\n}\n", "import type { Express } from \"express\";\nimport { z } from \"zod\";\nimport { db, isAuthenticated, isAdmin, isAdminOrSupport, logAudit, getClientIp } from \"./shared\";\nimport { consultationTypes, consultationAvailability, consultationBlockedDates, consultationBookings, users as usersTable } from \"@shared/schema\";\nimport { and, eq, desc, sql, inArray } from \"drizzle-orm\";\n\nexport function registerConsultationRoutes(app: Express) {\n  // ============ CONSULTATION BOOKING SYSTEM ============\n\n  // Get all active consultation types (public)\n  app.get(\"/api/consultations/types\", async (req, res) => {\n    try {\n      const types = await db.select().from(consultationTypes).where(eq(consultationTypes.isActive, true));\n      res.json(types);\n    } catch (err) {\n      console.error(\"Error fetching consultation types:\", err);\n      res.status(500).json({ message: \"Error fetching consultation types\" });\n    }\n  });\n\n  // Get availability for a specific date\n  app.get(\"/api/consultations/availability\", async (req, res) => {\n    try {\n      const date = req.query.date as string;\n      if (!date) return res.status(400).json({ message: \"Date parameter required\" });\n      const targetDate = new Date(date);\n      const dayOfWeek = targetDate.getDay();\n      \n      // Check if date is blocked\n      const blocked = await db.select().from(consultationBlockedDates)\n        .where(sql`DATE(${consultationBlockedDates.date}) = DATE(${targetDate})`);\n      \n      if (blocked.length > 0) {\n        return res.json({ available: false, slots: [], reason: \"blocked\" });\n      }\n      \n      // Get available slots for this day\n      const slots = await db.select().from(consultationAvailability)\n        .where(and(\n          eq(consultationAvailability.dayOfWeek, dayOfWeek),\n          eq(consultationAvailability.isActive, true)\n        ));\n      \n      // Get existing bookings for this date\n      const existingBookings = await db.select({\n        scheduledTime: consultationBookings.scheduledTime,\n        status: consultationBookings.status\n      }).from(consultationBookings)\n        .where(and(\n          sql`DATE(${consultationBookings.scheduledDate}) = DATE(${targetDate})`,\n          inArray(consultationBookings.status, ['pending', 'confirmed'])\n        ));\n      \n      const bookedTimes = new Set(existingBookings.map(b => b.scheduledTime));\n      \n      // Filter out booked slots\n      const availableSlots = slots.filter(slot => !bookedTimes.has(slot.startTime));\n      \n      res.json({ \n        available: availableSlots.length > 0, \n        slots: availableSlots.map(s => ({ startTime: s.startTime, endTime: s.endTime }))\n      });\n    } catch (err) {\n      console.error(\"Error fetching availability:\", err);\n      res.status(500).json({ message: \"Error fetching availability\" });\n    }\n  });\n\n  // Create a consultation booking (requires authentication)\n  app.post(\"/api/consultations/book\", isAuthenticated, async (req, res) => {\n    try {\n      const [user] = await db.select().from(usersTable).where(eq(usersTable.id, req.session.userId!)).limit(1);\n      if (!user) return res.status(401).json({ message: \"User not found\" });\n      \n      // Check account status\n      if (user.accountStatus === 'deactivated') {\n        return res.status(403).json({ message: \"Your account is deactivated\" });\n      }\n      \n      const schema = z.object({\n        consultationTypeId: z.number(),\n        scheduledDate: z.string(),\n        scheduledTime: z.string(),\n        hasLlc: z.string().optional(),\n        llcState: z.string().optional(),\n        estimatedRevenue: z.string().optional(),\n        countryOfResidence: z.string().optional(),\n        mainTopic: z.string().optional(),\n        additionalNotes: z.string().optional(),\n      });\n      \n      const data = schema.parse(req.body);\n      \n      // Verify consultation type exists\n      const [consultationType] = await db.select().from(consultationTypes)\n        .where(eq(consultationTypes.id, data.consultationTypeId));\n      \n      if (!consultationType || !consultationType.isActive) {\n        return res.status(400).json({ message: \"Invalid consultation type\" });\n      }\n      \n      // Check slot availability\n      const scheduledDate = new Date(data.scheduledDate);\n      const dayOfWeek = scheduledDate.getDay();\n      \n      const [slot] = await db.select().from(consultationAvailability)\n        .where(and(\n          eq(consultationAvailability.dayOfWeek, dayOfWeek),\n          eq(consultationAvailability.startTime, data.scheduledTime),\n          eq(consultationAvailability.isActive, true)\n        ));\n      \n      if (!slot) {\n        return res.status(400).json({ message: \"Schedule not available\" });\n      }\n      \n      // Check for existing booking at this time\n      const [existingBooking] = await db.select().from(consultationBookings)\n        .where(and(\n          sql`DATE(${consultationBookings.scheduledDate}) = DATE(${scheduledDate})`,\n          eq(consultationBookings.scheduledTime, data.scheduledTime),\n          inArray(consultationBookings.status, ['pending', 'confirmed'])\n        ));\n      \n      if (existingBooking) {\n        return res.status(400).json({ message: \"This schedule is already booked\" });\n      }\n      \n      // Generate booking code\n      const { generateUniqueBookingCode } = await import(\"../lib/id-generator\");\n      const bookingCode = await generateUniqueBookingCode();\n      \n      // Create booking\n      const [booking] = await db.insert(consultationBookings).values({\n        bookingCode,\n        userId: user.id,\n        consultationTypeId: data.consultationTypeId,\n        scheduledDate,\n        scheduledTime: data.scheduledTime,\n        duration: consultationType.duration,\n        status: 'pending',\n        hasLlc: data.hasLlc,\n        llcState: data.llcState,\n        estimatedRevenue: data.estimatedRevenue,\n        countryOfResidence: data.countryOfResidence,\n        mainTopic: data.mainTopic,\n        additionalNotes: data.additionalNotes,\n      }).returning();\n      \n      // Log audit\n      logAudit({\n        action: 'consultation_booked',\n        userId: user.id,\n        targetId: booking.id.toString(),\n        ip: getClientIp(req),\n        userAgent: req.headers['user-agent'],\n        details: {\n          bookingCode,\n          consultationType: consultationType.name,\n          scheduledDate: data.scheduledDate,\n          scheduledTime: data.scheduledTime\n        }\n      });\n      \n      res.json({ success: true, booking });\n    } catch (err: any) {\n      console.error(\"Error creating booking:\", err);\n      if (err.errors) {\n        return res.status(400).json({ message: err.errors[0]?.message || \"Error creating booking\" });\n      }\n      res.status(500).json({ message: \"Error creating the booking\" });\n    }\n  });\n\n  // Get user's consultations\n  app.get(\"/api/consultations/my\", isAuthenticated, async (req, res) => {\n    try {\n      const userId = req.session.userId!;\n      \n      const bookings = await db.select({\n        booking: consultationBookings,\n        consultationType: consultationTypes\n      }).from(consultationBookings)\n        .innerJoin(consultationTypes, eq(consultationBookings.consultationTypeId, consultationTypes.id))\n        .where(eq(consultationBookings.userId, userId))\n        .orderBy(desc(consultationBookings.scheduledDate));\n      \n      res.json(bookings);\n    } catch (err) {\n      console.error(\"Error fetching user consultations:\", err);\n      res.status(500).json({ message: \"Error fetching consultations\" });\n    }\n  });\n\n  // Cancel a consultation (user)\n  app.patch(\"/api/consultations/:id/cancel\", isAuthenticated, async (req, res) => {\n    try {\n      const userId = req.session.userId!;\n      const bookingId = parseInt(req.params.id);\n      \n      const [booking] = await db.select().from(consultationBookings)\n        .where(and(\n          eq(consultationBookings.id, bookingId),\n          eq(consultationBookings.userId, userId)\n        ));\n      \n      if (!booking) {\n        return res.status(404).json({ message: \"Booking not found\" });\n      }\n      \n      if (!['pending', 'confirmed'].includes(booking.status)) {\n        return res.status(400).json({ message: \"Cannot cancel this booking\" });\n      }\n      \n      await db.update(consultationBookings)\n        .set({ \n          status: 'cancelled', \n          cancelledAt: new Date(),\n          cancelReason: req.body.reason || 'Cancelled by user',\n          updatedAt: new Date()\n        })\n        .where(eq(consultationBookings.id, bookingId));\n      \n      logAudit({\n        action: 'consultation_cancelled',\n        userId: userId,\n        targetId: bookingId.toString(),\n        ip: getClientIp(req),\n        userAgent: req.headers['user-agent'],\n        details: { bookingCode: booking.bookingCode }\n      });\n      \n      res.json({ success: true });\n    } catch (err) {\n      console.error(\"Error cancelling booking:\", err);\n      res.status(500).json({ message: \"Error canceling booking\" });\n    }\n  });\n\n  // ===== ADMIN CONSULTATION ROUTES =====\n\n  // Get all consultation types (admin)\n  app.get(\"/api/admin/consultations/types\", isAdmin, async (req, res) => {\n    try {\n      const types = await db.select().from(consultationTypes).orderBy(desc(consultationTypes.createdAt));\n      res.json(types);\n    } catch (err) {\n      console.error(\"Error fetching consultation types:\", err);\n      res.status(500).json({ message: \"Error fetching consultation types\" });\n    }\n  });\n\n  // Create consultation type (admin)\n  app.post(\"/api/admin/consultations/types\", isAdmin, async (req, res) => {\n    try {\n      const schema = z.object({\n        name: z.string().min(1),\n        nameEs: z.string().min(1),\n        nameEn: z.string().min(1),\n        nameCa: z.string().min(1),\n        description: z.string().optional(),\n        descriptionEs: z.string().optional(),\n        descriptionEn: z.string().optional(),\n        descriptionCa: z.string().optional(),\n        duration: z.number().min(15).max(180),\n        price: z.number().min(0),\n        isActive: z.boolean().optional(),\n      });\n      \n      const data = schema.parse(req.body);\n      \n      const [type] = await db.insert(consultationTypes).values(data).returning();\n      \n      logAudit({\n        action: 'consultation_type_created',\n        userId: req.session.userId!,\n        targetId: type.id.toString(),\n        ip: getClientIp(req),\n        userAgent: req.headers['user-agent'],\n        details: { name: data.name }\n      });\n      \n      res.json(type);\n    } catch (err: any) {\n      console.error(\"Error creating consultation type:\", err);\n      res.status(400).json({ message: err.errors?.[0]?.message || \"Error creating consultation type\" });\n    }\n  });\n\n  // Update consultation type (admin)\n  app.patch(\"/api/admin/consultations/types/:id\", isAdmin, async (req, res) => {\n    try {\n      const typeId = parseInt(req.params.id);\n      \n      const [updated] = await db.update(consultationTypes)\n        .set(req.body)\n        .where(eq(consultationTypes.id, typeId))\n        .returning();\n      \n      if (!updated) {\n        return res.status(404).json({ message: \"Type not found\" });\n      }\n      \n      res.json(updated);\n    } catch (err) {\n      console.error(\"Error updating consultation type:\", err);\n      res.status(500).json({ message: \"Error updating type\" });\n    }\n  });\n\n  // Delete consultation type (admin)\n  app.delete(\"/api/admin/consultations/types/:id\", isAdmin, async (req, res) => {\n    try {\n      const typeId = parseInt(req.params.id);\n      await db.delete(consultationTypes).where(eq(consultationTypes.id, typeId));\n      res.json({ success: true });\n    } catch (err) {\n      console.error(\"Error deleting consultation type:\", err);\n      res.status(500).json({ message: \"Error deleting type\" });\n    }\n  });\n\n  // Get availability schedule (admin)\n  app.get(\"/api/admin/consultations/availability\", isAdmin, async (req, res) => {\n    try {\n      const slots = await db.select().from(consultationAvailability).orderBy(consultationAvailability.dayOfWeek, consultationAvailability.startTime);\n      res.json(slots);\n    } catch (err) {\n      console.error(\"Error fetching availability:\", err);\n      res.status(500).json({ message: \"Error fetching availability\" });\n    }\n  });\n\n  // Add availability slot (admin)\n  app.post(\"/api/admin/consultations/availability\", isAdmin, async (req, res) => {\n    try {\n      const schema = z.object({\n        dayOfWeek: z.number().min(0).max(6),\n        startTime: z.string().regex(/^\\d{2}:\\d{2}$/),\n        endTime: z.string().regex(/^\\d{2}:\\d{2}$/),\n        isActive: z.boolean().optional(),\n      });\n      \n      const data = schema.parse(req.body);\n      \n      const [slot] = await db.insert(consultationAvailability).values(data).returning();\n      res.json(slot);\n    } catch (err: any) {\n      console.error(\"Error creating availability slot:\", err);\n      res.status(400).json({ message: err.errors?.[0]?.message || \"Error creating schedule\" });\n    }\n  });\n\n  // Update availability slot (admin)\n  app.patch(\"/api/admin/consultations/availability/:id\", isAdmin, async (req, res) => {\n    try {\n      const slotId = parseInt(req.params.id);\n      \n      const [updated] = await db.update(consultationAvailability)\n        .set(req.body)\n        .where(eq(consultationAvailability.id, slotId))\n        .returning();\n      \n      res.json(updated);\n    } catch (err) {\n      console.error(\"Error updating availability:\", err);\n      res.status(500).json({ message: \"Error updating schedule\" });\n    }\n  });\n\n  // Delete availability slot (admin)\n  app.delete(\"/api/admin/consultations/availability/:id\", isAdmin, async (req, res) => {\n    try {\n      const slotId = parseInt(req.params.id);\n      await db.delete(consultationAvailability).where(eq(consultationAvailability.id, slotId));\n      res.json({ success: true });\n    } catch (err) {\n      console.error(\"Error deleting availability:\", err);\n      res.status(500).json({ message: \"Error deleting schedule\" });\n    }\n  });\n\n  // Get blocked dates (admin)\n  app.get(\"/api/admin/consultations/blocked-dates\", isAdmin, async (req, res) => {\n    try {\n      const dates = await db.select().from(consultationBlockedDates).orderBy(desc(consultationBlockedDates.date));\n      res.json(dates);\n    } catch (err) {\n      console.error(\"Error fetching blocked dates:\", err);\n      res.status(500).json({ message: \"Error fetching blocked dates\" });\n    }\n  });\n\n  // Add blocked date (admin)\n  app.post(\"/api/admin/consultations/blocked-dates\", isAdmin, async (req, res) => {\n    try {\n      const schema = z.object({\n        date: z.string(),\n        reason: z.string().optional(),\n      });\n      \n      const data = schema.parse(req.body);\n      \n      const [blocked] = await db.insert(consultationBlockedDates).values({\n        date: new Date(data.date),\n        reason: data.reason\n      }).returning();\n      \n      res.json(blocked);\n    } catch (err: any) {\n      console.error(\"Error creating blocked date:\", err);\n      res.status(400).json({ message: err.errors?.[0]?.message || \"Error blocking date\" });\n    }\n  });\n\n  // Delete blocked date (admin)\n  app.delete(\"/api/admin/consultations/blocked-dates/:id\", isAdmin, async (req, res) => {\n    try {\n      const dateId = parseInt(req.params.id);\n      await db.delete(consultationBlockedDates).where(eq(consultationBlockedDates.id, dateId));\n      res.json({ success: true });\n    } catch (err) {\n      console.error(\"Error deleting blocked date:\", err);\n      res.status(500).json({ message: \"Error deleting blocked date\" });\n    }\n  });\n\n  // Get all bookings (admin)\n  app.get(\"/api/admin/consultations/bookings\", isAdminOrSupport, async (req, res) => {\n    try {\n      const { status, from, to } = req.query;\n      \n      let query = db.select({\n        booking: consultationBookings,\n        consultationType: consultationTypes,\n        user: {\n          id: usersTable.id,\n          email: usersTable.email,\n          firstName: usersTable.firstName,\n          lastName: usersTable.lastName,\n          clientId: usersTable.clientId\n        }\n      }).from(consultationBookings)\n        .innerJoin(consultationTypes, eq(consultationBookings.consultationTypeId, consultationTypes.id))\n        .innerJoin(usersTable, eq(consultationBookings.userId, usersTable.id))\n        .orderBy(desc(consultationBookings.scheduledDate));\n      \n      const bookings = await query;\n      res.json(bookings);\n    } catch (err) {\n      console.error(\"Error fetching bookings:\", err);\n      res.status(500).json({ message: \"Error fetching bookings\" });\n    }\n  });\n\n  // Update booking status (admin)\n  app.patch(\"/api/admin/consultations/bookings/:id\", isAdminOrSupport, async (req, res) => {\n    try {\n      const bookingId = parseInt(req.params.id);\n      const { status, adminNotes, meetingLink } = req.body;\n      \n      const updateData: any = { updatedAt: new Date() };\n      \n      if (status) {\n        updateData.status = status;\n        if (status === 'confirmed') updateData.confirmedAt = new Date();\n        if (status === 'completed') updateData.completedAt = new Date();\n        if (status === 'cancelled') updateData.cancelledAt = new Date();\n      }\n      if (adminNotes !== undefined) updateData.adminNotes = adminNotes;\n      if (meetingLink !== undefined) updateData.meetingLink = meetingLink;\n      \n      const [updated] = await db.update(consultationBookings)\n        .set(updateData)\n        .where(eq(consultationBookings.id, bookingId))\n        .returning();\n      \n      if (!updated) {\n        return res.status(404).json({ message: \"Booking not found\" });\n      }\n      \n      logAudit({\n        action: 'consultation_updated',\n        userId: req.session.userId!,\n        targetId: bookingId.toString(),\n        ip: getClientIp(req),\n        userAgent: req.headers['user-agent'],\n        details: { status, adminNotes, meetingLink }\n      });\n      \n      res.json(updated);\n    } catch (err) {\n      console.error(\"Error updating booking:\", err);\n      res.status(500).json({ message: \"Error updating booking\" });\n    }\n  });\n\n  // Reschedule booking (admin)\n  app.patch(\"/api/admin/consultations/bookings/:id/reschedule\", isAdminOrSupport, async (req, res) => {\n    try {\n      const bookingId = parseInt(req.params.id);\n      const { scheduledDate, scheduledTime } = req.body;\n      \n      // Check new slot availability\n      const newDate = new Date(scheduledDate);\n      const [existingBooking] = await db.select().from(consultationBookings)\n        .where(and(\n          sql`DATE(${consultationBookings.scheduledDate}) = DATE(${newDate})`,\n          eq(consultationBookings.scheduledTime, scheduledTime),\n          inArray(consultationBookings.status, ['pending', 'confirmed'])\n        ));\n      \n      if (existingBooking && existingBooking.id !== bookingId) {\n        return res.status(400).json({ message: \"This schedule is already booked\" });\n      }\n      \n      const [updated] = await db.update(consultationBookings)\n        .set({ \n          scheduledDate: newDate,\n          scheduledTime,\n          status: 'rescheduled',\n          updatedAt: new Date()\n        })\n        .where(eq(consultationBookings.id, bookingId))\n        .returning();\n      \n      logAudit({\n        action: 'consultation_rescheduled',\n        userId: req.session.userId!,\n        targetId: bookingId.toString(),\n        ip: getClientIp(req),\n        userAgent: req.headers['user-agent'],\n        details: { scheduledDate, scheduledTime }\n      });\n      \n      res.json(updated);\n    } catch (err) {\n      console.error(\"Error rescheduling booking:\", err);\n      res.status(500).json({ message: \"Error rescheduling booking\" });\n    }\n  });\n\n  // Get consultation stats (admin)\n  app.get(\"/api/admin/consultations/stats\", isAdminOrSupport, async (req, res) => {\n    try {\n      const [pending] = await db.select({ count: sql<number>`count(*)` }).from(consultationBookings).where(eq(consultationBookings.status, 'pending'));\n      const [confirmed] = await db.select({ count: sql<number>`count(*)` }).from(consultationBookings).where(eq(consultationBookings.status, 'confirmed'));\n      const [completed] = await db.select({ count: sql<number>`count(*)` }).from(consultationBookings).where(eq(consultationBookings.status, 'completed'));\n      const [cancelled] = await db.select({ count: sql<number>`count(*)` }).from(consultationBookings).where(eq(consultationBookings.status, 'cancelled'));\n      \n      res.json({\n        pending: Number(pending?.count || 0),\n        confirmed: Number(confirmed?.count || 0),\n        completed: Number(completed?.count || 0),\n        cancelled: Number(cancelled?.count || 0),\n        total: Number(pending?.count || 0) + Number(confirmed?.count || 0) + Number(completed?.count || 0) + Number(cancelled?.count || 0)\n      });\n    } catch (err) {\n      console.error(\"Error fetching consultation stats:\", err);\n      res.status(500).json({ message: \"Error fetching statistics\" });\n    }\n  });\n}\n", "import type { Express } from \"express\";\nimport { z } from \"zod\";\nimport { and, eq, gt, desc, sql, inArray } from \"drizzle-orm\";\nimport { db, storage, isAuthenticated, isAdmin, logAudit, getClientIp, logActivity } from \"./shared\";\nimport { contactOtps, users as usersTable, userNotifications, orders as ordersTable, llcApplications as llcApplicationsTable, applicationDocuments as applicationDocumentsTable } from \"@shared/schema\";\nimport { sendEmail, getOtpEmailTemplate, getWelcomeEmailTemplate, getPasswordChangeOtpTemplate, getProfileChangeOtpTemplate, getAdminProfileChangesTemplate } from \"../lib/email\";\nimport { getEmailTranslations, EmailLanguage, getOtpSubject } from \"../lib/email-translations\";\nimport { checkRateLimit } from \"../lib/security\";\nimport { getUpcomingDeadlinesForUser } from \"../calendar-service\";\n\nexport function registerUserProfileRoutes(app: Express) {\n  // Get completed LLCs for user (for Operating Agreement generator)\n  app.get(\"/api/user/completed-llcs\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      \n      // Join LLC applications with orders to ensure ownership at DB level\n      const llcApps = await db.select({\n        id: llcApplicationsTable.id,\n        orderId: llcApplicationsTable.orderId,\n        companyName: llcApplicationsTable.companyName,\n        ein: llcApplicationsTable.ein,\n        state: llcApplicationsTable.state,\n        ownerFullName: llcApplicationsTable.ownerFullName,\n        ownerEmail: llcApplicationsTable.ownerEmail,\n        ownerPhone: llcApplicationsTable.ownerPhone,\n        ownerIdNumber: llcApplicationsTable.ownerIdNumber,\n        ownerIdType: llcApplicationsTable.ownerIdType,\n        ownerAddress: llcApplicationsTable.ownerAddress,\n        ownerCity: llcApplicationsTable.ownerCity,\n        ownerCountry: llcApplicationsTable.ownerCountry,\n        ownerProvince: llcApplicationsTable.ownerProvince,\n        ownerPostalCode: llcApplicationsTable.ownerPostalCode,\n        llcCreatedDate: llcApplicationsTable.llcCreatedDate,\n        designator: llcApplicationsTable.designator,\n      })\n        .from(llcApplicationsTable)\n        .innerJoin(ordersTable, eq(llcApplicationsTable.orderId, ordersTable.id))\n        .where(and(\n          eq(ordersTable.userId, userId),\n          eq(ordersTable.status, 'completed')\n        ));\n      \n      res.json(llcApps);\n    } catch (error) {\n      console.error(\"Error fetching completed LLCs:\", error);\n      res.status(500).json({ message: \"Error fetching completed LLCs\" });\n    }\n  });\n\n  // Save Operating Agreement to Document Center\n  app.post(\"/api/user/operating-agreements\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      const { llcApplicationId, pdfBase64, fileName } = req.body;\n      \n      if (!llcApplicationId || !pdfBase64 || !fileName) {\n        return res.status(400).json({ message: \"Incomplete data\" });\n      }\n      \n      // Verify user owns this LLC application\n      const [llcApp] = await db.select({ orderId: llcApplicationsTable.orderId, ein: llcApplicationsTable.ein, companyName: llcApplicationsTable.companyName })\n        .from(llcApplicationsTable)\n        .where(eq(llcApplicationsTable.id, llcApplicationId))\n        .limit(1);\n      \n      if (!llcApp) {\n        return res.status(404).json({ message: \"Application not found\" });\n      }\n      \n      // Check ownership via order\n      const [order] = await db.select().from(ordersTable).where(eq(ordersTable.id, llcApp.orderId)).limit(1);\n      if (!order || order.userId !== userId) {\n        return res.status(403).json({ message: \"Access denied\" });\n      }\n      \n      // Verify EIN is assigned (required for Operating Agreement)\n      if (!llcApp.ein) {\n        return res.status(400).json({ message: \"Cannot generate without assigned EIN\" });\n      }\n      \n      // Save to Document Center\n      const [doc] = await db.insert(applicationDocumentsTable).values({\n        orderId: llcApp.orderId,\n        userId: userId,\n        fileName: fileName,\n        fileType: \"application/pdf\",\n        fileUrl: pdfBase64,\n        documentType: \"operating_agreement\",\n        reviewStatus: \"approved\",\n        uploadedBy: userId,\n      }).returning();\n      \n      res.json({ success: true, documentId: doc.id });\n    } catch (error) {\n      console.error(\"Error saving Operating Agreement:\", error);\n      res.status(500).json({ message: \"Error saving document\" });\n    }\n  });\n\n  app.get(\"/api/user/documents\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      \n      // Get documents associated with user's orders\n      const orderDocs = await db.select({\n        doc: applicationDocumentsTable,\n        order: ordersTable\n      }).from(applicationDocumentsTable)\n        .leftJoin(ordersTable, eq(applicationDocumentsTable.orderId, ordersTable.id))\n        .where(eq(ordersTable.userId, userId))\n        .orderBy(desc(applicationDocumentsTable.uploadedAt));\n      \n      // Get documents directly assigned to user (without order)\n      const directDocs = await db.select().from(applicationDocumentsTable)\n        .where(eq(applicationDocumentsTable.userId, userId))\n        .orderBy(desc(applicationDocumentsTable.uploadedAt));\n      \n      // Combine and deduplicate\n      const allDocs = [...orderDocs.map(d => d.doc), ...directDocs];\n      const uniqueDocs = allDocs.filter((doc, index, self) => \n        index === self.findIndex(d => d.id === doc.id)\n      );\n      \n      const uploaderIds = Array.from(new Set(uniqueDocs.map(d => d.uploadedBy).filter(Boolean))) as string[];\n      const uploaderMap = new Map<string, { id: string; firstName: string | null; lastName: string | null; isAdmin: boolean | null }>();\n      if (uploaderIds.length > 0) {\n        const uploaders = await db.select({\n          id: usersTable.id,\n          firstName: usersTable.firstName,\n          lastName: usersTable.lastName,\n          isAdmin: usersTable.isAdmin\n        }).from(usersTable).where(inArray(usersTable.id, uploaderIds));\n        uploaders.forEach(u => uploaderMap.set(u.id, u));\n      }\n      \n      const docsWithUploader = uniqueDocs.map((doc) => {\n        const uploader = doc.uploadedBy ? uploaderMap.get(doc.uploadedBy) || null : null;\n        const { encryptionIv, fileHash, ...safeFields } = doc;\n        return { ...safeFields, fileUrl: doc.fileUrl ? `/api/user/documents/${doc.id}/download` : null, uploader };\n      });\n      \n      res.json(docsWithUploader);\n    } catch (error) {\n      res.status(500).json({ message: \"Error fetching documents\" });\n    }\n  });\n\n  app.delete(\"/api/user/documents/:id\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      const docId = parseInt(req.params.id);\n      \n      const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n      if (!user || user.accountStatus === 'pending') {\n        return res.status(403).json({ message: \"Your account is in a status that does not allow this action. Contact our team.\" });\n      }\n      \n      // Check if document belongs to user via order OR direct assignment\n      const orderDocs = await db.select().from(applicationDocumentsTable)\n        .leftJoin(ordersTable, eq(applicationDocumentsTable.orderId, ordersTable.id))\n        .where(and(\n          eq(applicationDocumentsTable.id, docId),\n          eq(ordersTable.userId, userId)\n        ));\n      \n      const directDocs = await db.select().from(applicationDocumentsTable)\n        .where(and(\n          eq(applicationDocumentsTable.id, docId),\n          eq(applicationDocumentsTable.userId, userId)\n        ));\n      \n      if (!orderDocs.length && !directDocs.length) {\n        return res.status(404).json({ message: \"Document not found\" });\n      }\n      \n      const docToDelete = orderDocs[0]?.application_documents || directDocs[0];\n      if (docToDelete && docToDelete.reviewStatus === 'approved') {\n        return res.status(403).json({ message: \"Approved documents cannot be deleted.\" });\n      }\n      \n      await db.delete(applicationDocumentsTable).where(eq(applicationDocumentsTable.id, docId));\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting document:\", error);\n      res.status(500).json({ message: \"Error deleting document\" });\n    }\n  });\n\n\n  app.get(\"/api/user/documents/:id/download\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      const docId = parseInt(req.params.id);\n      \n      const [doc] = await db.select().from(applicationDocumentsTable)\n        .where(eq(applicationDocumentsTable.id, docId)).limit(1);\n      \n      if (!doc) {\n        return res.status(404).json({ message: \"Document not found\" });\n      }\n      \n      let hasAccess = req.session.isAdmin || req.session.isSupport;\n      \n      if (!hasAccess && doc.orderId) {\n        const [order] = await db.select().from(ordersTable)\n          .where(eq(ordersTable.id, doc.orderId)).limit(1);\n        if (order && order.userId === userId) {\n          hasAccess = true;\n        }\n      }\n      \n      if (!hasAccess && doc.userId === userId) {\n        hasAccess = true;\n      }\n      \n      if (!hasAccess) {\n        return res.status(403).json({ message: \"Access denied\" });\n      }\n      \n      if (!doc.fileUrl) {\n        return res.status(404).json({ message: \"File not available\" });\n      }\n      \n      const path = await import('path');\n      const fs = await import('fs');\n      const filePath = path.join(process.cwd(), doc.fileUrl.replace(/^\\//, ''));\n      \n      if (!fs.existsSync(filePath)) {\n        return res.status(404).json({ message: \"File not found\" });\n      }\n      \n      res.setHeader('Content-Disposition', `attachment; filename=\"${doc.fileName}\"`);\n      res.setHeader('X-Content-Type-Options', 'nosniff');\n      res.setHeader('Cache-Control', 'private, no-cache');\n      \n      res.sendFile(filePath);\n    } catch (error) {\n      console.error(\"Error downloading document:\", error);\n      res.status(500).json({ message: \"Error downloading file\" });\n    }\n  });\n\n  // Client document upload\n  app.post(\"/api/documents/upload\", isAuthenticated, async (req: any, res) => {\n    try {\n      const { orderId, fileName, fileUrl, documentType, applicationId } = z.object({\n        orderId: z.number(),\n        applicationId: z.number(),\n        fileName: z.string(),\n        fileUrl: z.string(),\n        documentType: z.string()\n      }).parse(req.body);\n\n      const [doc] = await db.insert(applicationDocumentsTable).values({\n        orderId,\n        applicationId,\n        fileName,\n        fileType: \"application/pdf\",\n        fileUrl,\n        documentType,\n        reviewStatus: \"pending\",\n        uploadedBy: req.session.userId\n      }).returning();\n\n      logActivity(\"Documento Subido por Cliente\", { \n        \"Cliente ID\": req.session.userId,\n        \"Pedido ID\": orderId,\n        \"Tipo\": documentType\n      });\n\n      const { fileUrl: _url, encryptionIv: _iv, fileHash: _hash, ...safeDoc } = doc;\n      res.json(safeDoc);\n    } catch (error) {\n      res.status(500).json({ message: \"Error uploading document\" });\n    }\n  });\n\n  // Protected file serving - admin documents\n  app.get(\"/uploads/admin-docs/:filename\", isAuthenticated, async (req: any, res) => {\n    try {\n      const filename = req.params.filename;\n      \n      // Security: Prevent path traversal attacks\n      if (filename.includes('..') || filename.includes('/') || filename.includes('\\\\')) {\n        return res.status(400).json({ message: \"Invalid filename\" });\n      }\n      \n      const fileUrl = `/uploads/admin-docs/${filename}`;\n      \n      // Check if user account is under review (non-admin only)\n      if (!req.session.isAdmin && !req.session.isSupport) {\n        const [user] = await db.select().from(usersTable).where(eq(usersTable.id, req.session.userId)).limit(1);\n        if (user && user.accountStatus === 'pending') {\n          return res.status(403).json({ message: \"Your account is in a status that does not allow this action. Contact our team.\" });\n        }\n      }\n      \n      // Find document by URL\n      const [doc] = await db.select().from(applicationDocumentsTable)\n        .where(eq(applicationDocumentsTable.fileUrl, fileUrl)).limit(1);\n      \n      if (!doc) {\n        return res.status(404).json({ message: \"Document not found\" });\n      }\n      \n      // Check ownership: via orderId or direct userId assignment\n      let hasAccess = req.session.isAdmin || req.session.isSupport;\n      \n      if (!hasAccess && doc.orderId) {\n        const [order] = await db.select().from(ordersTable)\n          .where(eq(ordersTable.id, doc.orderId)).limit(1);\n        if (order && order.userId === req.session.userId) {\n          hasAccess = true;\n        }\n      }\n      \n      if (!hasAccess && doc.userId === req.session.userId) {\n        hasAccess = true;\n      }\n      \n      if (!hasAccess) {\n        return res.status(403).json({ message: \"Access denied\" });\n      }\n      \n      const path = await import('path');\n      const fs = await import('fs');\n      const filePath = path.join(process.cwd(), 'uploads', 'admin-docs', filename);\n      \n      if (!fs.existsSync(filePath)) {\n        return res.status(404).json({ message: \"File not found\" });\n      }\n      \n      // Security headers for file downloads\n      res.setHeader('Content-Disposition', `attachment; filename=\"${filename}\"`);\n      res.setHeader('X-Content-Type-Options', 'nosniff');\n      res.setHeader('Cache-Control', 'private, no-cache');\n      \n      res.sendFile(filePath);\n    } catch (error) {\n      console.error(\"Error serving admin doc:\", error);\n      res.status(500).json({ message: \"Error serving file\" });\n    }\n  });\n\n  // Protected file serving - client documents\n  app.get(\"/uploads/client-docs/:filename\", isAuthenticated, async (req: any, res) => {\n    try {\n      const filename = req.params.filename;\n      \n      // Security: Prevent path traversal attacks\n      if (filename.includes('..') || filename.includes('/') || filename.includes('\\\\')) {\n        return res.status(400).json({ message: \"Invalid filename\" });\n      }\n      \n      const fileUrl = `/uploads/client-docs/${filename}`;\n      \n      // Check if user account is under review (non-admin/support only)\n      if (!req.session.isAdmin && !req.session.isSupport) {\n        const [user] = await db.select().from(usersTable).where(eq(usersTable.id, req.session.userId)).limit(1);\n        if (user && user.accountStatus === 'pending') {\n          return res.status(403).json({ message: \"Your account is in a status that does not allow this action. Contact our team.\" });\n        }\n      }\n      \n      // Find document by URL\n      const [doc] = await db.select().from(applicationDocumentsTable)\n        .where(eq(applicationDocumentsTable.fileUrl, fileUrl)).limit(1);\n      \n      if (!doc) {\n        return res.status(404).json({ message: \"Document not found\" });\n      }\n      \n      // Check ownership: via orderId or direct userId assignment\n      let hasAccess = req.session.isAdmin || req.session.isSupport;\n      \n      if (!hasAccess && doc.orderId) {\n        const [order] = await db.select().from(ordersTable)\n          .where(eq(ordersTable.id, doc.orderId)).limit(1);\n        if (order && order.userId === req.session.userId) {\n          hasAccess = true;\n        }\n      }\n      \n      if (!hasAccess && doc.userId === req.session.userId) {\n        hasAccess = true;\n      }\n      \n      if (!hasAccess) {\n        return res.status(403).json({ message: \"Access denied\" });\n      }\n      \n      const path = await import('path');\n      const fs = await import('fs');\n      const filePath = path.join(process.cwd(), 'uploads', 'client-docs', filename);\n      \n      if (!fs.existsSync(filePath)) {\n        return res.status(404).json({ message: \"File not found\" });\n      }\n      \n      // Security headers for file downloads\n      res.setHeader('Content-Disposition', `attachment; filename=\"${filename}\"`);\n      res.setHeader('X-Content-Type-Options', 'nosniff');\n      res.setHeader('Cache-Control', 'private, no-cache');\n      \n      res.sendFile(filePath);\n    } catch (error) {\n      console.error(\"Error serving client doc:\", error);\n      res.status(500).json({ message: \"Error serving file\" });\n    }\n  });\n\n  // Catch-all for /uploads - deny access to any uncovered paths\n  app.get(\"/uploads/*\", (_req, res) => {\n    res.status(403).json({ message: \"Access denied\" });\n  });\n\n  app.get(\"/api/products\", async (req, res) => {\n    const products = await storage.getProducts();\n    res.json(products);\n  });\n\n  // Protected admin seeding - requires existing admin authentication\n  app.post(\"/api/seed-admin\", isAdmin, async (req, res) => {\n    try {\n      const { email } = req.body;\n      const adminEmail = email || process.env.ADMIN_EMAIL || \"afortuny07@gmail.com\";\n      \n      const [existingUser] = await db.select().from(usersTable).where(eq(usersTable.email, adminEmail)).limit(1);\n      if (!existingUser) {\n        return res.status(404).json({ message: \"User not found.\" });\n      }\n      \n      await db.update(usersTable).set({ isAdmin: true, accountStatus: 'active' }).where(eq(usersTable.email, adminEmail));\n      res.json({ success: true, message: \"Admin role assigned successfully\" });\n    } catch (error) {\n      console.error(\"Seed admin error:\", error);\n      res.status(500).json({ message: \"Error assigning admin role\" });\n    }\n  });\n\n  // Client Delete Account\n  app.delete(\"/api/user/account\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      const { mode } = req.body; // 'hard' for 100% delete, 'soft' to keep data but disable email\n\n      if (mode === 'hard') {\n        await db.delete(usersTable).where(eq(usersTable.id, userId));\n      } else {\n        // Soft delete: Keep record but mark as deactivated and change email to prevent reuse\n        const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n        await db.update(usersTable).set({ \n          accountStatus: 'deactivated',\n          isActive: false,\n          email: `deleted_${userId}_${user.email}`,\n          updatedAt: new Date()\n        }).where(eq(usersTable.id, userId));\n      }\n\n      req.session.destroy(() => {});\n      res.json({ success: true, message: \"Account processed successfully\" });\n    } catch (error) {\n      console.error(\"Delete account error:\", error);\n      res.status(500).json({ message: \"Error processing account deletion\" });\n    }\n  });\n\n  // Save language preference (separate from profile - no OTP needed)\n  app.patch(\"/api/user/language\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      const { preferredLanguage } = req.body;\n      if (!preferredLanguage || typeof preferredLanguage !== 'string') {\n        return res.status(400).json({ message: \"Invalid language\" });\n      }\n      await db.update(usersTable).set({ preferredLanguage }).where(eq(usersTable.id, userId));\n      const [updatedUser] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n      res.json(updatedUser);\n    } catch (error) {\n      console.error(\"Update language error:\", error);\n      res.status(500).json({ message: \"Error updating language\" });\n    }\n  });\n\n  // Client Update Profile\n  const updateProfileSchema = z.object({\n    firstName: z.string().optional(),\n    lastName: z.string().optional(),\n    phone: z.string().optional(),\n    businessActivity: z.string().optional(),\n    address: z.string().optional(),\n    streetType: z.string().optional(),\n    city: z.string().optional(),\n    province: z.string().optional(),\n    postalCode: z.string().optional(),\n    country: z.string().optional(),\n    idNumber: z.string().optional(),\n    idType: z.string().optional(),\n    birthDate: z.string().optional(),\n  });\n  \n  // Sensitive fields that require OTP: name, ID/passport, phone only\n  const sensitiveFields = ['firstName', 'lastName', 'idNumber', 'idType', 'phone'];\n  \n  app.patch(\"/api/user/profile\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      const { otpCode, ...profileData } = req.body;\n      const validatedData = updateProfileSchema.parse(profileData);\n      \n      const [currentUser] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n      if (!currentUser || !currentUser.email) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      const currentUserEmail = currentUser.email;\n      \n      // Check which sensitive fields are being changed\n      // OTP is only required when MODIFYING an existing value, not when setting it for the first time\n      const changedSensitiveFields: { field: string; oldValue: any; newValue: any }[] = [];\n      for (const field of sensitiveFields) {\n        const currentValue = currentUser[field as keyof typeof currentUser];\n        const newValue = validatedData[field as keyof typeof validatedData];\n        const currentIsEmpty = !currentValue || (typeof currentValue === 'string' && currentValue.trim() === '');\n        const newIsEmpty = !newValue || (typeof newValue === 'string' && newValue.trim() === '');\n        \n        if (field in validatedData && newValue !== currentValue) {\n          // Skip OTP if the current value is empty (first time setting) or new value is empty (clearing)\n          if (currentIsEmpty || newIsEmpty) {\n            continue;\n          }\n          changedSensitiveFields.push({\n            field,\n            oldValue: currentValue || '(empty)',\n            newValue: newValue || '(empty)'\n          });\n        }\n      }\n      \n      if (changedSensitiveFields.length > 0) {\n        if (!otpCode) {\n          // Separate non-sensitive changes (apply immediately) from sensitive (hold pending)\n          const nonSensitiveData: Record<string, any> = {};\n          const pendingData: Record<string, any> = {};\n          \n          for (const [key, value] of Object.entries(validatedData)) {\n            if (sensitiveFields.includes(key) && changedSensitiveFields.some(f => f.field === key)) {\n              pendingData[key] = value;\n            } else {\n              nonSensitiveData[key] = value;\n            }\n          }\n          \n          // Apply non-sensitive changes immediately\n          if (Object.keys(nonSensitiveData).length > 0) {\n            await db.update(usersTable).set(nonSensitiveData).where(eq(usersTable.id, userId));\n          }\n          \n          // Store pending sensitive changes with 24h expiry\n          const expiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000);\n          await db.update(usersTable).set({\n            pendingProfileChanges: { fields: pendingData, changedFields: changedSensitiveFields, requestedAt: new Date().toISOString() },\n            pendingChangesExpiresAt: expiresAt,\n          }).where(eq(usersTable.id, userId));\n          \n          // Generate OTP (24h validity)\n          const otp = Math.floor(100000 + Math.random() * 900000).toString();\n          const otpExpiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000);\n          \n          await db.insert(contactOtps).values({\n            email: currentUserEmail,\n            otp,\n            otpType: \"profile_change\",\n            expiresAt: otpExpiresAt,\n            verified: false\n          });\n          \n          const userLang = (currentUser.preferredLanguage as any) || 'es';\n          const userName = currentUser.firstName || 'Cliente';\n          sendEmail({\n            to: currentUserEmail,\n            subject: `${getEmailTranslations(userLang).profileChangeOtp.title} - Easy US LLC`,\n            html: getProfileChangeOtpTemplate(userName, otp, userLang)\n          }).catch(console.error);\n          \n          return res.status(400).json({ \n            message: \"OTP verification required for sensitive changes\",\n            code: \"OTP_REQUIRED\",\n            changedFields: changedSensitiveFields.map(f => f.field),\n            pendingChanges: pendingData\n          });\n        }\n        \n        // OTP provided - verify it\n        const [otpRecord] = await db.select()\n          .from(contactOtps)\n          .where(\n            and(\n              eq(contactOtps.email, currentUserEmail),\n              eq(contactOtps.otpType, \"profile_change\"),\n              eq(contactOtps.otp, otpCode),\n              eq(contactOtps.verified, false),\n              gt(contactOtps.expiresAt, new Date())\n            )\n          )\n          .orderBy(sql`${contactOtps.expiresAt} DESC`)\n          .limit(1);\n        \n        if (!otpRecord) {\n          return res.status(400).json({ message: \"Invalid or expired OTP code\", code: \"OTP_INVALID\" });\n        }\n        \n        // Mark OTP as used\n        await db.update(contactOtps).set({ verified: true }).where(eq(contactOtps.id, otpRecord.id));\n        \n        // Apply ALL changes (including previously pending sensitive ones)\n        await db.update(usersTable).set({\n          ...validatedData,\n          pendingProfileChanges: null,\n          pendingChangesExpiresAt: null,\n        }).where(eq(usersTable.id, userId));\n        \n        // Log audit for admin visibility\n        logAudit({\n          action: 'password_change',\n          userId,\n          details: {\n            type: 'profile_update_verified',\n            changedFields: changedSensitiveFields,\n            email: currentUser.email,\n            clientId: currentUser.clientId\n          }\n        });\n        \n        const adminEmail = process.env.ADMIN_EMAIL || \"afortuny07@gmail.com\";\n        sendEmail({\n          to: adminEmail,\n          subject: `[ALERTA] Cambios de perfil verificados - Cliente ${currentUser.clientId}`,\n          html: getAdminProfileChangesTemplate(\n            `${currentUser.firstName} ${currentUser.lastName}`,\n            currentUser.email || '',\n            currentUser.clientId || '',\n            changedSensitiveFields\n          )\n        }).catch(console.error);\n        \n        const [updatedUser] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n        return res.json(updatedUser);\n      }\n      \n      // No sensitive fields changed - apply immediately\n      await db.update(usersTable).set(validatedData).where(eq(usersTable.id, userId));\n      \n      const [updatedUser] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n      res.json(updatedUser);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: error.errors[0].message });\n      }\n      console.error(\"Update profile error:\", error);\n      res.status(500).json({ message: \"Error updating profile\" });\n    }\n  });\n  \n  // Confirm pending profile changes with OTP\n  app.post(\"/api/user/profile/confirm-otp\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      const { otpCode } = req.body;\n      \n      if (!otpCode || typeof otpCode !== 'string' || otpCode.length !== 6) {\n        return res.status(400).json({ message: \"Invalid OTP code\" });\n      }\n      \n      const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n      if (!user || !user.email) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      const pendingChanges = user.pendingProfileChanges as any;\n      if (!pendingChanges || !pendingChanges.fields) {\n        return res.status(400).json({ message: \"No pending changes to confirm\" });\n      }\n      \n      // Check if pending changes have expired\n      if (user.pendingChangesExpiresAt && new Date(user.pendingChangesExpiresAt) < new Date()) {\n        await db.update(usersTable).set({ pendingProfileChanges: null, pendingChangesExpiresAt: null }).where(eq(usersTable.id, userId));\n        return res.status(400).json({ message: \"Pending changes have expired. Please make the changes again.\" });\n      }\n      \n      const userEmail = user.email;\n      \n      // Verify OTP\n      const [otpRecord] = await db.select()\n        .from(contactOtps)\n        .where(\n          and(\n            eq(contactOtps.email, userEmail),\n            eq(contactOtps.otpType, \"profile_change\"),\n            eq(contactOtps.otp, otpCode),\n            eq(contactOtps.verified, false),\n            gt(contactOtps.expiresAt, new Date())\n          )\n        )\n        .orderBy(sql`${contactOtps.expiresAt} DESC`)\n        .limit(1);\n      \n      if (!otpRecord) {\n        const attempts = (pendingChanges.otpAttempts || 0) + 1;\n        const maxAttempts = 5;\n        \n        if (attempts >= maxAttempts) {\n          await db.update(usersTable).set({ \n            pendingProfileChanges: null, \n            pendingChangesExpiresAt: null,\n            accountStatus: 'pending'\n          }).where(eq(usersTable.id, userId));\n          \n          logAudit({\n            action: 'account_review',\n            userId,\n            details: { reason: 'Too many failed OTP attempts for profile change', attempts, email: user.email }\n          });\n          \n          return res.status(403).json({ \n            message: \"Too many failed attempts. Your account has been placed under review for security.\", \n            code: \"ACCOUNT_UNDER_REVIEW\",\n            attemptsRemaining: 0\n          });\n        }\n        \n        await db.update(usersTable).set({ \n          pendingProfileChanges: { ...pendingChanges, otpAttempts: attempts }\n        }).where(eq(usersTable.id, userId));\n        \n        return res.status(400).json({ \n          message: \"Invalid or expired OTP code\", \n          code: \"OTP_INVALID\",\n          attemptsRemaining: maxAttempts - attempts\n        });\n      }\n      \n      // Mark OTP as used\n      await db.update(contactOtps).set({ verified: true }).where(eq(contactOtps.id, otpRecord.id));\n      \n      // Apply pending changes\n      await db.update(usersTable).set({\n        ...pendingChanges.fields,\n        pendingProfileChanges: null,\n        pendingChangesExpiresAt: null,\n      }).where(eq(usersTable.id, userId));\n      \n      // Log audit\n      logAudit({\n        action: 'password_change',\n        userId,\n        details: {\n          type: 'profile_update_verified',\n          changedFields: pendingChanges.changedFields,\n          email: user.email,\n          clientId: user.clientId\n        }\n      });\n      \n      const adminEmail = process.env.ADMIN_EMAIL || \"afortuny07@gmail.com\";\n      sendEmail({\n        to: adminEmail,\n        subject: `[ALERTA] Cambios de perfil verificados - Cliente ${user.clientId}`,\n        html: getAdminProfileChangesTemplate(\n          `${user.firstName} ${user.lastName}`,\n          user.email || '',\n          user.clientId || '',\n          pendingChanges.changedFields || []\n        )\n      }).catch(console.error);\n      \n      const [updatedUser] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n      res.json({ success: true, user: updatedUser });\n    } catch (error) {\n      console.error(\"Confirm profile OTP error:\", error);\n      res.status(500).json({ message: \"Error confirming changes\" });\n    }\n  });\n  \n  // Cancel pending profile changes\n  app.post(\"/api/user/profile/cancel-pending\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      await db.update(usersTable).set({ pendingProfileChanges: null, pendingChangesExpiresAt: null }).where(eq(usersTable.id, userId));\n      const [updatedUser] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n      res.json({ success: true, user: updatedUser });\n    } catch (error) {\n      console.error(\"Cancel pending changes error:\", error);\n      res.status(500).json({ message: \"Error cancelling changes\" });\n    }\n  });\n  \n  // Resend OTP for pending profile changes\n  app.post(\"/api/user/profile/resend-otp\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n      \n      if (!user || !user.email) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      const pendingChanges = user.pendingProfileChanges as any;\n      if (!pendingChanges) {\n        return res.status(400).json({ message: \"No pending changes\" });\n      }\n      \n      const ip = getClientIp(req);\n      const rateCheck = checkRateLimit('otp', ip);\n      if (!rateCheck.allowed) {\n        return res.status(429).json({ message: `Too many attempts. Wait ${rateCheck.retryAfter} seconds.` });\n      }\n      \n      const otp = Math.floor(100000 + Math.random() * 900000).toString();\n      const otpExpiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000);\n      const userEmail = user.email;\n      \n      await db.insert(contactOtps).values({\n        email: userEmail,\n        otp,\n        otpType: \"profile_change\",\n        expiresAt: otpExpiresAt,\n        verified: false\n      });\n      \n      const resendLang = (user.preferredLanguage as any) || 'es';\n      const resendName = user.firstName || 'Cliente';\n      sendEmail({\n        to: userEmail,\n        subject: `${getEmailTranslations(resendLang).profileChangeOtp.title} - Easy US LLC`,\n        html: getProfileChangeOtpTemplate(resendName, otp, resendLang)\n      }).catch(console.error);\n      \n      res.json({ success: true, message: \"New OTP code sent\" });\n    } catch (error) {\n      console.error(\"Resend OTP error:\", error);\n      res.status(500).json({ message: \"Error sending OTP\" });\n    }\n  });\n  \n  // Verify email for pending accounts (activate account)\n  app.post(\"/api/user/verify-email\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      const { otpCode } = req.body;\n      \n      const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n      if (!user || !user.email) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      if (user.emailVerified) {\n        return res.json({ success: true, message: \"Email already verified\" });\n      }\n      \n      const userEmail = user.email;\n      \n      // Verify OTP\n      const [otpRecord] = await db.select()\n        .from(contactOtps)\n        .where(\n          and(\n            eq(contactOtps.email, userEmail),\n            eq(contactOtps.otpType, \"account_verification\"),\n            eq(contactOtps.otp, otpCode),\n            eq(contactOtps.verified, false),\n            gt(contactOtps.expiresAt, new Date())\n          )\n        )\n        .limit(1);\n      \n      if (!otpRecord) {\n        return res.status(400).json({ message: \"Invalid or expired OTP code\" });\n      }\n      \n      // Mark OTP as used and activate account\n      await db.update(contactOtps).set({ verified: true }).where(eq(contactOtps.id, otpRecord.id));\n      await db.update(usersTable).set({ \n        emailVerified: true, \n        accountStatus: 'active' \n      }).where(eq(usersTable.id, userId));\n      \n      // Update session\n      req.session.isAdmin = user.isAdmin;\n      req.session.isSupport = user.isSupport;\n      \n      // Send welcome email\n      const activeLang = ((user as any).preferredLanguage || 'es') as EmailLanguage;\n      sendEmail({\n        to: userEmail,\n        subject: activeLang === 'en' ? \"Account activated - Easy US LLC\" : activeLang === 'ca' ? \"Compte activat - Easy US LLC\" : activeLang === 'fr' ? \"Compte activ\u00E9 - Easy US LLC\" : activeLang === 'de' ? \"Konto aktiviert - Easy US LLC\" : activeLang === 'it' ? \"Account attivato - Easy US LLC\" : activeLang === 'pt' ? \"Conta ativada - Easy US LLC\" : \"Cuenta activada - Easy US LLC\",\n        html: getWelcomeEmailTemplate(user.firstName || undefined, activeLang)\n      }).catch(console.error);\n      \n      res.json({ success: true, message: \"Email verified successfully. Your account is active.\" });\n    } catch (error) {\n      console.error(\"Verify email error:\", error);\n      res.status(500).json({ message: \"Error verifying email\" });\n    }\n  });\n  \n  // Send verification OTP for pending accounts\n  app.post(\"/api/user/send-verification-otp\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      const [user] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n      \n      if (!user || !user.email) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      if (user.emailVerified) {\n        return res.json({ success: true, message: \"Email already verified\" });\n      }\n      \n      const ip = getClientIp(req);\n      const rateCheck = checkRateLimit('otp', ip);\n      if (!rateCheck.allowed) {\n        return res.status(429).json({ message: `Too many attempts. Wait ${rateCheck.retryAfter} seconds.` });\n      }\n      \n      const otp = Math.floor(100000 + Math.random() * 900000).toString();\n      const expiresAt = new Date(Date.now() + 10 * 60 * 1000);\n      const userEmail = user.email;\n      \n      await db.insert(contactOtps).values({\n        email: userEmail,\n        otp,\n        otpType: \"account_verification\",\n        expiresAt,\n        verified: false\n      });\n      \n      const vpLang = ((user as any).preferredLanguage || 'es') as EmailLanguage;\n      sendEmail({\n        to: userEmail,\n        subject: getOtpSubject(vpLang),\n        html: getOtpEmailTemplate(otp, user.firstName || undefined, vpLang)\n      }).catch(console.error);\n      \n      res.json({ success: true, message: \"OTP code sent to your email\" });\n    } catch (error) {\n      console.error(\"Send verification OTP error:\", error);\n      res.status(500).json({ message: \"Error sending OTP\" });\n    }\n  });\n\n  // User Compliance Deadlines - Calendar API\n  app.get(\"/api/user/deadlines\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      \n      // Get all user orders with applications\n      const userOrders = await db.select({\n        order: ordersTable,\n        application: llcApplicationsTable,\n      })\n      .from(ordersTable)\n      .leftJoin(llcApplicationsTable, eq(ordersTable.id, llcApplicationsTable.orderId))\n      .where(eq(ordersTable.userId, userId));\n\n      const applications = userOrders\n        .filter(o => o.application)\n        .map(o => o.application);\n\n      const deadlines = getUpcomingDeadlinesForUser(applications);\n      res.json(deadlines);\n    } catch (error) {\n      console.error(\"Error fetching deadlines:\", error);\n      res.status(500).json({ message: \"Error fetching compliance dates\" });\n    }\n  });\n\n  // Client update order (allowed fields before processing)\n  app.patch(\"/api/orders/:id\", isAuthenticated, async (req: any, res) => {\n    try {\n      const orderId = Number(req.params.id);\n      const order = await storage.getOrder(orderId);\n      \n      if (!order || order.userId !== req.session.userId) {\n        return res.status(403).json({ message: \"Not authorized\" });\n      }\n\n      if (order.status !== 'pending') {\n        return res.status(400).json({ message: \"The order is already in progress and cannot be modified.\" });\n      }\n\n      const updateSchema = z.object({\n        companyNameOption2: z.string().optional(),\n        designator: z.string().optional(),\n        companyDescription: z.string().optional(),\n        ownerNamesAlternates: z.string().optional(),\n        notes: z.string().optional()\n      });\n\n      const validatedData = updateSchema.parse(req.body);\n      \n      await db.update(llcApplicationsTable)\n        .set({ ...validatedData, lastUpdated: new Date() })\n        .where(eq(llcApplicationsTable.orderId, orderId));\n\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ message: \"Error updating order\" });\n    }\n  });\n\n  // Get user notifications\n  app.get(\"/api/user/notifications\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      const notifs = await db.select()\n        .from(userNotifications)\n        .where(eq(userNotifications.userId, userId))\n        .orderBy(desc(userNotifications.createdAt))\n        .limit(50);\n      res.json(notifs);\n    } catch (error) {\n      console.error(\"Get notifications error:\", error);\n      res.status(500).json({ message: \"Error fetching notifications\" });\n    }\n  });\n\n  app.patch(\"/api/user/notifications/:id/read\", isAuthenticated, async (req: any, res) => {\n    try {\n      await db.update(userNotifications)\n        .set({ isRead: true })\n        .where(and(eq(userNotifications.id, req.params.id), eq(userNotifications.userId, req.session.userId)));\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ message: \"Error\" });\n    }\n  });\n\n  // Delete user notification\n  app.delete(\"/api/user/notifications/:id\", isAuthenticated, async (req: any, res) => {\n    try {\n      await db.delete(userNotifications)\n        .where(and(eq(userNotifications.id, req.params.id), eq(userNotifications.userId, req.session.userId)));\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ message: \"Error deleting notification\" });\n    }\n  });\n\n  // Request OTP for password change\n  app.post(\"/api/user/request-password-otp\", isAuthenticated, async (req: any, res) => {\n    try {\n      const [user] = await db.select().from(usersTable).where(eq(usersTable.id, req.session.userId));\n      if (!user?.email) {\n        return res.status(400).json({ message: \"User not found\" });\n      }\n      \n      const otp = Math.floor(100000 + Math.random() * 900000).toString();\n      const expires = new Date(Date.now() + 10 * 60 * 1000); // 10 min\n      \n      // Store OTP in database\n      await db.insert(contactOtps).values({\n        email: user.email,\n        otp,\n        otpType: \"password_change\",\n        expiresAt: expires,\n        verified: false\n      });\n      \n      const pwLang = ((user as any).preferredLanguage || 'es') as EmailLanguage;\n      await sendEmail({\n        to: user.email,\n        subject: getOtpSubject(pwLang),\n        html: getPasswordChangeOtpTemplate(user.firstName || '', otp, pwLang)\n      });\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Request password OTP error:\", error);\n      res.status(500).json({ message: \"Error sending code\" });\n    }\n  });\n\n  // Change password with OTP verification\n  app.post(\"/api/user/change-password\", isAuthenticated, async (req: any, res) => {\n    try {\n      const { currentPassword, newPassword, otp } = z.object({\n        currentPassword: z.string().min(1),\n        newPassword: z.string().min(8),\n        otp: z.string().length(6)\n      }).parse(req.body);\n      \n      const [user] = await db.select().from(usersTable).where(eq(usersTable.id, req.session.userId));\n      if (!user?.email || !user?.passwordHash) {\n        return res.status(400).json({ message: \"Cannot change password\" });\n      }\n      \n      // Verify OTP from database\n      const [otpRecord] = await db.select()\n        .from(contactOtps)\n        .where(and(\n          eq(contactOtps.email, user.email),\n          eq(contactOtps.otp, otp),\n          eq(contactOtps.otpType, \"password_change\"),\n          gt(contactOtps.expiresAt, new Date())\n        ));\n      \n      if (!otpRecord) {\n        return res.status(400).json({ message: \"Invalid or expired verification code\" });\n      }\n      \n      // Delete used OTP\n      await db.delete(contactOtps).where(eq(contactOtps.id, otpRecord.id));\n      \n      const { verifyPassword, hashPassword } = await import(\"../lib/auth-service\");\n      const isValid = await verifyPassword(currentPassword, user.passwordHash);\n      if (!isValid) {\n        return res.status(400).json({ message: \"Incorrect current password\" });\n      }\n      \n      const newHash = await hashPassword(newPassword);\n      await db.update(usersTable).set({ passwordHash: newHash, updatedAt: new Date() }).where(eq(usersTable.id, req.session.userId));\n      \n      res.json({ success: true });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Invalid data\" });\n      }\n      console.error(\"Change password error:\", error);\n      res.status(500).json({ message: \"Error changing password\" });\n    }\n  });\n}\n", "import type { Express } from \"express\";\nimport { z } from \"zod\";\nimport { eq, desc, sql, and, gt } from \"drizzle-orm\";\nimport { db, storage, isAuthenticated, logAudit, getClientIp, logActivity, isIpBlockedFromOrders, trackOrderByIp } from \"./shared\";\nimport { api } from \"@shared/routes\";\nimport { contactOtps, users as usersTable, orderEvents, userNotifications, orders as ordersTable, llcApplications as llcApplicationsTable, maintenanceApplications, discountCodes } from \"@shared/schema\";\nimport { sendEmail, getWelcomeEmailTemplate } from \"../lib/email\";\nimport { EmailLanguage, getWelcomeEmailSubject } from \"../lib/email-translations\";\nimport { generateOrderInvoice } from \"../lib/pdf-generator\";\n\nexport function registerOrderRoutes(app: Express) {\n  // Orders (Requires authentication)\n  app.get(api.orders.list.path, async (req: any, res) => {\n    if (!req.session.userId) {\n      return res.status(401).json({ message: \"Unauthorized\" });\n    }\n    const orders = await storage.getOrders(req.session.userId);\n    res.json(orders);\n  });\n\n  // Invoices\n  app.get(\"/api/orders/:id/invoice\", isAuthenticated, async (req: any, res) => {\n    try {\n      const orderId = Number(req.params.id);\n      const order = await storage.getOrder(orderId);\n      \n      if (!order || (order.userId !== req.session.userId && !req.session.isAdmin && !req.session.isSupport)) {\n        return res.status(403).json({ message: \"Not authorized\" });\n      }\n\n      const [llcApp] = await db.select().from(llcApplicationsTable).where(eq(llcApplicationsTable.orderId, orderId)).limit(1);\n      const [maintApp] = await db.select().from(maintenanceApplications).where(eq(maintenanceApplications.orderId, orderId)).limit(1);\n      const activeAccounts = await storage.getActivePaymentAccounts();\n\n      const pdfBuffer = await generateOrderInvoice({\n        order: {\n          id: order.id,\n          invoiceNumber: order.invoiceNumber,\n          amount: order.amount,\n          originalAmount: order.originalAmount,\n          discountCode: order.discountCode,\n          discountAmount: order.discountAmount,\n          currency: order.currency || 'EUR',\n          status: order.status,\n          createdAt: order.createdAt\n        },\n        product: {\n          name: order.product?.name || 'Servicio LLC',\n          description: order.product?.description || '',\n          features: order.product?.features as string[] || []\n        },\n        user: {\n          firstName: order.user?.firstName,\n          lastName: order.user?.lastName,\n          email: order.user?.email || ''\n        },\n        application: llcApp || null,\n        maintenanceApplication: maintApp || null,\n        paymentLink: order.paymentLink || undefined,\n        bankAccounts: activeAccounts.map(a => ({ label: a.label, holder: a.holder, bankName: a.bankName, accountType: a.accountType, accountNumber: a.accountNumber, routingNumber: a.routingNumber, iban: a.iban, swift: a.swift, address: a.address }))\n      });\n      \n      const invoiceNumber = llcApp?.requestCode || maintApp?.requestCode || order.invoiceNumber || `INV-${orderId}`;\n      res.setHeader('Content-Type', 'application/pdf');\n      res.setHeader('Content-Disposition', `inline; filename=\"Factura-${invoiceNumber}.pdf\"`);\n      res.send(pdfBuffer);\n    } catch (error) {\n      console.error(\"Invoice Error:\", error);\n      res.status(500).send(\"Error generating invoice\");\n    }\n  });\n  app.post(api.orders.create.path, async (req: any, res) => {\n    try {\n      const { productId, email, password, ownerFullName, paymentMethod, discountCode, discountAmount } = req.body;\n      \n      // Check IP-based order creation limit first\n      const clientIp = getClientIp(req);\n      const ipCheck = isIpBlockedFromOrders(clientIp);\n      if (ipCheck.blocked) {\n        logAudit({ action: 'ip_order_blocked', details: { ip: clientIp, ordersCount: ipCheck.ordersCount } });\n        return res.status(429).json({ \n          message: \"Request limit reached from this connection. Please try again later or contact support.\",\n          code: \"IP_ORDER_LIMIT\"\n        });\n      }\n      \n      // Parse productId\n      const parsedInput = api.orders.create.input.parse({ productId });\n      \n      let userId: string;\n      let isNewUser = false;\n      \n      if (req.session?.userId) {\n        // User already authenticated\n        const [currentUser] = await db.select().from(usersTable).where(eq(usersTable.id, req.session.userId)).limit(1);\n        if (currentUser && (currentUser.accountStatus === 'pending' || currentUser.accountStatus === 'deactivated')) {\n          return res.status(403).json({ message: \"Your account is under review or deactivated. You cannot place new orders at this time.\" });\n        }\n        userId = req.session.userId;\n      } else {\n        // Require email, password and OTP verification for new users\n        if (!email || !password) {\n          return res.status(400).json({ message: \"Email and password are required to place an order.\" });\n        }\n        \n        if (password.length < 8) {\n          return res.status(400).json({ message: \"Password must be at least 8 characters.\" });\n        }\n        \n        // Check if email already exists\n        const [existingUser] = await db.select().from(usersTable).where(eq(usersTable.email, email)).limit(1);\n        if (existingUser) {\n          return res.status(400).json({ message: \"This email is already registered. Please log in.\" });\n        }\n        \n        // Verify that email has been verified via OTP\n        const [otpRecord] = await db.select()\n          .from(contactOtps)\n          .where(\n            and(\n              eq(contactOtps.email, email),\n              eq(contactOtps.otpType, \"account_verification\"),\n              eq(contactOtps.verified, true),\n              gt(contactOtps.expiresAt, new Date(Date.now() - 30 * 60 * 1000)) // Allow 30 min window after verification\n            )\n          )\n          .orderBy(sql`${contactOtps.expiresAt} DESC`)\n          .limit(1);\n        \n        if (!otpRecord) {\n          return res.status(400).json({ message: \"Please verify your email before continuing.\" });\n        }\n        \n        // Create new user with verified email and password\n        const { hashPassword } = await import(\"../lib/auth-service\");\n        const { generateUniqueClientId } = await import(\"../lib/id-generator\");\n        const passwordHash = await hashPassword(password);\n        const clientId = await generateUniqueClientId();\n        const nameParts = ownerFullName?.split(' ') || ['Cliente'];\n        \n        const [newUser] = await db.insert(usersTable).values({\n          email,\n          passwordHash,\n          clientId,\n          firstName: nameParts[0] || 'Cliente',\n          lastName: nameParts.slice(1).join(' ') || '',\n          emailVerified: true,\n          accountStatus: 'active',\n        }).returning();\n        \n        userId = newUser.id;\n        isNewUser = true;\n        \n        // Set session for the new user\n        req.session.userId = userId;\n        \n        const oLang = (req.body.preferredLanguage || 'es') as EmailLanguage;\n        sendEmail({\n          to: email,\n          subject: getWelcomeEmailSubject(oLang),\n          html: getWelcomeEmailTemplate(nameParts[0] || undefined, oLang)\n        }).catch(console.error);\n      }\n\n      const product = await storage.getProduct(productId);\n      if (!product) {\n        return res.status(400).json({ message: \"Invalid product\" });\n      }\n\n      // CRITICAL: Ensure pricing follows NM 739\u20AC, WY 899\u20AC, DE 1399\u20AC\n      let finalPrice = product.price;\n      if (product.name.includes(\"New Mexico\")) finalPrice = 73900;\n      else if (product.name.includes(\"Wyoming\")) finalPrice = 89900;\n      else if (product.name.includes(\"Delaware\")) finalPrice = 139900;\n\n      // Calculate final amount with discount\n      let originalAmount = finalPrice;\n      let appliedDiscountAmount = 0;\n      let appliedDiscountCode: string | null = null;\n      \n      if (discountCode && discountAmount) {\n        appliedDiscountCode = discountCode;\n        appliedDiscountAmount = discountAmount;\n        finalPrice = Math.max(0, finalPrice - discountAmount);\n        \n        // Increment used count for the discount code\n        await db.update(discountCodes)\n          .set({ usedCount: sql`${discountCodes.usedCount} + 1` })\n          .where(eq(discountCodes.code, discountCode.toUpperCase()));\n      }\n\n      // Create the order\n      const order = await storage.createOrder({\n        userId,\n        productId,\n        amount: finalPrice,\n        originalAmount: appliedDiscountCode ? originalAmount : null,\n        discountCode: appliedDiscountCode,\n        discountAmount: appliedDiscountAmount || null,\n        status: \"pending\",\n        stripeSessionId: \"mock_session_\" + Date.now(),\n      });\n\n      await db.insert(orderEvents).values({\n        orderId: order.id,\n        eventType: \"i18n:dashboard.tracking.orderReceived\",\n        description: `i18n:ntf.orderCreated.message::{\"productName\":\"${product.name}\"}`,\n        createdBy: userId\n      });\n\n      // Create an empty application linked to the order\n      const application = await storage.createLlcApplication({\n        orderId: order.id,\n        status: \"draft\",\n        state: product.name.split(\" \")[0], // Extract state name correctly\n      });\n\n      // NOTIFICATION: New order created (translated on frontend via i18n keys)\n      if (userId && !userId.startsWith('guest_')) {\n        await db.insert(userNotifications).values({\n          userId,\n          orderId: order.id,\n          orderCode: application.requestCode || order.invoiceNumber,\n          title: 'i18n:ntf.orderCreated.title',\n          message: `i18n:ntf.orderCreated.message::{\"productName\":\"${product.name}\"}`,\n          type: 'info',\n          isRead: false\n        });\n      }\n\n      // Generate unified request code: STATE-8digits (e.g., NM-12345678)\n      const { generateUniqueOrderCode } = await import(\"../lib/id-generator\");\n      const appState = product.name.split(\" \")[0] || 'New Mexico';\n      const requestCode = await generateUniqueOrderCode(appState);\n\n      const updatedApplication = await storage.updateLlcApplication(application.id, { requestCode });\n\n      // Track IP for order creation limiting\n      trackOrderByIp(clientIp);\n      \n      // Notification to admin about NEW ORDER\n      logActivity(\"Nuevo Pedido Recibido\", {\n        \"Referencia\": requestCode,\n        \"Producto\": product.name,\n        \"Importe\": `${(finalPrice / 100).toFixed(2)}\u20AC`,\n        \"Usuario\": userId,\n        \"IP\": req.ip\n      });\n\n      // Return order with application\n      res.status(201).json({ ...order, application: updatedApplication });\n    } catch (err) {\n      if (err instanceof z.ZodError) {\n        return res.status(400).json({ message: err.errors[0].message });\n      }\n      console.error(\"Error creating order:\", err);\n      return res.status(500).json({ message: \"Error creating order\" });\n    }\n  });\n\n  // Order Events Timeline\n  app.get(\"/api/orders/:id/events\", isAuthenticated, async (req: any, res) => {\n    try {\n      const orderId = Number(req.params.id);\n      const order = await storage.getOrder(orderId);\n      \n      if (!order) return res.status(404).json({ message: \"Order not found\" });\n      if (order.userId !== req.session.userId && !req.session.isAdmin) {\n        return res.status(403).json({ message: \"Access denied\" });\n      }\n      \n      const events = await db.select().from(orderEvents)\n        .where(eq(orderEvents.orderId, orderId))\n        .orderBy(desc(orderEvents.createdAt));\n      \n      res.json(events);\n    } catch (error) {\n      console.error(\"Error fetching order events:\", error);\n      res.status(500).json({ message: \"Error fetching events\" });\n    }\n  });\n}\n", "import { z } from 'zod';\nimport { insertLlcApplicationSchema, insertApplicationDocumentSchema, products, orders, llcApplications, applicationDocuments } from './schema';\n\nexport const errorSchemas = {\n  validation: z.object({\n    message: z.string(),\n    field: z.string().optional(),\n  }),\n  notFound: z.object({\n    message: z.string(),\n  }),\n  internal: z.object({\n    message: z.string(),\n  }),\n  unauthorized: z.object({\n    message: z.string(),\n  }),\n};\n\nexport const api = {\n  products: {\n    list: {\n      method: 'GET' as const,\n      path: '/api/products',\n      responses: {\n        200: z.array(z.custom<typeof products.$inferSelect>()),\n      },\n    },\n    get: {\n      method: 'GET' as const,\n      path: '/api/products/:id',\n      responses: {\n        200: z.custom<typeof products.$inferSelect>(),\n        404: errorSchemas.notFound,\n      },\n    }\n  },\n  orders: {\n    list: {\n      method: 'GET' as const,\n      path: '/api/orders',\n      responses: {\n        200: z.array(z.custom<typeof orders.$inferSelect & { product: typeof products.$inferSelect; application: typeof llcApplications.$inferSelect | null }>()),\n        401: errorSchemas.unauthorized,\n      },\n    },\n    create: {\n      method: 'POST' as const,\n      path: '/api/orders',\n      input: z.object({\n        productId: z.number(),\n      }),\n      responses: {\n        201: z.custom<typeof orders.$inferSelect>(),\n        400: errorSchemas.validation,\n        401: errorSchemas.unauthorized,\n      },\n    },\n  },\n  llc: {\n    get: {\n      method: 'GET' as const,\n      path: '/api/llc/:id',\n      responses: {\n        200: z.custom<typeof llcApplications.$inferSelect>(),\n        404: errorSchemas.notFound,\n        401: errorSchemas.unauthorized,\n      },\n    },\n    update: {\n      method: 'PUT' as const,\n      path: '/api/llc/:id',\n      input: insertLlcApplicationSchema.partial(),\n      responses: {\n        200: z.custom<typeof llcApplications.$inferSelect>(),\n        400: errorSchemas.validation,\n        401: errorSchemas.unauthorized,\n        404: errorSchemas.notFound,\n      },\n    },\n    getByCode: {\n      method: 'GET' as const,\n      path: '/api/llc/code/:code',\n      responses: {\n        200: z.custom<typeof llcApplications.$inferSelect & { documents: (typeof applicationDocuments.$inferSelect)[] }>(),\n        404: errorSchemas.notFound,\n      },\n    },\n  },\n  documents: {\n    create: {\n      method: 'POST' as const,\n      path: '/api/documents',\n      input: insertApplicationDocumentSchema,\n      responses: {\n        201: z.custom<typeof applicationDocuments.$inferSelect>(),\n        400: errorSchemas.validation,\n        404: errorSchemas.notFound,\n      },\n    },\n    delete: {\n      method: 'DELETE' as const,\n      path: '/api/documents/:id',\n      responses: {\n        200: z.object({ success: z.boolean() }),\n        404: errorSchemas.notFound,\n      },\n    },\n  },\n};\n\nexport function buildUrl(path: string, params?: Record<string, string | number>): string {\n  let url = path;\n  if (params) {\n    Object.entries(params).forEach(([key, value]) => {\n      if (url.includes(`:${key}`)) {\n        url = url.replace(`:${key}`, String(value));\n      }\n    });\n  }\n  return url;\n}\n", "import PDFDocument from 'pdfkit';\nimport path from 'path';\nimport fs from 'fs';\nimport { fileURLToPath } from 'url';\n\nfunction getDirname(): string {\n  try {\n    if (typeof import.meta?.url !== 'undefined') {\n      return path.dirname(fileURLToPath(import.meta.url));\n    }\n  } catch {}\n  return path.resolve();\n}\n\nconst __dirname = getDirname();\n\nconst BRAND_GREEN = '#6EDC8A';\nconst BRAND_DARK = '#0A0A0A';\nconst BRAND_GRAY = '#6B7280';\nconst BRAND_LIGHT_GREEN = '#ECFDF5';\nconst BRAND_LIGHT_GRAY = '#F9FAFB';\n\nexport interface BankAccountInfo {\n  label: string;\n  holder: string;\n  bankName: string;\n  accountType: string;\n  accountNumber?: string | null;\n  routingNumber?: string | null;\n  iban?: string | null;\n  swift?: string | null;\n  address?: string | null;\n}\n\nconst DEFAULT_BANK_ACCOUNTS: BankAccountInfo[] = [\n  {\n    label: 'Thread Bank (Checking)',\n    holder: 'Fortuny Consulting LLC',\n    bankName: 'Thread Bank NA',\n    accountType: 'checking',\n    accountNumber: '200002330558',\n    routingNumber: '064209588',\n    swift: 'CLNOUS66MER',\n    address: '1209 Mountain Road Place NE, STE R, Albuquerque, NM 87110'\n  },\n  {\n    label: 'Column N.A. (Checking)',\n    holder: 'Fortuny Consulting LLC',\n    bankName: 'Column N.A.',\n    accountType: 'checking',\n    accountNumber: '141432778929495',\n    routingNumber: '121145433',\n    address: '1 Letterman Drive, Building A, Suite A4-700, San Francisco, CA 94129'\n  },\n  {\n    label: 'Cuenta Internacional (IBAN)',\n    holder: 'Fortuny Consulting LLC',\n    bankName: 'BANKING CIRCLE SA',\n    accountType: 'iban',\n    iban: 'DK2489000045271938',\n    swift: 'SXPYDKKK',\n  }\n];\n\nlet cachedLogoPath: string | null = null;\nlet logoChecked = false;\n\nfunction getLogoPath(): string | null {\n  if (logoChecked) return cachedLogoPath;\n  const possiblePaths = [\n    path.join(process.cwd(), 'client/public/logo-icon.png'),\n    path.join(process.cwd(), 'dist/public/logo-icon.png'),\n    path.join(__dirname, '../../client/public/logo-icon.png'),\n  ];\n  for (const logoPath of possiblePaths) {\n    if (fs.existsSync(logoPath)) {\n      cachedLogoPath = logoPath;\n      logoChecked = true;\n      return logoPath;\n    }\n  }\n  logoChecked = true;\n  return null;\n}\n\nexport interface CustomerData {\n  name: string;\n  email: string;\n  phone?: string;\n  idType?: string;\n  idNumber?: string;\n  address?: string;\n  streetType?: string;\n  city?: string;\n  province?: string;\n  postalCode?: string;\n  country?: string;\n  clientId?: string;\n}\n\nexport interface InvoiceData {\n  orderNumber: string;\n  date: string;\n  dueDate?: string;\n  customer: CustomerData;\n  items: Array<{\n    description: string;\n    details?: string;\n    quantity: number;\n    unitPrice: number;\n    total: number;\n  }>;\n  subtotal: number;\n  discount?: {\n    code?: string;\n    type?: 'percentage' | 'fixed';\n    value?: number;\n    amount: number;\n  };\n  bankAccounts?: BankAccountInfo[];\n  total: number;\n  currency: string;\n  status: 'pending' | 'paid' | 'cancelled' | 'refunded';\n  paymentMethod?: 'transfer' | 'card' | 'stripe' | 'paypal' | 'link' | 'other';\n  paymentDate?: string;\n  paymentLink?: string;\n  notes?: string;\n  isMaintenance?: boolean;\n  maintenanceApplication?: {\n    requestCode?: string | null;\n    companyName?: string | null;\n    ein?: string | null;\n    state?: string | null;\n  } | null;\n}\n\nexport interface CustomInvoiceData {\n  invoiceNumber: string;\n  date: string;\n  customer: CustomerData;\n  concept: string;\n  description?: string;\n  amount: number;\n  currency: string;\n  status: 'pending' | 'paid';\n  paymentMethod?: string;\n  notes?: string;\n  bankAccounts?: BankAccountInfo[];\n}\n\nfunction formatCurrency(cents: number, currency: string): string {\n  const amount = (cents / 100).toFixed(2).replace('.', ',');\n  return currency === 'EUR' ? `${amount} \u20AC` : `$${amount}`;\n}\n\nfunction formatDate(dateStr: string): string {\n  try {\n    const date = new Date(dateStr);\n    return date.toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit', year: 'numeric' });\n  } catch {\n    return dateStr;\n  }\n}\n\nfunction getStatusText(status: string): string {\n  const map: Record<string, string> = {\n    'pending': 'PENDIENTE', 'paid': 'PAGADO', 'completed': 'COMPLETADO',\n    'cancelled': 'CANCELADO', 'refunded': 'REEMBOLSADO'\n  };\n  return map[status] || status.toUpperCase();\n}\n\nfunction getPaymentMethodText(method?: string): string {\n  if (!method) return 'No especificado';\n  const map: Record<string, string> = {\n    'transfer': 'Transferencia bancaria',\n    'link': 'Enlace de pago'\n  };\n  return map[method] || 'Transferencia bancaria';\n}\n\nexport function generateInvoicePdf(data: InvoiceData): Promise<Buffer> {\n  return new Promise((resolve, reject) => {\n    try {\n      const doc = new PDFDocument({ size: 'A4', margin: 50, bufferPages: false,\n        info: { Title: `Factura ${data.orderNumber}`, Author: 'Easy US LLC' }\n      });\n      const chunks: Buffer[] = [];\n      doc.on('data', (chunk: Buffer) => chunks.push(chunk));\n      doc.on('end', () => resolve(Buffer.concat(chunks)));\n      doc.on('error', reject);\n\n      const pageW = 595;\n      const left = 50;\n      const right = pageW - 50;\n      const contentW = right - left;\n      const black = '#111111';\n      const dark = '#1A1A1A';\n      const mid = '#555555';\n      const light = '#999999';\n      const line = '#D4D4D4';\n      const faint = '#F5F5F5';\n\n      doc.rect(0, 0, 595, 842).fill('#FFFFFF');\n\n      const logoPath = getLogoPath();\n      if (logoPath) { try { doc.image(logoPath, left, 40, { width: 36, height: 36 }); } catch {} }\n\n      doc.font('Helvetica-Bold').fontSize(16).fillColor(black).text('Easy US LLC', left + 44, 44);\n      doc.font('Helvetica').fontSize(7.5).fillColor(light).text('Fortuny Consulting LLC', left + 44, 62);\n\n      doc.font('Helvetica').fontSize(9).fillColor(mid).text(`No. ${data.orderNumber}`, left, 80, { align: 'right', width: contentW });\n\n      doc.moveTo(left, 98).lineTo(right, 98).strokeColor(black).lineWidth(1.5).stroke();\n\n      let y = 118;\n\n      doc.font('Helvetica').fontSize(7).fillColor(light).text('FROM', left, y);\n      doc.font('Helvetica-Bold').fontSize(10).fillColor(black).text('Fortuny Consulting LLC', left, y + 12);\n      doc.font('Helvetica').fontSize(8.5).fillColor(mid);\n      doc.text('1209 Mountain Road Place NE, STE R', left, y + 26);\n      doc.text('Albuquerque, NM 87110, USA', left, y + 38);\n      doc.text('hola@easyusllc.com', left, y + 50);\n\n      const cX = 320;\n      doc.font('Helvetica').fontSize(7).fillColor(light).text('BILL TO', cX, y);\n      doc.font('Helvetica-Bold').fontSize(10).fillColor(black).text(data.customer.name, cX, y + 12);\n      doc.font('Helvetica').fontSize(8.5).fillColor(mid);\n      let cy = y + 26;\n      if (data.customer.idType && data.customer.idNumber) {\n        doc.text(`${data.customer.idType}: ${data.customer.idNumber}`, cX, cy); cy += 12;\n      }\n      doc.text(data.customer.email, cX, cy); cy += 12;\n      if (data.customer.phone) { doc.text(data.customer.phone, cX, cy); cy += 12; }\n      if (data.customer.address) {\n        const addr = [data.customer.streetType, data.customer.address, data.customer.postalCode, data.customer.city, data.customer.country].filter(Boolean).join(', ');\n        doc.fontSize(8).text(addr, cX, cy, { width: right - cX });\n      }\n\n      y += 80;\n      doc.moveTo(left, y).lineTo(right, y).strokeColor(line).lineWidth(0.5).stroke();\n      y += 15;\n\n      const col2 = left + contentW * 0.33;\n      const col3 = left + contentW * 0.56;\n      const col4 = left + contentW * 0.78;\n      doc.font('Helvetica').fontSize(7).fillColor(light);\n      doc.text('ISSUE DATE', left, y);\n      doc.text('DUE DATE', col2, y);\n      doc.text('STATUS', col3, y);\n      doc.text('CURRENCY', col4, y);\n      y += 11;\n      doc.font('Helvetica-Bold').fontSize(9.5).fillColor(black);\n      doc.text(formatDate(data.date), left, y);\n      doc.text(data.dueDate ? formatDate(data.dueDate) : formatDate(data.date), col2, y);\n      const statusColors: Record<string, string> = { pending: '#D97706', paid: '#059669', cancelled: '#DC2626', refunded: '#7C3AED' };\n      doc.fillColor(statusColors[data.status] || '#059669').text(getStatusText(data.status), col3, y);\n      doc.fillColor(black).text(data.currency, col4, y);\n\n      y += 22;\n      doc.moveTo(left, y).lineTo(right, y).strokeColor(line).lineWidth(0.5).stroke();\n      y += 20;\n\n      doc.font('Helvetica-Bold').fontSize(7.5).fillColor(light);\n      doc.text('DESCRIPTION', left, y);\n      doc.text('QTY', left + contentW * 0.62, y, { width: 40 });\n      doc.text('UNIT PRICE', left + contentW * 0.72, y, { width: 60 });\n      doc.text('AMOUNT', right - 60, y, { width: 60, align: 'right' });\n      y += 14;\n      doc.moveTo(left, y).lineTo(right, y).strokeColor(black).lineWidth(0.8).stroke();\n      y += 8;\n\n      for (const item of data.items) {\n        doc.font('Helvetica-Bold').fontSize(9.5).fillColor(dark).text(item.description, left, y, { width: contentW * 0.58 });\n        const descH = doc.heightOfString(item.description, { width: contentW * 0.58 });\n        if (item.details) {\n          doc.font('Helvetica').fontSize(8).fillColor(light).text(item.details, left, y + descH + 2, { width: contentW * 0.58 });\n        }\n        doc.font('Helvetica').fontSize(9.5).fillColor(dark);\n        const rowMid = y + 1;\n        doc.text(item.quantity.toString(), left + contentW * 0.62, rowMid, { width: 40 });\n        doc.text(formatCurrency(item.unitPrice, data.currency), left + contentW * 0.72, rowMid, { width: 60 });\n        doc.font('Helvetica-Bold').text(formatCurrency(item.total, data.currency), right - 60, rowMid, { width: 60, align: 'right' });\n\n        const rowH = item.details ? descH + 18 : Math.max(descH + 8, 22);\n        y += rowH;\n        doc.moveTo(left, y).lineTo(right, y).strokeColor(faint).lineWidth(0.5).stroke();\n        y += 6;\n      }\n\n      y += 12;\n      const totalLeft = left + contentW * 0.55;\n      const totalValW = right - totalLeft - 5;\n\n      doc.font('Helvetica').fontSize(9).fillColor(mid).text('Subtotal', totalLeft, y);\n      doc.font('Helvetica').fontSize(9).fillColor(dark).text(formatCurrency(data.subtotal, data.currency), right - 60, y, { width: 60, align: 'right' });\n      y += 16;\n\n      if (data.discount && data.discount.amount > 0) {\n        const discLabel = data.discount.code ? `Discount (${data.discount.code})` : 'Discount';\n        doc.font('Helvetica').fontSize(9).fillColor(mid).text(discLabel, totalLeft, y);\n        doc.font('Helvetica').fontSize(9).fillColor('#059669').text(`-${formatCurrency(data.discount.amount, data.currency)}`, right - 60, y, { width: 60, align: 'right' });\n        y += 16;\n      }\n\n      doc.moveTo(totalLeft, y).lineTo(right, y).strokeColor(black).lineWidth(1).stroke();\n      y += 10;\n      doc.font('Helvetica-Bold').fontSize(11).fillColor(black).text('TOTAL', totalLeft, y);\n      doc.font('Helvetica-Bold').fontSize(14).fillColor(black).text(formatCurrency(data.total, data.currency), right - 80, y - 2, { width: 80, align: 'right' });\n      y += 30;\n\n      doc.moveTo(left, y).lineTo(right, y).strokeColor(line).lineWidth(0.5).stroke();\n      y += 18;\n\n      const accounts = data.bankAccounts && data.bankAccounts.length > 0 ? data.bankAccounts : DEFAULT_BANK_ACCOUNTS;\n      doc.font('Helvetica-Bold').fontSize(8).fillColor(black).text('PAYMENT DETAILS', left, y);\n      y += 14;\n\n      for (const account of accounts) {\n        doc.font('Helvetica-Bold').fontSize(7.5).fillColor(dark).text(account.label.toUpperCase(), left, y);\n        y += 11;\n\n        const colW = contentW / 4;\n        const fields: [string, string][] = [];\n        fields.push(['Holder', account.holder]);\n        fields.push(['Bank', account.bankName]);\n        if (account.iban) fields.push(['IBAN', account.iban]);\n        if (account.accountNumber) fields.push(['Account', account.accountNumber]);\n        if (account.routingNumber) fields.push(['Routing', account.routingNumber]);\n        if (account.swift) fields.push(['SWIFT/BIC', account.swift]);\n\n        let fX = left;\n        let fRow = 0;\n        for (const [label, value] of fields) {\n          if (fX + colW > right + 10) { fX = left; fRow++; }\n          const fY = y + fRow * 18;\n          doc.font('Helvetica').fontSize(6.5).fillColor(light).text(label.toUpperCase(), fX, fY);\n          doc.font('Helvetica').fontSize(7.5).fillColor(dark).text(value, fX, fY + 8);\n          fX += colW;\n        }\n        y += (fRow + 1) * 18 + 6;\n        doc.moveTo(left, y).lineTo(right, y).strokeColor(faint).lineWidth(0.5).stroke();\n        y += 8;\n      }\n\n      if (data.status === 'pending' && data.paymentLink) {\n        y += 4;\n        doc.font('Helvetica-Bold').fontSize(8).fillColor(black).text('ONLINE PAYMENT', left, y);\n        y += 12;\n        doc.font('Helvetica').fontSize(8.5).fillColor(mid).text(data.paymentLink, left, y, { link: data.paymentLink, underline: true });\n        y += 16;\n      }\n\n      doc.moveTo(left, 790).lineTo(right, 790).strokeColor(line).lineWidth(0.5).stroke();\n      doc.font('Helvetica').fontSize(7).fillColor(light).text('Easy US LLC is a brand of Fortuny Consulting LLC. 1209 Mountain Road Place NE, STE R, Albuquerque, NM 87110, USA', left, 798, { align: 'center', width: contentW });\n\n      doc.end();\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n\nexport function generateCustomInvoicePdf(data: CustomInvoiceData): Promise<Buffer> {\n  return new Promise((resolve, reject) => {\n    try {\n      const doc = new PDFDocument({ size: 'A4', margin: 50, bufferPages: false,\n        info: { Title: `Factura ${data.invoiceNumber}`, Author: 'Easy US LLC' }\n      });\n      const chunks: Buffer[] = [];\n      doc.on('data', (chunk: Buffer) => chunks.push(chunk));\n      doc.on('end', () => resolve(Buffer.concat(chunks)));\n      doc.on('error', reject);\n\n      const pageW = 595;\n      const left = 50;\n      const right = pageW - 50;\n      const contentW = right - left;\n      const black = '#111111';\n      const dark = '#1A1A1A';\n      const mid = '#555555';\n      const light = '#999999';\n      const line = '#D4D4D4';\n\n      doc.rect(0, 0, 595, 842).fill('#FFFFFF');\n\n      const logoPath = getLogoPath();\n      if (logoPath) { try { doc.image(logoPath, left, 40, { width: 36, height: 36 }); } catch {} }\n\n      doc.font('Helvetica-Bold').fontSize(16).fillColor(black).text('Easy US LLC', left + 44, 44);\n      doc.font('Helvetica').fontSize(7.5).fillColor(light).text('Fortuny Consulting LLC', left + 44, 62);\n\n      doc.font('Helvetica').fontSize(9).fillColor(mid).text(`No. ${data.invoiceNumber}`, left, 80, { align: 'right', width: contentW });\n\n      doc.moveTo(left, 98).lineTo(right, 98).strokeColor(black).lineWidth(1.5).stroke();\n\n      let y = 118;\n\n      doc.font('Helvetica').fontSize(7).fillColor(light).text('FROM', left, y);\n      doc.font('Helvetica-Bold').fontSize(10).fillColor(black).text('Fortuny Consulting LLC', left, y + 12);\n      doc.font('Helvetica').fontSize(8.5).fillColor(mid);\n      doc.text('1209 Mountain Road Place NE, STE R', left, y + 26);\n      doc.text('Albuquerque, NM 87110, USA', left, y + 38);\n      doc.text('hola@easyusllc.com', left, y + 50);\n\n      const cX = 320;\n      doc.font('Helvetica').fontSize(7).fillColor(light).text('BILL TO', cX, y);\n      doc.font('Helvetica-Bold').fontSize(10).fillColor(black).text(data.customer.name, cX, y + 12);\n      doc.font('Helvetica').fontSize(8.5).fillColor(mid);\n      let cy = y + 26;\n      doc.text(data.customer.email, cX, cy); cy += 12;\n      if (data.customer.phone) { doc.text(data.customer.phone, cX, cy); cy += 12; }\n\n      y += 80;\n      doc.moveTo(left, y).lineTo(right, y).strokeColor(line).lineWidth(0.5).stroke();\n      y += 15;\n\n      doc.font('Helvetica').fontSize(7).fillColor(light);\n      doc.text('ISSUE DATE', left, y);\n      doc.text('STATUS', left + contentW * 0.4, y);\n      y += 11;\n      doc.font('Helvetica-Bold').fontSize(9.5).fillColor(black).text(formatDate(data.date), left, y);\n      const sColor = data.status === 'paid' ? '#059669' : '#D97706';\n      doc.fillColor(sColor).text(getStatusText(data.status), left + contentW * 0.4, y);\n\n      y += 22;\n      doc.moveTo(left, y).lineTo(right, y).strokeColor(line).lineWidth(0.5).stroke();\n      y += 20;\n\n      doc.font('Helvetica-Bold').fontSize(7.5).fillColor(light);\n      doc.text('CONCEPT', left, y);\n      doc.text('AMOUNT', right - 60, y, { width: 60, align: 'right' });\n      y += 14;\n      doc.moveTo(left, y).lineTo(right, y).strokeColor(black).lineWidth(0.8).stroke();\n      y += 10;\n\n      doc.font('Helvetica-Bold').fontSize(10).fillColor(dark).text(data.concept, left, y, { width: contentW * 0.7 });\n      const conceptH = doc.heightOfString(data.concept, { width: contentW * 0.7 });\n      if (data.description) {\n        doc.font('Helvetica').fontSize(8.5).fillColor(light).text(data.description, left, y + conceptH + 4, { width: contentW * 0.7 });\n      }\n      doc.font('Helvetica-Bold').fontSize(11).fillColor(dark).text(formatCurrency(data.amount, data.currency), right - 80, y + 2, { width: 80, align: 'right' });\n\n      y += (data.description ? conceptH + 30 : conceptH + 16);\n      doc.moveTo(left, y).lineTo(right, y).strokeColor('#F5F5F5').lineWidth(0.5).stroke();\n\n      y += 20;\n      const totalLeft = left + contentW * 0.55;\n      doc.moveTo(totalLeft, y).lineTo(right, y).strokeColor(black).lineWidth(1).stroke();\n      y += 10;\n      doc.font('Helvetica-Bold').fontSize(11).fillColor(black).text('TOTAL', totalLeft, y);\n      doc.font('Helvetica-Bold').fontSize(14).fillColor(black).text(formatCurrency(data.amount, data.currency), right - 80, y - 2, { width: 80, align: 'right' });\n      y += 30;\n\n      doc.moveTo(left, y).lineTo(right, y).strokeColor(line).lineWidth(0.5).stroke();\n      y += 18;\n\n      const customAccounts = data.bankAccounts && data.bankAccounts.length > 0 ? data.bankAccounts : DEFAULT_BANK_ACCOUNTS;\n      doc.font('Helvetica-Bold').fontSize(8).fillColor(black).text('PAYMENT DETAILS', left, y);\n      y += 14;\n\n      for (const account of customAccounts) {\n        doc.font('Helvetica-Bold').fontSize(7.5).fillColor(dark).text(account.label.toUpperCase(), left, y);\n        y += 11;\n        const colW = contentW / 4;\n        const fields: [string, string][] = [];\n        fields.push(['Holder', account.holder]);\n        fields.push(['Bank', account.bankName]);\n        if (account.iban) fields.push(['IBAN', account.iban]);\n        if (account.accountNumber) fields.push(['Account', account.accountNumber]);\n        if (account.routingNumber) fields.push(['Routing', account.routingNumber]);\n        if (account.swift) fields.push(['SWIFT/BIC', account.swift]);\n\n        let fX = left;\n        let fRow = 0;\n        for (const [label, value] of fields) {\n          if (fX + colW > right + 10) { fX = left; fRow++; }\n          const fY = y + fRow * 18;\n          doc.font('Helvetica').fontSize(6.5).fillColor(light).text(label.toUpperCase(), fX, fY);\n          doc.font('Helvetica').fontSize(7.5).fillColor(dark).text(value, fX, fY + 8);\n          fX += colW;\n        }\n        y += (fRow + 1) * 18 + 6;\n        doc.moveTo(left, y).lineTo(right, y).strokeColor('#F5F5F5').lineWidth(0.5).stroke();\n        y += 8;\n      }\n\n      if (data.notes) {\n        y += 8;\n        doc.font('Helvetica-Bold').fontSize(8).fillColor(black).text('NOTES', left, y);\n        y += 12;\n        doc.font('Helvetica').fontSize(8.5).fillColor(mid).text(data.notes, left, y, { width: contentW });\n      }\n\n      doc.moveTo(left, 790).lineTo(right, 790).strokeColor(line).lineWidth(0.5).stroke();\n      doc.font('Helvetica').fontSize(7).fillColor(light).text('Easy US LLC is a brand of Fortuny Consulting LLC. 1209 Mountain Road Place NE, STE R, Albuquerque, NM 87110, USA', left, 798, { align: 'center', width: contentW });\n\n      doc.end();\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n\nexport function generateOperatingAgreement(data: {\n  llc: {\n    companyName: string;\n    designator: string;\n    ein?: string | null;\n    state: string;\n    ownerFullName: string;\n    ownerEmail: string;\n    ownerPhone: string;\n    ownerIdNumber: string;\n    ownerIdType: string;\n    ownerAddress: string;\n    ownerCity: string;\n    ownerCountry: string;\n    ownerProvince: string;\n    ownerPostalCode: string;\n    llcCreatedDate: string | Date | null;\n  };\n  formData: {\n    memberAddress: string;\n    memberPhone: string;\n    capitalContribution: string;\n    effectiveDate: string;\n    orderId: string;\n  };\n}): Promise<Buffer> {\n  const doc = new PDFDocument({\n    size: 'A4',\n    margin: 40,\n    info: {\n      Title: `Operating Agreement - ${data.llc.companyName}`,\n      Author: 'Easy US LLC'\n    }\n  });\n\n  const chunks: Buffer[] = [];\n  doc.on('data', (chunk) => chunks.push(chunk));\n\n  return new Promise((resolve, reject) => {\n    doc.on('end', () => resolve(Buffer.concat(chunks)));\n    doc.on('error', reject);\n\n    const margin = 40;\n    const pageWidth = 595;\n    const pageHeight = 842;\n    const contentWidth = pageWidth - margin * 2;\n    const companyFullName = `${data.llc.companyName} ${data.llc.designator || 'LLC'}`;\n    \n    // Header & Footer helpers\n    const addHeader = (pageNum: number) => {\n      const logoPath = getLogoPath();\n      if (logoPath) { try { doc.image(logoPath, pageWidth - margin - 40, 30, { width: 40 }); } catch {} }\n      \n      doc.font('Helvetica').fontSize(7).fillColor(BRAND_GRAY);\n      doc.text(`Order: ${data.formData.orderId}`, margin, 35, { align: 'right', width: contentWidth });\n      doc.moveTo(margin, 75).lineTo(pageWidth - margin, 75).strokeColor('#E5E7EB').lineWidth(0.5).stroke();\n    };\n\n    const addFooter = (pageNum: number) => {\n      doc.moveTo(margin, pageHeight - 50).lineTo(pageWidth - margin, pageHeight - 50).strokeColor('#E5E7EB').lineWidth(0.5).stroke();\n      doc.font('Helvetica').fontSize(7).fillColor(BRAND_GRAY);\n      doc.text('www.easyusllc.com', margin, pageHeight - 40);\n      doc.text(`Page ${pageNum}`, margin, pageHeight - 40, { align: 'right', width: contentWidth });\n    };\n\n    let currentPage = 1;\n    addHeader(currentPage);\n\n    // Cover Page\n    doc.font('Helvetica-Bold').fontSize(24).fillColor(BRAND_DARK).text('OPERATING AGREEMENT', margin, 150, { align: 'center', width: contentWidth });\n    doc.font('Helvetica').fontSize(12).fillColor(BRAND_GRAY).text('OF', margin, 185, { align: 'center', width: contentWidth });\n    doc.font('Helvetica-Bold').fontSize(18).fillColor(BRAND_DARK).text(companyFullName, margin, 210, { align: 'center', width: contentWidth });\n    doc.font('Helvetica').fontSize(12).fillColor(BRAND_GRAY).text('A Limited Liability Company', margin, 240, { align: 'center', width: contentWidth });\n\n    // Table info box\n    doc.rect(margin, 300, contentWidth, 50).fill('#F9FAFB');\n    doc.font('Helvetica-Bold').fontSize(8).fillColor(BRAND_GRAY);\n    doc.text('STATE', margin + 20, 315);\n    doc.text('EIN', margin + contentWidth/3 + 20, 315);\n    doc.text('FORMED', margin + (contentWidth/3)*2 + 20, 315);\n    \n    doc.font('Helvetica-Bold').fontSize(11).fillColor(BRAND_DARK);\n    doc.text(data.llc.state, margin + 20, 330);\n    doc.text(data.llc.ein || 'PENDING', margin + contentWidth/3 + 20, 330);\n    \n    const formedDate = data.llc.llcCreatedDate ? \n      (typeof data.llc.llcCreatedDate === 'string' ? data.llc.llcCreatedDate : data.llc.llcCreatedDate.toLocaleDateString()) : 'N/A';\n    doc.text(formedDate, margin + (contentWidth/3)*2 + 20, 330);\n\n    addFooter(currentPage);\n\n    // Articles Page\n    doc.addPage();\n    currentPage++;\n    addHeader(currentPage);\n    \n    let y = 100;\n    const addSection = (num: number, title: string, content: string | string[]) => {\n      if (y > 700) {\n        addFooter(currentPage);\n        doc.addPage();\n        currentPage++;\n        addHeader(currentPage);\n        y = 100;\n      }\n      \n      doc.font('Helvetica-Bold').fontSize(10).fillColor(BRAND_DARK).text(`ARTICLE ${num} \u2014 ${title}`, margin, y);\n      y += 15;\n      \n      doc.font('Helvetica').fontSize(9).fillColor(BRAND_GRAY);\n      const contentArray = Array.isArray(content) ? content : [content];\n      for (const text of contentArray) {\n        const textHeight = doc.heightOfString(text, { width: contentWidth });\n        if (y + textHeight > 750) {\n          addFooter(currentPage);\n          doc.addPage();\n          currentPage++;\n          addHeader(currentPage);\n          y = 100;\n        }\n        doc.text(text, margin, y, { width: contentWidth, align: 'justify' });\n        y += textHeight + 8;\n      }\n      y += 10;\n    };\n\n    addSection(1, \"FORMATION AND EXISTENCE\", [\n      `1.1 Formation: This Operating Agreement (\"Agreement\") governs ${companyFullName}, a Limited Liability Company duly organized under the laws of the State of ${data.llc.state}, United States of America (the \"Company\").`,\n      \"1.2 Separate Legal Entity: The Company shall operate as a separate legal entity distinct from its Member, maintaining full liability protection as permitted by applicable law.\",\n      \"1.3 Duration: The Company shall exist perpetually unless dissolved pursuant to this Agreement or applicable law.\"\n    ]);\n\n    addSection(2, \"BUSINESS PURPOSE AND ACTIVITIES\", [\n      \"2.1 General Purpose: The Company is organized to conduct any lawful business activity permitted under applicable United States law.\",\n      \"2.2 Authorized Activities: Business consulting services, Software and digital service operations, E-commerce and online commercial activities, Asset holding and investment operations, International business development, Technology and intellectual property management.\",\n      \"2.3 Geographic Scope: The Company may operate within the United States and internationally.\"\n    ]);\n\n    addSection(3, \"PRINCIPAL PLACE OF BUSINESS\", `The principal office of the Company shall be: ${data.llc.ownerAddress}, ${data.llc.ownerCity}, ${data.llc.ownerCountry}. The Member may change the principal place of business at any time.`);\n\n    addSection(4, \"MEMBER AND OWNERSHIP\", [\n      \"The Company has one Member:\",\n      `Full Legal Name: ${data.llc.ownerFullName}`,\n      `Identification / Passport / ID: ${data.llc.ownerIdNumber}`,\n      `Residential Address: ${data.llc.ownerAddress}, ${data.llc.ownerCity}, ${data.llc.ownerCountry}`,\n      `Telephone: ${data.formData.memberPhone}`,\n      `Email: ${data.llc.ownerEmail}`,\n      `Employer Identification Number (EIN): ${data.llc.ein || 'PENDING'}`,\n      \"The Member owns 100% of the Membership Interest.\"\n    ]);\n\n    addSection(5, \"BENEFICIAL OWNERSHIP REPRESENTATION\", [\n      \"The Member certifies that:\",\n      \"1. The Member is the ultimate beneficial owner of the Company.\",\n      \"2. No undisclosed nominee, trustee, or third-party beneficial owner exists.\",\n      \"3. The Company is not controlled directly or indirectly by any sanctioned individual or restricted entity.\"\n    ]);\n\n    addSection(6, \"CAPITAL CONTRIBUTIONS\", [\n      `6.1 Initial Contributions: The Member may contribute capital in the form of: Cash, Intellectual Property, Services, Assets. Initial contribution value: $${data.formData.capitalContribution} USD.`,\n      \"6.2 Additional Contributions: Additional contributions shall be voluntary and solely determined by the Member.\"\n    ]);\n\n    addSection(7, \"MANAGEMENT STRUCTURE\", [\n      \"7.1 Member-Managed Company: The Company shall be managed exclusively by the Member.\",\n      \"7.2 Authority of the Member: The Member shall have unrestricted authority to: Execute contracts, Open and manage bank accounts, Conduct financial transactions, Hire employees and contractors, Acquire or dispose of Company assets, Represent the Company before regulatory authorities, Enter strategic partnerships.\",\n      \"7.3 Appointment of Officers: The Member may appoint officers, consultants, or advisors through written authorization.\"\n    ]);\n\n    addSection(8, \"BANKING AND FINANCIAL OPERATIONS\", [\n      \"8.1 Financial Accounts: The Company may maintain accounts with domestic or international financial institutions.\",\n      \"8.2 Financial Governance: The Company shall maintain strict separation between personal and Company assets.\",\n      \"8.3 Authorized Signatory: The Member shall serve as the primary authorized signatory unless delegated in writing.\"\n    ]);\n\n    addSection(9, \"ACCOUNTING AND CORPORATE RECORDS\", \"The Company shall maintain: Financial records, Tax filings, Ownership documentation, Commercial agreements, Corporate governance documentation. Records shall be retained in accordance with regulatory and legal standards.\");\n\n    addSection(10, \"PROFITS, LOSSES AND DISTRIBUTIONS\", \"All profits and losses shall be allocated solely to the Member. The Member may withdraw funds at their discretion provided that the Company remains solvent.\");\n\n    addSection(11, \"TAX CLASSIFICATION AND REPORTING\", [\n      \"11.1 Federal Tax Treatment: Unless otherwise elected, the Company shall be treated as a Disregarded Entity for federal tax purposes.\",\n      \"11.2 Reporting Obligations: The Company shall comply with applicable reporting requirements including, when required: IRS Form 5472, IRS Form 1120 informational return, FBAR reporting (if applicable), and International reporting requirements.\"\n    ]);\n\n    addSection(12, \"ANTI-MONEY LAUNDERING AND COMPLIANCE\", \"The Company shall operate in accordance with: Anti-Money Laundering laws, Counter Terrorism Financing regulations, Know Your Customer requirements, and Sanctions compliance standards.\");\n\n    addSection(13, \"ECONOMIC SUBSTANCE REPRESENTATION\", \"The Company operates for legitimate commercial purposes, maintains appropriate operational control, business decisions are directed by the Member, and the Company is not formed solely for tax evasion.\");\n\n    addSection(14, \"INTELLECTUAL PROPERTY OWNERSHIP\", \"All intellectual property developed or acquired by the Company shall be owned exclusively by the Company unless otherwise assigned in writing.\");\n\n    addSection(15, \"CONFIDENTIALITY\", \"The Member agrees to maintain confidentiality regarding: Client information, Financial data, Trade secrets, and Business strategies.\");\n\n    addSection(16, \"LIMITATION OF LIABILITY AND INDEMNIFICATION\", [\n      \"16.1 Limited Liability: The Member shall not be personally liable for Company obligations beyond capital contributions except as required by law.\",\n      \"16.2 Indemnification: The Company shall indemnify the Member against losses arising from lawful Company activities.\"\n    ]);\n\n    addSection(17, \"TRANSFER OF MEMBERSHIP INTEREST\", \"The Member may transfer ownership interest at their sole discretion through written documentation.\");\n\n    addSection(18, \"DISSOLUTION AND WINDING UP\", [\n      \"18.1 Voluntary Dissolution: The Company may be dissolved by decision of the Member.\",\n      \"18.2 Liquidation Process: Upon dissolution: 1. All liabilities shall be satisfied; 2. Remaining assets shall be distributed to the Member; 3. All legal filings shall be completed.\"\n    ]);\n\n    addSection(19, \"DISPUTE RESOLUTION\", \"Any dispute arising under this Agreement shall be resolved through binding arbitration in accordance with the rules of the American Arbitration Association.\");\n\n    addSection(20, \"FORCE MAJEURE\", \"The Company shall not be liable for delays caused by events beyond reasonable control including natural disasters or regulatory changes.\");\n\n    addSection(21, \"DIGITAL EXECUTION\", \"This Agreement may be executed electronically and shall be legally binding.\");\n\n    addSection(22, \"GOVERNING LAW\", `This Agreement shall be governed by the laws of the State of ${data.llc.state}.`);\n\n    addSection(23, \"ENTIRE AGREEMENT\", \"This Agreement constitutes the complete governing document of the Company.\");\n\n    addSection(24, \"ADMINISTRATIVE PREPARATION STATEMENT\", \"This Operating Agreement has been prepared administratively by: Easy US LLC. Easy US LLC does not assume ownership, management, fiduciary responsibility, or legal representation of the Company.\");\n\n    addSection(25, \"COMPLIANCE AND REGULATORY COMMITMENT\", \"The Company is committed to operating with transparency, integrity, and full respect for applicable laws and regulations. The Member confirms that the Company has been created to conduct legitimate commercial activities.\");\n\n    addSection(26, \"BANKING RELATIONSHIP REPRESENTATION\", \"The Company intends to establish and maintain banking service relationships. The Member acknowledges that account approval is solely at the discretion of financial institutions.\");\n\n    addSection(27, \"SOURCE OF FUNDS DECLARATION\", \"The Member confirms that funds used origin from legitimate sources including personal savings, business income, client payments, family support, or lawful investments.\");\n\n    addSection(28, \"RISK MANAGEMENT PRINCIPLES\", \"The Company recognizes that responsible risk management is essential. It shall maintain accurate bookkeeping and operational transparency.\");\n\n    addSection(29, \"CLIENT ACCEPTANCE AND BUSINESS ETHICS\", \"The Company may decline business relationships that present unreasonable risk. It commits to providing services in good faith.\");\n\n    addSection(30, \"DATA PROTECTION AND CONFIDENTIALITY\", \"The Company respects confidentiality and shall take measures to protect sensitive information and comply with data protection regulations.\");\n\n    addSection(31, \"COOPERATION WITH REVIEWS\", \"The Member understands that periodic reviews by financial institutions are standard practice and agrees to cooperate in good faith.\");\n\n    addSection(32, \"RESPONSIBLE BUSINESS USE\", \"The Company is intended exclusively for lawful activities. Misuse of infrastructure may result in service termination.\");\n\n    addSection(33, \"AUTOMATED DOCUMENT PREPARATION\", \"This Agreement may be generated through structured administrative preparation processes. Easy US LLC assists in preparation but does not provide legal advice.\");\n\n    // Final Signature Page\n    doc.addPage();\n    currentPage++;\n    addHeader(currentPage);\n    \n    doc.font('Helvetica-Bold').fontSize(14).fillColor(BRAND_DARK).text('OPERATING AGREEMENT MEMBER CERTIFICATION', margin, 150, { align: 'center', width: contentWidth });\n    doc.font('Helvetica').fontSize(10).text('I certify that I am the sole Member and agree to all provisions herein.', margin, 180);\n    \n    doc.moveTo(margin, 220).lineTo(margin + 200, 220).strokeColor(BRAND_DARK).stroke();\n    \n    doc.font('Helvetica-Bold').fontSize(9).text('Member Name:', margin, 240);\n    doc.font('Helvetica').text(data.llc.ownerFullName, margin + 80, 240);\n    \n    doc.font('Helvetica-Bold').text('Signature:', margin, 270);\n    doc.rect(margin + 80, 260, 200, 30).fill('#F3F4F6');\n    doc.font('Helvetica-Bold').fontSize(8).fillColor(BRAND_DARK).text('ELECTRONICALLY SIGNED', margin + 90, 275);\n    doc.font('Helvetica').fillColor(BRAND_GRAY).text(`By: ${data.llc.ownerFullName}`, margin + 90, 285);\n    \n    const now = new Date();\n    doc.font('Helvetica-Bold').fontSize(9).fillColor(BRAND_DARK).text('Date:', margin, 310);\n    doc.font('Helvetica').text(now.toLocaleString(), margin + 80, 310);\n    \n    addFooter(currentPage);\n    doc.end();\n  });\n}\n\nexport function generateOrderInvoice(orderData: {\n  order: { id: number; invoiceNumber?: string | null; amount: number; originalAmount?: number | null; discountCode?: string | null; discountAmount?: number | null; currency: string; status: string; createdAt?: Date | null; };\n  product: { name: string; description: string; features?: string[]; };\n  user: { firstName?: string | null; lastName?: string | null; email: string; phone?: string | null; idType?: string | null; idNumber?: string | null; streetType?: string | null; address?: string | null; city?: string | null; province?: string | null; postalCode?: string | null; country?: string | null; };\n  application?: { ownerFullName?: string | null; ownerEmail?: string | null; ownerPhone?: string | null; ownerIdType?: string | null; ownerIdNumber?: string | null; ownerStreetType?: string | null; ownerAddress?: string | null; ownerCity?: string | null; ownerProvince?: string | null; ownerPostalCode?: string | null; ownerCountry?: string | null; companyName?: string | null; designator?: string | null; state?: string | null; ein?: string | null; llcCreatedDate?: string | Date | null; registeredAgent?: string | null; } | null;\n  maintenanceApplication?: { requestCode?: string | null; companyName?: string | null; ein?: string | null; state?: string | null; } | null;\n  paymentLink?: string;\n  isMaintenance?: boolean;\n  bankAccounts?: BankAccountInfo[];\n}): Promise<Buffer> {\n  const invoiceData: InvoiceData = {\n    orderNumber: orderData.order.invoiceNumber || orderData.order.id.toString(),\n    date: (orderData.order.createdAt || new Date()).toISOString(),\n    customer: {\n      name: `${orderData.user.firstName || ''} ${orderData.user.lastName || ''}`.trim() || 'Cliente',\n      email: orderData.user.email,\n      phone: orderData.user.phone || undefined,\n      idType: orderData.user.idType || undefined,\n      idNumber: orderData.user.idNumber || undefined,\n      address: orderData.user.address || undefined,\n      streetType: orderData.user.streetType || undefined,\n      city: orderData.user.city || undefined,\n      province: orderData.user.province || undefined,\n      postalCode: orderData.user.postalCode || undefined,\n      country: orderData.user.country || undefined,\n    },\n    items: [{\n      description: orderData.product.name,\n      details: orderData.product.description,\n      quantity: 1,\n      unitPrice: orderData.order.originalAmount || orderData.order.amount,\n      total: orderData.order.originalAmount || orderData.order.amount,\n    }],\n    subtotal: orderData.order.originalAmount || orderData.order.amount,\n    discount: orderData.order.discountAmount ? {\n      code: orderData.order.discountCode || undefined,\n      amount: orderData.order.discountAmount,\n    } : undefined,\n    total: orderData.order.amount,\n    currency: orderData.order.currency,\n    status: orderData.order.status as any,\n    isMaintenance: orderData.isMaintenance,\n    bankAccounts: orderData.bankAccounts,\n  };\n  return generateInvoicePdf(invoiceData);\n}\n", "import type { Express } from \"express\";\nimport { z } from \"zod\";\nimport { eq, and, gt, sql } from \"drizzle-orm\";\nimport { db, storage, isAuthenticated, isAdmin, logAudit } from \"./shared\";\nimport { api } from \"@shared/routes\";\nimport { insertLlcApplicationSchema, insertApplicationDocumentSchema, contactOtps, users as usersTable, orders as ordersTable, llcApplications as llcApplicationsTable, applicationDocuments as applicationDocumentsTable, discountCodes, userNotifications, messages as messagesTable } from \"@shared/schema\";\nimport { sendEmail, getWelcomeEmailTemplate, getConfirmationEmailTemplate, getAdminLLCOrderTemplate } from \"../lib/email\";\nimport { EmailLanguage, getWelcomeEmailSubject } from \"../lib/email-translations\";\n\nexport function registerLlcRoutes(app: Express) {\n  // Claim order endpoint - creates account and associates with existing order\n  app.post(\"/api/llc/claim-order\", async (req: any, res) => {\n    try {\n      const { applicationId, email, password, ownerFullName, paymentMethod, discountCode, discountAmount } = req.body;\n      \n      if (!applicationId || !email || !password) {\n        return res.status(400).json({ message: \"Email and password are required.\" });\n      }\n      \n      if (password.length < 8) {\n        return res.status(400).json({ message: \"Password must be at least 8 characters.\" });\n      }\n      \n      // Check if email already exists\n      const [existingUser] = await db.select().from(usersTable).where(eq(usersTable.email, email)).limit(1);\n      if (existingUser) {\n        // Check if account is deactivated\n        if (existingUser.isActive === false || existingUser.accountStatus === 'deactivated') {\n          return res.status(403).json({ \n            message: \"Your account has been deactivated. Contact our support team for more information.\",\n            code: \"ACCOUNT_DEACTIVATED\"\n          });\n        }\n        return res.status(400).json({ message: \"This email is already registered. Please log in.\" });\n      }\n      \n      // Verify that email has been verified via OTP\n      const [otpRecord] = await db.select()\n        .from(contactOtps)\n        .where(\n          and(\n            eq(contactOtps.email, email),\n            eq(contactOtps.otpType, \"account_verification\"),\n            eq(contactOtps.verified, true),\n            gt(contactOtps.expiresAt, new Date(Date.now() - 30 * 60 * 1000))\n          )\n        )\n        .orderBy(sql`${contactOtps.expiresAt} DESC`)\n        .limit(1);\n      \n      if (!otpRecord) {\n        return res.status(400).json({ message: \"Please verify your email before continuing.\" });\n      }\n      \n      // Get the application to find the order\n      const application = await storage.getLlcApplication(applicationId);\n      if (!application) {\n        return res.status(404).json({ message: \"Request not found.\" });\n      }\n      \n      // Create new user with verified email and copy address fields from application\n      const { hashPassword } = await import(\"../lib/auth-service\");\n      const { generateUniqueClientId } = await import(\"../lib/id-generator\");\n      const passwordHash = await hashPassword(password);\n      const clientId = await generateUniqueClientId();\n      const nameParts = ownerFullName?.split(' ') || ['Cliente'];\n      \n      const [newUser] = await db.insert(usersTable).values({\n        email,\n        passwordHash,\n        clientId,\n        firstName: nameParts[0] || 'Cliente',\n        lastName: nameParts.slice(1).join(' ') || '',\n        phone: application.ownerPhone || null,\n        streetType: application.ownerStreetType || null,\n        address: application.ownerAddress || null,\n        city: application.ownerCity || null,\n        province: application.ownerProvince || null,\n        postalCode: application.ownerPostalCode || null,\n        country: application.ownerCountry || null,\n        birthDate: application.ownerBirthDate || null,\n        businessActivity: application.businessActivity || null,\n        emailVerified: true,\n        accountStatus: 'active',\n      }).returning();\n      \n      // Update the order to associate with the new user and apply discount\n      const orderUpdate: any = { userId: newUser.id };\n      if (discountCode && discountAmount) {\n        orderUpdate.discountCode = discountCode;\n        orderUpdate.discountAmount = discountAmount;\n        // Increment discount code usage\n        await db.update(discountCodes)\n          .set({ usedCount: sql`${discountCodes.usedCount} + 1` })\n          .where(eq(discountCodes.code, discountCode));\n      }\n      await db.update(ordersTable)\n        .set(orderUpdate)\n        .where(eq(ordersTable.id, application.orderId));\n      \n      // Update LLC application with paymentMethod if provided\n      if (paymentMethod) {\n        await storage.updateLlcApplication(applicationId, { paymentMethod });\n      }\n      \n      // Set session for the new user\n      req.session.userId = newUser.id;\n      \n      const llcLang = (req.body.preferredLanguage || 'es') as EmailLanguage;\n      sendEmail({\n        to: email,\n        subject: getWelcomeEmailSubject(llcLang),\n        html: getWelcomeEmailTemplate(nameParts[0] || undefined, llcLang)\n      }).catch(console.error);\n      \n      res.json({ success: true, userId: newUser.id });\n    } catch (error) {\n      console.error(\"Error claiming order:\", error);\n      res.status(500).json({ message: \"Error creating account.\" });\n    }\n  });\n\n  // Client Update LLC Application Data\n  app.patch(\"/api/llc/:id/data\", isAuthenticated, async (req: any, res) => {\n    try {\n      const appId = Number(req.params.id);\n      const updates = req.body;\n      \n      // Security: Check if EIN has been assigned - if so, data is locked\n      const [existingApp] = await db.select({ ein: llcApplicationsTable.ein, orderId: llcApplicationsTable.orderId })\n        .from(llcApplicationsTable)\n        .where(eq(llcApplicationsTable.id, appId))\n        .limit(1);\n      \n      if (!existingApp) {\n        return res.status(404).json({ message: \"Application not found\" });\n      }\n      \n      // If EIN is assigned, only admin can modify\n      if (existingApp.ein && !req.session.isAdmin) {\n        return res.status(403).json({ message: \"Data cannot be modified after EIN assignment. Contact support.\" });\n      }\n      \n      // Verify ownership for non-admin users\n      if (existingApp.orderId && !req.session.isAdmin) {\n        const [order] = await db.select().from(ordersTable).where(eq(ordersTable.id, existingApp.orderId)).limit(1);\n        if (order && order.userId !== req.session.userId) {\n          return res.status(403).json({ message: \"Access denied\" });\n        }\n      }\n      \n      const [updated] = await db.update(llcApplicationsTable)\n        .set({ ...updates, lastUpdated: new Date() })\n        .where(eq(llcApplicationsTable.id, appId))\n        .returning();\n      res.json(updated);\n    } catch (error) {\n      res.status(500).json({ message: \"Error updating application\" });\n    }\n  });\n  app.get(api.llc.get.path, async (req: any, res) => {\n    const appId = Number(req.params.id);\n    \n    const application = await storage.getLlcApplication(appId);\n    if (!application) {\n      return res.status(404).json({ message: \"Application not found\" });\n    }\n\n    // Security: Verify user owns this application or is admin\n    if (!req.session.userId && !req.session.isAdmin) {\n      return res.status(401).json({ message: \"Unauthorized\" });\n    }\n    \n    // Get order to check ownership\n    if (application.orderId) {\n      const [order] = await db.select().from(ordersTable).where(eq(ordersTable.id, application.orderId)).limit(1);\n      if (order && order.userId !== req.session.userId && !req.session.isAdmin) {\n        return res.status(403).json({ message: \"Access denied\" });\n      }\n    }\n\n    res.json(application);\n  });\n\n  app.put(api.llc.update.path, async (req: any, res) => {\n    try {\n      const appId = Number(req.params.id);\n      const updates = api.llc.update.input.parse(req.body);\n\n      const application = await storage.getLlcApplication(appId);\n      if (!application) {\n        return res.status(404).json({ message: \"Application not found\" });\n      }\n\n      // Security: Verify ownership for non-admin users\n      if (application.orderId && !req.session.isAdmin) {\n        const [order] = await db.select().from(ordersTable).where(eq(ordersTable.id, application.orderId)).limit(1);\n        if (order && order.userId && order.userId !== req.session.userId) {\n          return res.status(403).json({ message: \"Access denied\" });\n        }\n      }\n\n      const updatedApp = await storage.updateLlcApplication(appId, updates);\n      \n      // If status is being updated to \"submitted\", send confirmation email\n      if (updates.status === \"submitted\" && updatedApp.ownerEmail) {\n        const orderIdentifier = updatedApp.requestCode || `#${updatedApp.id}`;\n        \n        // Get order info for price\n        const [order] = await db.select().from(ordersTable).where(eq(ordersTable.id, updatedApp.orderId)).limit(1);\n        const orderAmount = order ? (order.amount / 100).toFixed(2) : 'N/A';\n        \n        // Email notification to admin about completed order\n        const adminEmail = process.env.ADMIN_EMAIL || \"afortuny07@gmail.com\";\n        const paymentMethodLabel = updatedApp.paymentMethod === 'transfer' ? 'Transferencia Bancaria' : updatedApp.paymentMethod === 'link' ? 'Link de Pago' : 'No especificado';\n        \n        sendEmail({\n          to: adminEmail,\n          subject: `[PEDIDO REALIZADO] ${orderIdentifier} - ${updatedApp.companyName}`,\n          html: getAdminLLCOrderTemplate({\n            orderIdentifier,\n            amount: orderAmount,\n            paymentMethod: paymentMethodLabel,\n            ownerFullName: updatedApp.ownerFullName || undefined,\n            ownerEmail: updatedApp.ownerEmail || undefined,\n            ownerPhone: updatedApp.ownerPhone || undefined,\n            ownerBirthDate: updatedApp.ownerBirthDate || undefined,\n            ownerIdType: updatedApp.ownerIdType || undefined,\n            ownerIdNumber: updatedApp.ownerIdNumber || undefined,\n            ownerAddress: `${updatedApp.ownerStreetType || ''} ${updatedApp.ownerAddress || ''}`.trim() || undefined,\n            ownerCity: updatedApp.ownerCity || undefined,\n            ownerProvince: updatedApp.ownerProvince || undefined,\n            ownerPostalCode: updatedApp.ownerPostalCode || undefined,\n            ownerCountry: updatedApp.ownerCountry || undefined,\n            companyName: updatedApp.companyName || undefined,\n            companyNameOption2: updatedApp.companyNameOption2 || undefined,\n            designator: updatedApp.designator || undefined,\n            state: updatedApp.state || undefined,\n            businessCategory: updatedApp.businessCategory === \"Otra (especificar)\" ? (updatedApp.businessCategoryOther || undefined) : (updatedApp.businessCategory || undefined),\n            businessActivity: updatedApp.businessActivity || undefined,\n            companyDescription: updatedApp.companyDescription || undefined,\n            isSellingOnline: updatedApp.isSellingOnline || undefined,\n            needsBankAccount: updatedApp.needsBankAccount || undefined,\n            willUseStripe: updatedApp.willUseStripe || undefined,\n            wantsBoiReport: updatedApp.wantsBoiReport || undefined,\n            wantsMaintenancePack: updatedApp.wantsMaintenancePack || undefined,\n            notes: updatedApp.notes || undefined\n          })\n        }).catch(() => {});\n\n        // Confirmation to client with full info\n        sendEmail({\n          to: updatedApp.ownerEmail,\n          subject: `Solicitud recibida - Referencia ${orderIdentifier}`,\n          html: getConfirmationEmailTemplate(updatedApp.ownerFullName || \"Cliente\", orderIdentifier, { companyName: updatedApp.companyName || undefined }),\n        }).catch(() => {});\n    }\n\n    res.json(updatedApp);\n  } catch (err) {\n    if (err instanceof z.ZodError) {\n      return res.status(400).json({ message: err.errors[0].message });\n    }\n    console.error(\"Error updating LLC application:\", err);\n    res.status(500).json({ message: \"Error updating request\" });\n  }\n});\n\n  // Lookup by request code - requires authentication\n  app.get(api.llc.getByCode.path, async (req: any, res) => {\n    const code = req.params.code;\n    \n    const application = await storage.getLlcApplicationByRequestCode(code);\n    if (!application) {\n      return res.status(404).json({ message: \"Request not found. Verify the code entered.\" });\n    }\n\n    // Security: Only allow owner or admin to view\n    if (application.orderId) {\n      const [order] = await db.select().from(ordersTable).where(eq(ordersTable.id, application.orderId)).limit(1);\n      if (order && order.userId && req.session.userId !== order.userId && !req.session.isAdmin) {\n        return res.status(403).json({ message: \"Access denied\" });\n      }\n    }\n\n    res.json(application);\n  });\n\n  // Documents - requires authentication\n  app.post(api.documents.create.path, isAuthenticated, async (req: any, res) => {\n    try {\n      const docData = api.documents.create.input.parse(req.body);\n      \n      if (docData.applicationId) {\n        const application = await storage.getLlcApplication(docData.applicationId);\n        if (!application) {\n          return res.status(404).json({ message: \"Application not found\" });\n        }\n        \n        // Security: Verify ownership\n        if (application.orderId && !req.session.isAdmin) {\n          const [order] = await db.select().from(ordersTable).where(eq(ordersTable.id, application.orderId)).limit(1);\n          if (order && order.userId && order.userId !== req.session.userId) {\n            return res.status(403).json({ message: \"Access denied\" });\n          }\n        }\n      }\n\n      const document = await storage.createDocument(docData);\n      res.status(201).json(document);\n    } catch (err) {\n      if (err instanceof z.ZodError) {\n        return res.status(400).json({ message: err.errors[0].message });\n      }\n      throw err;\n    }\n  });\n\n  // Client document upload endpoint\n  const MAX_FILE_SIZE_MB = 5;\n  const MAX_FILE_SIZE_BYTES = MAX_FILE_SIZE_MB * 1024 * 1024;\n  \n  app.post(\"/api/user/documents/upload\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.session.userId;\n      if (!userId) {\n        return res.status(401).json({ message: \"Not authorized\" });\n      }\n\n      // Get user's orders to attach document (if any)\n      const userOrders = await storage.getOrders(userId);\n      \n      // Also check if user has pending document requests (action_required notifications)\n      const pendingRequests = await db.select().from(userNotifications)\n        .where(and(\n          eq(userNotifications.userId, userId),\n          eq(userNotifications.type, 'action_required'),\n          eq(userNotifications.isRead, false)\n        ));\n      \n      // Allow upload if user has orders OR pending document requests\n      const hasOrdersOrRequests = userOrders.length > 0 || pendingRequests.length > 0;\n\n      // Use busboy for file handling with size limit\n      const busboy = (await import('busboy')).default;\n      const bb = busboy({ \n        headers: req.headers,\n        limits: { fileSize: MAX_FILE_SIZE_BYTES }\n      });\n      \n      let fileName = '';\n      let fileBuffer: Buffer | null = null;\n      let fileTruncated = false;\n      let documentType = 'passport';\n      let notes = '';\n      \n      bb.on('field', (name: string, val: string) => {\n        if (name === 'documentType') documentType = val;\n        if (name === 'notes') notes = val;\n      });\n      \n      // Allowed file extensions and MIME types for security\n      const ALLOWED_EXTENSIONS = ['pdf', 'jpg', 'jpeg', 'png'];\n      const ALLOWED_MIMES = ['application/pdf', 'image/jpeg', 'image/png'];\n      let detectedMime = '';\n      \n      bb.on('file', (name: string, file: any, info: any) => {\n        fileName = info.filename || `documento_${Date.now()}`;\n        detectedMime = info.mimeType || '';\n        const chunks: Buffer[] = [];\n        file.on('data', (data: Buffer) => chunks.push(data));\n        file.on('limit', () => { fileTruncated = true; });\n        file.on('end', () => { fileBuffer = Buffer.concat(chunks); });\n      });\n\n      bb.on('finish', async () => {\n        if (fileTruncated) {\n          return res.status(413).json({ message: `File exceeds the ${MAX_FILE_SIZE_MB}MB size limit` });\n        }\n        \n        if (!fileBuffer) {\n          return res.status(400).json({ message: \"No file received\" });\n        }\n        \n        // Validate file extension\n        const ext = fileName.toLowerCase().split('.').pop() || '';\n        if (!ALLOWED_EXTENSIONS.includes(ext)) {\n          return res.status(400).json({ message: \"File type not allowed. Only accepted: PDF, JPG, JPEG, PNG\" });\n        }\n        \n        // Validate MIME type\n        if (!ALLOWED_MIMES.includes(detectedMime)) {\n          return res.status(400).json({ message: \"Invalid file format\" });\n        }\n\n        // Save file (in production, use cloud storage)\n        const fs = await import('fs/promises');\n        const path = await import('path');\n        const uploadDir = path.join(process.cwd(), 'uploads', 'client-docs');\n        await fs.mkdir(uploadDir, { recursive: true });\n        \n        const safeFileName = `${userId}_${Date.now()}_${fileName.replace(/[^a-zA-Z0-9.-]/g, '_')}`;\n        const filePath = path.join(uploadDir, safeFileName);\n        await fs.writeFile(filePath, fileBuffer);\n        \n        // Generate ticket ID for this document upload (8-digit format)\n        const { generateUniqueMessageId } = await import(\"../lib/id-generator\");\n        const ticketId = await generateUniqueMessageId();\n        \n        const docTypeLabelsUpload: Record<string, Record<string, string>> = {\n          'passport': { es: 'Pasaporte / Documento de Identidad', en: 'Passport / ID Document', ca: 'Passaport / Document d\\'Identitat', fr: 'Passeport / Pi\u00E8ce d\\'identit\u00E9', de: 'Reisepass / Ausweis', it: 'Passaporto / Documento d\\'identit\u00E0', pt: 'Passaporte / Documento de Identidade' },\n          'address_proof': { es: 'Comprobante de Domicilio', en: 'Proof of Address', ca: 'Comprovant de Domicili', fr: 'Justificatif de domicile', de: 'Adressnachweis', it: 'Prova di indirizzo', pt: 'Comprovante de Endere\u00E7o' },\n          'tax_id': { es: 'Identificaci\u00F3n Fiscal', en: 'Tax ID', ca: 'Identificaci\u00F3 Fiscal', fr: 'Identification fiscale', de: 'Steuer-ID', it: 'Codice fiscale', pt: 'Identifica\u00E7\u00E3o Fiscal' },\n          'other': { es: 'Otro Documento', en: 'Other Document', ca: 'Altre Document', fr: 'Autre document', de: 'Anderes Dokument', it: 'Altro documento', pt: 'Outro Documento' }\n        };\n        const userForLang = await db.select({ preferredLanguage: usersTable.preferredLanguage }).from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n        const userLang = (userForLang[0]?.preferredLanguage as string) || 'es';\n        const docTypeLabel = docTypeLabelsUpload[documentType]?.[userLang] || docTypeLabelsUpload[documentType]?.es || documentType;\n        \n        // Determine orderId - from orders or from pending request\n        let targetOrderId: number | null = null;\n        if (userOrders.length > 0) {\n          targetOrderId = userOrders[0].id;\n        } else if (pendingRequests.length > 0 && pendingRequests[0].orderId) {\n          targetOrderId = pendingRequests[0].orderId;\n        }\n        \n        // Determine file type from extension (ext already validated above)\n        const mimeTypesMap: Record<string, string> = {\n          'pdf': 'application/pdf',\n          'jpg': 'image/jpeg',\n          'jpeg': 'image/jpeg',\n          'png': 'image/png'\n        };\n        const fileExt = fileName.toLowerCase().split('.').pop() || '';\n        const detectedFileType = mimeTypesMap[fileExt] || 'application/octet-stream';\n        \n        // Create document record\n        const doc = await db.insert(applicationDocumentsTable).values({\n          orderId: targetOrderId,\n          fileName: fileName,\n          fileType: detectedFileType,\n          fileUrl: `/uploads/client-docs/${safeFileName}`,\n          documentType: documentType,\n          reviewStatus: 'pending',\n          uploadedBy: userId\n        }).returning();\n\n        // Get user data for admin notification\n        const userData = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n        const user = userData[0];\n        \n        if (user) {\n          const { encrypt } = await import(\"../utils/encryption\");\n          \n          const docSubjects: Record<string, string> = {\n            es: `Documento Recibido: ${docTypeLabel}`,\n            en: `Document Received: ${docTypeLabel}`,\n            ca: `Document Rebut: ${docTypeLabel}`,\n            fr: `Document Re\u00E7u: ${docTypeLabel}`,\n            de: `Dokument Erhalten: ${docTypeLabel}`,\n            it: `Documento Ricevuto: ${docTypeLabel}`,\n            pt: `Documento Recebido: ${docTypeLabel}`\n          };\n          const docMessages: Record<string, (type: string, notes: string) => string> = {\n            es: (type, n) => `Tu documento ha sido recibido correctamente.\\n\\nTipo: ${type}${n}\\n\\nNuestro equipo lo revisar\u00E1 pronto. Recibir\u00E1s una notificaci\u00F3n cuando sea procesado.`,\n            en: (type, n) => `Your document has been received successfully.\\n\\nType: ${type}${n}\\n\\nOur team will review it shortly. You will receive a notification when it is processed.`,\n            ca: (type, n) => `El teu document ha estat rebut correctament.\\n\\nTipus: ${type}${n}\\n\\nEl nostre equip el revisar\u00E0 aviat. Rebr\u00E0s una notificaci\u00F3 quan sigui processat.`,\n            fr: (type, n) => `Votre document a \u00E9t\u00E9 re\u00E7u avec succ\u00E8s.\\n\\nType: ${type}${n}\\n\\nNotre \u00E9quipe l'examinera bient\u00F4t. Vous recevrez une notification lorsqu'il sera trait\u00E9.`,\n            de: (type, n) => `Ihr Dokument wurde erfolgreich empfangen.\\n\\nTyp: ${type}${n}\\n\\nUnser Team wird es in K\u00FCrze pr\u00FCfen. Sie erhalten eine Benachrichtigung, wenn es bearbeitet wird.`,\n            it: (type, n) => `Il tuo documento \u00E8 stato ricevuto correttamente.\\n\\nTipo: ${type}${n}\\n\\nIl nostro team lo esaminer\u00E0 a breve. Riceverai una notifica quando sar\u00E0 elaborato.`,\n            pt: (type, n) => `O seu documento foi recebido com sucesso.\\n\\nTipo: ${type}${n}\\n\\nA nossa equipa ir\u00E1 rev\u00EA-lo em breve. Receber\u00E1 uma notifica\u00E7\u00E3o quando for processado.`\n          };\n          const notesLabels: Record<string, string> = { es: 'Notas', en: 'Notes', ca: 'Notes', fr: 'Notes', de: 'Notizen', it: 'Note', pt: 'Notas' };\n          const notesText = documentType === 'other' && notes ? `\\n${notesLabels[userLang] || 'Notas'}: ${notes}` : '';\n          const userVisibleContent = (docMessages[userLang] || docMessages.es)(docTypeLabel, notesText);\n          const adminInternalContent = `[ADMIN] Archivo: ${fileName} | Ruta: ${doc[0].fileUrl}`;\n          const clientLabels: Record<string, string> = { es: 'Cliente', en: 'Client', ca: 'Client', fr: 'Client', de: 'Kunde', it: 'Cliente', pt: 'Cliente' };\n          \n          await db.insert(messagesTable).values({\n            userId,\n            name: `${user.firstName || ''} ${user.lastName || ''}`.trim() || clientLabels[userLang] || 'Cliente',\n            email: user.email || 'sin-email@cliente.com',\n            subject: docSubjects[userLang] || docSubjects.es,\n            content: userVisibleContent,\n            encryptedContent: encrypt(adminInternalContent),\n            type: 'support',\n            status: 'unread',\n            messageId: ticketId\n          });\n        }\n        \n        // Mark pending document requests as read after upload\n        if (pendingRequests.length > 0) {\n          await db.update(userNotifications)\n            .set({ isRead: true })\n            .where(and(\n              eq(userNotifications.userId, userId),\n              eq(userNotifications.type, 'action_required')\n            ));\n        }\n\n        const safeDoc = { id: doc[0].id, documentType: doc[0].documentType, reviewStatus: doc[0].reviewStatus, uploadedAt: doc[0].uploadedAt };\n        res.json({ success: true, document: safeDoc, ticketId });\n      });\n\n      req.pipe(bb);\n    } catch (error: any) {\n      console.error(\"Client upload error:\", error);\n      res.status(500).json({ message: \"Error uploading document\" });\n    }\n  });\n\n  // Payment simulation endpoint for LLC\n  // PROTECTED: Only admin can manually mark orders as paid\n  app.post(\"/api/llc/:id/pay\", isAdmin, async (req: any, res) => {\n    try {\n      const appId = parseInt(req.params.id);\n      const application = await storage.getLlcApplication(appId);\n      if (!application) {\n        return res.status(404).json({ message: \"Application not found\" });\n      }\n      \n      // Update order status to paid\n      if (application.orderId) {\n        await storage.updateOrderStatus(application.orderId, \"paid\");\n        logAudit({\n          action: 'payment_received',\n          userId: req.session.userId,\n          targetId: application.orderId.toString(),\n          details: { applicationId: appId, markedBy: 'admin' }\n        });\n      }\n      \n      // Update application status to submitted\n      await storage.updateLlcApplication(appId, { status: \"submitted\", paymentStatus: \"paid\" });\n      \n      res.json({ success: true, message: \"Payment successful\" });\n    } catch (error) {\n      console.error(\"Payment error:\", error);\n      res.status(500).json({ message: \"Payment processing failed\" });\n    }\n  });\n}\n", "import type { Express } from \"express\";\nimport { eq, and, gt, sql } from \"drizzle-orm\";\nimport { db, storage, isAuthenticated, logAudit, getClientIp, logActivity, isIpBlockedFromOrders, trackOrderByIp, detectSuspiciousOrderActivity, flagAccountForReview } from \"./shared\";\nimport { contactOtps, users as usersTable, orders as ordersTable, maintenanceApplications, discountCodes, userNotifications } from \"@shared/schema\";\nimport { sendEmail, getWelcomeEmailTemplate, getConfirmationEmailTemplate, getAdminMaintenanceOrderTemplate, getAccountPendingVerificationTemplate } from \"../lib/email\";\nimport { EmailLanguage, getVerifyEmailSubject, getWelcomeEmailSubject } from \"../lib/email-translations\";\n\nexport function registerMaintenanceRoutes(app: Express) {\n  // Claim maintenance order endpoint\n  app.post(\"/api/maintenance/claim-order\", async (req: any, res) => {\n    try {\n      const { applicationId, email, password, ownerFullName, paymentMethod, discountCode, discountAmount } = req.body;\n      \n      if (!applicationId || !email || !password) {\n        return res.status(400).json({ message: \"Email and password are required.\" });\n      }\n      \n      if (password.length < 8) {\n        return res.status(400).json({ message: \"Password must be at least 8 characters.\" });\n      }\n      \n      // Check if email already exists\n      const [existingUser] = await db.select().from(usersTable).where(eq(usersTable.email, email)).limit(1);\n      if (existingUser) {\n        // Check if account is deactivated\n        if (existingUser.isActive === false || existingUser.accountStatus === 'deactivated') {\n          return res.status(403).json({ \n            message: \"Your account has been deactivated. Contact our support team for more information.\",\n            code: \"ACCOUNT_DEACTIVATED\"\n          });\n        }\n        return res.status(400).json({ message: \"This email is already registered. Please log in.\" });\n      }\n      \n      // Verify that email has been verified via OTP\n      const [otpRecord] = await db.select()\n        .from(contactOtps)\n        .where(\n          and(\n            eq(contactOtps.email, email),\n            eq(contactOtps.otpType, \"account_verification\"),\n            eq(contactOtps.verified, true),\n            gt(contactOtps.expiresAt, new Date(Date.now() - 30 * 60 * 1000))\n          )\n        )\n        .orderBy(sql`${contactOtps.expiresAt} DESC`)\n        .limit(1);\n      \n      if (!otpRecord) {\n        return res.status(400).json({ message: \"Please verify your email before continuing.\" });\n      }\n      \n      // Get the maintenance application to find the order\n      const [application] = await db.select().from(maintenanceApplications).where(eq(maintenanceApplications.id, applicationId)).limit(1);\n      if (!application) {\n        return res.status(404).json({ message: \"Request not found.\" });\n      }\n      \n      // Create new user with verified email\n      const { hashPassword } = await import(\"../lib/auth-service\");\n      const { generateUniqueClientId } = await import(\"../lib/id-generator\");\n      const passwordHash = await hashPassword(password);\n      const clientId = await generateUniqueClientId();\n      const nameParts = ownerFullName?.split(' ') || ['Cliente'];\n      \n      const [newUser] = await db.insert(usersTable).values({\n        email,\n        passwordHash,\n        clientId,\n        firstName: nameParts[0] || 'Cliente',\n        lastName: nameParts.slice(1).join(' ') || '',\n        emailVerified: true,\n        accountStatus: 'active',\n      }).returning();\n      \n      // Update the order to associate with the new user and apply discount\n      const orderUpdate: any = { userId: newUser.id };\n      if (discountCode && discountAmount) {\n        orderUpdate.discountCode = discountCode;\n        orderUpdate.discountAmount = discountAmount;\n        // Increment discount code usage\n        await db.update(discountCodes)\n          .set({ usedCount: sql`${discountCodes.usedCount} + 1` })\n          .where(eq(discountCodes.code, discountCode));\n      }\n      await db.update(ordersTable)\n        .set(orderUpdate)\n        .where(eq(ordersTable.id, application.orderId));\n      \n      // Update maintenance application with paymentMethod if provided\n      if (paymentMethod) {\n        await db.update(maintenanceApplications)\n          .set({ paymentMethod })\n          .where(eq(maintenanceApplications.id, applicationId));\n      }\n      \n      // Set session for the new user\n      req.session.userId = newUser.id;\n      \n      const claimLang = (req.body.preferredLanguage || 'es') as EmailLanguage;\n      sendEmail({\n        to: email,\n        subject: getWelcomeEmailSubject(claimLang),\n        html: getWelcomeEmailTemplate(nameParts[0] || undefined, claimLang)\n      }).catch(console.error);\n      \n      res.json({ success: true, userId: newUser.id });\n    } catch (error) {\n      console.error(\"Error claiming maintenance order:\", error);\n      res.status(500).json({ message: \"Error creating account.\" });\n    }\n  });\n\n  app.post(\"/api/maintenance/orders\", async (req: any, res) => {\n    try {\n      const { productId, state, email, password, ownerFullName, paymentMethod, discountCode, discountAmount } = req.body;\n      \n      // Check IP-based order creation limit first\n      const clientIp = getClientIp(req);\n      const ipCheck = isIpBlockedFromOrders(clientIp);\n      if (ipCheck.blocked) {\n        logAudit({ action: 'ip_order_blocked', details: { ip: clientIp, ordersCount: ipCheck.ordersCount } });\n        return res.status(429).json({ \n          message: \"Request limit reached from this connection. Please try again later or contact support.\",\n          code: \"IP_ORDER_LIMIT\"\n        });\n      }\n      \n      let userId: string;\n      let isNewUser = false;\n      \n      if (req.session?.userId) {\n        const [currentUser] = await db.select().from(usersTable).where(eq(usersTable.id, req.session.userId)).limit(1);\n        if (currentUser && (currentUser.accountStatus === 'pending' || currentUser.accountStatus === 'deactivated')) {\n          return res.status(403).json({ message: \"Your account is under review or deactivated. You cannot place new orders at this time.\" });\n        }\n        \n        // Check for suspicious order creation activity\n        const suspiciousCheck = await detectSuspiciousOrderActivity(req.session.userId);\n        if (suspiciousCheck.suspicious) {\n          await flagAccountForReview(req.session.userId, suspiciousCheck.reason || 'Suspicious order activity');\n          return res.status(403).json({ \n            message: \"Your account has been placed under review due to unusual activity. Our team will review it soon.\",\n            code: \"ACCOUNT_UNDER_REVIEW\"\n          });\n        }\n        \n        userId = req.session.userId;\n      } else {\n        if (!email || !password) {\n          return res.status(400).json({ message: \"Email and password are required to place an order.\" });\n        }\n        \n        if (password.length < 8) {\n          return res.status(400).json({ message: \"Password must be at least 8 characters.\" });\n        }\n        \n        const [existingUser] = await db.select().from(usersTable).where(eq(usersTable.email, email)).limit(1);\n        if (existingUser) {\n          return res.status(400).json({ message: \"This email is already registered. Please log in.\" });\n        }\n        \n        // Check if email was verified via OTP\n        const [otpRecord] = await db.select()\n          .from(contactOtps)\n          .where(\n            and(\n              eq(contactOtps.email, email),\n              eq(contactOtps.otpType, \"account_verification\"),\n              eq(contactOtps.verified, true),\n              gt(contactOtps.expiresAt, new Date(Date.now() - 30 * 60 * 1000))\n            )\n          )\n          .orderBy(sql`${contactOtps.expiresAt} DESC`)\n          .limit(1);\n        \n        // If OTP not verified, create account in \"pending\" status (needs email verification)\n        const isEmailVerified = !!otpRecord;\n        const accountStatus = isEmailVerified ? 'active' : 'pending';\n        \n        const { hashPassword } = await import(\"../lib/auth-service\");\n        const { generateUniqueClientId } = await import(\"../lib/id-generator\");\n        const passwordHash = await hashPassword(password);\n        const clientId = await generateUniqueClientId();\n        const nameParts = ownerFullName?.split(' ') || ['Cliente'];\n        \n        const [newUser] = await db.insert(usersTable).values({\n          email,\n          passwordHash,\n          clientId,\n          firstName: nameParts[0] || 'Cliente',\n          lastName: nameParts.slice(1).join(' ') || '',\n          emailVerified: isEmailVerified,\n          accountStatus: accountStatus,\n        }).returning();\n        \n        userId = newUser.id;\n        isNewUser = true;\n        req.session.userId = userId;\n        \n        const mLang = (req.body.preferredLanguage || 'es') as EmailLanguage;\n        if (isEmailVerified) {\n          sendEmail({\n            to: email,\n            subject: getWelcomeEmailSubject(mLang),\n            html: getWelcomeEmailTemplate(nameParts[0] || undefined, mLang)\n          }).catch(console.error);\n        } else {\n          sendEmail({\n            to: email,\n            subject: getVerifyEmailSubject(mLang),\n            html: getAccountPendingVerificationTemplate(nameParts[0] || undefined, mLang)\n          }).catch(console.error);\n        }\n      }\n\n      const product = await storage.getProduct(productId);\n      if (!product) return res.status(400).json({ message: \"Invalid product\" });\n\n      // State-specific pricing for maintenance: NM 539\u20AC, WY 699\u20AC, DE 999\u20AC\n      let finalPrice = product.price;\n      if (state?.includes(\"New Mexico\")) finalPrice = 53900;\n      else if (state?.includes(\"Wyoming\")) finalPrice = 69900;\n      else if (state?.includes(\"Delaware\")) finalPrice = 99900;\n\n      // Calculate final amount with discount\n      let originalAmount = finalPrice;\n      let appliedDiscountAmount = 0;\n      let appliedDiscountCode: string | null = null;\n      \n      if (discountCode && discountAmount) {\n        appliedDiscountCode = discountCode;\n        appliedDiscountAmount = discountAmount;\n        finalPrice = Math.max(0, finalPrice - discountAmount);\n        \n        // Increment used count for the discount code\n        await db.update(discountCodes)\n          .set({ usedCount: sql`${discountCodes.usedCount} + 1` })\n          .where(eq(discountCodes.code, discountCode.toUpperCase()));\n      }\n\n      const order = await storage.createOrder({\n        userId,\n        productId,\n        amount: finalPrice,\n        originalAmount: appliedDiscountCode ? originalAmount : null,\n        discountCode: appliedDiscountCode,\n        discountAmount: appliedDiscountAmount || null,\n        status: \"pending\",\n        stripeSessionId: \"mock_session_maint_\" + Date.now(),\n      });\n\n      const [application] = await db.insert(maintenanceApplications).values({\n        orderId: order.id,\n        status: \"draft\",\n        state: state || product.name.split(\" \")[0],\n      }).returning();\n\n      // Generate unified request code: STATE-8digits (e.g., NM-12345678)\n      const { generateUniqueOrderCode } = await import(\"../lib/id-generator\");\n      const appState = state || product.name.split(\" \")[0] || 'New Mexico';\n      const requestCode = await generateUniqueOrderCode(appState);\n\n      await db.update(maintenanceApplications)\n        .set({ requestCode })\n        .where(eq(maintenanceApplications.id, application.id));\n\n      // NOTIFICATION: New maintenance order (translated on frontend via i18n keys)\n      if (userId && !userId.startsWith('guest_')) {\n        await db.insert(userNotifications).values({\n          userId,\n          orderId: order.id,\n          orderCode: requestCode,\n          title: 'i18n:ntf.maintenanceSubmitted.title',\n          message: `i18n:ntf.maintenanceSubmitted.message::{\"requestCode\":\"${requestCode}\"}`,\n          type: 'info',\n          isRead: false\n        });\n      }\n\n      // Track IP for order creation limiting\n      trackOrderByIp(clientIp);\n\n      res.status(201).json({ ...order, application: { ...application, requestCode } });\n    } catch (err) {\n      console.error(\"Error creating maintenance order:\", err);\n      res.status(500).json({ message: \"Error creating maintenance order\" });\n    }\n  });\n\n  // Maintenance App Updates - Protected with ownership verification\n  app.put(\"/api/maintenance/:id\", isAuthenticated, async (req: any, res) => {\n    try {\n      const appId = Number(req.params.id);\n      const updates = req.body;\n      \n      // First, get the application to verify ownership\n      const [existingApp] = await db.select().from(maintenanceApplications).where(eq(maintenanceApplications.id, appId)).limit(1);\n      \n      if (!existingApp) {\n        return res.status(404).json({ message: \"Request not found\" });\n      }\n      \n      // Verify ownership through the order\n      if (existingApp.orderId) {\n        const [order] = await db.select().from(ordersTable).where(eq(ordersTable.id, existingApp.orderId)).limit(1);\n        if (order && order.userId && order.userId !== req.session.userId && !req.session.isAdmin) {\n          return res.status(403).json({ message: \"Not authorized\" });\n        }\n      }\n      \n      const [updatedApp] = await db.update(maintenanceApplications)\n        .set({ ...updates, lastUpdated: new Date() })\n        .where(eq(maintenanceApplications.id, appId))\n        .returning();\n      \n      if (!updatedApp) {\n        return res.status(404).json({ message: \"Request not found\" });\n      }\n      \n      if (updates.status === \"submitted\") {\n        const orderIdentifier = updatedApp.requestCode || `MN-${updatedApp.id}`;\n        \n        // Get order info for price\n        const [order] = await db.select().from(ordersTable).where(eq(ordersTable.id, updatedApp.orderId)).limit(1);\n        const orderAmount = order ? (order.amount / 100).toFixed(2) : 'N/A';\n        \n        // Email notification to admin about completed maintenance order\n        const adminEmail = process.env.ADMIN_EMAIL || \"afortuny07@gmail.com\";\n        const maintPaymentMethodLabel = updatedApp.paymentMethod === 'transfer' ? 'Transferencia Bancaria' : updatedApp.paymentMethod === 'link' ? 'Link de Pago' : 'No especificado';\n        \n        sendEmail({\n          to: adminEmail,\n          subject: `[PEDIDO REALIZADO] ${orderIdentifier} - Mantenimiento ${updatedApp.companyName}`,\n          html: getAdminMaintenanceOrderTemplate({\n            orderIdentifier,\n            amount: orderAmount,\n            paymentMethod: maintPaymentMethodLabel,\n            ownerFullName: updatedApp.ownerFullName || undefined,\n            ownerEmail: updatedApp.ownerEmail || undefined,\n            ownerPhone: updatedApp.ownerPhone || undefined,\n            companyName: updatedApp.companyName || undefined,\n            ein: updatedApp.ein || undefined,\n            state: updatedApp.state || undefined,\n            creationSource: updatedApp.creationSource || undefined,\n            creationYear: updatedApp.creationYear || undefined,\n            bankAccount: updatedApp.bankAccount || undefined,\n            paymentGateway: updatedApp.paymentGateway || undefined,\n            businessActivity: updatedApp.businessActivity || undefined,\n            expectedServices: updatedApp.expectedServices || undefined,\n            wantsDissolve: updatedApp.wantsDissolve || undefined,\n            notes: updatedApp.notes || undefined\n          })\n        }).catch(() => {});\n        \n        // Confirmation to client\n        if (updatedApp.ownerEmail) {\n          sendEmail({\n            to: updatedApp.ownerEmail,\n            subject: `Solicitud recibida - Referencia ${orderIdentifier}`,\n            html: getConfirmationEmailTemplate(updatedApp.ownerFullName || \"Cliente\", orderIdentifier, { companyName: updatedApp.companyName || undefined, serviceType: \"Mantenimiento Anual\" }),\n          }).catch(() => {});\n        }\n      }\n      \n      res.json(updatedApp);\n    } catch (error) {\n      res.status(500).json({ message: \"Error updating request\" });\n    }\n  });\n}\n", "import type { Express } from \"express\";\nimport { db, isAdmin, logAudit } from \"./shared\";\nimport { accountingTransactions } from \"@shared/schema\";\nimport { and, eq, desc, sql } from \"drizzle-orm\";\n\nexport function registerAccountingRoutes(app: Express) {\n  // Get all transactions with filters\n  app.get(\"/api/admin/accounting/transactions\", isAdmin, async (req, res) => {\n    try {\n      const { type, category, startDate, endDate } = req.query;\n      \n      let query = db.select().from(accountingTransactions);\n      const conditions: any[] = [];\n      \n      if (type && typeof type === 'string') {\n        conditions.push(eq(accountingTransactions.type, type));\n      }\n      if (category && typeof category === 'string') {\n        conditions.push(eq(accountingTransactions.category, category));\n      }\n      if (startDate && typeof startDate === 'string') {\n        conditions.push(sql`${accountingTransactions.transactionDate} >= ${new Date(startDate)}`);\n      }\n      if (endDate && typeof endDate === 'string') {\n        conditions.push(sql`${accountingTransactions.transactionDate} <= ${new Date(endDate)}`);\n      }\n      \n      const transactions = await db.select()\n        .from(accountingTransactions)\n        .where(conditions.length > 0 ? and(...conditions) : undefined)\n        .orderBy(desc(accountingTransactions.transactionDate));\n      \n      res.json(transactions);\n    } catch (err) {\n      console.error(\"Error fetching accounting transactions:\", err);\n      res.status(500).json({ message: \"Error fetching transactions\" });\n    }\n  });\n  \n  // Get accounting summary/stats\n  app.get(\"/api/admin/accounting/summary\", isAdmin, async (req, res) => {\n    try {\n      const { period } = req.query; // 'month', 'year', 'all'\n      \n      let startDate: Date | null = null;\n      const now = new Date();\n      \n      if (period === 'month') {\n        startDate = new Date(now.getFullYear(), now.getMonth(), 1);\n      } else if (period === 'year') {\n        startDate = new Date(now.getFullYear(), 0, 1);\n      }\n      \n      const dateCondition = startDate \n        ? sql`${accountingTransactions.transactionDate} >= ${startDate}`\n        : sql`1=1`;\n      \n      const [incomeResult] = await db.select({ total: sql<number>`COALESCE(SUM(amount), 0)` })\n        .from(accountingTransactions)\n        .where(and(eq(accountingTransactions.type, 'income'), dateCondition));\n      \n      const [expenseResult] = await db.select({ total: sql<number>`COALESCE(SUM(ABS(amount)), 0)` })\n        .from(accountingTransactions)\n        .where(and(eq(accountingTransactions.type, 'expense'), dateCondition));\n      \n      const totalIncome = Number(incomeResult?.total || 0);\n      const totalExpenses = Number(expenseResult?.total || 0);\n      \n      // Get breakdown by category\n      const categoryBreakdown = await db.select({\n        category: accountingTransactions.category,\n        type: accountingTransactions.type,\n        total: sql<number>`SUM(ABS(amount))`\n      })\n        .from(accountingTransactions)\n        .where(dateCondition)\n        .groupBy(accountingTransactions.category, accountingTransactions.type);\n      \n      res.json({\n        totalIncome,\n        totalExpenses,\n        netBalance: totalIncome - totalExpenses,\n        categoryBreakdown\n      });\n    } catch (err) {\n      console.error(\"Error fetching accounting summary:\", err);\n      res.status(500).json({ message: \"Error fetching accounting summary\" });\n    }\n  });\n  \n  // Create transaction\n  app.post(\"/api/admin/accounting/transactions\", isAdmin, async (req: any, res) => {\n    try {\n      const { type, category, amount, currency, description, orderId, userId, reference, transactionDate, notes } = req.body;\n      \n      if (!type || !category || amount === undefined) {\n        return res.status(400).json({ message: \"Missing required data\" });\n      }\n      \n      const amountCents = Math.round(Number(amount) * 100);\n      \n      const [transaction] = await db.insert(accountingTransactions).values({\n        type,\n        category,\n        amount: type === 'expense' ? -Math.abs(amountCents) : Math.abs(amountCents),\n        currency: currency || 'EUR',\n        description,\n        orderId: orderId || null,\n        userId: userId || null,\n        reference,\n        transactionDate: transactionDate ? new Date(transactionDate) : new Date(),\n        createdBy: req.session?.userId,\n        notes\n      }).returning();\n      \n      logAudit({\n        action: 'accounting_transaction_created',\n        userId: req.session?.userId,\n        targetId: String(transaction.id),\n        details: { type, category, amount: amountCents }\n      });\n      \n      res.json(transaction);\n    } catch (err) {\n      console.error(\"Error creating transaction:\", err);\n      res.status(500).json({ message: \"Error creating transaction\" });\n    }\n  });\n  \n  // Update transaction\n  app.patch(\"/api/admin/accounting/transactions/:id\", isAdmin, async (req: any, res) => {\n    try {\n      const txId = Number(req.params.id);\n      const { type, category, amount, currency, description, reference, transactionDate, notes } = req.body;\n      \n      const updateData: Record<string, any> = { updatedAt: new Date() };\n      if (type) updateData.type = type;\n      if (category) updateData.category = category;\n      if (amount !== undefined) {\n        const amountCents = Math.round(Number(amount) * 100);\n        updateData.amount = type === 'expense' ? -Math.abs(amountCents) : Math.abs(amountCents);\n      }\n      if (currency) updateData.currency = currency;\n      if (description !== undefined) updateData.description = description;\n      if (reference !== undefined) updateData.reference = reference;\n      if (transactionDate) updateData.transactionDate = new Date(transactionDate);\n      if (notes !== undefined) updateData.notes = notes;\n      \n      const [updated] = await db.update(accountingTransactions)\n        .set(updateData)\n        .where(eq(accountingTransactions.id, txId))\n        .returning();\n      \n      logAudit({\n        action: 'accounting_transaction_updated',\n        userId: req.session?.userId,\n        targetId: String(txId),\n        details: updateData\n      });\n      \n      res.json(updated);\n    } catch (err) {\n      console.error(\"Error updating transaction:\", err);\n      res.status(500).json({ message: \"Error updating transaction\" });\n    }\n  });\n  \n  // Delete transaction\n  app.delete(\"/api/admin/accounting/transactions/:id\", isAdmin, async (req: any, res) => {\n    try {\n      const txId = Number(req.params.id);\n      \n      await db.delete(accountingTransactions).where(eq(accountingTransactions.id, txId));\n      \n      logAudit({\n        action: 'accounting_transaction_deleted',\n        userId: req.session?.userId,\n        targetId: String(txId)\n      });\n      \n      res.json({ success: true });\n    } catch (err) {\n      console.error(\"Error deleting transaction:\", err);\n      res.status(500).json({ message: \"Error deleting transaction\" });\n    }\n  });\n  \n  // Export transactions to CSV\n  app.get(\"/api/admin/accounting/export-csv\", isAdmin, async (req, res) => {\n    try {\n      const { startDate, endDate, type, category } = req.query;\n      \n      const conditions: any[] = [];\n      if (type && typeof type === 'string') {\n        conditions.push(eq(accountingTransactions.type, type));\n      }\n      if (category && typeof category === 'string') {\n        conditions.push(eq(accountingTransactions.category, category));\n      }\n      if (startDate && typeof startDate === 'string') {\n        conditions.push(sql`${accountingTransactions.transactionDate} >= ${new Date(startDate)}`);\n      }\n      if (endDate && typeof endDate === 'string') {\n        conditions.push(sql`${accountingTransactions.transactionDate} <= ${new Date(endDate)}`);\n      }\n      \n      const transactions = await db.select()\n        .from(accountingTransactions)\n        .where(conditions.length > 0 ? and(...conditions) : undefined)\n        .orderBy(desc(accountingTransactions.transactionDate));\n      \n      // Build CSV\n      const headers = ['ID', 'Fecha', 'Tipo', 'Categor\u00EDa', 'Importe (\u20AC)', 'Descripci\u00F3n', 'Referencia', 'Notas'];\n      const rows = transactions.map(tx => [\n        tx.id,\n        tx.transactionDate ? new Date(tx.transactionDate).toLocaleDateString('es-ES') : '',\n        tx.type === 'income' ? 'Ingreso' : 'Gasto',\n        tx.category,\n        (tx.amount / 100).toFixed(2),\n        tx.description || '',\n        tx.reference || '',\n        tx.notes || ''\n      ]);\n      \n      const csvContent = [headers.join(';'), ...rows.map(r => r.join(';'))].join('\\n');\n      \n      res.setHeader('Content-Type', 'text/csv; charset=utf-8');\n      res.setHeader('Content-Disposition', `attachment; filename=\"transacciones_${new Date().toISOString().slice(0, 10)}.csv\"`);\n      res.send('\\uFEFF' + csvContent); // BOM for Excel UTF-8\n    } catch (err) {\n      console.error(\"Error exporting CSV:\", err);\n      res.status(500).json({ message: \"Error exporting CSV\" });\n    }\n  });\n}\n", "import type { Express } from \"express\";\nimport { db, storage, isAuthenticated, logActivity } from \"./shared\";\nimport { users as usersTable, messages as messagesTable, messageReplies, userNotifications } from \"@shared/schema\";\nimport { eq } from \"drizzle-orm\";\nimport { sendEmail, getAutoReplyTemplate, getMessageReplyTemplate } from \"../lib/email\";\nimport type { EmailLanguage } from \"../lib/email-translations\";\n\nexport function registerMessageRoutes(app: Express) {\n  // Messages API\n  app.get(\"/api/messages\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userMessages = await storage.getMessagesByUserId(req.session.userId);\n      res.json(userMessages);\n    } catch (error) {\n      res.status(500).json({ message: \"Error fetching messages\" });\n    }\n  });\n\n  app.post(\"/api/messages\", async (req: any, res) => {\n    try {\n      const { name, email, phone, contactByWhatsapp, subject, content, requestCode } = req.body;\n      const userId = req.session?.userId || null;\n      \n      // Restrict suspended or under-review accounts from sending new messages\n      if (userId) {\n        const [currentUser] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n        if (currentUser?.accountStatus === 'deactivated') {\n          return res.status(403).json({ message: \"Your account is deactivated. You cannot send messages.\" });\n        }\n        if (currentUser?.accountStatus === 'pending') {\n          return res.status(403).json({ \n            message: \"Your account is under review. Our team is performing security checks.\",\n            code: \"ACCOUNT_UNDER_REVIEW\"\n          });\n        }\n      }\n      \n      const message = await storage.createMessage({\n        userId,\n        name,\n        email,\n        phone: phone || null,\n        contactByWhatsapp: contactByWhatsapp || false,\n        subject,\n        content,\n        requestCode,\n        type: \"contact\"\n      });\n\n      // Send auto-reply with ticket ID (translated)\n      const ticketId = message.messageId || String(message.id);\n      let userLang: EmailLanguage = 'es';\n      if (userId) {\n        const [msgUser] = await db.select().from(usersTable).where(eq(usersTable.id, userId)).limit(1);\n        if (msgUser?.preferredLanguage) userLang = msgUser.preferredLanguage as EmailLanguage;\n      } else {\n        const browserLang = (req.headers['accept-language']?.split(',')[0]?.split('-')[0] || 'es') as string;\n        if (['es','en','ca','fr','de','it','pt'].includes(browserLang)) userLang = browserLang as EmailLanguage;\n      }\n      const ticketSubjects: Record<string, string> = {\n        es: `Recibimos tu mensaje - Ticket #${ticketId}`,\n        en: `We received your message - Ticket #${ticketId}`,\n        ca: `Hem rebut el teu missatge - Ticket #${ticketId}`,\n        fr: `Nous avons re\u00E7u votre message - Ticket #${ticketId}`,\n        de: `Wir haben Ihre Nachricht erhalten - Ticket #${ticketId}`,\n        it: `Abbiamo ricevuto il tuo messaggio - Ticket #${ticketId}`,\n        pt: `Recebemos a sua mensagem - Ticket #${ticketId}`\n      };\n      sendEmail({\n        to: email,\n        subject: ticketSubjects[userLang] || ticketSubjects.es,\n        html: getAutoReplyTemplate(name || \"Cliente\", ticketId, userLang),\n      }).catch(() => {});\n\n      // Notify admin with WhatsApp preference\n      logActivity(\"Nuevo Mensaje de Contacto\", {\n        \"Nombre\": name,\n        \"Email\": email,\n        \"Tel\u00E9fono\": phone || \"No proporcionado\",\n        \"WhatsApp\": contactByWhatsapp ? \"S\u00ED\" : \"No\",\n        \"Asunto\": subject,\n        \"Mensaje\": content,\n        \"Referencia\": requestCode || \"N/A\"\n      });\n\n      res.status(201).json(message);\n    } catch (error) {\n      res.status(500).json({ message: \"Error sending message\" });\n    }\n  });\n\n  // Message replies - secured: only message owner or admin can view\n  app.get(\"/api/messages/:id/replies\", isAuthenticated, async (req: any, res) => {\n    try {\n      const messageId = Number(req.params.id);\n      \n      // Verify message belongs to user or user is admin\n      const [message] = await db.select().from(messagesTable).where(eq(messagesTable.id, messageId)).limit(1);\n      if (!message) {\n        return res.status(404).json({ message: \"Message not found\" });\n      }\n      if (message.userId !== req.session.userId && !req.session.isAdmin && !req.session.isSupport) {\n        return res.status(403).json({ message: \"Access denied\" });\n      }\n      \n      const replies = await db.select().from(messageReplies)\n        .where(eq(messageReplies.messageId, messageId))\n        .orderBy(messageReplies.createdAt);\n      \n      res.json(replies);\n    } catch (error) {\n      console.error(\"Error fetching message replies:\", error);\n      res.status(500).json({ message: \"Error fetching replies\" });\n    }\n  });\n\n  // Add reply to message - secured: only message owner or admin can reply\n  app.post(\"/api/messages/:id/reply\", isAuthenticated, async (req: any, res) => {\n    try {\n      const messageId = Number(req.params.id);\n      const { content } = req.body;\n      \n      // Verify message belongs to user or user is admin\n      const [existingMessage] = await db.select().from(messagesTable).where(eq(messagesTable.id, messageId)).limit(1);\n      if (!existingMessage) {\n        return res.status(404).json({ message: \"Message not found\" });\n      }\n      if (existingMessage.userId !== req.session.userId && !req.session.isAdmin && !req.session.isSupport) {\n        return res.status(403).json({ message: \"Access denied\" });\n      }\n      \n      if (!content || typeof content !== 'string' || !content.trim()) {\n        return res.status(400).json({ message: \"El contenido de la respuesta es requerido\" });\n      }\n      \n      const [reply] = await db.insert(messageReplies).values({\n        messageId,\n        content,\n        isAdmin: req.session.isAdmin || req.session.isSupport || false,\n        createdBy: req.session.userId,\n      }).returning();\n      \n      // Get message for email notification\n      const [message] = await db.select().from(messagesTable).where(eq(messagesTable.id, messageId)).limit(1);\n      if (message?.email && (req.session.isAdmin || req.session.isSupport)) {\n        // Admin reply - notify client by email\n        const ticketId = message.messageId || String(messageId);\n        sendEmail({\n          to: message.email,\n          subject: `Nueva respuesta a tu consulta - Ticket #${ticketId}`,\n          html: getMessageReplyTemplate(message.name?.split(' ')[0] || 'Cliente', content, ticketId)\n        }).catch(() => {});\n        \n        // Create notification for client if they have a user account\n        if (message.userId) {\n          await db.insert(userNotifications).values({\n            userId: message.userId,\n            title: 'i18n:ntf.messageReply.title',\n            message: `i18n:ntf.messageReply.message::{\"ticketId\":\"${ticketId}\"}`,\n            type: 'info',\n            isRead: false\n          });\n        }\n      }\n      \n      res.json(reply);\n    } catch (error) {\n      console.error(\"Error creating reply:\", error);\n      res.status(500).json({ message: \"Error creating reply\" });\n    }\n  });\n}\n", "import type { Express } from \"express\";\nimport { z } from \"zod\";\nimport { db, storage, isAuthenticated, logAudit, getClientIp, logActivity } from \"./shared\";\nimport { contactOtps, users as usersTable, newsletterSubscribers, userNotifications } from \"@shared/schema\";\nimport { and, eq, gt } from \"drizzle-orm\";\nimport { checkRateLimit, sanitizeHtml } from \"../lib/security\";\nimport { sendEmail, getOtpEmailTemplate, getNewsletterWelcomeTemplate, getAutoReplyTemplate } from \"../lib/email\";\nimport { EmailLanguage, getOtpSubject } from \"../lib/email-translations\";\n\nexport function registerContactRoutes(app: Express) {\n  // Newsletter\n  app.get(\"/api/newsletter/status\", isAuthenticated, async (req: any, res) => {\n    const isSubscribed = await storage.isSubscribedToNewsletter(req.session.email);\n    res.json({ isSubscribed });\n  });\n\n  app.post(\"/api/newsletter/unsubscribe\", isAuthenticated, async (req: any, res) => {\n    await db.delete(newsletterSubscribers).where(eq(newsletterSubscribers.email, req.session.email));\n    res.json({ success: true });\n  });\n\n  // Newsletter Subscription\n  app.post(\"/api/newsletter/subscribe\", async (req: any, res) => {\n    try {\n      const { email } = z.object({ email: z.string().email().optional() }).parse(req.body);\n      \n      // If no email provided, try to use authenticated user's email\n      const targetEmail = email || req.session?.email || null;\n      \n      if (!targetEmail) {\n        return res.status(400).json({ message: \"Email is required\" });\n      }\n\n      const isSubscribed = await storage.isSubscribedToNewsletter(targetEmail);\n      if (isSubscribed) {\n        // Silent success for already subscribed via dashboard toggle\n        return res.json({ success: true, message: \"Already subscribed\" });\n      }\n\n      await storage.subscribeToNewsletter(targetEmail);\n\n      await storage.createGuestVisitor({\n        email: targetEmail,\n        source: 'newsletter',\n        ip: getClientIp(req),\n        userAgent: req.headers['user-agent'] || null,\n        language: req.headers['accept-language']?.split(',')[0] || null,\n        page: req.headers['referer'] || null,\n        referrer: null,\n        metadata: null,\n      }).catch(() => {});\n\n      // NOTIFICATION: Newsletter subscription (translated on frontend via i18n keys)\n      const [user] = await db.select().from(usersTable).where(eq(usersTable.email, targetEmail)).limit(1);\n      if (user) {\n        await db.insert(userNotifications).values({\n          userId: user.id,\n          title: 'i18n:ntf.newsletterSubscribed.title',\n          message: 'i18n:ntf.newsletterSubscribed.message',\n          type: 'info',\n          isRead: false\n        });\n      }\n      \n      const nlLang = ((user as any)?.preferredLanguage || req.headers['accept-language']?.split(',')[0]?.split('-')[0] || 'es') as EmailLanguage;\n      const nlSubjects: Record<string, string> = {\n        en: \"Subscription confirmed - Easy US LLC\",\n        ca: \"Subscripci\u00F3 confirmada - Easy US LLC\",\n        fr: \"Abonnement confirm\u00E9 - Easy US LLC\",\n        de: \"Abonnement best\u00E4tigt - Easy US LLC\",\n        it: \"Iscrizione confermata - Easy US LLC\",\n        pt: \"Subscri\u00E7\u00E3o confirmada - Easy US LLC\",\n      };\n      await sendEmail({\n        to: targetEmail,\n        subject: nlSubjects[nlLang] || \"Confirmaci\u00F3n de suscripci\u00F3n a Easy US LLC\",\n        html: getNewsletterWelcomeTemplate(nlLang),\n      }).catch(() => {});\n      \n      res.json({ success: true });\n    } catch (err) {\n      if (err instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Invalid email\" });\n      }\n      res.status(500).json({ message: \"Error subscribing\" });\n    }\n  });\n\n\n  // Contact form\n  app.post(\"/api/contact/send-otp\", async (req, res) => {\n    try {\n      const ip = getClientIp(req);\n      const rateCheck = checkRateLimit('contact', ip);\n      if (!rateCheck.allowed) {\n        return res.status(429).json({ \n          message: `Too many attempts. Wait ${rateCheck.retryAfter} seconds.` \n        });\n      }\n\n      const { email } = z.object({ email: z.string().email() }).parse(req.body);\n      const otp = Math.floor(100000 + Math.random() * 900000).toString();\n      const expiresAt = new Date(Date.now() + 10 * 60 * 1000); // 10 mins\n\n      await db.insert(contactOtps).values({\n        email,\n        otp,\n        expiresAt,\n      });\n\n      const cLang = (req.headers['accept-language']?.split(',')[0]?.split('-')[0] || 'es') as EmailLanguage;\n      const supportedContactLangs: string[] = ['es', 'en', 'ca', 'fr', 'de', 'it', 'pt'];\n      const contactLang = supportedContactLangs.includes(cLang) ? cLang : 'es' as EmailLanguage;\n      await sendEmail({\n        to: email,\n        subject: getOtpSubject(contactLang),\n        html: getOtpEmailTemplate(otp, undefined, contactLang),\n      });\n\n      res.json({ success: true });\n    } catch (err) {\n      console.error(\"Error sending contact OTP:\", err);\n      res.status(400).json({ message: \"Error sending verification code. Please try again in a few minutes.\" });\n    }\n  });\n\n  app.post(\"/api/contact/verify-otp\", async (req, res) => {\n    try {\n      const { email, otp } = z.object({ email: z.string().email(), otp: z.string() }).parse(req.body);\n      \n      const [record] = await db.select()\n        .from(contactOtps)\n        .where(\n          and(\n            eq(contactOtps.email, email),\n            eq(contactOtps.otp, otp),\n            gt(contactOtps.expiresAt, new Date())\n          )\n        )\n        .limit(1);\n\n      if (!record) {\n        return res.status(400).json({ message: \"The code has expired or is incorrect. Please request a new one.\" });\n      }\n\n      await db.update(contactOtps)\n        .set({ verified: true })\n        .where(eq(contactOtps.id, record.id));\n\n      res.json({ success: true });\n    } catch (err) {\n      console.error(\"Error verifying contact OTP:\", err);\n      res.status(400).json({ message: \"Could not verify the code. Please try again.\" });\n    }\n  });\n\n  app.post(\"/api/contact\", async (req, res) => {\n    try {\n      const contactData = z.object({\n        nombre: z.string(),\n        apellido: z.string(),\n        email: z.string().email(),\n        telefono: z.string().optional(),\n        subject: z.string(),\n        mensaje: z.string(),\n        otp: z.string(),\n      }).parse(req.body);\n\n      // Sanitize user input\n      const sanitizedData = {\n        nombre: sanitizeHtml(contactData.nombre),\n        apellido: sanitizeHtml(contactData.apellido),\n        subject: sanitizeHtml(contactData.subject),\n        mensaje: sanitizeHtml(contactData.mensaje),\n        telefono: contactData.telefono ? sanitizeHtml(contactData.telefono) : undefined,\n      };\n\n      const [otpRecord] = await db.select()\n        .from(contactOtps)\n        .where(\n          and(\n            eq(contactOtps.email, contactData.email),\n            eq(contactOtps.otp, contactData.otp),\n            eq(contactOtps.verified, true)\n          )\n        )\n        .limit(1);\n\n      if (!otpRecord) {\n        return res.status(400).json({ message: \"Email no verificado\" });\n      }\n\n      const clientIp = getClientIp(req);\n      const { generateUniqueMessageId } = await import(\"../lib/id-generator\");\n      const ticketId = await generateUniqueMessageId();\n      \n      // Notification to admin with sanitized data\n      logActivity(\"Acci\u00F3n Contacto\", {\n        \"ID Ticket\": ticketId,\n        \"Nombre\": `${sanitizedData.nombre} ${sanitizedData.apellido}`,\n        \"Email\": contactData.email,\n        \"Tel\u00E9fono\": sanitizedData.telefono || \"No proporcionado\",\n        \"Asunto\": sanitizedData.subject,\n        \"Mensaje\": sanitizedData.mensaje,\n        \"IP\": clientIp\n      });\n\n      const contactLang = (req.headers['accept-language']?.split(',')[0]?.split('-')[0] || 'es') as EmailLanguage;\n      const validLang = ['es','en','ca','fr','de','it','pt'].includes(contactLang) ? contactLang : 'es';\n      const contactTicketSubjects: Record<string, string> = {\n        es: `Hemos recibido tu mensaje - Ticket #${ticketId}`,\n        en: `We received your message - Ticket #${ticketId}`,\n        ca: `Hem rebut el teu missatge - Ticket #${ticketId}`,\n        fr: `Nous avons re\u00E7u votre message - Ticket #${ticketId}`,\n        de: `Wir haben Ihre Nachricht erhalten - Ticket #${ticketId}`,\n        it: `Abbiamo ricevuto il tuo messaggio - Ticket #${ticketId}`,\n        pt: `Recebemos a sua mensagem - Ticket #${ticketId}`\n      };\n      await sendEmail({\n        to: contactData.email,\n        subject: contactTicketSubjects[validLang] || contactTicketSubjects.es,\n        html: getAutoReplyTemplate(sanitizedData.nombre, ticketId, validLang as EmailLanguage),\n      });\n\n      await storage.createGuestVisitor({\n        email: contactData.email,\n        source: 'contact',\n        ip: clientIp,\n        userAgent: req.headers['user-agent'] || null,\n        language: req.headers['accept-language']?.split(',')[0] || null,\n        page: '/contacto',\n        referrer: req.headers['referer'] || null,\n        metadata: JSON.stringify({ name: `${sanitizedData.nombre} ${sanitizedData.apellido}`, subject: sanitizedData.subject }),\n      }).catch(() => {});\n\n      logAudit({ action: 'order_created', ip: clientIp, details: { ticketId, type: 'contact' } });\n      res.json({ success: true, ticketId });\n    } catch (err) {\n      console.error(\"Error processing contact form:\", err);\n      res.status(400).json({ message: \"Error processing message\" });\n    }\n  });\n}\n", "import type { Express } from \"express\";\nimport { z } from \"zod\";\nimport { db, logAudit, getClientIp } from \"./shared\";\nimport { contactOtps, users as usersTable } from \"@shared/schema\";\nimport { and, eq, gt } from \"drizzle-orm\";\nimport { checkRateLimit } from \"../lib/security\";\nimport { sendEmail, getOtpEmailTemplate } from \"../lib/email\";\nimport { EmailLanguage, getOtpSubject } from \"../lib/email-translations\";\n\nexport function registerAuthExtRoutes(app: Express) {\n  // Check if email already exists (for form flow to detect existing users)\n  app.post(\"/api/auth/check-email\", async (req, res) => {\n    try {\n      const { email } = z.object({ email: z.string().email() }).parse(req.body);\n      \n      const [existingUser] = await db.select().from(usersTable).where(eq(usersTable.email, email)).limit(1);\n      \n      const isDeactivated = existingUser ? (existingUser.isActive === false || existingUser.accountStatus === 'deactivated') : false;\n      \n      res.json({ \n        exists: !!existingUser,\n        deactivated: isDeactivated,\n        firstName: existingUser?.firstName || null\n      });\n    } catch (err) {\n      res.status(400).json({ message: \"Invalid email\" });\n    }\n  });\n  \n  // Send OTP for account registration (email verification before creating account)\n  app.post(\"/api/register/send-otp\", async (req, res) => {\n    try {\n      const ip = getClientIp(req);\n      const rateCheck = checkRateLimit('register', ip);\n      if (!rateCheck.allowed) {\n        return res.status(429).json({ \n          message: `Too many attempts. Wait ${rateCheck.retryAfter} seconds.` \n        });\n      }\n\n      const { email } = z.object({ email: z.string().email() }).parse(req.body);\n      \n      // Check if email is already registered\n      const [existingUser] = await db.select().from(usersTable).where(eq(usersTable.email, email)).limit(1);\n      if (existingUser) {\n        // Check if account is deactivated\n        if (existingUser.isActive === false || existingUser.accountStatus === 'deactivated') {\n          return res.status(403).json({ \n            message: \"Your account has been deactivated. Contact our support team for more information.\",\n            code: \"ACCOUNT_DEACTIVATED\"\n          });\n        }\n        return res.status(400).json({ message: \"This email is already registered. Please log in.\" });\n      }\n      \n      const otp = Math.floor(100000 + Math.random() * 900000).toString();\n      const expiresAt = new Date(Date.now() + 10 * 60 * 1000); // 10 mins\n\n      await db.insert(contactOtps).values({\n        email,\n        otp,\n        otpType: \"account_verification\",\n        expiresAt,\n      });\n\n      const browserLang = (req.body.preferredLanguage || req.headers['accept-language']?.split(',')[0]?.split('-')[0] || 'es') as EmailLanguage;\n      const supportedLangs: string[] = ['es', 'en', 'ca', 'fr', 'de', 'it', 'pt'];\n      const lang = supportedLangs.includes(browserLang) ? browserLang : 'es' as EmailLanguage;\n      await sendEmail({\n        to: email,\n        subject: getOtpSubject(lang),\n        html: getOtpEmailTemplate(otp, undefined, lang),\n      });\n\n      logAudit({ action: 'user_register', ip, details: { email, step: 'otp_sent' } });\n      res.json({ success: true });\n    } catch (err) {\n      console.error(\"Error sending registration OTP:\", err);\n      res.status(400).json({ message: \"Error sending verification code.\" });\n    }\n  });\n\n  // Verify OTP for account registration\n  app.post(\"/api/register/verify-otp\", async (req, res) => {\n    try {\n      const { email, otp } = z.object({ email: z.string().email(), otp: z.string() }).parse(req.body);\n      \n      const [record] = await db.select()\n        .from(contactOtps)\n        .where(\n          and(\n            eq(contactOtps.email, email),\n            eq(contactOtps.otp, otp),\n            eq(contactOtps.otpType, \"account_verification\"),\n            gt(contactOtps.expiresAt, new Date())\n          )\n        )\n        .limit(1);\n\n      if (!record) {\n        return res.status(400).json({ message: \"The code has expired or is incorrect. Please request a new one.\" });\n      }\n\n      await db.update(contactOtps)\n        .set({ verified: true })\n        .where(eq(contactOtps.id, record.id));\n\n      res.json({ success: true });\n    } catch (err) {\n      console.error(\"Error verifying registration OTP:\", err);\n      res.status(400).json({ message: \"Could not verify the code. Please try again.\" });\n    }\n  });\n\n  // Send OTP for password reset (forgot password)\n  app.post(\"/api/password-reset/send-otp\", async (req, res) => {\n    try {\n      const ip = getClientIp(req);\n      const rateCheck = checkRateLimit('passwordReset', ip);\n      if (!rateCheck.allowed) {\n        return res.status(429).json({ \n          message: `Too many attempts. Wait ${rateCheck.retryAfter} seconds.` \n        });\n      }\n\n      const { email } = z.object({ email: z.string().email() }).parse(req.body);\n      \n      // Check if user exists (but don't reveal this to prevent enumeration)\n      const [existingUser] = await db.select().from(usersTable).where(eq(usersTable.email, email)).limit(1);\n      \n      // Always return success to prevent email enumeration attacks\n      if (!existingUser) {\n        return res.json({ success: true });\n      }\n      \n      const otp = Math.floor(100000 + Math.random() * 900000).toString();\n      const expiresAt = new Date(Date.now() + 10 * 60 * 1000); // 10 mins\n\n      await db.insert(contactOtps).values({\n        email,\n        otp,\n        otpType: \"password_reset\",\n        expiresAt,\n      });\n\n      const resetLang = ((existingUser as any)?.preferredLanguage || 'es') as EmailLanguage;\n      await sendEmail({\n        to: email,\n        subject: getOtpSubject(resetLang),\n        html: getOtpEmailTemplate(otp, existingUser?.firstName || undefined, resetLang),\n      });\n\n      logAudit({ action: 'password_reset', ip, details: { email } });\n      res.json({ success: true });\n    } catch (err) {\n      console.error(\"Error sending password reset OTP:\", err);\n      res.status(400).json({ message: \"Error sending verification code.\" });\n    }\n  });\n\n  // Verify OTP and reset password\n  app.post(\"/api/password-reset/confirm\", async (req, res) => {\n    try {\n      const { email, otp, newPassword } = z.object({ \n        email: z.string().email(), \n        otp: z.string(),\n        newPassword: z.string().min(8, \"Password must be at least 8 characters\")\n      }).parse(req.body);\n      \n      const [record] = await db.select()\n        .from(contactOtps)\n        .where(\n          and(\n            eq(contactOtps.email, email),\n            eq(contactOtps.otp, otp),\n            eq(contactOtps.otpType, \"password_reset\"),\n            gt(contactOtps.expiresAt, new Date()),\n            eq(contactOtps.verified, false)\n          )\n        )\n        .limit(1);\n\n      if (!record) {\n        return res.status(400).json({ message: \"The code has expired or is incorrect. Please request a new one.\" });\n      }\n\n      // Find the user\n      const [user] = await db.select().from(usersTable).where(eq(usersTable.email, email)).limit(1);\n      if (!user) {\n        return res.status(400).json({ message: \"User not found\" });\n      }\n\n      // Hash new password and update\n      const { hashPassword } = await import(\"../lib/auth-service\");\n      const passwordHash = await hashPassword(newPassword);\n      \n      await db.update(usersTable)\n        .set({ passwordHash, updatedAt: new Date() })\n        .where(eq(usersTable.id, user.id));\n\n      // Mark OTP as used\n      await db.update(contactOtps)\n        .set({ verified: true })\n        .where(eq(contactOtps.id, record.id));\n\n      res.json({ success: true, message: \"Password updated successfully\" });\n    } catch (err: any) {\n      console.error(\"Error resetting password:\", err);\n      if (err.errors) {\n        return res.status(400).json({ message: err.errors[0]?.message || \"Error resetting password\" });\n      }\n      res.status(400).json({ message: \"Error resetting password\" });\n    }\n  });\n}\n", "import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { fileURLToPath } from \"url\";\n\nfunction getDirname(): string {\n  try {\n    if (typeof import.meta?.url !== 'undefined') {\n      return path.dirname(fileURLToPath(import.meta.url));\n    }\n  } catch {}\n  return path.resolve();\n}\n\nconst __dirname = getDirname();\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath, {\n    maxAge: '1y',\n    immutable: true,\n    index: false,\n    etag: true,\n    lastModified: true\n  }));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"), {\n      headers: {\n        'Cache-Control': 'no-cache, no-store, must-revalidate'\n      }\n    });\n  });\n}\n", "import * as Sentry from \"@sentry/node\";\nimport type { Request, Response, NextFunction } from \"express\";\n\nlet isInitialized = false;\n\nexport function initServerSentry() {\n  if (process.env.NODE_ENV === \"production\" && process.env.SENTRY_DSN) {\n    Sentry.init({\n      dsn: process.env.SENTRY_DSN,\n      environment: process.env.NODE_ENV,\n      tracesSampleRate: 0.1,\n      beforeSend(event) {\n        if (event.exception) {\n          console.error(\"[Sentry Server] Captured exception\");\n        }\n        return event;\n      },\n    });\n    isInitialized = true;\n    console.log(\"[Sentry] Server monitoring initialized\");\n  }\n}\n\nexport function sentryRequestHandler() {\n  return (req: Request, _res: Response, next: NextFunction) => {\n    if (isInitialized) {\n      Sentry.setContext(\"request\", {\n        url: req.url,\n        method: req.method,\n      });\n    }\n    next();\n  };\n}\n\nexport function sentryErrorHandler() {\n  return (err: Error, req: Request, _res: Response, next: NextFunction) => {\n    if (isInitialized) {\n      Sentry.captureException(err, {\n        extra: {\n          url: req.url,\n          method: req.method,\n        },\n      });\n    }\n    next(err);\n  };\n}\n\nexport function captureServerError(error: Error, context?: Record<string, unknown>) {\n  console.error(\"[Server Error]\", error.message, context);\n  if (isInitialized) {\n    Sentry.captureException(error, { extra: context });\n  }\n}\n\nexport { Sentry };\n", "import { exec } from \"child_process\";\nimport { promisify } from \"util\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nconst execAsync = promisify(exec);\n\nconst BACKUP_DIR = \"/tmp/db-backups\";\nconst MAX_BACKUPS = 7;\n\nasync function ensureBackupDir() {\n  if (!fs.existsSync(BACKUP_DIR)) {\n    fs.mkdirSync(BACKUP_DIR, { recursive: true });\n  }\n}\n\nasync function cleanOldBackups() {\n  const files = fs.readdirSync(BACKUP_DIR)\n    .filter(f => f.endsWith(\".sql\"))\n    .map(f => ({\n      name: f,\n      path: path.join(BACKUP_DIR, f),\n      time: fs.statSync(path.join(BACKUP_DIR, f)).mtime.getTime()\n    }))\n    .sort((a, b) => b.time - a.time);\n\n  while (files.length > MAX_BACKUPS) {\n    const oldest = files.pop();\n    if (oldest) {\n      fs.unlinkSync(oldest.path);\n      console.log(`[Backup] Deleted old backup: ${oldest.name}`);\n    }\n  }\n}\n\nexport async function createBackup(): Promise<string | null> {\n  try {\n    await ensureBackupDir();\n\n    const timestamp = new Date().toISOString().replace(/[:.]/g, \"-\");\n    const backupFile = path.join(BACKUP_DIR, `backup-${timestamp}.sql`);\n\n    const databaseUrl = process.env.DATABASE_URL;\n    if (!databaseUrl) {\n      console.error(\"[Backup] DATABASE_URL not configured\");\n      return null;\n    }\n\n    const pgDumpCmd = `pg_dump \"${databaseUrl}\" --no-owner --no-acl -f \"${backupFile}\"`;\n    \n    await execAsync(pgDumpCmd);\n    \n    await cleanOldBackups();\n\n    console.log(`[Backup] Created successfully: ${backupFile}`);\n    return backupFile;\n  } catch (error) {\n    console.error(\"[Backup] Failed:\", error);\n    return null;\n  }\n}\n\nexport function scheduleBackups() {\n  const BACKUP_INTERVAL = 24 * 60 * 60 * 1000;\n\n  createBackup();\n\n  setInterval(() => {\n    createBackup();\n  }, BACKUP_INTERVAL);\n\n  console.log(\"[Backup] Scheduled daily backups\");\n}\n\nexport async function listBackups(): Promise<string[]> {\n  await ensureBackupDir();\n  return fs.readdirSync(BACKUP_DIR)\n    .filter(f => f.endsWith(\".sql\"))\n    .sort()\n    .reverse();\n}\n", "import type { Express } from \"express\";\n\nconst BASE_URL = \"https://easyusllc.com\";\nconst LINKTREE_URL = \"https://creamostullc.com\";\n\nconst PUBLIC_ROUTES = [\n  { path: \"/\", priority: 1.0, changefreq: \"weekly\" },\n  { path: \"/servicios\", priority: 0.9, changefreq: \"weekly\" },\n  { path: \"/faq\", priority: 0.8, changefreq: \"monthly\" },\n  { path: \"/contacto\", priority: 0.7, changefreq: \"monthly\" },\n  { path: \"/llc/formation\", priority: 0.9, changefreq: \"weekly\" },\n  { path: \"/llc/maintenance\", priority: 0.8, changefreq: \"weekly\" },\n  { path: \"/tools/price-calculator\", priority: 0.7, changefreq: \"monthly\" },\n  { path: \"/tools/invoice\", priority: 0.6, changefreq: \"monthly\" },\n  { path: \"/tools/operating-agreement\", priority: 0.6, changefreq: \"monthly\" },\n  { path: \"/legal/terminos\", priority: 0.4, changefreq: \"yearly\" },\n  { path: \"/legal/privacidad\", priority: 0.4, changefreq: \"yearly\" },\n  { path: \"/legal/reembolsos\", priority: 0.4, changefreq: \"yearly\" },\n  { path: \"/legal/cookies\", priority: 0.4, changefreq: \"yearly\" },\n];\n\nconst LINKTREE_ROUTES = [\n  { path: \"/\", priority: 1.0, changefreq: \"weekly\" },\n  { path: \"/tu-llc\", priority: 0.9, changefreq: \"weekly\" },\n];\n\nexport function generateSitemap(): string {\n  const today = new Date().toISOString().split(\"T\")[0];\n  \n  const urls = PUBLIC_ROUTES.map(route => `\n  <url>\n    <loc>${BASE_URL}${route.path}</loc>\n    <lastmod>${today}</lastmod>\n    <changefreq>${route.changefreq}</changefreq>\n    <priority>${route.priority.toFixed(1)}</priority>\n  </url>`).join(\"\");\n\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n${urls}\n</urlset>`;\n}\n\nexport function generateLinktreeSitemap(): string {\n  const today = new Date().toISOString().split(\"T\")[0];\n  \n  const urls = LINKTREE_ROUTES.map(route => `\n  <url>\n    <loc>${LINKTREE_URL}${route.path}</loc>\n    <lastmod>${today}</lastmod>\n    <changefreq>${route.changefreq}</changefreq>\n    <priority>${route.priority.toFixed(1)}</priority>\n  </url>`).join(\"\");\n\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n${urls}\n</urlset>`;\n}\n\nexport function setupSitemapRoute(app: Express): void {\n  app.get(\"/sitemap.xml\", (req, res) => {\n    const host = req.get('host') || '';\n    const isLinktree = host.includes('creamostullc');\n    \n    res.header(\"Content-Type\", \"application/xml\");\n    res.header(\"Cache-Control\", \"public, max-age=3600, stale-while-revalidate=86400\");\n    res.send(isLinktree ? generateLinktreeSitemap() : generateSitemap());\n  });\n  \n  app.get(\"/robots.txt\", (req, res) => {\n    const host = req.get('host') || '';\n    const isLinktree = host.includes('creamostullc');\n    \n    res.header(\"Content-Type\", \"text/plain\");\n    res.header(\"Cache-Control\", \"public, max-age=86400\");\n    \n    const robotsContent = isLinktree \n      ? `User-agent: *\nAllow: /\n\nUser-agent: Googlebot\nAllow: /\n\nUser-agent: Bingbot\nAllow: /\n\nSitemap: ${LINKTREE_URL}/sitemap.xml`\n      : `User-agent: *\nAllow: /\nDisallow: /api/\nDisallow: /dashboard\nDisallow: /admin\nDisallow: /auth/\nCrawl-delay: 1\n\nUser-agent: Googlebot\nAllow: /\nDisallow: /api/\nDisallow: /dashboard\nDisallow: /admin\nDisallow: /auth/\n\nUser-agent: Bingbot\nAllow: /\nDisallow: /api/\nDisallow: /dashboard\nDisallow: /admin\nDisallow: /auth/\nCrawl-delay: 2\n\nSitemap: ${BASE_URL}/sitemap.xml`;\n    \n    res.send(robotsContent);\n  });\n}\n"],
  "mappings": "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",
  "names": ["import_pg_core", "import_drizzle_orm", "pg", "path", "nodemailer", "timestamp", "import_drizzle_orm", "import_drizzle_orm", "import_drizzle_orm", "bcrypt", "crypto", "isAdmin", "getOtpEmailTemplate", "import_drizzle_orm", "isProduction", "text", "crypto", "import_crypto", "app", "import_drizzle_orm", "import_path", "react", "path", "import_crypto", "pool", "crypto", "app", "createViteServer", "path", "rootDir", "fs", "import_vite", "import_fs", "import_path", "import_express", "import_drizzle_orm", "connectPg", "session", "isProduction", "app", "express", "ordersTable", "contactOtps", "sendEmail", "getOtpEmailTemplate", "import_drizzle_orm", "app", "inArray", "encrypt", "messages", "import_drizzle_orm", "import_drizzle_orm", "import_crypto", "app", "crypto", "import_drizzle_orm", "app", "import_crypto", "path", "app", "path", "fs", "parseObjectPath", "import_crypto", "crypto", "import_drizzle_orm", "logActivity", "import_drizzle_orm", "app", "orderCode", "updateData", "import_zod", "import_drizzle_orm", "app", "users", "logActivity", "bcrypt", "path", "fs", "import_zod", "import_drizzle_orm", "app", "generateUniqueAdminOrderCode", "generate8DigitId", "getClientsNeedingRenewal", "checkExpiredRenewals", "generateUniqueInvoiceNumber", "import_zod", "import_drizzle_orm", "app", "import_zod", "import_drizzle_orm", "app", "fs", "path", "generateUniqueTicketId", "generateDocRequestId", "encrypt", "import_zod", "import_drizzle_orm", "app", "generateUniqueBookingCode", "import_zod", "import_drizzle_orm", "app", "index", "path", "fs", "logActivity", "products", "updatedUser", "verifyPassword", "hashPassword", "import_zod", "import_drizzle_orm", "import_zod", "import_path", "import_fs", "path", "path", "fs", "formatDate", "PDFDocument", "formatDate", "app", "orders", "hashPassword", "generateUniqueClientId", "generateUniqueOrderCode", "logActivity", "import_zod", "import_drizzle_orm", "app", "hashPassword", "generateUniqueClientId", "MAX_FILE_SIZE_MB", "MAX_FILE_SIZE_BYTES", "fs", "path", "generateUniqueMessageId", "encrypt", "import_drizzle_orm", "app", "hashPassword", "generateUniqueClientId", "generateUniqueOrderCode", "import_drizzle_orm", "app", "import_drizzle_orm", "app", "logActivity", "import_zod", "import_drizzle_orm", "app", "generateUniqueMessageId", "logActivity", "import_zod", "import_drizzle_orm", "app", "hashPassword", "httpServer", "app", "path", "import_express", "import_fs", "import_path", "import_url", "import_meta", "getDirname", "path", "__dirname", "app", "fs", "express", "import_fs", "import_path", "fs", "path", "timestamp", "backupFile", "BACKUP_INTERVAL", "app", "express", "isProduction", "compression", "setupVite"]
}
