import{j as s,m as N}from"./vendor-DoqeAWLV.js";import{a as n,w as g,al as v,am as y,s as k}from"./ui-DQs5cT5J.js";import{u as C,F as E,t as S,o as P,s as x}from"./form-DPaYdZ4w.js";import{u as L,c as R,N as o,L as p,B as c,F as i,d as F}from"./index-B4plyIND.js";import{F as u}from"./form-input-WL-FopQm.js";import"./textarea-jZCJtOuD.js";import"./select-DUrm1R9_.js";import"./checkbox-gLd055QV.js";import"./label-B_CBzfAp.js";const A=P({password:x().min(8,"La contraseña debe tener al menos 8 caracteres"),confirmPassword:x()}).refine(e=>e.password===e.confirmPassword,{message:"Las contraseñas no coinciden",path:["confirmPassword"]});function H(){L();const[e,l]=n.useState(!1),[a,h]=n.useState(!1),[f,j]=n.useState(!1),{toast:m}=R(),r=new URLSearchParams(window.location.search).get("token"),t=C({resolver:S(A),defaultValues:{password:"",confirmPassword:""}}),b=async w=>{if(!r){m({title:"Error",description:"Token inválido",variant:"destructive"});return}l(!0);try{(await(await F("POST","/api/auth/reset-password",{token:r,password:w.password})).json()).success&&j(!0)}catch(d){m({title:"Error",description:d.message||"No se pudo restablecer la contraseña",variant:"destructive"})}finally{l(!1)}};return r?f?s.jsxs("div",{className:"min-h-screen bg-background font-sans",children:[s.jsx(o,{}),s.jsx("main",{className:"pt-24 pb-16 px-5 sm:px-6 flex flex-col items-center justify-center min-h-[80vh]",children:s.jsxs(N.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"w-full max-w-md text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-[#6EDC8A] rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(g,{className:"w-8 h-8 text-primary"})}),s.jsxs("h1",{className:"text-2xl sm:text-3xl font-black text-primary tracking-tight mb-4",children:["Contraseña ",s.jsx("span",{className:"text-accent",children:"Actualizada"})]}),s.jsx("p",{className:"text-muted-foreground mb-8",children:"Tu contraseña ha sido restablecida correctamente."}),s.jsx(p,{href:"/login",children:s.jsx(c,{className:"rounded-full px-8 font-black bg-[#6EDC8A] text-primary",children:"Iniciar Sesión"})})]})}),s.jsx(i,{})]}):s.jsxs("div",{className:"min-h-screen bg-background font-sans",children:[s.jsx(o,{}),s.jsx("main",{className:"pt-24 pb-16 px-5 sm:px-6 flex flex-col items-center justify-center min-h-[80vh]",children:s.jsxs("div",{className:"w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsxs("h1",{className:"text-3xl sm:text-4xl font-black text-primary tracking-tight",children:["Nueva ",s.jsx("span",{className:"text-accent",children:"Contraseña"})]}),s.jsx("p",{className:"text-muted-foreground mt-2",children:"Introduce tu nueva contraseña"})]}),s.jsx("div",{children:s.jsx(E,{...t,children:s.jsxs("form",{onSubmit:t.handleSubmit(b),className:"space-y-6",children:[s.jsxs("div",{className:"relative",children:[s.jsx(u,{control:t.control,name:"password",label:"Nueva Contraseña",type:a?"text":"password",placeholder:"Mínimo 8 caracteres"}),s.jsx("button",{type:"button",onClick:()=>h(!a),className:"absolute right-4 top-[42px] text-muted-foreground hover:text-primary transition-colors",children:a?s.jsx(v,{className:"w-5 h-5"}):s.jsx(y,{className:"w-5 h-5"})})]}),s.jsx(u,{control:t.control,name:"confirmPassword",label:"Confirmar Contraseña",type:a?"text":"password",placeholder:"Repite tu contraseña"}),s.jsx(c,{type:"submit",disabled:e,className:"w-full bg-[#6EDC8A] text-primary font-black py-7 rounded-full text-lg shadow-lg shadow-[#6EDC8A]/20 active:scale-95 transition-all","data-testid":"button-reset-password",children:e?s.jsx(k,{className:"animate-spin"}):"Restablecer Contraseña"})]})})})]})}),s.jsx(i,{})]}):s.jsxs("div",{className:"min-h-screen bg-background font-sans",children:[s.jsx(o,{}),s.jsx("main",{className:"pt-24 pb-16 px-5 sm:px-6 flex flex-col items-center justify-center min-h-[80vh]",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-2xl font-black text-primary mb-4",children:"Enlace inválido"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"Este enlace no es válido o ha expirado."}),s.jsx(p,{href:"/forgot-password",children:s.jsx(c,{className:"rounded-full px-8 font-black bg-[#6EDC8A] text-primary",children:"Solicitar nuevo enlace"})})]})}),s.jsx(i,{})]})}export{H as default};
