import{a as c,j as e,t as T,E as _,x as $,a6 as K}from"./react-vendor-DySzTZYh.js";import{a as Q,t as Y}from"./forms-BCWHroEx.js";import{u as U,m as g}from"./vendor-CfPiAaHv.js";import{N as I,F as A,a as b,q as P}from"./index-CIBZtyMu.js";import{u as G,I as o,B as i,F as H,e as l,f as d,g as m,h as p,j as x,i as J}from"./ui-components-tQHy3as0.js";import{S as W}from"./social-login-BPOUuDnx.js";import{o as X,s as u}from"./validation-D376FIhw.js";import"./tanstack-Be0kG5UR.js";import"./i18n-BSAMEAt_.js";import"./radix-ui-CBW9IaP7.js";const Z=X({firstName:u().min(1,"Este campo es obligatorio"),lastName:u().min(1,"Este campo es obligatorio"),email:u().email("Introduce un email válido"),phone:u().min(6,"Este campo es obligatorio"),businessActivity:u().optional(),password:u().min(8,"La contraseña debe tener al menos 8 caracteres"),confirmPassword:u()}).refine(j=>j.password===j.confirmPassword,{message:"Las contraseñas no coinciden",path:["confirmPassword"]}),ee=["E-commerce / Tienda online","Dropshipping","Consultoría / Servicios profesionales","Marketing digital / Agencia","Desarrollo de software / IT","Inversiones / Trading","Bienes raíces / Real estate","Importación / Exportación","Coaching / Formación online","Creador de contenido / Influencer","Otro"],N=6;function xe(){const[,j]=U(),[a,y]=c.useState(0),[v,w]=c.useState(!1),[f,V]=c.useState(!1),[L,F]=c.useState(!1),[h,R]=c.useState(""),[k,C]=c.useState(!1),[S,E]=c.useState(!1),{toast:n}=G(),t=Q({resolver:Y(Z),defaultValues:{firstName:"",lastName:"",email:"",phone:"",businessActivity:"",password:"",confirmPassword:""}}),z={0:["firstName","lastName"],1:["email"],2:["phone"],3:[],4:["password","confirmPassword"]},q=async()=>{const s=z[a]||[];await t.trigger(s)&&a<N-1&&y(a+1)},O=()=>{a>0&&y(a-1)},M=async s=>{w(!0);try{(await(await b("POST","/api/auth/register",{firstName:s.firstName,lastName:s.lastName,email:s.email,phone:s.phone,businessActivity:s.businessActivity||null,password:s.password})).json()).success&&(await P.refetchQueries({queryKey:["/api/auth/user"]}),F(!0),n({title:"Cuenta creada",description:"Te hemos enviado un código para confirmar tu email"}))}catch(r){n({title:"Error",description:r.message||"Error al crear la cuenta",variant:"destructive"})}finally{w(!1)}},B=async()=>{if(!h||h.length<6){n({title:"Falta el código",description:"Introduce el código de 6 dígitos",variant:"destructive"});return}C(!0);try{(await(await b("POST","/api/auth/verify-email",{code:h})).json()).success&&(await P.refetchQueries({queryKey:["/api/auth/user"]}),n({title:"Email verificado",description:"Perfecto. Ya puedes continuar"}),j("/dashboard"))}catch{n({title:"Código incorrecto",description:"El código no es válido o ha caducado",variant:"destructive"})}finally{C(!1)}},D=async()=>{E(!0);try{await b("POST","/api/auth/resend-verification"),n({title:"Código enviado",description:"Revisa tu correo, te esperamos aquí"})}catch{n({title:"Error",description:"No se pudo enviar el código",variant:"destructive"})}finally{E(!1)}};return L?e.jsxs("div",{className:"min-h-screen bg-background font-sans",children:[e.jsx(I,{}),e.jsx("main",{className:"pt-24 pb-16 px-5 sm:px-6 flex flex-col items-center justify-center min-h-[80vh]",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-black text-primary tracking-tight",children:["Verifica tu ",e.jsx("span",{className:"text-accent",children:"correo electrónico"})]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Te hemos enviado un código de verificación para confirmar tu email"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-black text-primary block mb-2",children:"Código de verificación"}),e.jsx(o,{value:h,onChange:s=>R(s.target.value.replace(/\D/g,"")),className:"rounded-full text-center text-2xl font-black border-gray-200 focus:border-accent tracking-[0.5em]",maxLength:6,inputMode:"numeric",autoComplete:"one-time-code","data-testid":"input-verification-code"})]}),e.jsx(i,{onClick:B,disabled:k||h.length<6,size:"lg",className:"w-full bg-accent text-primary font-black rounded-full","data-testid":"button-verify",children:k?e.jsx(T,{className:"animate-spin"}):"Verificar mi email"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"¿No has recibido el código?"}),e.jsx(i,{variant:"link",onClick:D,disabled:S,className:"text-accent p-0 h-auto","data-testid":"button-resend-code",children:S?"Enviando...":"Reenviar código"})]}),e.jsxs("div",{className:"text-center pt-4 border-t border-gray-100",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Puedes verificarlo más tarde desde tu área de cliente"}),e.jsx(g,{href:"/dashboard",children:e.jsx(i,{variant:"link",className:"text-accent p-0 h-auto","data-testid":"button-verify-later",children:"Ir a mi panel"})})]})]})]})}),e.jsx(A,{})]}):e.jsxs("div",{className:"min-h-screen bg-background font-sans",children:[e.jsx(I,{}),e.jsx("main",{className:"pt-20 md:pt-24 pb-12 md:pb-16 px-4 sm:px-6 flex flex-col items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-sm md:max-w-md",children:[e.jsxs("div",{className:"text-center mb-5 md:mb-8",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-black text-primary tracking-tight",children:["Crear ",e.jsx("span",{className:"text-accent",children:"cuenta"})]}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm md:text-base",children:"Registro rapido"})]}),e.jsx("div",{className:"flex justify-center gap-1.5 md:gap-2 mb-5 md:mb-8",children:Array.from({length:N}).map((s,r)=>e.jsx("div",{className:`h-1.5 md:h-2 rounded-full transition-all duration-300 ${r===a?"w-6 md:w-8 bg-accent":r<a?"w-1.5 md:w-2 bg-accent":"w-1.5 md:w-2 bg-muted"}`},r))}),e.jsx(H,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(M),className:"space-y-6",children:[a===0&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(W,{mode:"login"})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-black text-primary",children:"¿Cómo te llamas?"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"O registrate con tu email"})]}),e.jsx(l,{control:t.control,name:"firstName",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{className:"font-black text-primary",children:"Nombre"}),e.jsx(p,{children:e.jsx(o,{...s,className:"rounded-full border-gray-200 focus:border-accent","data-testid":"input-firstName"})}),e.jsx(x,{})]})}),e.jsx(l,{control:t.control,name:"lastName",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{className:"font-black text-primary",children:"Apellido"}),e.jsx(p,{children:e.jsx(o,{...s,className:"rounded-full border-gray-200 focus:border-accent","data-testid":"input-lastName"})}),e.jsx(x,{})]})})]},"step-0"),a===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-black text-primary",children:"Tu correo electrónico"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Lo usaremos para que puedas acceder a tu cuenta y recibir actualizaciones"})]}),e.jsx(l,{control:t.control,name:"email",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{className:"font-black text-primary",children:"Correo electrónico"}),e.jsx(p,{children:e.jsx(o,{...s,type:"email",inputMode:"email",className:"rounded-full border-gray-200 focus:border-accent","data-testid":"input-email"})}),e.jsx(x,{})]})})]},"step-1"),a===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-black text-primary",children:"Tu teléfono"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Solo lo usaremos para contactarte si es necesario"})]}),e.jsx(l,{control:t.control,name:"phone",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{className:"font-black text-primary",children:"Número de teléfono con prefijo"}),e.jsx(p,{children:e.jsx(o,{...s,type:"tel",inputMode:"tel",className:"rounded-full border-gray-200 focus:border-accent","data-testid":"input-phone"})}),e.jsx(x,{})]})})]},"step-2"),a===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-black text-primary",children:"Tu actividad"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Opcional, pero nos ayuda a adaptar mejor el servicio a ti"})]}),e.jsx(l,{control:t.control,name:"businessActivity",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{className:"font-black text-primary",children:"¿A qué te dedicas?"}),e.jsx(J,{className:"text-sm text-muted-foreground mb-3",children:"Elige la opción que mejor describe tu negocio"}),e.jsx("div",{className:"grid gap-2 max-h-[300px] overflow-y-auto pr-2",children:ee.map(r=>e.jsx(i,{type:"button",variant:"outline",onClick:()=>t.setValue("businessActivity",r),className:`w-full justify-start text-left rounded-xl toggle-elevate ${s.value===r?"toggle-elevated border-accent bg-accent/10":""}`,"data-testid":`button-activity-${r.toLowerCase().replace(/[^a-z0-9]/g,"-")}`,children:r},r))}),e.jsx(x,{})]})})]},"step-3"),a===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-black text-primary",children:"Tu contraseña"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Elige una contraseña segura para proteger tu cuenta"})]}),e.jsx(l,{control:t.control,name:"password",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{className:"font-black text-primary",children:"Contraseña"}),e.jsx(p,{children:e.jsxs("div",{className:"relative",children:[e.jsx(o,{...s,type:f?"text":"password",autoComplete:"new-password",className:"rounded-full pr-12 border-gray-200 focus:border-accent","data-testid":"input-password"}),e.jsx(i,{type:"button",variant:"ghost",size:"icon",onClick:()=>V(!f),className:"absolute right-2 top-1/2 -translate-y-1/2","aria-label":f?"Ocultar contraseña":"Mostrar contraseña","data-testid":"button-toggle-password",children:f?e.jsx(_,{className:"w-5 h-5"}):e.jsx($,{className:"w-5 h-5"})})]})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Mínimo 8 caracteres"}),e.jsx(x,{})]})}),e.jsx(l,{control:t.control,name:"confirmPassword",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{className:"font-black text-primary",children:"Confirmar contraseña"}),e.jsx(p,{children:e.jsx(o,{...s,type:f?"text":"password",autoComplete:"new-password",className:"rounded-full border-gray-200 focus:border-accent","data-testid":"input-confirmPassword"})}),e.jsx(x,{})]})})]},"step-4"),a===5&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-black text-primary",children:"Confirmar registro"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Revisa tus datos antes de continuar"})]}),e.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-zinc-800 rounded-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-zinc-700",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Nombre"}),e.jsxs("span",{className:"font-medium text-primary",children:[t.getValues("firstName")," ",t.getValues("lastName")]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-zinc-700",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Email"}),e.jsx("span",{className:"font-medium text-primary",children:t.getValues("email")})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-zinc-700",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Teléfono"}),e.jsx("span",{className:"font-medium text-primary",children:t.getValues("phone")})]}),t.getValues("businessActivity")&&e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Actividad"}),e.jsx("span",{className:"font-medium text-primary text-right max-w-[200px]",children:t.getValues("businessActivity")})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Al registrarte aceptas nuestros"," ",e.jsx(g,{href:"/legal/terminos","data-testid":"link-terms",children:e.jsx("span",{className:"text-accent underline cursor-pointer",children:"Términos y Condiciones"})})," ","y"," ",e.jsx(g,{href:"/legal/privacidad","data-testid":"link-privacy",children:e.jsx("span",{className:"text-accent underline cursor-pointer",children:"Política de Privacidad"})})]})]},"step-5"),e.jsxs("div",{className:"flex gap-3 pt-4",children:[a>0&&e.jsxs(i,{type:"button",variant:"outline",size:"lg",onClick:O,className:"flex-1 rounded-full font-black","data-testid":"button-prev",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Volver"]}),a<N-1?e.jsx(i,{type:"button",size:"lg",onClick:q,className:"flex-1 bg-accent text-primary font-black rounded-full","data-testid":"button-next",children:"Continuar"}):e.jsx(i,{type:"submit",size:"lg",disabled:v,className:"flex-1 bg-accent text-primary font-black rounded-full","data-testid":"button-register",children:v?e.jsx(T,{className:"animate-spin"}):"Crear Cuenta"})]})]})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-muted-foreground text-sm",children:["¿Ya tienes cuenta?"," ",e.jsx(g,{href:"/auth/login","data-testid":"link-login",children:e.jsx("span",{className:"font-black text-primary underline cursor-pointer",children:"Inicia sesión aquí"})})]})})]})}),e.jsx(A,{})]})}export{xe as default};
