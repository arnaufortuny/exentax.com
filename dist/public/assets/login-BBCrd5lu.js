import{a as o,j as e,F as j,H as w,t as N}from"./react-vendor-0u4i6o3R.js";import{a as v,t as y}from"./forms-soYwKzaw.js";import{u as E,m as u}from"./vendor-CcWLwBcD.js";import{N as S,F as k,a as L,q as F}from"./index-CLIhc-sl.js";import{u as T,F as q,B as l}from"./ui-components-C65bcPfg.js";import{F as p}from"./form-input-CdSK3oz0.js";import{S as C}from"./social-login-D1vIkujT.js";import{o as I,s as h}from"./validation-D376FIhw.js";import"./tanstack-BGyfl4P4.js";import"./i18n-CerrjaX-.js";import"./radix-ui-CJuqdRty.js";const R=I({email:h().email("Introduce un email válido"),password:h().min(1,"La contraseña es requerida")});function D(){const[,f]=E(),[d,m]=o.useState(!1),[a,b]=o.useState(!1),[r,n]=o.useState(null),{toast:x}=T(),i=v({resolver:y(R),defaultValues:{email:"",password:""}});o.useEffect(()=>{if(r){const c=setTimeout(()=>n(null),5e3);return()=>clearTimeout(c)}},[r]);const g=async c=>{m(!0),n(null);try{(await(await L("POST","/api/auth/login",c)).json()).success&&(await F.refetchQueries({queryKey:["/api/auth/user"]}),x({title:"Bienvenido de nuevo",description:"Sesión iniciada correctamente"}),f("/dashboard"))}catch(t){let s="Error al iniciar sesión";t.message?.includes("401")?s="Email o contraseña incorrectos":t.message?.includes("404")?s="Usuario no encontrado":t.message&&(s=t.message),n(s),x({title:"Error de autenticación",description:s,variant:"destructive"})}finally{m(!1)}};return e.jsxs("div",{className:"min-h-screen bg-background font-sans",children:[e.jsx(S,{}),e.jsx("main",{className:"pt-20 md:pt-24 pb-12 md:pb-16 px-4 sm:px-6 flex flex-col items-center justify-center min-h-[80vh]",children:e.jsxs("div",{className:"w-full max-w-sm md:max-w-md",children:[e.jsxs("div",{className:"text-center mb-6 md:mb-8",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-black text-primary tracking-tight",children:["Iniciar ",e.jsx("span",{className:"text-accent",children:"sesion"})]}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm md:text-base",children:"Accede a tu area de cliente"})]}),r&&e.jsx("div",{className:"mb-4 md:mb-6 p-3 md:p-4 bg-destructive/10 border border-destructive/20 rounded-xl text-center",children:e.jsx("p",{className:"text-destructive font-medium text-xs md:text-sm",children:r})}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl md:rounded-3xl p-5 md:p-8 border border-border shadow-sm",children:[e.jsx(q,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(g),className:"space-y-4 md:space-y-5",children:[e.jsx(p,{control:i.control,name:"email",label:"Email",type:"email",inputMode:"email"}),e.jsxs("div",{className:"relative",children:[e.jsx(p,{control:i.control,name:"password",label:"Contrasena",type:a?"text":"password"}),e.jsx(l,{type:"button",variant:"ghost",size:"icon",onClick:()=>b(!a),className:"absolute right-2 top-1/2 -translate-y-1/2 h-8 w-8","aria-label":a?"Ocultar":"Mostrar","data-testid":"button-toggle-password",children:a?e.jsx(j,{className:"w-4 h-4"}):e.jsx(w,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"text-center",children:e.jsx(u,{href:"/forgot-password",children:e.jsx(l,{variant:"link",className:"text-accent p-0 h-auto text-xs md:text-sm","data-testid":"link-forgot-password",children:"Recuperar contrasena"})})}),e.jsx(l,{type:"submit",disabled:d,className:"w-full bg-accent text-primary font-black rounded-full h-11 md:h-12 text-sm md:text-base shadow-lg shadow-accent/20","data-testid":"button-login",children:d?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"animate-spin mr-2 w-4 h-4"}),"Entrando..."]}):"Entrar"})]})}),e.jsx("div",{className:"mt-6 pt-5 border-t border-border",children:e.jsx(C,{mode:"login"})}),e.jsx("div",{className:"mt-6 pt-5 border-t border-border text-center",children:e.jsxs("p",{className:"text-muted-foreground text-xs md:text-sm",children:["¿No tienes cuenta?"," ",e.jsx(u,{href:"/register",children:e.jsx("span",{className:"font-black text-primary hover:text-accent transition-colors cursor-pointer","data-testid":"link-register",children:"Registrate"})})]})})]})]})}),e.jsx(k,{})]})}export{D as default};
