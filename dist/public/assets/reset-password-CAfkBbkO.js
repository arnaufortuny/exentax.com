import{j as e,m as N}from"./vendor-rACX9Y5t.js";import{a as n,w as g,am as v,an as y,s as k}from"./ui-BDRs75dM.js";import{u as C,F as E,t as S,o as P,s as x}from"./form-BTpaeBvT.js";import{u as L,c as R,N as o,L as p,B as c,F as i,d as F}from"./index-BmcZvhzO.js";import{F as u}from"./form-input-jX--FoeL.js";import"./textarea-CkuaKn8P.js";import"./select-Dc_JaQim.js";import"./checkbox-CRSq1QK8.js";import"./label-Cp9cVBxA.js";const A=P({password:x().min(8,"La contraseña debe tener al menos 8 caracteres"),confirmPassword:x()}).refine(s=>s.password===s.confirmPassword,{message:"Las contraseñas no coinciden",path:["confirmPassword"]});function H(){L();const[s,l]=n.useState(!1),[a,h]=n.useState(!1),[f,j]=n.useState(!1),{toast:m}=R(),r=new URLSearchParams(window.location.search).get("token"),t=C({resolver:S(A),defaultValues:{password:"",confirmPassword:""}}),b=async w=>{if(!r){m({title:"Error",description:"Token inválido",variant:"destructive"});return}l(!0);try{(await(await F("POST","/api/auth/reset-password",{token:r,password:w.password})).json()).success&&j(!0)}catch(d){m({title:"Error",description:d.message||"No se pudo restablecer la contraseña",variant:"destructive"})}finally{l(!1)}};return r?f?e.jsxs("div",{className:"min-h-screen bg-background font-sans",children:[e.jsx(o,{}),e.jsx("main",{className:"pt-24 pb-16 px-4 flex flex-col items-center justify-center min-h-[80vh]",children:e.jsxs(N.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"w-full max-w-md text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-[#6EDC8A] rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(g,{className:"w-8 h-8 text-primary"})}),e.jsxs("h1",{className:"text-2xl sm:text-3xl font-black text-primary tracking-tight mb-4",children:["Contraseña ",e.jsx("span",{className:"text-accent",children:"Actualizada"})]}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Tu contraseña ha sido restablecida correctamente."}),e.jsx(p,{href:"/login",children:e.jsx(c,{className:"rounded-full px-8 font-black bg-[#6EDC8A] text-primary",children:"Iniciar Sesión"})})]})}),e.jsx(i,{})]}):e.jsxs("div",{className:"min-h-screen bg-background font-sans",children:[e.jsx(o,{}),e.jsx("main",{className:"pt-24 pb-16 px-4 flex flex-col items-center justify-center min-h-[80vh]",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl font-black text-primary tracking-tight",children:["Nueva ",e.jsx("span",{className:"text-accent",children:"Contraseña"})]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Introduce tu nueva contraseña"})]}),e.jsx("div",{children:e.jsx(E,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(b),className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(u,{control:t.control,name:"password",label:"Nueva Contraseña",type:a?"text":"password",placeholder:"Mínimo 8 caracteres"}),e.jsx("button",{type:"button",onClick:()=>h(!a),className:"absolute right-4 top-[42px] text-muted-foreground hover:text-primary transition-colors",children:a?e.jsx(v,{className:"w-5 h-5"}):e.jsx(y,{className:"w-5 h-5"})})]}),e.jsx(u,{control:t.control,name:"confirmPassword",label:"Confirmar Contraseña",type:a?"text":"password",placeholder:"Repite tu contraseña"}),e.jsx(c,{type:"submit",disabled:s,className:"w-full bg-[#6EDC8A] text-primary font-black py-7 rounded-full text-lg shadow-lg shadow-[#6EDC8A]/20 active:scale-95 transition-all","data-testid":"button-reset-password",children:s?e.jsx(k,{className:"animate-spin"}):"Restablecer Contraseña"})]})})})]})}),e.jsx(i,{})]}):e.jsxs("div",{className:"min-h-screen bg-background font-sans",children:[e.jsx(o,{}),e.jsx("main",{className:"pt-24 pb-16 px-4 flex flex-col items-center justify-center min-h-[80vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-black text-primary mb-4",children:"Enlace inválido"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Este enlace no es válido o ha expirado."}),e.jsx(p,{href:"/forgot-password",children:e.jsx(c,{className:"rounded-full px-8 font-black bg-[#6EDC8A] text-primary",children:"Solicitar nuevo enlace"})})]})}),e.jsx(i,{})]})}export{H as default};
