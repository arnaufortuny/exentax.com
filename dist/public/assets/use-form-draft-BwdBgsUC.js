import{a}from"./react-vendor-0u4i6o3R.js";function E({form:n,storageKey:t,debounceMs:i=1e3,defaultValues:l={}}){const c=a.useRef(null),f=a.useRef(!1),o=a.useCallback(r=>{try{const e={data:r,savedAt:new Date().toISOString()};localStorage.setItem(t,JSON.stringify(e))}catch(e){console.warn("Error saving form draft:",e)}},[t]),u=a.useCallback(()=>{try{const r=localStorage.getItem(t);if(r)return JSON.parse(r).data}catch(r){console.warn("Error loading form draft:",r)}return null},[t]),d=a.useCallback(()=>{try{localStorage.removeItem(t)}catch(r){console.warn("Error clearing form draft:",r)}},[t]),m=a.useCallback(()=>{try{return localStorage.getItem(t)!==null}catch{return!1}},[t]);return a.useEffect(()=>{if(!f.current){const r=u();if(r){const e=n.getValues(),D=!n.formState.isDirty,S=Object.entries(e).some(([b,s])=>{const h=l[b];return!(s===h||s===""||s===!1||s===null||s===void 0)});D&&!S&&n.reset(r)}f.current=!0}},[n,u,l]),a.useEffect(()=>{const r=n.watch(e=>{c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{o(e)},i)});return()=>{r.unsubscribe(),c.current&&clearTimeout(c.current)}},[n,o,i]),{loadDraft:u,clearDraft:d,hasDraft:m,saveDraft:o}}export{E as u};
